[05:36:42] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23358328 edges into 16 parts and get 6265389 edge cuts
main start at this time 1651556182.219031
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02956557273864746
global_2_local spend time (sec) 0.035095930099487305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004682302474975586
A = g.adjacency_matrix() spent  0.007596254348754883
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07728743553161621
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2834115028381348
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1842234134674072

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328})
Convert a graph into a bidirected graph: 0.973 seconds
Metis partitioning: 4.739 seconds
Split the graph: 0.686 seconds
Construct subgraphs: 0.069 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.477477788925171
5797
5796
5721
5804
5823
5786
5809
5799
5517
5727
5606
5517
5517
5553
5559
5610
total k batches seeds list generation spend  16.975533723831177
after graph partition
graph partition algorithm spend time 17.052402019500732
5797
5796
5721
5804
5823
5786
5809
5799
5517
5727
5606
5517
5517
5553
5559
5610
partition_len_list
[13354, 11018, 14542, 14361, 11345, 11106, 13460, 13326, 30082, 27936, 32476, 25378, 27607, 21189, 16704, 14684]
shared_neighbor_graph_partition_s0 selection method  spend 17.1357638835907
time for parepare:  0.017215251922607422
local_output_nid generation:  0.0011799335479736328
local_in_edges_tensor generation:  0.0013871192932128906
mini_batch_src_global generation:  0.0014955997467041016
r_  generation:  0.013315677642822266
local_output_nid generation:  0.001352548599243164
local_in_edges_tensor generation:  0.001317739486694336
mini_batch_src_global generation:  0.0011968612670898438
r_  generation:  0.011980772018432617
local_output_nid generation:  0.001333475112915039
local_in_edges_tensor generation:  0.0012383460998535156
mini_batch_src_global generation:  0.0014142990112304688
r_  generation:  0.01589512825012207
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0012180805206298828
mini_batch_src_global generation:  0.0014352798461914062
r_  generation:  0.014772176742553711
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.0012123584747314453
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.01666569709777832
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0011837482452392578
mini_batch_src_global generation:  0.0013065338134765625
r_  generation:  0.013819694519042969
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0011909008026123047
mini_batch_src_global generation:  0.0013408660888671875
r_  generation:  0.01567673683166504
local_output_nid generation:  0.0014867782592773438
local_in_edges_tensor generation:  0.0011444091796875
mini_batch_src_global generation:  0.0013706684112548828
r_  generation:  0.015526533126831055
local_output_nid generation:  0.0014758110046386719
local_in_edges_tensor generation:  0.0012848377227783203
mini_batch_src_global generation:  0.0015645027160644531
r_  generation:  0.019364118576049805
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0014491081237792969
mini_batch_src_global generation:  0.002607583999633789
r_  generation:  0.02375197410583496
local_output_nid generation:  0.0017342567443847656
local_in_edges_tensor generation:  0.0013463497161865234
mini_batch_src_global generation:  0.0018603801727294922
r_  generation:  0.021259546279907227
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0012476444244384766
mini_batch_src_global generation:  0.0014913082122802734
r_  generation:  0.01543283462524414
local_output_nid generation:  0.0016579627990722656
local_in_edges_tensor generation:  0.001218557357788086
mini_batch_src_global generation:  0.0014989376068115234
r_  generation:  0.018643617630004883
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0011730194091796875
mini_batch_src_global generation:  0.0014464855194091797
r_  generation:  0.015126705169677734
local_output_nid generation:  0.0016252994537353516
local_in_edges_tensor generation:  0.0011277198791503906
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.01095890998840332
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0011119842529296875
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.012540340423583984
----------------------check_connections_block total spend ----------------------------- 0.40424680709838867
generate_one_block  0.02147984504699707
generate_one_block  0.015993833541870117
generate_one_block  0.022299766540527344
generate_one_block  0.02014613151550293
generate_one_block  0.026299715042114258
generate_one_block  0.019004106521606445
generate_one_block  0.02136969566345215
generate_one_block  0.020791053771972656
generate_one_block  0.028881549835205078
generate_one_block  0.034262895584106445
generate_one_block  0.031088829040527344
generate_one_block  0.021027565002441406
generate_one_block  0.0251767635345459
generate_one_block  0.021259546279907227
generate_one_block  0.01663947105407715
generate_one_block  0.015363693237304688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02254319190979004
gen group dst list time:  0.00858759880065918
time for parepare:  0.02158641815185547
local_output_nid generation:  0.0025789737701416016
local_in_edges_tensor generation:  0.007019519805908203
mini_batch_src_global generation:  0.007119894027709961
r_  generation:  0.02772378921508789
local_output_nid generation:  0.003154754638671875
local_in_edges_tensor generation:  0.0026979446411132812
mini_batch_src_global generation:  0.002321004867553711
r_  generation:  0.021071672439575195
local_output_nid generation:  0.004105806350708008
local_in_edges_tensor generation:  0.003551483154296875
mini_batch_src_global generation:  0.0030591487884521484
r_  generation:  0.03447246551513672
local_output_nid generation:  0.003966331481933594
local_in_edges_tensor generation:  0.0037031173706054688
mini_batch_src_global generation:  0.0032515525817871094
r_  generation:  0.032233238220214844
local_output_nid generation:  0.003315448760986328
local_in_edges_tensor generation:  0.0026559829711914062
mini_batch_src_global generation:  0.002473115921020508
r_  generation:  0.02631831169128418
local_output_nid generation:  0.0030333995819091797
local_in_edges_tensor generation:  0.002460002899169922
mini_batch_src_global generation:  0.0020303726196289062
r_  generation:  0.0229494571685791
local_output_nid generation:  0.0037145614624023438
local_in_edges_tensor generation:  0.0029115676879882812
mini_batch_src_global generation:  0.002791166305541992
r_  generation:  0.03275656700134277
local_output_nid generation:  0.0046367645263671875
local_in_edges_tensor generation:  0.003973722457885742
mini_batch_src_global generation:  0.00468897819519043
r_  generation:  0.03060173988342285
local_output_nid generation:  0.007533550262451172
local_in_edges_tensor generation:  0.008925676345825195
mini_batch_src_global generation:  0.008655071258544922
r_  generation:  0.08831024169921875
local_output_nid generation:  0.007247209548950195
local_in_edges_tensor generation:  0.02030181884765625
mini_batch_src_global generation:  0.017937898635864258
r_  generation:  0.08359646797180176
local_output_nid generation:  0.008467912673950195
local_in_edges_tensor generation:  0.007147073745727539
mini_batch_src_global generation:  0.015088319778442383
r_  generation:  0.09435129165649414
local_output_nid generation:  0.0073337554931640625
local_in_edges_tensor generation:  0.0056858062744140625
mini_batch_src_global generation:  0.014765024185180664
r_  generation:  0.07051396369934082
local_output_nid generation:  0.00859212875366211
local_in_edges_tensor generation:  0.006084918975830078
mini_batch_src_global generation:  0.011443138122558594
r_  generation:  0.0791022777557373
local_output_nid generation:  0.006038665771484375
local_in_edges_tensor generation:  0.004976987838745117
mini_batch_src_global generation:  0.007371664047241211
r_  generation:  0.056523799896240234
local_output_nid generation:  0.0049800872802734375
local_in_edges_tensor generation:  0.003899097442626953
mini_batch_src_global generation:  0.004519462585449219
r_  generation:  0.03915548324584961
local_output_nid generation:  0.004279136657714844
local_in_edges_tensor generation:  0.003276824951171875
mini_batch_src_global generation:  0.003328084945678711
r_  generation:  0.03275775909423828
----------------------check_connections_block total spend ----------------------------- 1.2782630920410156
generate_one_block  0.03527021408081055
generate_one_block  0.027008771896362305
generate_one_block  0.04581618309020996
generate_one_block  0.04257321357727051
generate_one_block  0.034635305404663086
generate_one_block  0.028916358947753906
generate_one_block  0.04813838005065918
generate_one_block  0.03864288330078125
generate_one_block  0.12328982353210449
generate_one_block  0.10718131065368652
generate_one_block  0.12713360786437988
generate_one_block  0.09312629699707031
generate_one_block  0.10425376892089844
generate_one_block  0.07132124900817871
generate_one_block  0.04953265190124512
generate_one_block  0.0412135124206543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.2782630920410156
block generation total time  1.0180535316467285
average batch blocks generation time:  0.06362834572792053
pseudo mini batch 0 input nodes size: 25731
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.015047073364257812  GigaBytes
Max Memory Allocated: 0.015047073364257812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.015090465545654297  GigaBytes
Max Memory Allocated: 0.015090465545654297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.015090465545654297  GigaBytes
Max Memory Allocated: 0.015090465545654297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01596689224243164  GigaBytes
Max Memory Allocated: 0.01596689224243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01596689224243164  GigaBytes
Max Memory Allocated: 0.01596689224243164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01596689224243164  GigaBytes
Max Memory Allocated: 0.01596689224243164  GigaBytes

torch.Size([25731, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01596689224243164  GigaBytes
Max Memory Allocated: 0.01596689224243164  GigaBytes

m.shape torch.Size([1463, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.05513763427734375  GigaBytes
Max Memory Allocated: 0.05554389953613281  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.05513763427734375  GigaBytes
Max Memory Allocated: 0.05554389953613281  GigaBytes

 h.shape torch.Size([1, 1463, 128]), torch.Size([1, 1463, 128])
----------------------------------------3
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.056532859802246094  GigaBytes
Max Memory Allocated: 0.056532859802246094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.06769466400146484  GigaBytes
Max Memory Allocated: 0.06839227676391602  GigaBytes

rst.shape  torch.Size([1, 1463, 128])
m.shape torch.Size([1474, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.06867742538452148  GigaBytes
Max Memory Allocated: 0.0687112808227539  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.06867742538452148  GigaBytes
Max Memory Allocated: 0.0687112808227539  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0700831413269043  GigaBytes
Max Memory Allocated: 0.0700831413269043  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09116888046264648  GigaBytes
Max Memory Allocated: 0.0925745964050293  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([1375, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09319162368774414  GigaBytes
Max Memory Allocated: 0.09323835372924805  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09319162368774414  GigaBytes
Max Memory Allocated: 0.09323835372924805  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09450292587280273  GigaBytes
Max Memory Allocated: 0.09450292587280273  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12395811080932617  GigaBytes
Max Memory Allocated: 0.12592506408691406  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1201, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.1255931854248047  GigaBytes
Max Memory Allocated: 0.12592506408691406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.1255931854248047  GigaBytes
Max Memory Allocated: 0.12592506408691406  GigaBytes

 h.shape torch.Size([1, 1201, 128]), torch.Size([1, 1201, 128])
----------------------------------------3
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.1267385482788086  GigaBytes
Max Memory Allocated: 0.1267385482788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.15995407104492188  GigaBytes
Max Memory Allocated: 0.1622447967529297  GigaBytes

rst.shape  torch.Size([1, 1201, 128])
m.shape torch.Size([1130, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.16207551956176758  GigaBytes
Max Memory Allocated: 0.1622447967529297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.16207551956176758  GigaBytes
Max Memory Allocated: 0.1622447967529297  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.16315317153930664  GigaBytes
Max Memory Allocated: 0.16315317153930664  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20208215713500977  GigaBytes
Max Memory Allocated: 0.20477628707885742  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([904, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20412969589233398  GigaBytes
Max Memory Allocated: 0.20477628707885742  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20412969589233398  GigaBytes
Max Memory Allocated: 0.20477628707885742  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20499181747436523  GigaBytes
Max Memory Allocated: 0.20499181747436523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.24274015426635742  GigaBytes
Max Memory Allocated: 0.24532651901245117  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([731, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2447490692138672  GigaBytes
Max Memory Allocated: 0.24532651901245117  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2447490692138672  GigaBytes
Max Memory Allocated: 0.24532651901245117  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.24544620513916016  GigaBytes
Max Memory Allocated: 0.24544620513916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.28156566619873047  GigaBytes
Max Memory Allocated: 0.28400564193725586  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([668, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.2837653160095215  GigaBytes
Max Memory Allocated: 0.28400564193725586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.2837653160095215  GigaBytes
Max Memory Allocated: 0.28400564193725586  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.28440237045288086  GigaBytes
Max Memory Allocated: 0.28440237045288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32205629348754883  GigaBytes
Max Memory Allocated: 0.32460451126098633  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([559, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32413673400878906  GigaBytes
Max Memory Allocated: 0.32460451126098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32413673400878906  GigaBytes
Max Memory Allocated: 0.32460451126098633  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32466983795166016  GigaBytes
Max Memory Allocated: 0.32466983795166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.35944318771362305  GigaBytes
Max Memory Allocated: 0.36184215545654297  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([3849, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3775300979614258  GigaBytes
Max Memory Allocated: 0.3779606819152832  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3775300979614258  GigaBytes
Max Memory Allocated: 0.3779606819152832  GigaBytes

 h.shape torch.Size([1, 3849, 128]), torch.Size([1, 3849, 128])
----------------------------------------3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.38213443756103516  GigaBytes
Max Memory Allocated: 0.38213443756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.6427536010742188  GigaBytes
Max Memory Allocated: 0.661107063293457  GigaBytes

rst.shape  torch.Size([1, 3849, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.6100749969482422  GigaBytes
Max Memory Allocated: 0.661107063293457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.6228103637695312  GigaBytes
Max Memory Allocated: 0.661107063293457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6364822387695312  GigaBytes
Max Memory Allocated: 0.661107063293457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6236472129821777  GigaBytes
Max Memory Allocated: 0.661107063293457  GigaBytes

torch.Size([13354, 256])
first layer input nodes number: 25731
first layer output nodes number: 13354
edges number: 78396
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6366763114929199  GigaBytes
Max Memory Allocated: 0.661107063293457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.649411678314209  GigaBytes
Max Memory Allocated: 0.661107063293457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6535320281982422  GigaBytes
Max Memory Allocated: 0.6662673950195312  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6535320281982422  GigaBytes
Max Memory Allocated: 0.6662673950195312  GigaBytes

m.shape torch.Size([970, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6922645568847656  GigaBytes
Max Memory Allocated: 0.6922683715820312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6922645568847656  GigaBytes
Max Memory Allocated: 0.6922683715820312  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.6941146850585938  GigaBytes
Max Memory Allocated: 0.6941146850585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7089157104492188  GigaBytes
Max Memory Allocated: 0.7098407745361328  GigaBytes

rst.shape  torch.Size([1, 970, 256])
m.shape torch.Size([811, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7096676826477051  GigaBytes
Max Memory Allocated: 0.7098407745361328  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7096676826477051  GigaBytes
Max Memory Allocated: 0.7098407745361328  GigaBytes

 h.shape torch.Size([1, 811, 256]), torch.Size([1, 811, 256])
----------------------------------------3
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.711214542388916  GigaBytes
Max Memory Allocated: 0.711214542388916  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.7345976829528809  GigaBytes
Max Memory Allocated: 0.7363524436950684  GigaBytes

rst.shape  torch.Size([1, 811, 256])
m.shape torch.Size([623, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.7356295585632324  GigaBytes
Max Memory Allocated: 0.7363524436950684  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.7356295585632324  GigaBytes
Max Memory Allocated: 0.7363524436950684  GigaBytes

 h.shape torch.Size([1, 623, 256]), torch.Size([1, 623, 256])
----------------------------------------3
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.7368178367614746  GigaBytes
Max Memory Allocated: 0.7368178367614746  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7629599571228027  GigaBytes
Max Memory Allocated: 0.764742374420166  GigaBytes

rst.shape  torch.Size([1, 623, 256])
m.shape torch.Size([513, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.764338493347168  GigaBytes
Max Memory Allocated: 0.764742374420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.764338493347168  GigaBytes
Max Memory Allocated: 0.764742374420166  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7653169631958008  GigaBytes
Max Memory Allocated: 0.7653169631958008  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7943525314331055  GigaBytes
Max Memory Allocated: 0.7963094711303711  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([465, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7960982322692871  GigaBytes
Max Memory Allocated: 0.7963094711303711  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7960982322692871  GigaBytes
Max Memory Allocated: 0.7963094711303711  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7969851493835449  GigaBytes
Max Memory Allocated: 0.7969851493835449  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8290009498596191  GigaBytes
Max Memory Allocated: 0.8312182426452637  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8305010795593262  GigaBytes
Max Memory Allocated: 0.8312182426452637  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8305010795593262  GigaBytes
Max Memory Allocated: 0.8312182426452637  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.831143856048584  GigaBytes
Max Memory Allocated: 0.8312182426452637  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.8592524528503418  GigaBytes
Max Memory Allocated: 0.8611807823181152  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([292, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.8608956336975098  GigaBytes
Max Memory Allocated: 0.8611807823181152  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.8608956336975098  GigaBytes
Max Memory Allocated: 0.8611807823181152  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.861452579498291  GigaBytes
Max Memory Allocated: 0.861452579498291  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8901915550231934  GigaBytes
Max Memory Allocated: 0.8921408653259277  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([246, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8918275833129883  GigaBytes
Max Memory Allocated: 0.8921408653259277  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8918275833129883  GigaBytes
Max Memory Allocated: 0.8921408653259277  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8922967910766602  GigaBytes
Max Memory Allocated: 0.8922967910766602  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.919041633605957  GigaBytes
Max Memory Allocated: 0.9209184646606445  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.9205718040466309  GigaBytes
Max Memory Allocated: 0.9209184646606445  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.9205718040466309  GigaBytes
Max Memory Allocated: 0.9209184646606445  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.9209609031677246  GigaBytes
Max Memory Allocated: 0.9209609031677246  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9458632469177246  GigaBytes
Max Memory Allocated: 0.9476141929626465  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([168, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9472837448120117  GigaBytes
Max Memory Allocated: 0.9476141929626465  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9472837448120117  GigaBytes
Max Memory Allocated: 0.9476141929626465  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9476041793823242  GigaBytes
Max Memory Allocated: 0.9476141929626465  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.9703550338745117  GigaBytes
Max Memory Allocated: 0.9719572067260742  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.9717278480529785  GigaBytes
Max Memory Allocated: 0.9719572067260742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.9717278480529785  GigaBytes
Max Memory Allocated: 0.9719572067260742  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.9720044136047363  GigaBytes
Max Memory Allocated: 0.9720044136047363  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.9935765266418457  GigaBytes
Max Memory Allocated: 0.9950976371765137  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.9946842193603516  GigaBytes
Max Memory Allocated: 0.9950976371765137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.9946842193603516  GigaBytes
Max Memory Allocated: 0.9950976371765137  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.9948902130126953  GigaBytes
Max Memory Allocated: 0.9950976371765137  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 1.012399673461914  GigaBytes
Max Memory Allocated: 1.0136356353759766  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 1.0135464668273926  GigaBytes
Max Memory Allocated: 1.0136356353759766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 1.0135464668273926  GigaBytes
Max Memory Allocated: 1.0136356353759766  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 1.0137372016906738  GigaBytes
Max Memory Allocated: 1.0137372016906738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 1.0312848091125488  GigaBytes
Max Memory Allocated: 1.032524585723877  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 1.0324139595031738  GigaBytes
Max Memory Allocated: 1.032524585723877  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 1.0324139595031738  GigaBytes
Max Memory Allocated: 1.032524585723877  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 1.0325875282287598  GigaBytes
Max Memory Allocated: 1.0325875282287598  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.0497708320617676  GigaBytes
Max Memory Allocated: 1.0509858131408691  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.0507984161376953  GigaBytes
Max Memory Allocated: 1.0509858131408691  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.0507984161376953  GigaBytes
Max Memory Allocated: 1.0509858131408691  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.050933837890625  GigaBytes
Max Memory Allocated: 1.0509858131408691  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0652885437011719  GigaBytes
Max Memory Allocated: 1.0663042068481445  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.066359043121338  GigaBytes
Max Memory Allocated: 1.06636381149292  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.066359043121338  GigaBytes
Max Memory Allocated: 1.06636381149292  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.066500186920166  GigaBytes
Max Memory Allocated: 1.066500186920166  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0824494361877441  GigaBytes
Max Memory Allocated: 1.0835785865783691  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2791748046875 GB
    Memory Allocated: 1.0831470489501953  GigaBytes
Max Memory Allocated: 1.0835785865783691  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2791748046875 GB
    Memory Allocated: 1.0831470489501953  GigaBytes
Max Memory Allocated: 1.0835785865783691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2791748046875 GB
    Memory Allocated: 1.0832366943359375  GigaBytes
Max Memory Allocated: 1.0835785865783691  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 1.093994140625  GigaBytes
Max Memory Allocated: 1.0947561264038086  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 1.0947628021240234  GigaBytes
Max Memory Allocated: 1.0947661399841309  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 1.0947628021240234  GigaBytes
Max Memory Allocated: 1.0947661399841309  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 1.0948524475097656  GigaBytes
Max Memory Allocated: 1.0948524475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3006591796875 GB
    Memory Allocated: 1.1062374114990234  GigaBytes
Max Memory Allocated: 1.1070442199707031  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 1.1070876121520996  GigaBytes
Max Memory Allocated: 1.1070914268493652  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 1.1070876121520996  GigaBytes
Max Memory Allocated: 1.1070914268493652  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 1.1071810722351074  GigaBytes
Max Memory Allocated: 1.1071810722351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.1197047233581543  GigaBytes
Max Memory Allocated: 1.1205925941467285  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.1205806732177734  GigaBytes
Max Memory Allocated: 1.1205925941467285  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.1205806732177734  GigaBytes
Max Memory Allocated: 1.1205925941467285  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.1206722259521484  GigaBytes
Max Memory Allocated: 1.1206722259521484  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 1.1335811614990234  GigaBytes
Max Memory Allocated: 1.1344966888427734  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 1.134080410003662  GigaBytes
Max Memory Allocated: 1.1344966888427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 1.134080410003662  GigaBytes
Max Memory Allocated: 1.1344966888427734  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 1.134131908416748  GigaBytes
Max Memory Allocated: 1.1344966888427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 1.1417536735534668  GigaBytes
Max Memory Allocated: 1.1422944068908691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 1.1422991752624512  GigaBytes
Max Memory Allocated: 1.1423015594482422  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 1.1422991752624512  GigaBytes
Max Memory Allocated: 1.1423015594482422  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 1.142350673675537  GigaBytes
Max Memory Allocated: 1.142350673675537  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 1.1503329277038574  GigaBytes
Max Memory Allocated: 1.1508994102478027  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 1.1508378982543945  GigaBytes
Max Memory Allocated: 1.1508994102478027  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 1.1508378982543945  GigaBytes
Max Memory Allocated: 1.1508994102478027  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 1.150883674621582  GigaBytes
Max Memory Allocated: 1.1508994102478027  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.158299446105957  GigaBytes
Max Memory Allocated: 1.1588258743286133  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.1587152481079102  GigaBytes
Max Memory Allocated: 1.1588258743286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.1587152481079102  GigaBytes
Max Memory Allocated: 1.1588258743286133  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.1587514877319336  GigaBytes
Max Memory Allocated: 1.1588258743286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.1648759841918945  GigaBytes
Max Memory Allocated: 1.1653108596801758  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.1718502044677734  GigaBytes
Max Memory Allocated: 1.171877384185791  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.1718502044677734  GigaBytes
Max Memory Allocated: 1.171877384185791  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.1724052429199219  GigaBytes
Max Memory Allocated: 1.1724052429199219  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.2734107971191406  GigaBytes
Max Memory Allocated: 1.280348777770996  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.241262435913086  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.24212646484375  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 1.242990493774414  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 1.2420830726623535  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

torch.Size([5797, 40])
input nodes number: 13354
output nodes number: 5797
edges number: 39082
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 1.2430901527404785  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 1.243091106414795  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.021332263946533203  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

pseudo mini batch 1 input nodes size: 18212
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.018730640411376953  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.018730640411376953  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.027414798736572266  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.02745819091796875  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.015145301818847656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.015816688537597656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.015816688537597656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.015816688537597656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

torch.Size([18212, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.015816688537597656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

m.shape torch.Size([1460, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.044592857360839844  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.044592857360839844  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.04598522186279297  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.05712413787841797  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([1567, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.058630943298339844  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.058630943298339844  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1567, 128]), torch.Size([1, 1567, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.06012535095214844  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.08282184600830078  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1567, 128])
m.shape torch.Size([1328, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.08397436141967773  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.08397436141967773  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1328, 128]), torch.Size([1, 1328, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.08524084091186523  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.11310338973999023  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1328, 128])
m.shape torch.Size([1155, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.11467313766479492  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.11467313766479492  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.11577463150024414  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.14797544479370117  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([953, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.14969682693481445  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.14969682693481445  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.1506056785583496  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.18354320526123047  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([758, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.1852574348449707  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.1852574348449707  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.18598031997680664  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.2185673713684082  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([634, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.2203221321105957  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.2203221321105957  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.22092676162719727  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.25164365768432617  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([519, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.25332117080688477  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.25332117080688477  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.2538161277770996  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.28220605850219727  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([425, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.2837824821472168  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.2837824821472168  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.28418779373168945  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.31012773513793945  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([2219, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.32050609588623047  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.32050609588623047  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 2219, 128]), torch.Size([1, 2219, 128])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.3233647346496582  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.4779839515686035  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 2219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.45424699783325195  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.464754581451416  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.4752621650695801  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.4646720886230469  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

torch.Size([11018, 256])
first layer input nodes number: 18212
first layer output nodes number: 11018
edges number: 57116
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.4753999710083008  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.48590755462646484  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.48853445053100586  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.48853445053100586  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

m.shape torch.Size([1018, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5213098526000977  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5213098526000977  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1018, 256]), torch.Size([1, 1018, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5232515335083008  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5389471054077148  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1018, 256])
m.shape torch.Size([910, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5397257804870605  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5397257804870605  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 910, 256]), torch.Size([1, 910, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5414614677429199  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5674967765808105  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 910, 256])
m.shape torch.Size([737, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5687713623046875  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5687713623046875  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.5701770782470703  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6011028289794922  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([568, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6025838851928711  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6025838851928711  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6036672592163086  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6351156234741211  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([455, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6367607116699219  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6367607116699219  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6376285552978516  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6704397201538086  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([371, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6721453666687012  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6721453666687012  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.6728529930114746  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7032809257507324  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([304, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7049727439880371  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7049727439880371  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7055525779724121  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.734900951385498  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([243, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7364797592163086  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7364797592163086  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.736943244934082  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.763361930847168  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7647566795349121  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7647566795349121  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7651152610778809  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7880644798278809  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7894906997680664  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7894906997680664  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.7898092269897461  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8124246597290039  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8135237693786621  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8135237693786621  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8137507438659668  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8314547538757324  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8326330184936523  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8326330184936523  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8328466415405273  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8510046005249023  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8520393371582031  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8520393371582031  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8522071838378906  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8676490783691406  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8685340881347656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8685340881347656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8686714172363281  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8822669982910156  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8833475112915039  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8833475112915039  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8834905624389648  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8986539840698242  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8993363380432129  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8993363380432129  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.8994297981262207  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9099907875061035  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9106960296630859  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9106960296630859  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9107837677001953  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9213123321533203  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.922029972076416  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.922029972076416  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9221138954162598  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.932772159576416  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9332599639892578  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9332599639892578  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9333152770996094  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9407272338867188  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.941103458404541  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.941103458404541  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9411435127258301  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9467911720275879  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9471344947814941  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9471344947814941  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9471688270568848  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9522500038146973  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9526138305664062  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9526138305664062  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9526481628417969  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9579696655273438  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9583063125610352  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9583063125610352  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9583368301391602  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9632806777954102  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9636807441711426  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9636807441711426  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9637150764465332  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9695172309875488  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([110, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9721431732177734  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9721431732177734  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.9723529815673828  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0092792510986328  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 110, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9832587242126465  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9841227531433105  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9849867820739746  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9840793609619141  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

torch.Size([5796, 40])
input nodes number: 11018
output nodes number: 5796
edges number: 32839
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9842052459716797  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9842057228088379  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.017182350158691406  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

pseudo mini batch 2 input nodes size: 34135
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.015145301818847656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.015145301818847656  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.03142213821411133  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.03146505355834961  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.022737503051757812  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.02385425567626953  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.02385425567626953  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.02385425567626953  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

torch.Size([34135, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.02385425567626953  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

m.shape torch.Size([1059, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.07448816299438477  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.07448816299438477  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.07549810409545898  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.08357763290405273  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1138, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.08430719375610352  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.08430719375610352  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.08539247512817383  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.10262155532836914  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1115, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.10367393493652344  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.10367393493652344  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.1047372817993164  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.1290426254272461  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1000, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.1304183006286621  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.1304183006286621  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.13137197494506836  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.1594862937927246  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([943, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.16125774383544922  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.16125774383544922  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 943, 128]), torch.Size([1, 943, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.1621570587158203  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.19530153274536133  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 943, 128])
m.shape torch.Size([814, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.19718074798583984  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.19718074798583984  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.19795703887939453  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.2322378158569336  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([717, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.23424291610717773  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.23424291610717773  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.23492670059204102  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.2695012092590332  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([709, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.2718639373779297  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.2718639373779297  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.2725400924682617  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.31165266036987305  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([620, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.31397533416748047  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.31397533416748047  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.31456661224365234  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.35349178314208984  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([6427, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.38384246826171875  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.38384246826171875  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 6427, 128]), torch.Size([1, 6427, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.3899717330932617  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8251495361328125  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 6427, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.7805905342102051  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.7944588661193848  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8083271980285645  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.7943501472473145  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

torch.Size([14542, 256])
first layer input nodes number: 34135
first layer output nodes number: 14542
edges number: 100820
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8085837364196777  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8224520683288574  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.82666015625  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.82666015625  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

m.shape torch.Size([740, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8746895790100098  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8746895790100098  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.876101016998291  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.887392520904541  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 740, 256])
m.shape torch.Size([637, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8883233070373535  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8883233070373535  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 637, 256]), torch.Size([1, 637, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.8895382881164551  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9077630043029785  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 637, 256])
m.shape torch.Size([547, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9091877937316895  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9091877937316895  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9102311134338379  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9349126815795898  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([480, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9362363815307617  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9362363815307617  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9371519088745117  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9637022018432617  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9650754928588867  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9650754928588867  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9658021926879883  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9932737350463867  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9947042465209961  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9947042465209961  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.9952974319458008  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.021195411682129  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([267, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.022695541381836  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.022695541381836  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.0232048034667969  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.050704002380371  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([249, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.0523643493652344  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.0523643493652344  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.0528392791748047  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.0799102783203125  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([220, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.081575870513916  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.081575870513916  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.0819954872131348  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1088509559631348  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([195, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1105155944824219  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1105155944824219  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1108875274658203  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1372947692871094  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1387267112731934  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1387267112731934  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1390185356140137  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.161780834197998  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([147, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1633305549621582  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1633305549621582  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1636109352111816  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.1874432563781738  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([117, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.188765048980713  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.188765048980713  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.188988208770752  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2095189094543457  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([119, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2110090255737305  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2110090255737305  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2112360000610352  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2337064743041992  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([103, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2350783348083496  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2350783348083496  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2352747917175293  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2560992240905762  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.257260799407959  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.257260799407959  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2573962211608887  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2726988792419434  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([77, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.273940086364746  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.273940086364746  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2740869522094727  GigaBytes
Max Memory Allocated: 1.2897367477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2917108535766602  GigaBytes
Max Memory Allocated: 1.292959213256836  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2927446365356445  GigaBytes
Max Memory Allocated: 1.292959213256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2927446365356445  GigaBytes
Max Memory Allocated: 1.292959213256836  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2928667068481445  GigaBytes
Max Memory Allocated: 1.292959213256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3083696365356445  GigaBytes
Max Memory Allocated: 1.3094682693481445  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3092036247253418  GigaBytes
Max Memory Allocated: 1.3094682693481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3092036247253418  GigaBytes
Max Memory Allocated: 1.3094682693481445  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3092970848083496  GigaBytes
Max Memory Allocated: 1.3094682693481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3218207359313965  GigaBytes
Max Memory Allocated: 1.3227086067199707  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3227968215942383  GigaBytes
Max Memory Allocated: 1.322801113128662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3227968215942383  GigaBytes
Max Memory Allocated: 1.322801113128662  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3228960037231445  GigaBytes
Max Memory Allocated: 1.3228960037231445  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3368806838989258  GigaBytes
Max Memory Allocated: 1.3378725051879883  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3377394676208496  GigaBytes
Max Memory Allocated: 1.3378725051879883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3377394676208496  GigaBytes
Max Memory Allocated: 1.3378725051879883  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3378252983093262  GigaBytes
Max Memory Allocated: 1.3378725051879883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3505282402038574  GigaBytes
Max Memory Allocated: 1.3514294624328613  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3515849113464355  GigaBytes
Max Memory Allocated: 1.3515892028808594  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3515849113464355  GigaBytes
Max Memory Allocated: 1.3515892028808594  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3516840934753418  GigaBytes
Max Memory Allocated: 1.3516840934753418  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3670573234558105  GigaBytes
Max Memory Allocated: 1.3681483268737793  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.3677153587341309  GigaBytes
Max Memory Allocated: 1.3681483268737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.3677153587341309  GigaBytes
Max Memory Allocated: 1.3681483268737793  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.3677763938903809  GigaBytes
Max Memory Allocated: 1.3681483268737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.3776640892028809  GigaBytes
Max Memory Allocated: 1.3783659934997559  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.378556251525879  GigaBytes
Max Memory Allocated: 1.3785600662231445  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.378556251525879  GigaBytes
Max Memory Allocated: 1.3785600662231445  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.3786325454711914  GigaBytes
Max Memory Allocated: 1.3786325454711914  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 1.391526222229004  GigaBytes
Max Memory Allocated: 1.392441749572754  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([573, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 1.4052562713623047  GigaBytes
Max Memory Allocated: 1.4053096771240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 1.4052562713623047  GigaBytes
Max Memory Allocated: 1.4053096771240234  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 1.4063491821289062  GigaBytes
Max Memory Allocated: 1.4063491821289062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5987224578857422  GigaBytes
Max Memory Allocated: 1.6123943328857422  GigaBytes

rst.shape  torch.Size([1, 573, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5577468872070312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5585994720458984  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.5594520568847656  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.5585565567016602  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([5721, 40])
input nodes number: 14542
output nodes number: 5721
edges number: 48994
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.5586967468261719  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.55869722366333  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.025969982147216797  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

pseudo mini batch 3 input nodes size: 30798
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.022726058959960938  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.022726058959960938  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.03741168975830078  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.037455081939697266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021135330200195312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02214527130126953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02214527130126953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02214527130126953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([30798, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.02214527130126953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([1268, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06780624389648438  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06780624389648438  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1268, 128]), torch.Size([1, 1268, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0690155029296875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.0793294906616211  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1268, 128])
m.shape torch.Size([1433, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08009147644042969  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08009147644042969  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.08145809173583984  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10195732116699219  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1296, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10312795639038086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10312795639038086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.10436391830444336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13155508041381836  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1296, 128])
m.shape torch.Size([1153, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13313627243041992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13313627243041992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.13423585891723633  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1661238670349121  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1000, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16795825958251953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16795825958251953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.16891193389892578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20349788665771484  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([873, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2055187225341797  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2055187225341797  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.20635128021240234  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24250316619873047  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([771, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2446603775024414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2446603775024414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.24539566040039062  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2825736999511719  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([723, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.28496408462524414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.28496408462524414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.28565359115600586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3252091407775879  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([585, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3273749351501465  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3273749351501465  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.32793283462524414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3647770881652832  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([5259, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3895750045776367  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3895750045776367  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 5259, 128]), torch.Size([1, 5259, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3945903778076172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7506818771362305  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 5259, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7110648155212402  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7247605323791504  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7384562492370605  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7246532440185547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([14361, 256])
first layer input nodes number: 30798
first layer output nodes number: 14361
edges number: 91908
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7386879920959473  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7523837089538574  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7558078765869141  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7558078765869141  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([848, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7985734939575195  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7985734939575195  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 848, 256]), torch.Size([1, 848, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8001909255981445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8131303787231445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 848, 256])
m.shape torch.Size([783, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.814023494720459  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.814023494720459  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8155169486999512  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8389983177185059  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([602, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.840242862701416  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.840242862701416  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8413910865783691  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8682703971862793  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([504, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8696889877319336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8696889877319336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8706502914428711  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.899381160736084  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([410, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9008712768554688  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9008712768554688  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9016532897949219  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9304141998291016  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([348, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.932030200958252  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.932030200958252  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9326939582824707  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9619331359863281  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([269, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9634113311767578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9634113311767578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9639244079589844  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9903616905212402  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([274, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9922122955322266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9922122955322266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9927349090576172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0228805541992188  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([178, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0241594314575195  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0241594314575195  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0244989395141602  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0462274551391602  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([177, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0477590560913086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0477590560913086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0480966567993164  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.072066307067871  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0735154151916504  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0735154151916504  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0738072395324707  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.096569538116455  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([134, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.09798002243042  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.09798002243042  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0982356071472168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1199603080749512  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1211819648742676  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1211819648742676  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1213879585266113  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1403393745422363  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.141420841217041  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.141420841217041  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1415886878967285  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.158205509185791  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1594195365905762  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1594195365905762  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1595911979675293  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1777873039245605  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([84, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1789932250976562  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1789932250976562  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1791534423828125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1972579956054688  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1982402801513672  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1982402801513672  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1983642578125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2132415771484375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2141313552856445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2141313552856445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2142362594604492  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2275590896606445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2284197807312012  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2284197807312012  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2285151481628418  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2412943840026855  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2422466278076172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2422466278076172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2423458099365234  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2563304901123047  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2572097778320312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2572097778320312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2572975158691406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2702827453613281  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.271169662475586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.271169662475586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2712535858154297  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.284261703491211  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.285170555114746  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.285170555114746  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.285252571105957  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.298539161682129  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2990517616271973  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2990517616271973  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2990975379943848  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3068337440490723  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([375, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3163814544677734  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3163814544677734  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3170967102050781  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.450413703918457  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 375, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.4140739440917969  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.4149389266967773  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.4158039093017578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.4148955345153809  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([5804, 40])
input nodes number: 14361
output nodes number: 5804
edges number: 43401
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.4150586128234863  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.4150590896606445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.024109363555908203  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

pseudo mini batch 4 input nodes size: 20901
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021147727966308594  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.021147727966308594  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.03111410140991211  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.031157493591308594  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.016428470611572266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01738882064819336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01738882064819336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01738882064819336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([20901, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.01738882064819336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([748, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05574607849121094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05574607849121094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.05645942687988281  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06366205215454102  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([887, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06415128707885742  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06415128707885742  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.06499719619750977  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07768583297729492  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([916, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07857322692871094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07857322692871094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.07944679260253906  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.09912872314453125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([865, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.100341796875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.100341796875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.1011667251586914  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12546539306640625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([788, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12693166732788086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12693166732788086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.12768316268920898  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15497541427612305  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([723, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15666818618774414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15666818618774414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.15735769271850586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18729448318481445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([639, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18908262252807617  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18908262252807617  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.18969202041625977  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22017669677734375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([592, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22213029861450195  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22213029861450195  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.22269487380981445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.25586938858032227  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([509, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.25777149200439453  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.25777149200439453  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2582569122314453  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.2893238067626953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([4678, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3113875389099121  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.3113875389099121  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 4678, 128]), torch.Size([1, 4678, 128])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.31584882736206055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6326003074645996  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 4678, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.5985698699951172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6093893051147461  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.620208740234375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6093044281005859  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([11345, 256])
first layer input nodes number: 20901
first layer output nodes number: 11345
edges number: 77578
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6203665733337402  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6311860084533691  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6338911056518555  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6338911056518555  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([565, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6838779449462891  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6838779449462891  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6849555969238281  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6935768127441406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([580, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6941885948181152  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6941885948181152  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.6952948570251465  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7118887901306152  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([518, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7130336761474609  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7130336761474609  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7140216827392578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7361173629760742  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7373957633972168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7373957633972168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7382750511169434  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7639613151550293  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([416, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7655210494995117  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7655210494995117  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7663145065307617  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7963666915893555  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([371, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7981095314025879  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7981095314025879  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.7988171577453613  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8305397033691406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([319, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8323321342468262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8323321342468262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8329405784606934  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8635563850402832  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([281, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8654131889343262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8654131889343262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8659491539001465  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8969416618347168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([233, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8986892700195312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8986892700195312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.8991336822509766  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9275760650634766  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([241, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9296703338623047  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9296703338623047  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9301300048828125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9627666473388672  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([226, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9649262428283691  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9649262428283691  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9653573036193848  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 0.9989800453186035  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([156, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0005640983581543  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0005640983581543  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.000861644744873  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0261530876159668  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([162, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0280284881591797  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0280284881591797  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0283374786376953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0567646026611328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([132, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0583863258361816  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0583863258361816  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.058638095855713  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0835633277893066  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([108, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.085014820098877  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.085014820098877  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.0852208137512207  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1070561408996582  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1085524559020996  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1085524559020996  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.108750820159912  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1311659812927246  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([94, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1326026916503906  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1326026916503906  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.132781982421875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.154296875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([79, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1555743217468262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1555743217468262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1557250022888184  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1748614311218262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1758480072021484  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1758480072021484  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1759567260742188  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1905250549316406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([88, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1921625137329102  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1921625137329102  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.1923303604125977  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2159967422485352  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2171845436096191  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2171845436096191  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2173047065734863  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.23508882522583  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2361087799072266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2361087799072266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2362060546875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2512836456298828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2520751953125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2520751953125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.2521476745605469  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9334716796875 GB
    Memory Allocated: 1.2638893127441406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9334716796875 GB
    Memory Allocated: 1.264822006225586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9334716796875 GB
    Memory Allocated: 1.264822006225586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9334716796875 GB
    Memory Allocated: 1.264902114868164  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2784404754638672  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([438, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2889251708984375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2889251708984375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2897605895996094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 1.4378652572631836  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 438, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 1.3940472602844238  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 1.3949151039123535  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.3957829475402832  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.394871711730957  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([5823, 40])
input nodes number: 11345
output nodes number: 5823
edges number: 51153
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.395002841949463  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.395003318786621  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.01920938491821289  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

pseudo mini batch 5 input nodes size: 20538
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.016431331634521484  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.016431331634521484  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.026224613189697266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02626800537109375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.01625823974609375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.017043113708496094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.017043113708496094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.017043113708496094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([20538, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.017043113708496094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([1237, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.049361228942871094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.049361228942871094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1237, 128]), torch.Size([1, 1237, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.050540924072265625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.059978485107421875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1237, 128])
m.shape torch.Size([1370, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.060907840728759766  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.060907840728759766  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1370, 128]), torch.Size([1, 1370, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06221437454223633  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08332586288452148  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1370, 128])
m.shape torch.Size([1196, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08438348770141602  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08438348770141602  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1196, 128]), torch.Size([1, 1196, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08552408218383789  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11117219924926758  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1196, 128])
m.shape torch.Size([1014, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11253595352172852  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11253595352172852  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11350297927856445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.14241647720336914  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([782, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1437973976135254  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1437973976135254  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.14454317092895508  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.17220830917358398  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([682, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.17378664016723633  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.17378664016723633  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1744370460510254  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.20240449905395508  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([586, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.20403528213500977  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.20403528213500977  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.20459413528442383  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.23306703567504883  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([517, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.23475980758666992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.23475980758666992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.23525285720825195  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2639641761779785  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([439, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.26560163497924805  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.26560163497924805  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2660202980041504  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2928147315979004  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([3283, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3082599639892578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3082599639892578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 3283, 128]), torch.Size([1, 3283, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3121366500854492  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5426349639892578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 3283, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5158400535583496  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5264315605163574  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5370230674743652  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5263485908508301  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([11106, 256])
first layer input nodes number: 20538
first layer output nodes number: 11106
edges number: 64642
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5371780395507812  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5477695465087891  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.550417423248291  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.550417423248291  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([894, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5908794403076172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5908794403076172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 894, 256]), torch.Size([1, 894, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.5925846099853516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6062259674072266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 894, 256])
m.shape torch.Size([856, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6075053215026855  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6075053215026855  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 856, 256]), torch.Size([1, 856, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.609138011932373  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6336283683776855  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 856, 256])
m.shape torch.Size([664, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6350913047790527  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6350913047790527  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6363577842712402  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6643352508544922  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([534, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6658544540405273  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6658544540405273  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6668729782104492  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6975374221801758  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([406, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.698979377746582  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.698979377746582  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6997537612915039  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7285776138305664  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([324, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7300591468811035  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7300591468811035  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7306771278381348  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7581005096435547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7595477104187012  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7595477104187012  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7600455284118652  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7853531837463379  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.786780834197998  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.786780834197998  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7871966361999512  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8108973503112793  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([202, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8124370574951172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8124370574951172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8128223419189453  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8374805450439453  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8388257026672363  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8388257026672363  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8391308784484863  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8607983589172363  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8620204925537109  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8620204925537109  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8622684478759766  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8816089630126953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8837900161743164  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8837900161743164  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8840475082397461  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9059343338012695  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9070553779602051  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9070553779602051  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9072461128234863  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9247937202453613  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.92584228515625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.92584228515625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9260044097900391  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9420547485351562  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9430117607116699  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9430117607116699  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9431490898132324  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9577059745788574  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9585909843444824  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9585909843444824  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9587092399597168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9720721244812012  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9731731414794922  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9731731414794922  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9733085632324219  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9895591735839844  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9905123710632324  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9905123710632324  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9906249046325684  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0049166679382324  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0059013366699219  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0059013366699219  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0060100555419922  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.020578384399414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0211200714111328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0211200714111328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.02117919921875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0295162200927734  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0304155349731445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0304155349731445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.030503273010254  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0434885025024414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.044121265411377  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.044121265411377  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.044182300567627  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.053642749786377  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0543417930603027  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0543417930603027  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0544047355651855  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0646014213562012  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.065216064453125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.065216064453125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0652694702148438  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0742950439453125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([326, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.082101821899414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.082101821899414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.082723617553711  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.195852279663086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 326, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1622014045715332  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1630640029907227  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.163926601409912  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1630206108093262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([5786, 40])
input nodes number: 11106
output nodes number: 5786
edges number: 40532
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1631417274475098  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.163142204284668  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.018592357635498047  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

pseudo mini batch 6 input nodes size: 23446
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.016252994537353516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.016252994537353516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.027432918548583984  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02747631072998047  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.017639636993408203  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.018663883209228516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.018663883209228516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.018663883209228516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([23446, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.018663883209228516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([1069, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06337356567382812  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06337356567382812  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0643930435180664  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07300186157226562  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1136, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0743093490600586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0743093490600586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0753927230834961  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09244251251220703  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1137, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09352731704711914  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09352731704711914  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09461164474487305  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11846685409545898  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([980, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.12075328826904297  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.12075328826904297  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1216878890991211  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.14963054656982422  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([942, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.15140914916992188  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.15140914916992188  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.15230751037597656  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18561840057373047  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([787, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18742084503173828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18742084503173828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18817138671875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22046184539794922  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([701, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2224264144897461  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2224264144897461  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22309494018554688  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2570796012878418  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([668, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.26023197174072266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.26023197174072266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.26086902618408203  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.29760074615478516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([538, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.299591064453125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.299591064453125  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.30010414123535156  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.33377790451049805  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([5502, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3597569465637207  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3597569465637207  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 5502, 128]), torch.Size([1, 5502, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3650040626525879  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7375493049621582  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 5502, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6980681419372559  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.710904598236084  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7237410545349121  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7108039855957031  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([13460, 256])
first layer input nodes number: 23446
first layer output nodes number: 13460
edges number: 90217
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7239179611206055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7367544174194336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7399635314941406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7399635314941406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([775, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7863273620605469  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7863273620605469  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 775, 256]), torch.Size([1, 775, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7878055572509766  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8006610870361328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 775, 256])
m.shape torch.Size([703, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8016700744628906  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8016700744628906  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 703, 256]), torch.Size([1, 703, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8030109405517578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8231239318847656  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 703, 256])
m.shape torch.Size([601, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8243098258972168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8243098258972168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8254561424255371  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8513674736022949  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8529672622680664  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8529672622680664  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8538236618041992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8796052932739258  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([396, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.881080150604248  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.881080150604248  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8818354606628418  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9090266227722168  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([335, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.910581111907959  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.910581111907959  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9112200736999512  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9399065971374512  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([295, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9415721893310547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9415721893310547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9421348571777344  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9705181121826172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([247, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9721360206604004  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9721360206604004  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9726071357727051  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9994606971740723  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([218, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0018911361694336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0018911361694336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0023069381713867  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0289182662963867  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([183, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0304694175720215  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0304694175720215  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0308184623718262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.055600643157959  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([172, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0572447776794434  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0572447776794434  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.057572841644287  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0831618309020996  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0845551490783691  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0845551490783691  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0848126411437988  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1066994667053223  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([116, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.108020305633545  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.108020305633545  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1082415580749512  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1285967826843262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([113, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1300067901611328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1300067901611328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1302223205566406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.151559829711914  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1528077125549316  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1528077125549316  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.152987003326416  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1719918251037598  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1731324195861816  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1731324195861816  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1732850074768066  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1905274391174316  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([85, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1918401718139648  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1918401718139648  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.192002296447754  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2114572525024414  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2123451232910156  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2123451232910156  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2124519348144531  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2260169982910156  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2268404960632324  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2268404960632324  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2269320487976074  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2392001152038574  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2403655052185059  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2403655052185059  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.240485668182373  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2574286460876465  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2584834098815918  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2584834098815918  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2585844993591309  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.273545742034912  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.274214267730713  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.274214267730713  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2742791175842285  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2843308448791504  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2850279808044434  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2850279808044434  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2850909233093262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2952876091003418  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2962942123413086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2962942123413086  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2963800430297852  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3108854293823242  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([480, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3223762512207031  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3223762512207031  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3232917785644531  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.4851875305175781  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 480, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.4451117515563965  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.4459776878356934  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.4468436241149902  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.4459342956542969  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([5809, 40])
input nodes number: 13460
output nodes number: 5809
edges number: 47220
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.4460816383361816  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.4460821151733398  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.020586013793945312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

pseudo mini batch 7 input nodes size: 26056
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.017642974853515625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.017642974853515625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.03006744384765625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.030110836029052734  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.01888751983642578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.01987457275390625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.01987457275390625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.01987457275390625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([26056, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.01987457275390625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([1191, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06276082992553711  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06276082992553711  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1191, 128]), torch.Size([1, 1191, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06389665603637695  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0729832649230957  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1191, 128])
m.shape torch.Size([1229, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07366275787353516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07366275787353516  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1229, 128]), torch.Size([1, 1229, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07483482360839844  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09241580963134766  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1229, 128])
m.shape torch.Size([1168, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09385347366333008  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09385347366333008  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09496736526489258  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11954545974731445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1058, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1215214729309082  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1215214729309082  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.12253046035766602  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.15179109573364258  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([925, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.15349197387695312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.15349197387695312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1543741226196289  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18681764602661133  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([848, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18880271911621094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18880271911621094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18961143493652344  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22450828552246094  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([691, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2264103889465332  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2264103889465332  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22706937789916992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2610006332397461  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([616, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.26302099227905273  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.26302099227905273  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.263608455657959  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.29773473739624023  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([527, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.29970264434814453  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.29970264434814453  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3002052307128906  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.33353090286254883  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([5073, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3574695587158203  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3574695587158203  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 5073, 128]), torch.Size([1, 5073, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3623075485229492  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7090320587158203  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 5073, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6715421676635742  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6842508316040039  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6969594955444336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6841511726379395  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([13326, 256])
first layer input nodes number: 26056
first layer output nodes number: 13326
edges number: 86336
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.6971559524536133  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.709864616394043  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7135448455810547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7135448455810547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([843, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7588200569152832  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7588200569152832  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 843, 256]), torch.Size([1, 843, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7604279518127441  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7732911109924316  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 843, 256])
m.shape torch.Size([708, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7740912437438965  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7740912437438965  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7754416465759277  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7973265647888184  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([632, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7984738349914551  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7984738349914551  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7996792793273926  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8264431953430176  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([493, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8281688690185547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8281688690185547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8291091918945312  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8565731048583984  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([405, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8580493927001953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8580493927001953  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8588218688964844  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8866310119628906  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([345, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8882346153259277  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8882346153259277  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.888892650604248  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9172930717468262  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9186191558837891  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9186191558837891  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9190883636474609  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9425487518310547  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9440674781799316  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9440674781799316  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9445023536682129  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9692902565002441  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([203, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9708290100097656  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9708290100097656  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9712162017822266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9959964752197266  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([177, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9975042343139648  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9975042343139648  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9978418350219727  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0218114852905273  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0230913162231445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0230913162231445  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0233526229858398  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0437345504760742  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0449881553649902  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0449881553649902  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0452170372009277  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0646719932556152  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0658321380615234  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0658321380615234  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0660266876220703  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0839252471923828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([101, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0851874351501465  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0851874351501465  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0853800773620605  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1044516563415527  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1056675910949707  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1056675910949707  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1058411598205566  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.124239444732666  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.125075340270996  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.125075340270996  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1251897811889648  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1381216049194336  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1392617225646973  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1392617225646973  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1394009590148926  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.15610933303833  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1571545600891113  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1571545600891113  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.157270908355713  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1720471382141113  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1731414794921875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1731414794921875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.173257827758789  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1888484954833984  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1900482177734375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1900482177734375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.190155029296875  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2052154541015625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2061715126037598  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2061715126037598  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2062668800354004  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.220381259918213  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2210102081298828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2210102081298828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2210712432861328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2305316925048828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2313857078552246  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2313857078552246  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.231462001800537  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.243821620941162  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.244314193725586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.244314193725586  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2443580627441406  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2517719268798828  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([512, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.264052391052246  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.264052391052246  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.265028953552246  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.436903953552246  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 512, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3979334831237793  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3987979888916016  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3996624946594238  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.398754596710205  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([5799, 40])
input nodes number: 13326
output nodes number: 5799
edges number: 46021
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3988962173461914  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3988966941833496  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.021762847900390625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

pseudo mini batch 8 input nodes size: 64246
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.018886089324951172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.018886089324951172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.04952096939086914  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.04956245422363281  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0370945930480957  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.03935956954956055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.03935956954956055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.03935956954956055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

torch.Size([64246, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.03935956954956055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

m.shape torch.Size([1239, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.16064167022705078  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.16064167022705078  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.16182327270507812  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.17127609252929688  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1239, 128])
m.shape torch.Size([1284, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.17202329635620117  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.17202329635620117  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1284, 128]), torch.Size([1, 1284, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.1732478141784668  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.19161558151245117  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1284, 128])
m.shape torch.Size([1303, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.19286727905273438  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.19286727905273438  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1303, 128]), torch.Size([1, 1303, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.19410991668701172  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.22144794464111328  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1303, 128])
m.shape torch.Size([1200, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.2231154441833496  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.2231154441833496  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.2242598533630371  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.2574477195739746  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1162, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.259645938873291  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.259645938873291  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1162, 128]), torch.Size([1, 1162, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.2607541084289551  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.30064821243286133  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1162, 128])
m.shape torch.Size([1084, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.3031954765319824  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.3031954765319824  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.3042292594909668  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.34960508346557617  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1053, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.3526029586791992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.3526029586791992  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.353607177734375  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.4038410186767578  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([969, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.40703535079956055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.40703535079956055  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.4079594612121582  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.46068859100341797  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([953, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.46431636810302734  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.46431636810302734  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.4652252197265625  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1951904296875 GB
    Memory Allocated: 0.5241999626159668  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([19835, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2908935546875 GB
    Memory Allocated: 0.6183261871337891  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2908935546875 GB
    Memory Allocated: 0.6183261871337891  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

 h.shape torch.Size([1, 19835, 128]), torch.Size([1, 19835, 128])
----------------------------------------3
 Nvidia-smi: 3.2908935546875 GB
    Memory Allocated: 0.637242317199707  GigaBytes
Max Memory Allocated: 1.615525722503662  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.9864387512207031  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

rst.shape  torch.Size([1, 19835, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.872419834136963  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.9011082649230957  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.9297966957092285  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.900883674621582  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

torch.Size([30082, 256])
first layer input nodes number: 64246
first layer output nodes number: 30082
edges number: 246880
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.9302773475646973  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.95896577835083  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.9661378860473633  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 1.9661378860473633  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

m.shape torch.Size([743, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.0218682289123535  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.0218682289123535  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

 h.shape torch.Size([1, 743, 256]), torch.Size([1, 743, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.023285388946533  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.0346226692199707  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

rst.shape  torch.Size([1, 743, 256])
m.shape torch.Size([603, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.035097122192383  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.035097122192383  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.0362472534179688  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.0536041259765625  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([491, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.05446720123291  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.05446720123291  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.055403709411621  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.0765485763549805  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([373, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.077547073364258  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.077547073364258  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.078258514404297  GigaBytes
Max Memory Allocated: 2.081019401550293  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1011557579040527  GigaBytes
Max Memory Allocated: 2.102578639984131  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([307, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1022753715515137  GigaBytes
Max Memory Allocated: 2.102578639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1022753715515137  GigaBytes
Max Memory Allocated: 2.102578639984131  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.102860927581787  GigaBytes
Max Memory Allocated: 2.102860927581787  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1248183250427246  GigaBytes
Max Memory Allocated: 2.126282215118408  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([228, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1258902549743652  GigaBytes
Max Memory Allocated: 2.126282215118408  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1258902549743652  GigaBytes
Max Memory Allocated: 2.126282215118408  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1263251304626465  GigaBytes
Max Memory Allocated: 2.1263251304626465  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1450247764587402  GigaBytes
Max Memory Allocated: 2.146378993988037  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([207, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.146200180053711  GigaBytes
Max Memory Allocated: 2.146378993988037  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.146200180053711  GigaBytes
Max Memory Allocated: 2.146378993988037  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.146595001220703  GigaBytes
Max Memory Allocated: 2.146595001220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1663360595703125  GigaBytes
Max Memory Allocated: 2.167717933654785  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([158, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1673784255981445  GigaBytes
Max Memory Allocated: 2.167717933654785  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1673784255981445  GigaBytes
Max Memory Allocated: 2.167717933654785  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.167679786682129  GigaBytes
Max Memory Allocated: 2.167717933654785  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1848573684692383  GigaBytes
Max Memory Allocated: 2.1860876083374023  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([157, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1860718727111816  GigaBytes
Max Memory Allocated: 2.1860876083374023  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.1860718727111816  GigaBytes
Max Memory Allocated: 2.1860876083374023  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.186371326446533  GigaBytes
Max Memory Allocated: 2.186371326446533  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.205536365509033  GigaBytes
Max Memory Allocated: 2.2068839073181152  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([137, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2067036628723145  GigaBytes
Max Memory Allocated: 2.2068839073181152  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2067036628723145  GigaBytes
Max Memory Allocated: 2.2068839073181152  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2069649696350098  GigaBytes
Max Memory Allocated: 2.2069649696350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.225517749786377  GigaBytes
Max Memory Allocated: 2.2268242835998535  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.226700782775879  GigaBytes
Max Memory Allocated: 2.2268242835998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.226700782775879  GigaBytes
Max Memory Allocated: 2.2268242835998535  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.226935386657715  GigaBytes
Max Memory Allocated: 2.226935386657715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.245234489440918  GigaBytes
Max Memory Allocated: 2.2465248107910156  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2465128898620605  GigaBytes
Max Memory Allocated: 2.2465248107910156  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2465128898620605  GigaBytes
Max Memory Allocated: 2.2465248107910156  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.246743679046631  GigaBytes
Max Memory Allocated: 2.246743679046631  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2663607597351074  GigaBytes
Max Memory Allocated: 2.2677454948425293  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2675576210021973  GigaBytes
Max Memory Allocated: 2.2677454948425293  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2675576210021973  GigaBytes
Max Memory Allocated: 2.2677454948425293  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2677578926086426  GigaBytes
Max Memory Allocated: 2.2677578926086426  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2861828804016113  GigaBytes
Max Memory Allocated: 2.287564754486084  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2872138023376465  GigaBytes
Max Memory Allocated: 2.287564754486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2872138023376465  GigaBytes
Max Memory Allocated: 2.287564754486084  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.2873644828796387  GigaBytes
Max Memory Allocated: 2.287564754486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3022818565368652  GigaBytes
Max Memory Allocated: 2.3035120964050293  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3034467697143555  GigaBytes
Max Memory Allocated: 2.3035120964050293  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3034467697143555  GigaBytes
Max Memory Allocated: 2.3035120964050293  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3036108016967773  GigaBytes
Max Memory Allocated: 2.3036108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.320998191833496  GigaBytes
Max Memory Allocated: 2.32222843170166  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.322155475616455  GigaBytes
Max Memory Allocated: 2.32222843170166  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.322155475616455  GigaBytes
Max Memory Allocated: 2.32222843170166  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.322296619415283  GigaBytes
Max Memory Allocated: 2.322296619415283  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3382458686828613  GigaBytes
Max Memory Allocated: 2.3394761085510254  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.339414596557617  GigaBytes
Max Memory Allocated: 2.3394761085510254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.339414596557617  GigaBytes
Max Memory Allocated: 2.3394761085510254  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.339550018310547  GigaBytes
Max Memory Allocated: 2.339550018310547  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3558006286621094  GigaBytes
Max Memory Allocated: 2.3570308685302734  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3569726943969727  GigaBytes
Max Memory Allocated: 2.3570308685302734  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3569726943969727  GigaBytes
Max Memory Allocated: 2.3570308685302734  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3571062088012695  GigaBytes
Max Memory Allocated: 2.3571062088012695  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3740625381469727  GigaBytes
Max Memory Allocated: 2.3752927780151367  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.375235080718994  GigaBytes
Max Memory Allocated: 2.3752927780151367  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.375235080718994  GigaBytes
Max Memory Allocated: 2.3752927780151367  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3753552436828613  GigaBytes
Max Memory Allocated: 2.3753552436828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3914570808410645  GigaBytes
Max Memory Allocated: 2.3926873207092285  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3926358222961426  GigaBytes
Max Memory Allocated: 2.3926873207092285  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.3926358222961426  GigaBytes
Max Memory Allocated: 2.3926873207092285  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.392744541168213  GigaBytes
Max Memory Allocated: 2.392744541168213  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.408073902130127  GigaBytes
Max Memory Allocated: 2.409304141998291  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4090771675109863  GigaBytes
Max Memory Allocated: 2.409304141998291  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4090771675109863  GigaBytes
Max Memory Allocated: 2.409304141998291  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4091763496398926  GigaBytes
Max Memory Allocated: 2.409304141998291  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4238553047180176  GigaBytes
Max Memory Allocated: 2.4249043464660645  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.424609661102295  GigaBytes
Max Memory Allocated: 2.4249043464660645  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.424609661102295  GigaBytes
Max Memory Allocated: 2.4249043464660645  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.424682140350342  GigaBytes
Max Memory Allocated: 2.4249043464660645  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4359164237976074  GigaBytes
Max Memory Allocated: 2.436713695526123  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4369373321533203  GigaBytes
Max Memory Allocated: 2.436941623687744  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4369373321533203  GigaBytes
Max Memory Allocated: 2.436941623687744  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.437023162841797  GigaBytes
Max Memory Allocated: 2.437023162841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.450927734375  GigaBytes
Max Memory Allocated: 2.452157974243164  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4521236419677734  GigaBytes
Max Memory Allocated: 2.452157974243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.4521236419677734  GigaBytes
Max Memory Allocated: 2.452157974243164  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.452211380004883  GigaBytes
Max Memory Allocated: 2.452211380004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.467039108276367  GigaBytes
Max Memory Allocated: 2.4682693481445312  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([1083, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.49301815032959  GigaBytes
Max Memory Allocated: 2.493119239807129  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.49301815032959  GigaBytes
Max Memory Allocated: 2.493119239807129  GigaBytes

 h.shape torch.Size([1, 1083, 256]), torch.Size([1, 1083, 256])
----------------------------------------3
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.495478630065918  GigaBytes
Max Memory Allocated: 2.495478630065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.8784618377685547  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 1083, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.827263355255127  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.8280858993530273  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.8289084434509277  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.8280444145202637  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

torch.Size([5517, 40])
input nodes number: 30082
output nodes number: 5517
edges number: 57009
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.828268527984619  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2459716796875 GB
    Memory Allocated: 2.8282690048217773  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.04322338104248047  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

pseudo mini batch 9 input nodes size: 53737
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.03705263137817383  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.03705263137817383  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.06267642974853516  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.06271934509277344  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.0320429801940918  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.03438425064086914  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.03438425064086914  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.03438425064086914  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

torch.Size([53737, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.03438425064086914  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

m.shape torch.Size([877, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.15192556381225586  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.15192556381225586  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.15276193618774414  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.1594529151916504  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([944, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.15993499755859375  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.15993499755859375  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.16083526611328125  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.17530202865600586  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([895, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.17635726928710938  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.17635726928710938  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 895, 128]), torch.Size([1, 895, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.17721080780029297  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.19600391387939453  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 895, 128])
m.shape torch.Size([878, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.1972517967224121  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.1972517967224121  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.1980891227722168  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.22261381149291992  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([895, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.22432899475097656  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.22432899475097656  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 895, 128]), torch.Size([1, 895, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.22518253326416016  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.25592517852783203  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 895, 128])
m.shape torch.Size([806, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.25780439376831055  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.25780439376831055  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.258573055267334  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.29228925704956055  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([845, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.2947254180908203  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.2947254180908203  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.2955312728881836  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.33683156967163086  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([810, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.33951854705810547  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.33951854705810547  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.34029102325439453  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.3851804733276367  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([845, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.38842058181762695  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.38842058181762695  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.38922643661499023  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.44104671478271484  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([20141, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 0.5366835594177246  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 0.5366835594177246  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 20141, 128]), torch.Size([1, 20141, 128])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 0.5562148094177246  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.9414787292480469  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 20141, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.8295717239379883  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.8562135696411133  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.8828554153442383  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.8560051918029785  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

torch.Size([27936, 256])
first layer input nodes number: 53737
first layer output nodes number: 27936
edges number: 239683
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.8832578659057617  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.9098997116088867  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.916560173034668  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.916560173034668  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

m.shape torch.Size([548, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.9888672828674316  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.9888672828674316  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.989912509918213  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.9991192817687988  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([461, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.9994831085205078  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 1.9994831085205078  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0003623962402344  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0151290893554688  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([345, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0156893730163574  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0156893730163574  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0163474082946777  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0314741134643555  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([302, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0330328941345215  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0330328941345215  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.033608913421631  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0503573417663574  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([271, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0513720512390137  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0513720512390137  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.051888942718506  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0708565711975098  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([207, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0717921257019043  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0717921257019043  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0721869468688965  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.0891642570495605  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([198, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.090299129486084  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.090299129486084  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.090676784515381  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1095595359802246  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([151, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.110531806945801  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.110531806945801  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1108198165893555  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1272363662719727  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([158, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1284594535827637  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1284594535827637  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.128760814666748  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.148047924041748  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1493968963623047  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1493968963623047  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1496944427490234  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1708202362060547  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.172130584716797  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.172130584716797  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.172393798828125  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1929244995117188  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.194361686706543  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.194361686706543  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.1946210861206055  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.216670036315918  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([112, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.217939853668213  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.217939853668213  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.218153476715088  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.237806797027588  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2390055656433105  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2390055656433105  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2391905784606934  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.257506847381592  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.258697509765625  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.258697509765625  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2588672637939453  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2768611907958984  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([87, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2781143188476562  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2781143188476562  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.278280258178711  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.2970314025878906  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([85, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.298337459564209  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.298337459564209  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.298499584197998  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.3179545402526855  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([92, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.319465160369873  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.319465160369873  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.319640636444092  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.341926097869873  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.343632221221924  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.343632221221924  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.343771457672119  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.362429141998291  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([89, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.364070415496826  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.364070415496826  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.3642401695251465  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.3881754875183105  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([87, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.3898468017578125  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.3898468017578125  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.390012741088867  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.414571762084961  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([56, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.41567325592041  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.41567325592041  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.4157800674438477  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.43233585357666  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.4336533546447754  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.4336533546447754  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.4337716102600098  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.4529290199279785  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.454346179962158  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.454346179962158  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.454468250274658  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.475098133087158  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([1663, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.51499605178833  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.51499605178833  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

 h.shape torch.Size([1, 1663, 256]), torch.Size([1, 1663, 256])
----------------------------------------3
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 2.5181679725646973  GigaBytes
Max Memory Allocated: 2.904282569885254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.0893406867980957  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1663, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.0220985412597656  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.022952079772949  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.023805618286133  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.022909164428711  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

torch.Size([5727, 40])
input nodes number: 27936
output nodes number: 5727
edges number: 74441
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.023191452026367  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.0231919288635254  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.03840208053588867  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

pseudo mini batch 10 input nodes size: 68819
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.032073974609375  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.032073974609375  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.06488943099975586  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.06493139266967773  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.039264678955078125  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.04173469543457031  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.04173469543457031  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.04173469543457031  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

torch.Size([68819, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.04173469543457031  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

m.shape torch.Size([1194, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.17443609237670898  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.17443609237670898  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1194, 128]), torch.Size([1, 1194, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.17557477951049805  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.18468427658081055  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1194, 128])
m.shape torch.Size([1316, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.18634510040283203  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.18634510040283203  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1316, 128]), torch.Size([1, 1316, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.18760013580322266  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.20642566680908203  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1316, 128])
m.shape torch.Size([1319, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.20768499374389648  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.20768499374389648  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1319, 128]), torch.Size([1, 1319, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.20894289016723633  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.2366166114807129  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1319, 128])
m.shape torch.Size([1225, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.23832416534423828  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.23832416534423828  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1225, 128]), torch.Size([1, 1225, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.23949241638183594  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.27421092987060547  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1225, 128])
m.shape torch.Size([1235, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.27657127380371094  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.27657127380371094  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.27774906158447266  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.32101011276245117  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1173, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.3237771987915039  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.3237771987915039  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1173, 128]), torch.Size([1, 1173, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.32489585876464844  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.37303924560546875  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1173, 128])
m.shape torch.Size([1113, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.37634992599487305  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.37634992599487305  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.3774113655090332  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.4313340187072754  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1065, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.43486595153808594  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.43486595153808594  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.4358816146850586  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.4947490692138672  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([1081, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.49888038635253906  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.49888038635253906  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.4999113082885742  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.5683598518371582  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([21755, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.6715803146362305  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.6715803146362305  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 21755, 128]), torch.Size([1, 21755, 128])
----------------------------------------3
 Nvidia-smi: 4.6795654296875 GB
    Memory Allocated: 0.6932377815246582  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.166287899017334  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 21755, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.041882038116455  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0728535652160645  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.103825092315674  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0726113319396973  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

torch.Size([32476, 256])
first layer input nodes number: 68819
first layer output nodes number: 32476
edges number: 269486
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.104340076446533  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1353116035461426  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.143402576446533  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.143402576446533  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

m.shape torch.Size([659, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.203747272491455  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.203747272491455  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 659, 256]), torch.Size([1, 659, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2050042152404785  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2156710624694824  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 659, 256])
m.shape torch.Size([573, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.21614408493042  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.21614408493042  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2172369956970215  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.233940601348877  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([448, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2348785400390625  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2348785400390625  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2357330322265625  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.255880832672119  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([320, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2567124366760254  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2567124366760254  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2573227882385254  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.277639865875244  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([315, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2788782119750977  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2788782119750977  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2794790267944336  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.303328514099121  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([249, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.304464340209961  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.304464340209961  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3049392700195312  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3253612518310547  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([212, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3265504837036133  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3265504837036133  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3269548416137695  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.347172737121582  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([169, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3482704162597656  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3482704162597656  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.348592758178711  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3669662475585938  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([156, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.368154525756836  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.368154525756836  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3684520721435547  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3874950408935547  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.389223098754883  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.389223098754883  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3895111083984375  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4099597930908203  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4112114906311035  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4112114906311035  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4114632606506348  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4311013221740723  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4324636459350586  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4324636459350586  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4327096939086914  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4536237716674805  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4548254013061523  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4548254013061523  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4550275802612305  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.473628044128418  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.474832534790039  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.474832534790039  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.475017547607422  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4933338165283203  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([103, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.495116710662842  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.495116710662842  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4953131675720215  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5161375999450684  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.517454147338867  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.517454147338867  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.517629623413086  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5374584197998047  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.538710594177246  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.538710594177246  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5388669967651367  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5576353073120117  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([89, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5590972900390625  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5590972900390625  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.559267044067383  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5808258056640625  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5818915367126465  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5818915367126465  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5820116996765137  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.598113536834717  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5992836952209473  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5992836952209473  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5994057655334473  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6166176795959473  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6180343627929688  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6180343627929688  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6181507110595703  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6353702545166016  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6364564895629883  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6364564895629883  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6365461349487305  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6504411697387695  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.651258945465088  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.651258945465088  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6513333320617676  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.663383960723877  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6643619537353516  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6643619537353516  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.6644458770751953  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.678628921508789  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([1206, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.7075653076171875  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.7075653076171875  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

 h.shape torch.Size([1, 1206, 256]), torch.Size([1, 1206, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.7098655700683594  GigaBytes
Max Memory Allocated: 3.1289896965026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 3.1148948669433594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1206, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 3.0599465370178223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 3.060781955718994  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 3.061617374420166  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 3.0607399940490723  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5606, 40])
input nodes number: 32476
output nodes number: 5606
edges number: 61892
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 3.0610060691833496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 3.061006546020508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.045950889587402344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 11 input nodes size: 66781
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.039246559143066406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.039246559143066406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0710902214050293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07113170623779297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.038274288177490234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03999948501586914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03999948501586914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03999948501586914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([66781, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03999948501586914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1521, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.13412094116210938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.13412094116210938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1521, 128]), torch.Size([1, 1521, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.13557147979736328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14717578887939453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1521, 128])
m.shape torch.Size([1650, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14823055267333984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14823055267333984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1650, 128]), torch.Size([1, 1650, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14980411529541016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17340755462646484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1650, 128])
m.shape torch.Size([1525, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17480230331420898  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17480230331420898  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1525, 128]), torch.Size([1, 1525, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17625665664672852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2082524299621582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1525, 128])
m.shape torch.Size([1396, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2101879119873047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2101879119873047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1396, 128]), torch.Size([1, 1396, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2115192413330078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2510204315185547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1396, 128])
m.shape torch.Size([1280, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2539100646972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2539100646972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1280, 128]), torch.Size([1, 1280, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2551307678222656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2990760803222656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1280, 128])
m.shape torch.Size([1140, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.301727294921875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.301727294921875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3028144836425781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3499436378479004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1045, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3528881072998047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3528881072998047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3538846969604492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4039449691772461  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([977, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.40717363357543945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.40717363357543945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.40810537338256836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4626646041870117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([904, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.46682214736938477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.46682214736938477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.467684268951416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.523989200592041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([13940, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.590029239654541  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.590029239654541  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 13940, 128]), torch.Size([1, 13940, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6033234596252441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.547213077545166  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 13940, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4619131088256836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4861154556274414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5103178024291992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4859261512756348  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([25378, 256])
first layer input nodes number: 66781
first layer output nodes number: 25378
edges number: 190887
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.510817527770996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.535019874572754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5410704612731934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5410704612731934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([952, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5811433792114258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5811433792114258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 952, 256]), torch.Size([1, 952, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5829591751098633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5988197326660156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 952, 256])
m.shape torch.Size([814, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5995168685913086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5995168685913086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 814, 256]), torch.Size([1, 814, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.601069450378418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6243581771850586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 814, 256])
m.shape torch.Size([616, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.625791072845459  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.625791072845459  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6269659996032715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6553397178649902  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([445, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6564631462097168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6564631462097168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6573119163513184  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.684863567352295  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.686255931854248  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.686255931854248  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6869769096374512  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7139945030212402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([287, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7152891159057617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7152891159057617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.715836524963379  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7409939765930176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([236, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7423081398010254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7423081398010254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7427582740783691  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7652649879455566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7666702270507812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7666702270507812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7670745849609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7901229858398438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([168, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7913742065429688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7913742065429688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7916946411132812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8122024536132812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([125, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.813840389251709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.813840389251709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8140788078308105  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8310065269470215  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8321666717529297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8321666717529297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8323974609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8503990173339844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([100, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8514370918273926  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8514370918273926  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8516278266906738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.86784029006958  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8689322471618652  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8689322471618652  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8691134452819824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8857836723327637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8866486549377441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8866486549377441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8867840766906738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.900190830230713  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.901017189025879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.901017189025879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9011354446411133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.913670539855957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.914503574371338  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.914503574371338  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.914614200592041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9271149635314941  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9276971817016602  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9276971817016602  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9277715682983398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9366979598999023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9375262260437012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9375262260437012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9376215934753418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9497332572937012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9506354331970215  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9506354331970215  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9507346153259277  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9640250205993652  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9646291732788086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9646291732788086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9646940231323242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9738378524780273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9747138023376465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9747138023376465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.974799633026123  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9875025749206543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9878826141357422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9878826141357422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9879207611083984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9938335418701172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9944777488708496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9944777488708496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.994534969329834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0038046836853027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0041913986206055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0041913986206055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.004225730895996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0100278854370117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([489, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.022576332092285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.022576332092285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0235090255737305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1880006790161133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 489, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1540441513061523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1548666954040527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.155689239501953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.154825210571289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5517, 40])
input nodes number: 25378
output nodes number: 5517
edges number: 40511
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.155043125152588  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.155043601989746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04314279556274414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 12 input nodes size: 63436
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03826141357421875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03826141357421875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06851005554199219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06855154037475586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0366663932800293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03868913650512695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03868913650512695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03868913650512695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([63436, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03868913650512695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1341, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14639949798583984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14639949798583984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1341, 128]), torch.Size([1, 1341, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14767837524414062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15790939331054688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1341, 128])
m.shape torch.Size([1511, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15871095657348633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15871095657348633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16015195846557617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18246984481811523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1328, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18364906311035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18364906311035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1328, 128]), torch.Size([1, 1328, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18491554260253906  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21372032165527344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1328, 128])
m.shape torch.Size([1242, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2154560089111328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2154560089111328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1242, 128]), torch.Size([1, 1242, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21664047241210938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2515697479248047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1242, 128])
m.shape torch.Size([1215, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2538743019104004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2538743019104004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1215, 128]), torch.Size([1, 1215, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.255033016204834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2970561981201172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1215, 128])
m.shape torch.Size([1085, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29958105087280273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29958105087280273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3006157875061035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34601545333862305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([971, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3487391471862793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3487391471862793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34966516494750977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.39657020568847656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([970, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3998074531555176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3998074531555176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.40073251724243164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4534611701965332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([945, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45705413818359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45705413818359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45795536041259766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5165467262268066  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([16999, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5971536636352539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5971536636352539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 16999, 128]), torch.Size([1, 16999, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6133651733398438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7643823623657227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 16999, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6645164489746094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6908445358276367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.717172622680664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.690638542175293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([27607, 256])
first layer input nodes number: 63436
first layer output nodes number: 27607
edges number: 218952
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7176475524902344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7439756393432617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.750615119934082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.750615119934082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([797, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8019814491271973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8019814491271973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8035016059875488  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8165011405944824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([697, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8171963691711426  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8171963691711426  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.818525791168213  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8417716026306152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 697, 256])
m.shape torch.Size([519, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8426179885864258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8426179885864258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8436079025268555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.86771821975708  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([402, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8687691688537598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8687691688537598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8695359230041504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8926830291748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([347, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8943519592285156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8943519592285156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8950138092041016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9192485809326172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([246, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9203367233276367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9203367233276367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9208059310913086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9409818649291992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([182, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9420175552368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9420175552368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9423646926879883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.959721565246582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([168, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9608783721923828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9608783721923828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9611988067626953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9794635772705078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9807829856872559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9807829856872559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9811091423034668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.001983165740967  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([130, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0030698776245117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0030698776245117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0033178329467773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0209226608276367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0219831466674805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0219831466674805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0221967697143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0388593673706055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.040102005004883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.040102005004883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.040325164794922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.059293746948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.060609817504883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.060609817504883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.060791015625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0774612426757812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.078352928161621  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.078352928161621  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0784921646118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0922765731811523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0933566093444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0933566093444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0935072898864746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1094794273376465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1101884841918945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1101884841918945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.110285758972168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1212778091430664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.121932029724121  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.121932029724121  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.122014045715332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1318559646606445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.132870674133301  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.132870674133301  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1329870223999023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.147763252258301  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1488194465637207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1488194465637207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1489357948303223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1645264625549316  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.165583610534668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.165583610534668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.165694236755371  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1812925338745117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.181943893432617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.181943893432617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1820106506347656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1918907165527344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1925764083862305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1925764083862305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.192641258239746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.202692985534668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2034125328063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2034125328063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.203477382659912  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2139830589294434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2149505615234375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2149505615234375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2150325775146484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.228893280029297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([962, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.251967430114746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.251967430114746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 962, 256]), torch.Size([1, 962, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2538022994995117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5772204399108887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 962, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.531459331512451  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5322818756103516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.533104419708252  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.532240390777588  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5517, 40])
input nodes number: 27607
output nodes number: 5517
edges number: 52413
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5324878692626953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5324883460998535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04225635528564453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 13 input nodes size: 49377
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0366663932800293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0366663932800293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.060211181640625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06025266647338867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029962539672851562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03144073486328125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03144073486328125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03144073486328125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([49377, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03144073486328125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1423, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10844564437866211  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10844564437866211  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1423, 128]), torch.Size([1, 1423, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1098027229309082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12065935134887695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1423, 128])
m.shape torch.Size([1492, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12140369415283203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12140369415283203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1492, 128]), torch.Size([1, 1492, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12282657623291016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14416980743408203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1492, 128])
m.shape torch.Size([1329, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14574718475341797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14574718475341797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1329, 128]), torch.Size([1, 1329, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14701461791992188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1755847930908203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1329, 128])
m.shape torch.Size([1208, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17725515365600586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17725515365600586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1208, 128]), torch.Size([1, 1208, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1784071922302246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21181631088256836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1208, 128])
m.shape torch.Size([1133, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21464300155639648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21464300155639648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21572351455688477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25470399856567383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([962, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2569160461425781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2569160461425781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25783348083496094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2974262237548828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([872, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2998781204223633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2998781204223633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30070972442626953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3429417610168457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([863, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34581804275512695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34581804275512695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34664106369018555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3935532569885254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([783, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3965020179748535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3965020179748535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3972487449645996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4452395439147949  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([11124, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4979095458984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4979095458984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 11124, 128]), torch.Size([1, 11124, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5085182189941406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2635526657104492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 11124, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1935839653015137  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2137913703918457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2339987754821777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2136330604553223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([21189, 256])
first layer input nodes number: 49377
first layer output nodes number: 21189
edges number: 155958
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2343688011169434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2545762062072754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2596282958984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2596282958984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([944, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3014655113220215  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3014655113220215  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 944, 256]), torch.Size([1, 944, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3032660484313965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3182096481323242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 944, 256])
m.shape torch.Size([788, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3189654350280762  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3189654350280762  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 788, 256]), torch.Size([1, 788, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3204684257507324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3430132865905762  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 788, 256])
m.shape torch.Size([576, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3442068099975586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3442068099975586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3453054428100586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3717947006225586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([430, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3731904029846191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3731904029846191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3740105628967285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3992905616760254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.400735855102539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.400735855102539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4014720916748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4279766082763672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4294137954711914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4294137954711914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4300107955932617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4568438529968262  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.458200454711914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.458200454711914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.458669662475586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4821300506591797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([203, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4834566116333008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4834566116333008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4838438034057617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5059137344360352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5071907043457031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5071907043457031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5075149536132812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5282669067382812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5295372009277344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5295372009277344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5298213958740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5499992370605469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.551337718963623  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.551337718963623  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5516047477722168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5724329948425293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5732684135437012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5732684135437012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5734286308288574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5870471000671387  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5879416465759277  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5879416465759277  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.588090419769287  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6017775535583496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6028943061828613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6028943061828613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6030468940734863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6181530952453613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6188268661499023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6188268661499023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6189260482788086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.629439353942871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6303434371948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6303434371948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6304616928100586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.643824577331543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6446151733398438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6446151733398438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.64471435546875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6566162109375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6572413444519043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6572413444519043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.657315731048584  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6667628288269043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6676573753356934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6676573753356934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6677546501159668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6807894706726074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6816444396972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6816444396972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6817340850830078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6943740844726562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6951370239257812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6951370239257812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6952133178710938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7065048217773438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7071433067321777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7071433067321777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7072043418884277  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7166647911071777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.717010498046875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.717010498046875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7170429229736328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7222957611083984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.722879409790039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.722879409790039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7229290008544922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7313098907470703  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([548, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.744452953338623  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.744452953338623  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7454981803894043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9300570487976074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 548, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.894320011138916  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8951478004455566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8959755897521973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.895106315612793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5553, 40])
input nodes number: 21189
output nodes number: 5553
edges number: 42350
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8953113555908203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8953118324279785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.034145355224609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 14 input nodes size: 43540
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029967784881591797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029967784881591797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.05072927474975586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.05077075958251953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027184486389160156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028211593627929688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028211593627929688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028211593627929688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([43540, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028211593627929688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1716, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0805654525756836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0805654525756836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1716, 128]), torch.Size([1, 1716, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08220195770263672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09529399871826172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1716, 128])
m.shape torch.Size([1676, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09607410430908203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09607410430908203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1676, 128]), torch.Size([1, 1676, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0976724624633789  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12253284454345703  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1676, 128])
m.shape torch.Size([1507, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12406444549560547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12406444549560547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1507, 128]), torch.Size([1, 1507, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1255016326904297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1571197509765625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1507, 128])
m.shape torch.Size([1318, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15891504287719727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15891504287719727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1318, 128]), torch.Size([1, 1318, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1601719856262207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1966233253479004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1318, 128])
m.shape torch.Size([1227, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19892024993896484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19892024993896484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1227, 128]), torch.Size([1, 1227, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2000904083251953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2431812286376953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1227, 128])
m.shape torch.Size([948, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24530839920043945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24530839920043945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24621248245239258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.28603267669677734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([851, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2884211540222168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2884211540222168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2892327308654785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.33046722412109375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([767, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.33298730850219727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.33298730850219727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.33371877670288086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.376619815826416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([604, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3788461685180664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3788461685180664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3794221878051758  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4168820381164551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([6090, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4456334114074707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4456334114074707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 6090, 128]), torch.Size([1, 6090, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45144128799438477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8638005256652832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 6090, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8184213638305664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8343515396118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8502817153930664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8342270851135254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([16704, 256])
first layer input nodes number: 43540
first layer output nodes number: 16704
edges number: 105113
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8506083488464355  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8665385246276855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.870521068572998  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.870521068572998  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1106, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.90313720703125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.90313720703125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1106, 256]), torch.Size([1, 1106, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9055032730102539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9223794937133789  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1106, 256])
m.shape torch.Size([852, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9234452247619629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9234452247619629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 852, 256]), torch.Size([1, 852, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9250702857971191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9518380165100098  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 852, 256])
m.shape torch.Size([688, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9531488418579102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9531488418579102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9544610977172852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9834566116333008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([506, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9849233627319336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9849233627319336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9858884811401367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0146207809448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([462, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0163588523864746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0163588523864746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.017240047454834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0516505241394043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([282, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0528364181518555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0528364181518555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0533742904663086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0778989791870117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0794062614440918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0794062614440918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0799098014831543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1061577796936035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1077919006347656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1077919006347656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1082038879394531  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1316871643066406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.133012294769287  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.133012294769287  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.133349895477295  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.154956340789795  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1561331748962402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1561331748962402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.156400203704834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1753592491149902  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([97, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1762514114379883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1762514114379883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.176436424255371  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1908674240112305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.191986083984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.191986083984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1921863555908203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2092094421386719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([86, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.210184097290039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.210184097290039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.210348129272461  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2254390716552734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.226137638092041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.226137638092041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2262482643127441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2372002601623535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.238053321838379  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.238053321838379  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.238173484802246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.250910758972168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.251619815826416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.251619815826416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2517151832580566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2624917030334473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2631630897521973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2631630897521973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.263247013092041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.273317813873291  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2738642692565918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2738642692565918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2739291191101074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2821650505065918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2828083038330078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2828083038330078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2828788757324219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2923355102539062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2927041053771973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2927041053771973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2927441596984863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2983918190002441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2987351417541504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2987351417541504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.298769474029541  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3038506507873535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3042144775390625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3042144775390625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3042488098144531  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3095703125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.309885025024414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.309885025024414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3099136352539062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3145484924316406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.315157413482666  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.315157413482666  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.315208911895752  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3239121437072754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([193, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.328524112701416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.328524112701416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3288922309875488  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3936810493469238  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3676366806030273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3684654235839844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3692941665649414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3684239387512207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5559, 40])
input nodes number: 16704
output nodes number: 5559
edges number: 32546
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3685908317565918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.36859130859375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.030243873596191406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 15 input nodes size: 33253
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027185440063476562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027185440063476562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04304170608520508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04308366775512695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02228069305419922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023186683654785156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023186683654785156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023186683654785156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([33253, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023186683654785156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1528, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06687593460083008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06687593460083008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1528, 128]), torch.Size([1, 1528, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06833314895629883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07999086380004883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1528, 128])
m.shape torch.Size([1725, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08170700073242188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08170700073242188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1725, 128]), torch.Size([1, 1725, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08335208892822266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10853958129882812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1725, 128])
m.shape torch.Size([1464, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10981130599975586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10981130599975586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1464, 128]), torch.Size([1, 1464, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11120748519897461  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1419234275817871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1464, 128])
m.shape torch.Size([1315, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14392805099487305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14392805099487305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1315, 128]), torch.Size([1, 1315, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14518213272094727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1815505027770996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1315, 128])
m.shape torch.Size([1123, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18360090255737305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18360090255737305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18467187881469727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2235875129699707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([902, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2256326675415039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2256326675415039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22649288177490234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26441097259521484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([797, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26664113998413086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26664113998413086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26740121841430664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30579090118408203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([677, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30799341201782227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30799341201782227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3086390495300293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34628963470458984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([618, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3486189842224121  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3486189842224121  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34920835494995117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3874516487121582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([4535, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4087815284729004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4087815284729004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 4535, 128]), torch.Size([1, 4535, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.41310644149780273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7213592529296875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 4535, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6841654777526855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6981692314147949  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7121729850769043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6980595588684082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([14684, 256])
first layer input nodes number: 33253
first layer output nodes number: 14684
edges number: 87564
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7124228477478027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7264266014099121  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7299275398254395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7299275398254395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1026, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7638163566589355  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7638163566589355  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1026, 256]), torch.Size([1, 1026, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7658429145812988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7836823463439941  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1026, 256])
m.shape torch.Size([930, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7835783958435059  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7835783958435059  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 930, 256]), torch.Size([1, 930, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7853522300720215  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8126049041748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 930, 256])
m.shape torch.Size([670, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8136501312255859  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8136501312255859  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8149280548095703  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8430423736572266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([540, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8444795608520508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8444795608520508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8455095291137695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8753786087036133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([422, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8768916130065918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8768916130065918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8776965141296387  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9073233604431152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9087319374084473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9087319374084473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9093308448791504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9355931282043457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9369559288024902  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9369559288024902  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9374270439147949  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9609827995300293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([209, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9623546600341797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9623546600341797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9627532958984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9854755401611328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9872021675109863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9872021675109863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9875321388244629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.008650302886963  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([143, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0098600387573242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0098600387573242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0101327896118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0294981002807617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0304722785949707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0304722785949707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.030672550201416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0462937355041504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0473241806030273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0473241806030273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.047511100769043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.063399314880371  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([86, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0644111633300781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0644111633300781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0645751953125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0796661376953125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0806341171264648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0806341171264648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0807828903198242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0955114364624023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0961723327636719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0961723327636719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0962696075439453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1065807342529297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1073474884033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1073474884033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1074485778808594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1188716888427734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1197361946105957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1197361946105957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1198430061340332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1326603889465332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1334376335144043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1334376335144043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1335291862487793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1451563835144043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.145768165588379  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.145768165588379  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1458368301391602  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1550378799438477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.155503749847412  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.155503749847412  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1555533409118652  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1625456809997559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.16314697265625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.16314697265625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1632061004638672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.171957015991211  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1723718643188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1723718643188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1724119186401367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1786203384399414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1789984703063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1789984703063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.179032802581787  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1845946311950684  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.184992790222168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.184992790222168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1850271224975586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1908292770385742  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([211, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1958823204040527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1958823204040527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1962847709655762  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2671160697937012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 211, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.239863395690918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2406997680664062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2415361404418945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2406578063964844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5610, 40])
input nodes number: 14684
output nodes number: 5610
edges number: 33846
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2408170700073242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes
[05:37:08] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23400434 edges into 16 parts and get 6366724 edge cuts

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2408175468444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024992942810058594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03054332733154297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03054332733154297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014103516936302185 |0.024362191557884216 |0.14842133224010468 |9.942054748535156e-05 |0.07573820650577545 |0.005842685699462891 |
----------------------------------------------------------pseudo_mini_loss sum 5.333592891693115
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  941574
Number of first layer input nodes during this epoch:  643006
Number of first layer output nodes during this epoch:  298568
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.030542850494384766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03911614418029785
global_2_local spend time (sec) 0.05271649360656738
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0044596195220947266
A = g.adjacency_matrix() spent  0.010617971420288086
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08250951766967773
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3147594928741455
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1990430355072021

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434})
Convert a graph into a bidirected graph: 1.087 seconds
Metis partitioning: 4.906 seconds
Split the graph: 0.776 seconds
Construct subgraphs: 0.107 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.8857481479644775
5802
5805
5830
5782
5706
5635
5734
5736
5652
5550
5763
5544
5517
5851
5517
5517
total k batches seeds list generation spend  17.914533376693726
after graph partition
graph partition algorithm spend time 18.013890027999878
5802
5805
5830
5782
5706
5635
5734
5736
5652
5550
5763
5544
5517
5851
5517
5517
partition_len_list
[14901, 13548, 11814, 10712, 13550, 12520, 11200, 12804, 29130, 20984, 14630, 19111, 29794, 29493, 23043, 28879]
shared_neighbor_graph_partition_s0 selection method  spend 18.124362230300903
time for parepare:  0.016982316970825195
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0016369819641113281
mini_batch_src_global generation:  0.001895904541015625
r_  generation:  0.016043663024902344
local_output_nid generation:  0.0016789436340332031
local_in_edges_tensor generation:  0.0013921260833740234
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.015371322631835938
local_output_nid generation:  0.0017671585083007812
local_in_edges_tensor generation:  0.0012712478637695312
mini_batch_src_global generation:  0.001146078109741211
r_  generation:  0.013155937194824219
local_output_nid generation:  0.0017228126525878906
local_in_edges_tensor generation:  0.0011572837829589844
mini_batch_src_global generation:  0.0012469291687011719
r_  generation:  0.010126829147338867
local_output_nid generation:  0.0016968250274658203
local_in_edges_tensor generation:  0.0011699199676513672
mini_batch_src_global generation:  0.0012531280517578125
r_  generation:  0.01492762565612793
local_output_nid generation:  0.0018033981323242188
local_in_edges_tensor generation:  0.0012166500091552734
mini_batch_src_global generation:  0.0014643669128417969
r_  generation:  0.015628576278686523
local_output_nid generation:  0.0018420219421386719
local_in_edges_tensor generation:  0.001203298568725586
mini_batch_src_global generation:  0.0013937950134277344
r_  generation:  0.016190528869628906
local_output_nid generation:  0.0018732547760009766
local_in_edges_tensor generation:  0.0011835098266601562
mini_batch_src_global generation:  0.0013163089752197266
r_  generation:  0.015247344970703125
local_output_nid generation:  0.001850128173828125
local_in_edges_tensor generation:  0.00145721435546875
mini_batch_src_global generation:  0.0023124217987060547
r_  generation:  0.02214837074279785
local_output_nid generation:  0.0025255680084228516
local_in_edges_tensor generation:  0.0012500286102294922
mini_batch_src_global generation:  0.001638650894165039
r_  generation:  0.015297651290893555
local_output_nid generation:  0.002094268798828125
local_in_edges_tensor generation:  0.001249551773071289
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.01335453987121582
local_output_nid generation:  0.0019867420196533203
local_in_edges_tensor generation:  0.0011248588562011719
mini_batch_src_global generation:  0.0013382434844970703
r_  generation:  0.010627269744873047
local_output_nid generation:  0.0018572807312011719
local_in_edges_tensor generation:  0.0011796951293945312
mini_batch_src_global generation:  0.001627206802368164
r_  generation:  0.02063274383544922
local_output_nid generation:  0.0021343231201171875
local_in_edges_tensor generation:  0.0019702911376953125
mini_batch_src_global generation:  0.0026307106018066406
r_  generation:  0.025540828704833984
local_output_nid generation:  0.002160787582397461
local_in_edges_tensor generation:  0.0012884140014648438
mini_batch_src_global generation:  0.0015139579772949219
r_  generation:  0.014030694961547852
local_output_nid generation:  0.0020780563354492188
local_in_edges_tensor generation:  0.0013017654418945312
mini_batch_src_global generation:  0.0013399124145507812
r_  generation:  0.016979694366455078
----------------------check_connections_block total spend ----------------------------- 0.4373607635498047
generate_one_block  0.030126094818115234
generate_one_block  0.021835803985595703
generate_one_block  0.01735997200012207
generate_one_block  0.014574766159057617
generate_one_block  0.018703460693359375
generate_one_block  0.02166295051574707
generate_one_block  0.021541833877563477
generate_one_block  0.020552396774291992
generate_one_block  0.032103776931762695
generate_one_block  0.022138357162475586
generate_one_block  0.01791524887084961
generate_one_block  0.017183780670166016
generate_one_block  0.028815031051635742
generate_one_block  0.03756093978881836
generate_one_block  0.02050328254699707
generate_one_block  0.024632930755615234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04022645950317383
gen group dst list time:  0.008702993392944336
time for parepare:  0.02373528480529785
local_output_nid generation:  0.0031037330627441406
local_in_edges_tensor generation:  0.01027822494506836
mini_batch_src_global generation:  0.0035238265991210938
r_  generation:  0.03561210632324219
local_output_nid generation:  0.004608154296875
local_in_edges_tensor generation:  0.0037589073181152344
mini_batch_src_global generation:  0.003344297409057617
r_  generation:  0.030411958694458008
local_output_nid generation:  0.0040743350982666016
local_in_edges_tensor generation:  0.00254058837890625
mini_batch_src_global generation:  0.0020456314086914062
r_  generation:  0.024958133697509766
local_output_nid generation:  0.003745555877685547
local_in_edges_tensor generation:  0.0021903514862060547
mini_batch_src_global generation:  0.001613616943359375
r_  generation:  0.01950216293334961
local_output_nid generation:  0.00436091423034668
local_in_edges_tensor generation:  0.0032126903533935547
mini_batch_src_global generation:  0.004700183868408203
r_  generation:  0.03159976005554199
local_output_nid generation:  0.004011869430541992
local_in_edges_tensor generation:  0.0025529861450195312
mini_batch_src_global generation:  0.002711057662963867
r_  generation:  0.02875995635986328
local_output_nid generation:  0.003717660903930664
local_in_edges_tensor generation:  0.002394437789916992
mini_batch_src_global generation:  0.002191781997680664
r_  generation:  0.026079893112182617
local_output_nid generation:  0.004089832305908203
local_in_edges_tensor generation:  0.002857685089111328
mini_batch_src_global generation:  0.002552032470703125
r_  generation:  0.029288053512573242
local_output_nid generation:  0.007964372634887695
local_in_edges_tensor generation:  0.00871419906616211
mini_batch_src_global generation:  0.007903814315795898
r_  generation:  0.08091235160827637
local_output_nid generation:  0.006995677947998047
local_in_edges_tensor generation:  0.0050890445709228516
mini_batch_src_global generation:  0.00648188591003418
r_  generation:  0.05618166923522949
local_output_nid generation:  0.005277156829833984
local_in_edges_tensor generation:  0.0035097599029541016
mini_batch_src_global generation:  0.0037839412689208984
r_  generation:  0.03293490409851074
local_output_nid generation:  0.006520748138427734
local_in_edges_tensor generation:  0.004205942153930664
mini_batch_src_global generation:  0.0041141510009765625
r_  generation:  0.045198917388916016
local_output_nid generation:  0.009006023406982422
local_in_edges_tensor generation:  0.007977008819580078
mini_batch_src_global generation:  0.010631322860717773
r_  generation:  0.08521127700805664
local_output_nid generation:  0.008849143981933594
local_in_edges_tensor generation:  0.007961034774780273
mini_batch_src_global generation:  0.010105609893798828
r_  generation:  0.08668780326843262
local_output_nid generation:  0.008019685745239258
local_in_edges_tensor generation:  0.005313873291015625
mini_batch_src_global generation:  0.0075528621673583984
r_  generation:  0.06125521659851074
local_output_nid generation:  0.009446382522583008
local_in_edges_tensor generation:  0.006699800491333008
mini_batch_src_global generation:  0.01198887825012207
r_  generation:  0.08165931701660156
----------------------check_connections_block total spend ----------------------------- 1.221837043762207
generate_one_block  0.0717020034790039
generate_one_block  0.0436248779296875
generate_one_block  0.03144979476928711
generate_one_block  0.025414705276489258
generate_one_block  0.06026339530944824
generate_one_block  0.03677105903625488
generate_one_block  0.03979301452636719
generate_one_block  0.03838491439819336
generate_one_block  0.11393189430236816
generate_one_block  0.07215356826782227
generate_one_block  0.04243779182434082
generate_one_block  0.06067252159118652
generate_one_block  0.11699366569519043
generate_one_block  0.11888909339904785
generate_one_block  0.08483505249023438
generate_one_block  0.11121821403503418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.030542850494384766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

connection checking time:  1.221837043762207
block generation total time  1.068535566329956
average batch blocks generation time:  0.06678347289562225
block dataloader generation time/epoch 21.455360651016235
pseudo mini batch 0 input nodes size: 34339
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027837753295898438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027837753295898438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04421186447143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04425525665283203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02835702896118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029489994049072266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029489994049072266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029489994049072266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([34339, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029489994049072266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1092, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08056354522705078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08056354522705078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0816049575805664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0899362564086914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1178, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09071588516235352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09071588516235352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09183931350708008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10888147354125977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1134, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10994195938110352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10994195938110352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1110234260559082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.13481569290161133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([994, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1361708641052246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1361708641052246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.13711881637573242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1650099754333496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([992, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1669011116027832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1669011116027832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1678471565246582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2026371955871582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([830, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.20453882217407227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.20453882217407227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.20533037185668945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23936700820922852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([756, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24149465560913086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24149465560913086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24221563339233398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2790675163269043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([732, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.28149938583374023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.28149938583374023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2821974754333496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.321988582611084  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([619, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3242959976196289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3242959976196289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3248863220214844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36356306076049805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([6574, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.39461517333984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.39461517333984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 6574, 128]), torch.Size([1, 6574, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.40088462829589844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8539676666259766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 6574, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8077101707458496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8219208717346191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8361315727233887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8218097686767578  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([14901, 256])
first layer input nodes number: 34339
first layer output nodes number: 14901
edges number: 103225
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8363895416259766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8506002426147461  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8541531562805176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8541531562805176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([773, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9023723602294922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9023723602294922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9038467407226562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9156417846679688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([701, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9163608551025391  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9163608551025391  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9176979064941406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9377536773681641  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([558, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9387421607971191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9387421607971191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9398064613342285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9643750190734863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9656243324279785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9656243324279785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9664826393127441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9917302131652832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([393, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.993189811706543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.993189811706543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9939393997192383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0212554931640625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([315, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0226974487304688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0226974487304688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0232982635498047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.049386978149414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([279, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0512871742248535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0512871742248535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0518193244934082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0803442001342773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([261, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.082085132598877  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.082085132598877  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.082582950592041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1124095916748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([200, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1138911247253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1138911247253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1142725944519043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1386866569519043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([194, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1403608322143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1403608322143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.140730857849121  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1670026779174805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1683087348937988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1683087348937988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1685776710510254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1895546913146973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1918354034423828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1918354034423828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1921138763427734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2157840728759766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([135, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.217331886291504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.217331886291504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2175893783569336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2412786483764648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([122, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2427916526794434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2427916526794434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2430243492126465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2660613059997559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.267430305480957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.267430305480957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2676267623901367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2884511947631836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.289475917816162  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.289475917816162  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2896151542663574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3053488731384277  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3066191673278809  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3066191673278809  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3067755699157715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3255438804626465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.32643461227417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.32643461227417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3265414237976074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.34010648727417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3409481048583984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3409481048583984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3410415649414062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3535652160644531  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3545761108398438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3545761108398438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3546810150146484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3694725036621094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3703489303588867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3703489303588867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.370436668395996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3834218978881836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3843297958374023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3843297958374023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.384415626525879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.397719383239746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.398207187652588  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.398207187652588  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3982529640197754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4056687355041504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.406545639038086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.406545639038086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4066200256347656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4191913604736328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([562, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4326581954956055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4326581954956055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.433730125427246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.624588966369629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 562, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5825824737548828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5834474563598633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5843124389648438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5834040641784668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5802, 40])
input nodes number: 14901
output nodes number: 5802
edges number: 48691
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5835871696472168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5835881233215332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03167104721069336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 1 input nodes size: 26203
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028386592864990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028386592864990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04088115692138672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0409245491027832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02450704574584961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025489330291748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025489330291748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025489330291748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([26203, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025489330291748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1201, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06850385665893555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06850385665893555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1201, 128]), torch.Size([1, 1201, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06964921951293945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0788121223449707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1201, 128])
m.shape torch.Size([1304, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07992410659790039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07992410659790039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1304, 128]), torch.Size([1, 1304, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08116769790649414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09982156753540039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1304, 128])
m.shape torch.Size([1240, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10102510452270508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10102510452270508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1240, 128]), torch.Size([1, 1240, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10220766067504883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12822389602661133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1240, 128])
m.shape torch.Size([1076, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1296849250793457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1296849250793457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.13071107864379883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16059160232543945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([979, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1624126434326172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1624126434326172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1633462905883789  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19877958297729492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([848, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.20073890686035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.20073890686035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.20154762268066406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23667335510253906  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([737, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23872900009155273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23872900009155273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23943185806274414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2749204635620117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([708, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2772698402404785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2772698402404785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.27794504165649414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3172478675842285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([610, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.31952810287475586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.31952810287475586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.32010984420776367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.35912418365478516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([4845, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.38193607330322266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.38193607330322266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 4845, 128]), torch.Size([1, 4845, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.38655662536621094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7146158218383789  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 4845, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6772222518920898  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6901426315307617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7030630111694336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6900415420532227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([13548, 256])
first layer input nodes number: 26203
first layer output nodes number: 13548
edges number: 86579
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7032604217529297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7161808013916016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7194108963012695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7194108963012695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([804, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7638158798217773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7638158798217773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7653493881225586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7783641815185547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([726, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7794203758239746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7794203758239746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7808051109313965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8021998405456543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 726, 256])
m.shape torch.Size([603, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.803619384765625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.803619384765625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8047695159912109  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8300724029541016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([501, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8314237594604492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8314237594604492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8323793411254883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8605108261108398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([407, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8619890213012695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8619890213012695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8627653121948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.890711784362793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([310, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8921117782592773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8921117782592773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8927030563354492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.919093132019043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([285, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.92071533203125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.92071533203125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9212589263916016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9485616683959961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([255, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9502506256103516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9502506256103516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9507369995117188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9784603118896484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([228, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9801898002624512  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9801898002624512  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9806246757507324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0084567070007324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([185, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0100173950195312  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0100173950195312  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0103702545166016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0354232788085938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([177, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0371184349060059  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0371184349060059  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0374560356140137  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.063788890838623  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([133, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0651540756225586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0651540756225586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0654077529907227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.086970329284668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([112, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.088243007659912  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.088243007659912  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.088456630706787  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.108109951019287  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1091742515563965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1091742515563965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1093401908874512  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1257681846618652  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.127026081085205  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.127026081085205  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1272034645080566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1460061073303223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1471633911132812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1471633911132812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.147317886352539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1647758483886719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1658101081848145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1658101081848145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1659398078918457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1815037727355957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1824793815612793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1824793815612793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1825919151306152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1968836784362793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1981606483459473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1981606483459473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1982998847961426  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2169575691223145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2187533378601074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2187533378601074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2188620567321777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2341914176940918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2349648475646973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2349648475646973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2350430488586426  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2466168403625488  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2476348876953125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2476348876953125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2477264404296875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2619171142578125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2628002166748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2628002166748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2628803253173828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.275857925415039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2766022682189941  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2766022682189941  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2766671180725098  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2876267433166504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([396, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.297109603881836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.297109603881836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2978649139404297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4307994842529297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 396, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3931708335876465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3940362930297852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3949017524719238  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3939929008483887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5805, 40])
input nodes number: 13548
output nodes number: 5805
edges number: 45153
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3941378593444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3941383361816406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02737283706665039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 2 input nodes size: 22872
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024507522583007812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024507522583007812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03541374206542969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.035457611083984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.022919654846191406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023682594299316406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023682594299316406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023682594299316406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([22872, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023682594299316406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1411, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.056733131408691406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.056733131408691406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1411, 128]), torch.Size([1, 1411, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.058078765869140625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06891822814941406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1411, 128])
m.shape torch.Size([1518, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07048988342285156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07048988342285156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07193756103515625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09365272521972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([1289, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09501934051513672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09501934051513672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1289, 128]), torch.Size([1, 1289, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09624862670898438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12379837036132812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1289, 128])
m.shape torch.Size([1131, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12534093856811523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12534093856811523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1264195442199707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1576991081237793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([961, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15945100784301758  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15945100784301758  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16036748886108398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19413089752197266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([777, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19589567184448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19589567184448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19663667678833008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2288041114807129  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([667, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23065996170043945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23065996170043945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23129606246948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2638063430786133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([577, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2656893730163574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2656893730163574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26623964309692383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.298184871673584  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([495, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3000340461730957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3000340461730957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3005061149597168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3307185173034668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([2988, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3447303771972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3447303771972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 2988, 128]), torch.Size([1, 2988, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3475799560546875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5506024360656738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 2988, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5231461524963379  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5344128608703613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5456795692443848  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5343246459960938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([11814, 256])
first layer input nodes number: 22872
first layer output nodes number: 11814
edges number: 65925
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5458521842956543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5571188926696777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5599355697631836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5599355697631836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([943, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.59600830078125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.59600830078125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 943, 256]), torch.Size([1, 943, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5978069305419922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6133618354797363  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 943, 256])
m.shape torch.Size([881, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6151070594787598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6151070594787598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 881, 256]), torch.Size([1, 881, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6167874336242676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6419930458068848  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 881, 256])
m.shape torch.Size([682, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6431193351745605  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6431193351745605  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 682, 256]), torch.Size([1, 682, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6444201469421387  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6730380058288574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 682, 256])
m.shape torch.Size([570, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6746993064880371  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6746993064880371  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6757864952087402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7073149681091309  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([464, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7090015411376953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7090015411376953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7098865509033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7421131134033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([341, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7436370849609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7436370849609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7442874908447266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7739620208740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([308, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7757091522216797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7757091522216797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7762966156005859  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8056697845458984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([240, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8072214126586914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8072214126586914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8076791763305664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8337717056274414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([207, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8353338241577148  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8353338241577148  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.835728645324707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.860997200012207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([183, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8625588417053223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8625588417053223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.862907886505127  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8876900672912598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8889431953430176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8889431953430176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8892006874084473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9092850685119629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.910367488861084  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.910367488861084  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9105677604675293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9275908470153809  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9287528991699219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9287528991699219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9289455413818359  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9466686248779297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9476065635681152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9476065635681152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.947751522064209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9621024131774902  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9641227722167969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9641227722167969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9642753601074219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9804496765136719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9813904762268066  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9813904762268066  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9815163612365723  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9957413673400879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9965119361877441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9965119361877441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9966092109680176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.00828218460083  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0091853141784668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0091853141784668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0092902183532715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0226130485534668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0231819152832031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0231819152832031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0232467651367188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0319366455078125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0325965881347656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0325965881347656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0326652526855469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0423469543457031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0428175926208496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0428175926208496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.04286527633667  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0499224662780762  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0503640174865723  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0503640174865723  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0504059791564941  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0569100379943848  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0573315620422363  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0573315620422363  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0573697090148926  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.063549518585205  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0639457702636719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0639457702636719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0639801025390625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0697822570800781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([187, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.074258804321289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.074258804321289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.074615478515625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.13739013671875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1079859733581543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1088547706604004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1097235679626465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1088109016418457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5830, 40])
input nodes number: 11814
output nodes number: 5830
edges number: 36343
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1089463233947754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1089468002319336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02522134780883789  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 3 input nodes size: 18604
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.022922992706298828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.022922992706298828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.031794071197509766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03183746337890625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.020887374877929688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.021493911743164062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.021493911743164062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.021493911743164062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([18604, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.021493911743164062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1699, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04793262481689453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04793262481689453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1699, 128]), torch.Size([1, 1699, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04955291748046875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0625152587890625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1699, 128])
m.shape torch.Size([1691, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06331777572631836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06331777572631836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1691, 128]), torch.Size([1, 1691, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06493043899536133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08989095687866211  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1691, 128])
m.shape torch.Size([1345, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09143733978271484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09143733978271484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1345, 128]), torch.Size([1, 1345, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09272003173828125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.121124267578125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1345, 128])
m.shape torch.Size([1076, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12253522872924805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12253522872924805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12356138229370117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1533198356628418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([913, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1549835205078125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1549835205078125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1558542251586914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1876378059387207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([704, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18931961059570312  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18931961059570312  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18999099731445312  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21986961364746094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([557, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22139310836791992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22139310836791992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2219243049621582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2485971450805664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([476, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25014734268188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25014734268188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25060129165649414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2764763832092285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([346, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.27773427963256836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.27773427963256836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2780642509460449  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2991824150085449  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([1905, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30810117721557617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30810117721557617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1905, 128]), torch.Size([1, 1905, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3099179267883301  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4389071464538574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1905, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4186406135559082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.42885637283325195  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4390721321105957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.42877626419067383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([10712, 256])
first layer input nodes number: 18604
first layer output nodes number: 10712
edges number: 52080
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4392127990722656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4494285583496094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4526090621948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4526090621948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1199, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.48231029510498047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.48231029510498047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1199, 256]), torch.Size([1, 1199, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.48503780364990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5044755935668945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1199, 256])
m.shape torch.Size([1000, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5052547454833984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5052547454833984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1000, 256]), torch.Size([1, 1000, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5071620941162109  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5357723236083984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1000, 256])
m.shape torch.Size([753, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5369901657104492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5369901657104492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.538426399230957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5700235366821289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([545, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5714011192321777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5714011192321777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5724406242370605  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6034064292907715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([466, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6051263809204102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6051263809204102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6060152053833008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6380395889282227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([352, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.639625072479248  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.639625072479248  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.640296459197998  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6699051856994629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6713929176330566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6713929176330566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6719098091125488  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.698631763458252  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([242, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7002344131469727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7002344131469727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7006959915161133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7270059585571289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([162, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7281765937805176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7281765937805176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7284855842590332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7482609748840332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7494621276855469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7494621276855469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7497310638427734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7688255310058594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7702107429504395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7702107429504395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7704110145568848  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7860321998596191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7871088981628418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7871088981628418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7873034477233887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.803840160369873  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8045554161071777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8045554161071777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8046793937683105  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8160853385925293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.816777229309082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.816777229309082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8168840408325195  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.827458381652832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8281402587890625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8281402587890625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8282375335693359  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8385486602783203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8390846252441406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8390846252441406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8391571044921875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8473472595214844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8478670120239258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8478670120239258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8479318618774414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8557138442993164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8561315536499023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8561315536499023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8561811447143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8624792098999023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8628015518188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8628015518188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8628377914428711  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8676939010620117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8679642677307129  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8679642677307129  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8679928779602051  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8720269203186035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8723759651184082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8723759651184082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8724102973937988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8774914741516113  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8777070045471191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8777070045471191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8777279853820801  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8809800148010254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8812351226806641  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8812351226806641  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8812580108642578  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8849658966064453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8852543830871582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8852543830871582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8852791786193848  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8894696235656738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([86, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8915238380432129  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8915238380432129  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8916878700256348  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9205574989318848  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 86, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8979883193969727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8988499641418457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8997116088867188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8988065719604492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5782, 40])
input nodes number: 10712
output nodes number: 5782
edges number: 29227
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8989229202270508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.898923397064209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.022756099700927734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 4 input nodes size: 25086
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02088022232055664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02088022232055664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.032842159271240234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.032885074615478516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023970603942871094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024956703186035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024956703186035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024956703186035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([25086, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024956703186035156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1215, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06967449188232422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06967449188232422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1215, 128]), torch.Size([1, 1215, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07083320617675781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08010292053222656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1215, 128])
m.shape torch.Size([1267, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08123350143432617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08123350143432617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1267, 128]), torch.Size([1, 1267, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08244180679321289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10056638717651367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1267, 128])
m.shape torch.Size([1205, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10184860229492188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10184860229492188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1205, 128]), torch.Size([1, 1205, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1029977798461914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1282796859741211  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1205, 128])
m.shape torch.Size([991, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12988519668579102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12988519668579102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1308302879333496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15823793411254883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([968, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16007328033447266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16007328033447266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1609964370727539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19457340240478516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([761, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1962890625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1962890625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19701480865478516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22907543182373047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([713, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2310924530029297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2310924530029297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23177242279052734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26636266708374023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([658, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26853275299072266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26853275299072266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26916027069091797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3053598403930664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([517, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3072648048400879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3072648048400879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3077578544616699  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34020137786865234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([5255, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36501264572143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36501264572143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 5255, 128]), torch.Size([1, 5255, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3700242042541504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7258448600769043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 5255, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6865715980529785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6994938850402832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7124161720275879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6993927955627441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([13550, 256])
first layer input nodes number: 25086
first layer output nodes number: 13550
edges number: 88192
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7126049995422363  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.725527286529541  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7287578582763672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7287578582763672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([862, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7731127738952637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7731127738952637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.774756908416748  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7880325317382812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([744, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7886977195739746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7886977195739746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7901167869567871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8127532005310059  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([618, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8140482902526855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8140482902526855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8152270317077637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.841315746307373  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 618, 256])
m.shape torch.Size([439, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8427305221557617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8427305221557617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8435678482055664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8692507743835449  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([370, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.870610237121582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.870610237121582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8713159561157227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8974084854125977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8988494873046875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8988494873046875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8994426727294922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9260201454162598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([274, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9275670051574707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9275670051574707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9280896186828613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9548139572143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([242, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.956413745880127  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.956413745880127  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9568753242492676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9831852912902832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9847192764282227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9847192764282227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9851083755493164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0100107192993164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([179, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0115365982055664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0115365982055664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0118780136108398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.036118507385254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([151, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0375442504882812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0375442504882812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.037832260131836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0602970123291016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.061525821685791  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.061525821685791  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0617527961730957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0810456275939941  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0823192596435547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0823192596435547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0825309753417969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1020088195800781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.103315830230713  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.103315830230713  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1035161018371582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1233429908752441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1245551109313965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1245551109313965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1247286796569824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1431269645690918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.144270420074463  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.144270420074463  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.144423007965088  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.161665439605713  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.16286039352417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.16286039352417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1630034446716309  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1801695823669434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1809287071228027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1809287071228027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1810202598571777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1926474571228027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1934237480163574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1934237480163574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.193509578704834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2050108909606934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2061023712158203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2061023712158203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2062149047851562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2220821380615234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2231025695800781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2231025695800781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2232017517089844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2378807067871094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2385077476501465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2385077476501465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2385687828063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2480292320251465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2487506866455078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2487506866455078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2488155364990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2593212127685547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2601423263549805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2601423263549805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2602128982543945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.272139549255371  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([424, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.282292366027832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.282292366027832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2831010818481445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4259748458862305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 424, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3879222869873047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.388772964477539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3896236419677734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3887300491333008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5706, 40])
input nodes number: 13550
output nodes number: 5706
edges number: 44043
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3888630867004395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3888635635375977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.026815414428710938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 5 input nodes size: 23430
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023959636688232422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023959636688232422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03513193130493164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03517436981201172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023169517517089844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024135589599609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024135589599609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024135589599609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([23430, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024135589599609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1103, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06503582000732422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06503582000732422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06608772277832031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07489871978759766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1122, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07595157623291016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07595157623291016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07702159881591797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09393978118896484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1014, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09485530853271484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09485530853271484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09582233428955078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1175079345703125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([965, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1188650131225586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1188650131225586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11978530883789062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14688777923583984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([870, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14850187301635742  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14850187301635742  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14933156967163086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18006372451782227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([761, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18182611465454102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18182611465454102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18255186080932617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21410703659057617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([659, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2159438133239746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2159438133239746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21657228469848633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24885225296020508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([563, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2506856918334961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2506856918334961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2512226104736328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2818784713745117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([523, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.28395986557006836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.28395986557006836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.28445863723754883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3170285224914551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([4940, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3403348922729492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3403348922729492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 4940, 128]), torch.Size([1, 4940, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3450460433959961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6912946701049805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 4940, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.654695987701416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6666359901428223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6785759925842285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6665425300598145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([12520, 256])
first layer input nodes number: 23430
first layer output nodes number: 12520
edges number: 82389
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6787528991699219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6906929016113281  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6937351226806641  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6937351226806641  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([811, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7401223182678223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7401223182678223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 811, 256]), torch.Size([1, 811, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7416691780090332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7540440559387207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 811, 256])
m.shape torch.Size([662, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7546539306640625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7546539306640625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7559165954589844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7752227783203125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([542, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7763872146606445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7763872146606445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7774209976196289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8009252548217773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8022723197937012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8022723197937012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.803128719329834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8279643058776855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([390, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8294105529785156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8294105529785156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8301544189453125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.85693359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([296, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8582687377929688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8582687377929688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8588333129882812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8843021392822266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([265, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8858027458190918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8858027458190918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8863081932067871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9128479957580566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([199, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9141254425048828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9141254425048828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9145050048828125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9361400604248047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([219, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9378447532653809  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9378447532653809  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9382624626159668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9649958610534668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([176, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9664788246154785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9664788246154785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9668145179748535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9906487464904785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9920458793640137  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9920458793640137  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9923281669616699  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0143465995788574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0156702995300293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0156702995300293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0159125328063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0365023612976074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0377182960510254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0377182960510254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0379223823547363  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0566983222961426  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0580363273620605  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0580363273620605  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0582404136657715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0784449577331543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0796260833740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0796260833740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0797958374023438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0977897644042969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0986275672912598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0986275672912598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0987420082092285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1116738319396973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([83, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1129732131958008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1129732131958008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1131315231323242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1321287155151367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1332778930664062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1332778930664062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.133413314819336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1506118774414062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1517677307128906  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1517677307128906  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.151895523071289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1690196990966797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1701092720031738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1701092720031738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1702237129211426  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1863598823547363  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1877975463867188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1877975463867188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1878929138183594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2020072937011719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.202721118927002  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.202721118927002  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2027897834777832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.213432788848877  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2143049240112305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2143049240112305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2143831253051758  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2270517349243164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2277507781982422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2277507781982422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2278118133544922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2381267547607422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([548, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2512640953063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2512640953063965  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2523093223571777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4422011375427246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 548, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4019031524658203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.402742862701416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4035825729370117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.402700424194336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5635, 40])
input nodes number: 12520
output nodes number: 5635
edges number: 47212
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4028253555297852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4028258323669434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025961875915527344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 6 input nodes size: 21477
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023158550262451172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023158550262451172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03339958190917969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03344249725341797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.022227764129638672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023163318634033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023163318634033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023163318634033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([21477, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.023163318634033203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([767, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06092500686645508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06092500686645508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06165647506713867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06801319122314453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([868, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06847524642944336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06847524642944336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06930303573608398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08171987533569336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([893, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08258342742919922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08258342742919922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08343505859375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10297441482543945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([876, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10421943664550781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10421943664550781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10505485534667969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12958717346191406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([773, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1310124397277832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1310124397277832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.13174962997436523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15877628326416016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([733, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16050481796264648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16050481796264648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16120386123657227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19126272201538086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([631, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19301939010620117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19301939010620117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19362115859985352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22402715682983398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([576, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2259235382080078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2259235382080078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2264728546142578  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2588329315185547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([461, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26053667068481445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26053667068481445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26097631454467773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.28911352157592773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([4622, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.31093311309814453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.31093311309814453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 4622, 128]), torch.Size([1, 4622, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3153409957885742  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.628300666809082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 4622, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5948195457458496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6055006980895996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6161818504333496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6054172515869141  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([11200, 256])
first layer input nodes number: 21477
first layer output nodes number: 11200
edges number: 76343
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6163439750671387  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6270251274108887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6305346488952637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6305346488952637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([586, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6785712242126465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6785712242126465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6796889305114746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6891989707946777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([561, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.690244197845459  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.690244197845459  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6913142204284668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7076544761657715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([537, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7090315818786621  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7090315818786621  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 537, 256]), torch.Size([1, 537, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7100558280944824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7331390380859375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 537, 256])
m.shape torch.Size([465, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7345409393310547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7345409393310547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7354278564453125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7626590728759766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([431, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.764286994934082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.764286994934082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7651090621948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7954673767089844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([379, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7981634140014648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7981634140014648  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7988862991333008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8307065963745117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([323, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8325185775756836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8325185775756836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.833134651184082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.864227294921875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([274, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8660264015197754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8660264015197754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.866549015045166  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.897432804107666  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([211, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8989968299865723  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8989968299865723  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8993992805480957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9251561164855957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([236, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9272232055664062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9272232055664062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.92767333984375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9596328735351562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([214, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9616703987121582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9616703987121582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9620785713195801  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9939160346984863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([152, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9954652786254883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9954652786254883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9957551956176758  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0203981399536133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([147, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.022089958190918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.022089958190918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0223703384399414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0481653213500977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([128, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0497474670410156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0497474670410156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0499916076660156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0741615295410156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0753660202026367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0753660202026367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0755414962768555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.094141960144043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([102, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0956230163574219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0956230163574219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0958175659179688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1178016662597656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1193547248840332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1193547248840332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1195473670959473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1426644325256348  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([76, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1439900398254395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1439900398254395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1441349983215332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1625447273254395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1634950637817383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1634950637817383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1636018753051758  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1779146194458008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([79, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.179379940032959  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.179379940032959  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1795306205749512  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2007765769958496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2019124031066895  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2019124031066895  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2020268440246582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2189640998840332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2198586463928223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2198586463928223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2199444770812988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.233248233795166  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2339348793029785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2339348793029785  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2339978218078613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.244194507598877  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2451090812683105  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2451090812683105  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2451872825622559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2584033012390137  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([405, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2680959701538086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2680959701538086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2688684463500977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4048242568969727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 405, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.362943172454834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.363797664642334  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.364652156829834  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3637547492980957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5734, 40])
input nodes number: 11200
output nodes number: 5734
edges number: 49060
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3638958930969238  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.363896369934082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.024955272674560547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 7 input nodes size: 27353
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02224254608154297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.02224254608154297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03591442108154297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03595733642578125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025673389434814453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.026631832122802734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.026631832122802734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.026631832122802734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([27353, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.026631832122802734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1054, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06809329986572266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06809329986572266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06909847259521484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07713985443115234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([1179, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07776165008544922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07776165008544922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1179, 128]), torch.Size([1, 1179, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07888603210449219  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09575176239013672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1179, 128])
m.shape torch.Size([1161, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0969700813293457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0969700813293457  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09807729721069336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12310361862182617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([1026, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12450695037841797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12450695037841797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12548542022705078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15386104583740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([868, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1554412841796875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1554412841796875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15626907348632812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18633270263671875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([767, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18811321258544922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18811321258544922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1888446807861328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2217845916748047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([680, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22368860244750977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22368860244750977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22433710098266602  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2568211555480957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([636, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2589230537414551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2589230537414551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25952959060668945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2945523262023926  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([548, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2966008186340332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2966008186340332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29712343215942383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3316774368286133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([4885, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3547096252441406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3547096252441406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 4885, 128]), torch.Size([1, 4885, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.35936832427978516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7053756713867188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 4885, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6690554618835449  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6812663078308105  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6934771537780762  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6811704635620117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([12804, 256])
first layer input nodes number: 27353
first layer output nodes number: 12804
edges number: 83571
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6936831474304199  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7058939933776855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.708946704864502  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.708946704864502  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([749, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7532029151916504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7532029151916504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.754631519317627  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.766451358795166  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([728, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7675409317016602  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7675409317016602  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7689294815063477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7897577285766602  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([629, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7910299301147461  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7910299301147461  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7922296524047852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8189592361450195  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([508, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8205184936523438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8205184936523438  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8214874267578125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8497390747070312  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([412, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8512349128723145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8512349128723145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8520207405090332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8808140754699707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([334, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.882347583770752  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.882347583770752  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8829846382141113  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9103779792785645  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9118156433105469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9118156433105469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9123134613037109  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9375791549682617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9391374588012695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9391374588012695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9395856857299805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9651346206665039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([218, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9667963981628418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9667963981628418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9672122001647949  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9938235282897949  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9950671195983887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9950671195983887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9953551292419434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0158038139343262  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([151, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.017256259918213  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.017256259918213  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0175442695617676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0400090217590332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([155, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0416531562805176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0416531562805176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0419487953186035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0670781135559082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([113, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.068425178527832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.068425178527832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0686407089233398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0884695053100586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0897612571716309  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0897612571716309  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0899596214294434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1095976829528809  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1107816696166992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1107816696166992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1109514236450195  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1289453506469727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.129906177520752  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.129906177520752  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1300358772277832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1446919441223145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1457219123840332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1457219123840332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1458497047424316  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1611847877502441  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([76, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1624360084533691  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1624360084533691  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.162580966949463  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1809906959533691  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1819047927856445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1819047927856445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1820077896118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1958093643188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1965270042419434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1965270042419434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1966032981872559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2073607444763184  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2083725929260254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2083725929260254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2084717750549316  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2231507301330566  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2240104675292969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2240104675292969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2240924835205078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2368049621582031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2376484870910645  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2376484870910645  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.237724781036377  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.250084400177002  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2507152557373047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2507152557373047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2507705688476562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2601184844970703  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([430, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2704229354858398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2704229354858398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2712430953979492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4155912399291992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 430, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3775582313537598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.378413200378418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3792681694030762  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3783702850341797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5736, 40])
input nodes number: 12804
output nodes number: 5736
edges number: 44973
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.378509521484375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3785099983215332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028482913970947266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 8 input nodes size: 60622
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025673866271972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.025673866271972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0545806884765625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.05462312698364258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0409083366394043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.043187618255615234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.043187618255615234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.043187618255615234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([60622, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.043187618255615234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1053, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1615433692932129  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1615433692932129  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16254758834838867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17074108123779297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([1283, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1714625358581543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1714625358581543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1283, 128]), torch.Size([1, 1283, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17268610000610352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1910395622253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1283, 128])
m.shape torch.Size([1184, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1924571990966797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1924571990966797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1184, 128]), torch.Size([1, 1184, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1935863494873047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2185497283935547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1184, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22006988525390625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22006988525390625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22111225128173828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25215721130371094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1121, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25430870056152344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25430870056152344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25537776947021484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29415225982666016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1007, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29649877548217773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29649877548217773  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29745912551879883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3400592803955078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([1024, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34299707412719727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34299707412719727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1024, 128]), torch.Size([1, 1024, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34397363662719727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3933224678039551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1024, 128])
m.shape torch.Size([960, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3964962959289551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3964962959289551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3974118232727051  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4503293037414551  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([991, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45412445068359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45412445068359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45506954193115234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5163416862487793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([19414, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6084423065185547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6084423065185547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 19414, 128]), torch.Size([1, 19414, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6269569396972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9414958953857422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 19414, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.830615520477295  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.858396053314209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.886176586151123  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8581786155700684  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([29130, 256])
first layer input nodes number: 60622
first layer output nodes number: 29130
edges number: 241097
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8866305351257324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9144110679626465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.921356201171875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.921356201171875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([630, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9843788146972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9843788146972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9855804443359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9960365295410156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([582, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9966082572937012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9966082572937012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.997718334197998  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.014369487762451  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([443, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0153236389160156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0153236389160156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0161685943603516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0378475189208984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([330, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.039060115814209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.039060115814209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.039689540863037  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0672354698181152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([309, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0689659118652344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0689659118652344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0695552825927734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0936708450317383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([232, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0947141647338867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0947141647338867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.095156669616699  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1141843795776367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([187, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1152215003967285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1152215003967285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1155781745910645  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1334118843078613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([162, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1354284286499023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1354284286499023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.135737419128418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1533498764038086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([161, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.154588222503662  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.154588222503662  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.154895305633545  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.174548625946045  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1758079528808594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1758079528808594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.176088333129883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.195995330810547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.197293281555176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.197293281555176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1975526809692383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2177858352661133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2193965911865234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2193965911865234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.219633102416992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.239736557006836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.240905284881592  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.240905284881592  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2411017417907715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2591757774353027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.260369300842285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.260369300842285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.260552406311035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.278679847717285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2798571586608887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2798571586608887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.280025005340576  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.297816753387451  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.298978805541992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.298978805541992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.29913330078125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.316591262817383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.317657947540283  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.317657947540283  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.31779146194458  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.333813190460205  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3358139991760254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3358139991760254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3359932899475098  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3587632179260254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3599886894226074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3599886894226074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.36012601852417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.378528118133545  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3796706199645996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3796706199645996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.379790782928467  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3967337608337402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3979859352111816  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3979859352111816  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3981099128723145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4164586067199707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.417454242706299  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.417454242706299  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4175496101379395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4323315620422363  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4332127571105957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4332127571105957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.433292865753174  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.44627046585083  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4473838806152344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4473838806152344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.447479248046875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4635963439941406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([1335, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.495626449584961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.495626449584961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1335, 256]), torch.Size([1, 1335, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.499068260192871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.9544363021850586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1335, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8967251777648926  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8975677490234375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8984103202819824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8975253105163574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5652, 40])
input nodes number: 29130
output nodes number: 5652
edges number: 64703
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.897772789001465  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.897773265838623  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04710531234741211  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 9 input nodes size: 47467
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.040895938873291016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.040895938873291016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06352996826171875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06357145309448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0346221923828125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.036106109619140625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.036106109619140625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.036106109619140625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([47467, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.036106109619140625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1394, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11281442642211914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11281442642211914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1394, 128]), torch.Size([1, 1394, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11414384841918945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12477922439575195  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1394, 128])
m.shape torch.Size([1455, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1255021095275879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1255021095275879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1455, 128]), torch.Size([1, 1455, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.12688970565795898  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1477036476135254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1455, 128])
m.shape torch.Size([1222, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1495809555053711  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1495809555053711  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1222, 128]), torch.Size([1, 1222, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.15074634552001953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17638492584228516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1222, 128])
m.shape torch.Size([1193, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17807769775390625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17807769775390625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1193, 128]), torch.Size([1, 1193, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1792154312133789  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21270990371704102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1193, 128])
m.shape torch.Size([1103, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21477079391479492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21477079391479492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21582269668579102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2542881965637207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([944, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25646305084228516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25646305084228516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25736331939697266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29720211029052734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([927, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29984617233276367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.29984617233276367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30073022842407227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3454093933105469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([854, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34822511672973633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34822511672973633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.34903955459594727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3963799476623535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([770, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3992772102355957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3992772102355957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4000115394592285  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.44791650772094727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([11122, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5005831718444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5005831718444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 11122, 128]), torch.Size([1, 11122, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5111899375915527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2657465934753418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 11122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1959543228149414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2159662246704102  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.235978126525879  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2158098220825195  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([20984, 256])
first layer input nodes number: 47467
first layer output nodes number: 20984
edges number: 155392
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2363338470458984  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2563457489013672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2613487243652344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2613487243652344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([902, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3044347763061523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3044347763061523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 902, 256]), torch.Size([1, 902, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3061552047729492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3210601806640625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 902, 256])
m.shape torch.Size([769, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3218655586242676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3218655586242676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3233323097229004  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3453564643859863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 769, 256])
m.shape torch.Size([542, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.346574306488037  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.346574306488037  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3476080894470215  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3711237907409668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([440, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3725590705871582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3725590705871582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3733983039855957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.399487018585205  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4009079933166504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4009079933166504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4016385078430176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4284796714782715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([290, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4297871589660645  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4297871589660645  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.43034029006958  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4551868438720703  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([256, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.457284927368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.457284927368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.457773208618164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.482187271118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4836039543151855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4836039543151855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.484015941619873  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5074992179870605  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5087637901306152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5087637901306152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5090880393981934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5298399925231934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5311293601989746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5311293601989746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5314173698425293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.551866054534912  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([149, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.553297519683838  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.553297519683838  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.553581714630127  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5757489204406738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.576737403869629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.576737403869629  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5769243240356445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5928125381469727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([85, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5937814712524414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5937814712524414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5939435958862305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6088590621948242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6097602844238281  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6097602844238281  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6098995208740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6236839294433594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6245660781860352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6245660781860352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6246919631958008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.638035774230957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6388802528381348  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6388802528381348  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6389927864074707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6517090797424316  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6526169776916504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6526169776916504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6527295112609863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6662335395812988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.667111873626709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.667111873626709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6672148704528809  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.680295467376709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6811938285827637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6811938285827637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.68129301071167  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6945834159851074  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.695551872253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.695551872253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.6956510543823242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7096357345581055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7103533744812012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7103533744812012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.710425853729248  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7211527824401855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7218570709228516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7218570709228516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.721923828125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7322711944580078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7327241897583008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7327241897583008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7327661514282227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7395639419555664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7401890754699707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7401890754699707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7402424812316895  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7492680549621582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([561, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7627215385437012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.7627215385437012  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.763791561126709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9581379890441895  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 561, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.921107292175293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9219346046447754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9227619171142578  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9218931198120117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5550, 40])
input nodes number: 20984
output nodes number: 5550
edges number: 43691
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9220757484436035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9220762252807617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03878641128540039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 10 input nodes size: 31854
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03460693359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03460693359375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.049796104431152344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04983949661254883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027163982391357422  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028081417083740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028081417083740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028081417083740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([31854, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.028081417083740234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1575, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07158517837524414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07158517837524414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1575, 128]), torch.Size([1, 1575, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.07308721542358398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08510351181030273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1575, 128])
m.shape torch.Size([1591, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08586978912353516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.08586978912353516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0873870849609375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11025428771972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1480, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11161279678344727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11161279678344727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1480, 128]), torch.Size([1, 1480, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11302423477172852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14412736892700195  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1480, 128])
m.shape torch.Size([1290, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14588212966918945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14588212966918945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14711236953735352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18278932571411133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1186, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18500185012817383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18500185012817383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1186, 128]), torch.Size([1, 1186, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18613290786743164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22768545150756836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1186, 128])
m.shape torch.Size([972, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23081636428833008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23081636428833008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23174333572387695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2716031074523926  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([770, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.273709774017334  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.273709774017334  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2744441032409668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3124394416809082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([748, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3149256706237793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3149256706237793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.31563901901245117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3570742607116699  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([538, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3590264320373535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3590264320373535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3595395088195801  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.39383649826049805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([4480, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.41494226455688477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.41494226455688477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 4480, 128]), torch.Size([1, 4480, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.42019128799438477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7281136512756348  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 4480, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6911234855651855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.705075740814209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7190279960632324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7049665451049805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([14630, 256])
first layer input nodes number: 31854
first layer output nodes number: 14630
edges number: 87135
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7192673683166504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7332196235656738  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7367076873779297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7367076873779297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1035, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7724766731262207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7724766731262207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1035, 256]), torch.Size([1, 1035, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7747354507446289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7921357154846191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1035, 256])
m.shape torch.Size([816, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7927918434143066  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7927918434143066  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 816, 256]), torch.Size([1, 816, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.7943482398986816  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8177981376647949  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 816, 256])
m.shape torch.Size([686, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8189983367919922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8189983367919922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 686, 256]), torch.Size([1, 686, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8203067779541016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8490924835205078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 686, 256])
m.shape torch.Size([535, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8507003784179688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8507003784179688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8517208099365234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8813133239746094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([462, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.883023738861084  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.883023738861084  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.8839049339294434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9162592887878418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([362, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9179062843322754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9179062843322754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9185967445373535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9489483833312988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([265, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9503860473632812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9503860473632812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9508914947509766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9773664474487305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([254, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9790668487548828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9790668487548828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9795513153076172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0071659088134766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0085501670837402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0085501670837402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.008908748626709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.031857967376709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0332069396972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0332069396972656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0335102081298828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0550422668457031  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0561699867248535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0561699867248535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0564007759094238  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0744023323059082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0756711959838867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0756711959838867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0759000778198242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0953550338745117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0964279174804688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0964279174804688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.096609115600586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1132793426513672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1142520904541016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1142520904541016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1144027709960938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1293201446533203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1300954818725586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1300954818725586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1302080154418945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.142136573791504  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1429572105407715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1429572105407715  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1430659294128418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.155351161956787  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1560158729553223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1560158729553223  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.156099796295166  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.166170597076416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1668901443481445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1668901443481445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1669740676879883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1776323318481445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1782846450805664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1782846450805664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1783571243286133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1880693435668945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1886868476867676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1886868476867676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1887516975402832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1978955268859863  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.198246955871582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.198246955871582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1982831954956055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2036466598510742  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2039670944213867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2039670944213867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2039976119995117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2087278366088867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2091550827026367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2091550827026367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.209193229675293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2153730392456055  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2158384323120117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2158384323120117  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2158784866333008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2226476669311523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([234, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.228250503540039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.228250503540039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2286968231201172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3072490692138672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 234, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2781295776367188  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2789883613586426  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2798471450805664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.278944969177246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5763, 40])
input nodes number: 14630
output nodes number: 5763
edges number: 35932
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2791290283203125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2791295051574707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.029929161071777344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 11 input nodes size: 49951
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027195453643798828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.027195453643798828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.051013946533203125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0510554313659668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03582286834716797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03699016571044922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03699016571044922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03699016571044922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([49951, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03699016571044922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1760, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09878015518188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.09878015518188477  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1760, 128]), torch.Size([1, 1760, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.10045862197875977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11388635635375977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1760, 128])
m.shape torch.Size([1919, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11487722396850586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11487722396850586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1919, 128]), torch.Size([1, 1919, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.11670732498168945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14415884017944336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1919, 128])
m.shape torch.Size([1628, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14593505859375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14593505859375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1628, 128]), torch.Size([1, 1628, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.14748764038085938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18164443969726562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1628, 128])
m.shape torch.Size([1473, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18369150161743164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18369150161743164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18509626388549805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22583436965942383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1209, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22801446914672852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22801446914672852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1209, 128]), torch.Size([1, 1209, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22916746139526367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.27150440216064453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1209, 128])
m.shape torch.Size([1026, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2738633155822754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2738633155822754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2748417854309082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3177189826965332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([918, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3211054801940918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3211054801940918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.32198095321655273  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.366213321685791  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([855, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3690371513366699  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3690371513366699  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36985254287719727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4169611930847168  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([703, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4195704460144043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4195704460144043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4202408790588379  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.46454524993896484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([7620, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5006098747253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5006098747253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 7620, 128]), torch.Size([1, 7620, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5078768730163574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0238337516784668  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 7620, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9696459770202637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9878716468811035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0060973167419434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.9877290725708008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([19111, 256])
first layer input nodes number: 49951
first layer output nodes number: 19111
edges number: 124368
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0064716339111328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0246973037719727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0296945571899414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0296945571899414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1112, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0621733665466309  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0621733665466309  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1112, 256]), torch.Size([1, 1112, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0647845268249512  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0851149559020996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1112, 256])
m.shape torch.Size([969, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0856142044067383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0856142044067383  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.0874624252319336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1151857376098633  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([682, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1162281036376953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1162281036376953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 682, 256]), torch.Size([1, 682, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1175289154052734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1461467742919922  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 682, 256])
m.shape torch.Size([541, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1475763320922852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1475763320922852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1486082077026367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1794023513793945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.180851936340332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.180851936340332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.1816320419311523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2097158432006836  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([293, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2110157012939453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2110157012939453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2115745544433594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2393321990966797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([224, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2405600547790527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2405600547790527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2409873008728027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2623496055603027  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([191, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2636046409606934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2636046409606934  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2639689445495605  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2847342491149902  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([152, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.285926342010498  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.285926342010498  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.2862162590026855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3047709465026855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([117, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3059988021850586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3059988021850586  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3062219619750977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.322066307067871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([93, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3229379653930664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3229379653930664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.323115348815918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3369512557983398  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3377737998962402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3377737998962402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3379244804382324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3507323265075684  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3515443801879883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3515443801879883  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.351679801940918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3641386032104492  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3648381233215332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3648381233215332  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3649468421936035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3757100105285645  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3763766288757324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3763766288757324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.376471996307373  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3865809440612793  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3873329162597656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3873329162597656  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3874320983886719  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3986396789550781  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3992114067077637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3992114067077637  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.3992838859558105  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4079813957214355  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4083952903747559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4083952903747559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.408444881439209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4147429466247559  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4152846336364746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4152846336364746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4153437614440918  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.423266887664795  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4237375259399414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4237375259399414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4237871170043945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4307794570922852  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4313201904296875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4313201904296875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4313735961914062  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4392776489257812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.439589500427246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.439589500427246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.439620018005371  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.444350242614746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4448213577270508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4448213577270508  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4448633193969727  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4516611099243164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4520788192749023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4520788192749023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4521150588989258  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4582395553588867  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([246, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4641327857971191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.4641327857971191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.464601993560791  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.547182559967041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.52105712890625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.521883487701416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.522709846496582  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5218420028686523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5544, 40])
input nodes number: 19111
output nodes number: 5544
edges number: 32246
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.521993637084961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.5219941139221191  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03922843933105469  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 12 input nodes size: 63446
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.035790443420410156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.035790443420410156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06604385375976562  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0660853385925293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.04222536087036133  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.044499874114990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.044499874114990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.044499874114990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([63446, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.044499874114990234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([1212, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16520357131958008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16520357131958008  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1212, 128]), torch.Size([1, 1212, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16635942459106445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17560625076293945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1212, 128])
m.shape torch.Size([1276, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17690229415893555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17690229415893555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1276, 128]), torch.Size([1, 1276, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17811918258666992  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.19637250900268555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1276, 128])
m.shape torch.Size([1230, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1977248191833496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1977248191833496  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1230, 128]), torch.Size([1, 1230, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1988978385925293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22470426559448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1230, 128])
m.shape torch.Size([1151, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22631311416625977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22631311416625977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.22741079330444336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.25974321365356445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([1147, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2619290351867676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2619290351867676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.26302289962768555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3024020195007324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1031, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30480480194091797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.30480480194091797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3057880401611328  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3481302261352539  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([953, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.351438045501709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.351438045501709  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.35234689712524414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3979649543762207  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([950, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4011344909667969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4011344909667969  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4020404815673828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45368194580078125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([946, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4572887420654297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4572887420654297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 946, 128]), torch.Size([1, 946, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.45819091796875  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.51593017578125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 946, 128])
m.shape torch.Size([19898, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6111822128295898  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6111822128295898  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 19898, 128]), torch.Size([1, 19898, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.6301584243774414  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9835748672485352  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 19898, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8699994087219238  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.8984131813049316  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9268269538879395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.898190975189209  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([29794, 256])
first layer input nodes number: 63446
first layer output nodes number: 29794
edges number: 245744
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9273018836975098  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9557156562805176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9628190994262695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9628190994262695  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([696, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0208210945129395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0208210945129395  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.022148609161377  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.033053398132324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([586, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0336661338806152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0336661338806152  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0347838401794434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0527663230895996  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([457, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.053572177886963  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.053572177886963  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.054443836212158  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.073946475982666  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([326, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0748863220214844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0748863220214844  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0755081176757812  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.095689296722412  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([316, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0968971252441406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0968971252441406  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0974998474121094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1200389862060547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([277, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.121335029602051  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.121335029602051  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.12186336517334  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.145543098449707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([199, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1474103927612305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1474103927612305  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.14778995513916  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1667680740356445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([165, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.167847156524658  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.167847156524658  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1681618690490723  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.186100482940674  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1874399185180664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1874399185180664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.187769889831543  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.208888053894043  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([131, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.209982395172119  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.209982395172119  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2102322578430176  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2279725074768066  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2291059494018555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2291059494018555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.22933292388916  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.247036933898926  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2484116554260254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2484116554260254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.248657703399658  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2695717811584473  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.270610809326172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.270610809326172  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2707881927490234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.287107467651367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.288149356842041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.288149356842041  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2883095741271973  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.304171085357666  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3052096366882324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3052096366882324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3053488731384277  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.320107936859131  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3211569786071777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3211569786071777  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.321288585662842  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.336160182952881  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.337108612060547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.337108612060547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3372249603271484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.351186752319336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3521742820739746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3521742820739746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3522887229919434  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3668227195739746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3678836822509766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3678836822509766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3679866790771484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3817882537841797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.38285493850708  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.38285493850708  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.382956027984619  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.397209644317627  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([68, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.398531913757324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.398531913757324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3986616134643555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4178571701049805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.418447971343994  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.418447971343994  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4185070991516113  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4276719093322754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4285268783569336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4285268783569336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.428603172302246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.440962791442871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4420433044433594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4420433044433594  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4421348571777344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4576072692871094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([1209, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.486611843109131  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.486611843109131  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1209, 256]), torch.Size([1, 1209, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.488917827606201  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8955130577087402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 1209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8428359031677246  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.843658447265625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8444809913635254  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8436169624328613  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([5517, 40])
input nodes number: 29794
output nodes number: 5517
edges number: 59416
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.843876838684082  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.8438773155212402  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0484161376953125  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

pseudo mini batch 13 input nodes size: 54967
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0422215461730957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0422215461730957  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06843185424804688  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.06847572326660156  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.03818082809448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0406489372253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0406489372253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0406489372253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([54967, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.0406489372253418  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([900, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16512203216552734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16512203216552734  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.16598033905029297  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17284679412841797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([908, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17328357696533203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.17328357696533203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.1741495132446289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18713855743408203  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([963, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18808317184448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18808317184448242  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.18900156021118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2100205421447754  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([937, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2113485336303711  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2113485336303711  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.21224212646484375  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23815631866455078  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([896, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23984575271606445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.23984575271606445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.24070024490356445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.27146196365356445  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([906, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.27362680435180664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.27362680435180664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.2744908332824707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.312166690826416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([911, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3147754669189453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3147754669189453  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.3156442642211914  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36042070388793945  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([834, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36316776275634766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36316776275634766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.36396312713623047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4105997085571289  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([854, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4138669967651367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4138669967651367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.41468143463134766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.4672098159790039  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([21384, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5687694549560547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5687694549560547  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 21384, 128]), torch.Size([1, 21384, 128])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 0.5891628265380859  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0370922088623047  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 21384, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9193568229675293  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9474835395812988  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9756102561950684  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9472637176513672  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

torch.Size([29493, 256])
first layer input nodes number: 54967
first layer output nodes number: 29493
edges number: 253844
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 1.9760217666625977  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.004148483276367  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0111804008483887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0111804008483887  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

m.shape torch.Size([538, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.086191177368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.086191177368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.087217330932617  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.095815658569336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([426, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0961217880249023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0961217880249023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.0969343185424805  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.11246395111084  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([382, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.113178253173828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.113178253173828  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1139068603515625  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.134542465209961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([304, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1353487968444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1353487968444824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1359286308288574  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1547017097473145  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1555123329162598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1555123329162598  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.155949115753174  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.17167329788208  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([203, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.17262601852417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.17262601852417  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.173013210296631  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.189662456512451  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([191, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1911582946777344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1911582946777344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.1915225982666016  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.209737777709961  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([164, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2108168601989746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2108168601989746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.211129665374756  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.228959560394287  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([162, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2302045822143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2302045822143555  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.230513572692871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.250288963317871  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([165, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.251720428466797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.251720428466797  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.252035140991211  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2743797302246094  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2757134437561035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2757134437561035  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.27598237991333  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.296959400177002  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2984628677368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.2984628677368164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.298733711242676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3217554092407227  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([134, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3239970207214355  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3239970207214355  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3242526054382324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.347766399383545  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([114, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.349172592163086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.349172592163086  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3493900299072266  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3709163665771484  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3723506927490234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3723506927490234  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3725547790527344  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3941879272460938  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3956851959228516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.3956851959228516  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.395883560180664  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4182987213134766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.419604778289795  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.419604778289795  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.419768810272217  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.439452648162842  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([96, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4410314559936523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4410314559936523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4412145614624023  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4644689559936523  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4662036895751953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4662036895751953  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4663944244384766  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.491952896118164  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([85, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4934916496276855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4934916496276855  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.4936537742614746  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5165133476257324  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([85, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5181479454040527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5181479454040527  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.518310070037842  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.542304515838623  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.543492317199707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.543492317199707  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.543606758117676  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.561345100402832  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([67, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.562805652618408  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.562805652618408  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5629334449768066  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.5836358070373535  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.584933280944824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.584933280944824  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.4295654296875 GB
    Memory Allocated: 2.58504581451416  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4315185546875 GB
    Memory Allocated: 2.6040639877319336  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([1707, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4315185546875 GB
    Memory Allocated: 2.645023822784424  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4315185546875 GB
    Memory Allocated: 2.645023822784424  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

 h.shape torch.Size([1, 1707, 256]), torch.Size([1, 1707, 256])
----------------------------------------3
 Nvidia-smi: 5.4315185546875 GB
    Memory Allocated: 2.6482796669006348  GigaBytes
Max Memory Allocated: 3.143648147583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4315185546875 GB
    Memory Allocated: 3.2213082313537598  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1707, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4315185546875 GB
    Memory Allocated: 3.153308391571045  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4315185546875 GB
    Memory Allocated: 3.1541805267333984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 3.155052661895752  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 3.1541366577148438  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5851, 40])
input nodes number: 29493
output nodes number: 5851
edges number: 77261
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 3.154449939727783  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 3.1544504165649414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04487800598144531  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 14 input nodes size: 61715
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03823041915893555  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03823041915893555  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0676584243774414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06769990921020508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04144573211669922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.042977333068847656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.042977333068847656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.042977333068847656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([61715, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.042977333068847656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1521, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1253662109375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1253662109375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1521, 128]), torch.Size([1, 1521, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1268167495727539  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.13935232162475586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1521, 128])
m.shape torch.Size([1645, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1401958465576172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1401958465576172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1645, 128]), torch.Size([1, 1645, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14176464080810547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1652965545654297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1645, 128])
m.shape torch.Size([1590, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16720247268676758  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16720247268676758  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1590, 128]), torch.Size([1, 1590, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16871881484985352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20207834243774414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1590, 128])
m.shape torch.Size([1462, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20410871505737305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20410871505737305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1462, 128]), torch.Size([1, 1462, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20550298690795898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24594831466674805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1462, 128])
m.shape torch.Size([1344, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24845552444458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24845552444458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1344, 128]), torch.Size([1, 1344, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24973726272583008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2966008186340332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1344, 128])
m.shape torch.Size([1111, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.29913854598999023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.29913854598999023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3001980781555176  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.34649085998535156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([994, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.34927892684936523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.34927892684936523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.35022687911987305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.39835023880004883  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([911, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4013514518737793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4013514518737793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4022202491760254  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4525771141052246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([874, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.45589351654052734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.45589351654052734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4567270278930664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5107784271240234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([11591, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5656318664550781  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5656318664550781  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 11591, 128]), torch.Size([1, 11591, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5773539543151855  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3644309043884277  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 11591, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2899022102355957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.311877727508545  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3338532447814941  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3117055892944336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([23043, 256])
first layer input nodes number: 61715
first layer output nodes number: 23043
edges number: 166837
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.334315299987793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3562908172607422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.362257480621338  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.362257480621338  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([947, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.40047025680542  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.40047025680542  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 947, 256]), torch.Size([1, 947, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4022765159606934  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4167265892028809  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 947, 256])
m.shape torch.Size([801, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.41737699508667  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.41737699508667  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 801, 256]), torch.Size([1, 801, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4189047813415527  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.441821575164795  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 801, 256])
m.shape torch.Size([641, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4434266090393066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4434266090393066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4446492195129395  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4716696739196777  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([496, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4734406471252441  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4734406471252441  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4743866920471191  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5018219947814941  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([406, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5033001899719238  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5033001899719238  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5040745735168457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5329957008361816  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([294, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.534304141998291  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.534304141998291  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.534864902496338  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5607495307922363  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([237, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5620636940002441  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5620636940002441  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5625157356262207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5851178169250488  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([197, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5864067077636719  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5864067077636719  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.586782455444336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6082000732421875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6095433235168457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6095433235168457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6098809242248535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6314873695373535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([145, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6327123641967773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6327123641967773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6329889297485352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6526250839233398  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6544914245605469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6544914245605469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6547069549560547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.671518325805664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([96, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6725387573242188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6725387573242188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6727218627929688  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6882858276367188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([89, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6893067359924316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.6893067359924316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.689476490020752  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7050938606262207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.706064224243164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.706064224243164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7062091827392578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.720560073852539  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7215585708618164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7215585708618164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7216978073120117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7364568710327148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7372794151306152  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7372794151306152  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7373900413513184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7498908042907715  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7505707740783691  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7505707740783691  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7506566047668457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7609562873840332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7616400718688965  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7616400718688965  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7617201805114746  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7718939781188965  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7725844383239746  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7725844383239746  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.772660732269287  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.782884120941162  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.783576488494873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.783576488494873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.78364896774292  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7938685417175293  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7944583892822266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7944583892822266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7945175170898438  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8032684326171875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8038520812988281  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8038520812988281  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8039073944091797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8124809265136719  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8130059242248535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8130059242248535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8130536079406738  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8207783699035645  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8212623596191406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8212623596191406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8213043212890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8283958435058594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([399, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8379621505737305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8379621505737305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8387231826782227  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9741849899291992  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 399, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.942155361175537  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9429779052734375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.943800449371338  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9429364204406738  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5517, 40])
input nodes number: 23043
output nodes number: 5517
edges number: 38575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9431004524230957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.943100929260254  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04578685760498047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 15 input nodes size: 69535
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.041396141052246094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.041396141052246094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07455301284790039  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07459449768066406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04512500762939453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04718303680419922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04718303680419922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04718303680419922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([69535, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04718303680419922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1421, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1595749855041504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1595749855041504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1421, 128]), torch.Size([1, 1421, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16093015670776367  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1722564697265625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1421, 128])
m.shape torch.Size([1584, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17308950424194336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17308950424194336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1584, 128]), torch.Size([1, 1584, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17460012435913086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19725942611694336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1584, 128])
m.shape torch.Size([1427, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19947481155395508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19947481155395508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1427, 128]), torch.Size([1, 1427, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2008357048034668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23083829879760742  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1427, 128])
m.shape torch.Size([1285, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23264312744140625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23264312744140625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23386859893798828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2694072723388672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1261, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2718009948730469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2718009948730469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.27300357818603516  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3165864944458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1151, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3192782402038574  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3192782402038574  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.320375919342041  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3682065010070801  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([1081, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.37126588821411133  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.37126588821411133  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3722968101501465  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.42674827575683594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([1045, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4302191734313965  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4302191734313965  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.431215763092041  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.48807621002197266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([950, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4916548728942871  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4916548728942871  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.49256086349487305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5507006645202637  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([17674, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.634523868560791  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.634523868560791  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 17674, 128]), torch.Size([1, 17674, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6516108512878418  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8524861335754395  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 17674, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7475252151489258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.7750663757324219  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.802607536315918  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.774850845336914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([28879, 256])
first layer input nodes number: 69535
first layer output nodes number: 28879
edges number: 228438
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8031277656555176  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8306689262390137  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8375544548034668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8375544548034668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([841, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8844575881958008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8844575881958008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.886061668395996  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8988943099975586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([754, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8996057510375977  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.8996057510375977  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9010438919067383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.922739028930664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 754, 256])
m.shape torch.Size([522, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9236187934875488  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9236187934875488  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.924614429473877  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.949779987335205  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([421, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9509010314941406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9509010314941406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9517040252685547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.97552490234375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([375, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9772777557373047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9772777557373047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9779930114746094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0040664672851562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([279, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0053181648254395  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0053181648254395  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.005850315093994  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0300488471984863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([220, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0312633514404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0312633514404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0316829681396484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.052663803100586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([175, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.053799629211426  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.053799629211426  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.054133415222168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0731592178344727  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([144, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0742383003234863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0742383003234863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0745129585266113  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0920910835266113  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.093289852142334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.093289852142334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.093554973602295  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1123785972595215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([109, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.113567352294922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.113567352294922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1137752532958984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1299915313720703  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1311564445495605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1311564445495605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.13136625289917  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.149199962615967  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.150282382965088  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.150282382965088  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.150463581085205  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1671338081359863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.167985439300537  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.167985439300537  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.168118953704834  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1813368797302246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1828694343566895  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1828694343566895  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1830315589904785  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.200216770172119  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2011046409606934  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2011046409606934  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2012248039245605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2148032188415527  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.215846538543701  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.215846538543701  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.215972423553467  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.231078624725342  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.23214054107666  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.23214054107666  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.232264518737793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.24800968170166  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2488975524902344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2488975524902344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2489967346191406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.262287139892578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2633066177368164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2633066177368164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.263411521911621  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.278203010559082  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.278937816619873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.278937816619873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2790122032165527  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2900214195251465  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.290766716003418  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.290766716003418  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.290837287902832  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3017759323120117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3025145530700684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3025145530700684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.302581310272217  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3133959770202637  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3141703605651855  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3141703605651855  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.314237117767334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.32551908493042  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([731, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.343050479888916  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.343050479888916  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.344444751739502  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5902838706970215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 731, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.549213409423828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5500359535217285  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.550858497619629  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.549994468688965  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5517, 40])
input nodes number: 28879
output nodes number: 5517
edges number: 47724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5502514839172363  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5502519607543945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes
[05:37:32] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23407770 edges into 16 parts and get 6100910 edge cuts

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05082416534423828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05082416534423828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05082416534423828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011069729924201965 |0.0023445487022399902 |0.1157645732164383 |8.755922317504883e-05 |0.07499122619628906 |0.004707813262939453 |
----------------------------------------------------------pseudo_mini_loss sum 4.756931781768799
Total (block generation + training)time/epoch 24.817384719848633
Training time/epoch 3.361722707748413
Training time without block to device /epoch 3.3242099285125732
Training time without total dataloading part /epoch 3.058201551437378
load block tensor time/epoch 0.17711567878723145
block to device time/epoch 0.037512779235839844
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  935034
Number of first layer input nodes during this epoch:  638921
Number of first layer output nodes during this epoch:  296113
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05082368850708008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028490304946899414
global_2_local spend time (sec) 0.05131864547729492
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004590272903442383
A = g.adjacency_matrix() spent  0.011484622955322266
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0826878547668457
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.283381700515747
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.162154197692871

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770})
Convert a graph into a bidirected graph: 0.956 seconds
Metis partitioning: 4.894 seconds
Split the graph: 0.692 seconds
Construct subgraphs: 0.057 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.60959267616272
5693
5812
5562
5802
5802
5786
5741
5774
5783
5517
5575
5517
5689
5591
5710
5587
total k batches seeds list generation spend  17.127559900283813
after graph partition
graph partition algorithm spend time 17.223360061645508
5693
5812
5562
5802
5802
5786
5741
5774
5783
5517
5575
5517
5689
5591
5710
5587
partition_len_list
[12722, 11229, 14737, 13024, 14484, 12125, 11030, 11514, 29834, 27815, 32100, 29526, 13836, 16767, 17732, 25756]
shared_neighbor_graph_partition_s0 selection method  spend 17.3332679271698
time for parepare:  0.018160581588745117
local_output_nid generation:  0.0013740062713623047
local_in_edges_tensor generation:  0.0029358863830566406
mini_batch_src_global generation:  0.0019702911376953125
r_  generation:  0.017499208450317383
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0019221305847167969
mini_batch_src_global generation:  0.0020990371704101562
r_  generation:  0.0180966854095459
local_output_nid generation:  0.001683950424194336
local_in_edges_tensor generation:  0.0013723373413085938
mini_batch_src_global generation:  0.002680063247680664
r_  generation:  0.013707160949707031
local_output_nid generation:  0.001773834228515625
local_in_edges_tensor generation:  0.0014791488647460938
mini_batch_src_global generation:  0.0016016960144042969
r_  generation:  0.017022132873535156
local_output_nid generation:  0.0018265247344970703
local_in_edges_tensor generation:  0.001470327377319336
mini_batch_src_global generation:  0.0014941692352294922
r_  generation:  0.016208171844482422
local_output_nid generation:  0.001844644546508789
local_in_edges_tensor generation:  0.0013337135314941406
mini_batch_src_global generation:  0.0013153553009033203
r_  generation:  0.01397395133972168
local_output_nid generation:  0.0017893314361572266
local_in_edges_tensor generation:  0.0013120174407958984
mini_batch_src_global generation:  0.0012254714965820312
r_  generation:  0.010142803192138672
local_output_nid generation:  0.004355192184448242
local_in_edges_tensor generation:  0.0014052391052246094
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.014746904373168945
local_output_nid generation:  0.0017819404602050781
local_in_edges_tensor generation:  0.0015561580657958984
mini_batch_src_global generation:  0.0022308826446533203
r_  generation:  0.02450704574584961
local_output_nid generation:  0.001969575881958008
local_in_edges_tensor generation:  0.0015683174133300781
mini_batch_src_global generation:  0.0021381378173828125
r_  generation:  0.0202181339263916
local_output_nid generation:  0.001985788345336914
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.00197601318359375
r_  generation:  0.02535390853881836
local_output_nid generation:  0.0020036697387695312
local_in_edges_tensor generation:  0.0026226043701171875
mini_batch_src_global generation:  0.0016598701477050781
r_  generation:  0.018301010131835938
local_output_nid generation:  0.0020661354064941406
local_in_edges_tensor generation:  0.0015044212341308594
mini_batch_src_global generation:  0.0012478828430175781
r_  generation:  0.013202667236328125
local_output_nid generation:  0.001940011978149414
local_in_edges_tensor generation:  0.0014028549194335938
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.01349949836730957
local_output_nid generation:  0.001960277557373047
local_in_edges_tensor generation:  0.0013551712036132812
mini_batch_src_global generation:  0.0012688636779785156
r_  generation:  0.01512289047241211
local_output_nid generation:  0.0019752979278564453
local_in_edges_tensor generation:  0.001386880874633789
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.0178987979888916
----------------------check_connections_block total spend ----------------------------- 0.44237494468688965
generate_one_block  0.028237342834472656
generate_one_block  0.022584915161132812
generate_one_block  0.019632339477539062
generate_one_block  0.022856712341308594
generate_one_block  0.022545337677001953
generate_one_block  0.018290042877197266
generate_one_block  0.014879226684570312
generate_one_block  0.01710963249206543
generate_one_block  0.0388493537902832
generate_one_block  0.028846025466918945
generate_one_block  0.030939579010009766
generate_one_block  0.025901079177856445
generate_one_block  0.017091751098632812
generate_one_block  0.018948078155517578
generate_one_block  0.020839929580688477
generate_one_block  0.024900436401367188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037421226501464844
gen group dst list time:  0.008826494216918945
time for parepare:  0.019408226013183594
local_output_nid generation:  0.0028181076049804688
local_in_edges_tensor generation:  0.014529228210449219
mini_batch_src_global generation:  0.0029058456420898438
r_  generation:  0.028757810592651367
local_output_nid generation:  0.0034101009368896484
local_in_edges_tensor generation:  0.0032601356506347656
mini_batch_src_global generation:  0.002826213836669922
r_  generation:  0.025880813598632812
local_output_nid generation:  0.0042765140533447266
local_in_edges_tensor generation:  0.003620147705078125
mini_batch_src_global generation:  0.0029616355895996094
r_  generation:  0.033383846282958984
local_output_nid generation:  0.0038487911224365234
local_in_edges_tensor generation:  0.003012418746948242
mini_batch_src_global generation:  0.002811431884765625
r_  generation:  0.05035829544067383
local_output_nid generation:  0.005986213684082031
local_in_edges_tensor generation:  0.004179954528808594
mini_batch_src_global generation:  0.0047800540924072266
r_  generation:  0.03501629829406738
local_output_nid generation:  0.003613710403442383
local_in_edges_tensor generation:  0.0028138160705566406
mini_batch_src_global generation:  0.0025305747985839844
r_  generation:  0.02697157859802246
local_output_nid generation:  0.003300905227661133
local_in_edges_tensor generation:  0.00241851806640625
mini_batch_src_global generation:  0.0037839412689208984
r_  generation:  0.02152276039123535
local_output_nid generation:  0.0034008026123046875
local_in_edges_tensor generation:  0.002607107162475586
mini_batch_src_global generation:  0.001964092254638672
r_  generation:  0.024417877197265625
local_output_nid generation:  0.007571697235107422
local_in_edges_tensor generation:  0.007766008377075195
mini_batch_src_global generation:  0.00878453254699707
r_  generation:  0.09421706199645996
local_output_nid generation:  0.012939214706420898
local_in_edges_tensor generation:  0.00948333740234375
mini_batch_src_global generation:  0.00966501235961914
r_  generation:  0.08197641372680664
local_output_nid generation:  0.008698225021362305
local_in_edges_tensor generation:  0.010556697845458984
mini_batch_src_global generation:  0.013227224349975586
r_  generation:  0.09550595283508301
local_output_nid generation:  0.008589982986450195
local_in_edges_tensor generation:  0.008328437805175781
mini_batch_src_global generation:  0.009773492813110352
r_  generation:  0.08620262145996094
local_output_nid generation:  0.0044553279876708984
local_in_edges_tensor generation:  0.005839109420776367
mini_batch_src_global generation:  0.004656076431274414
r_  generation:  0.03247237205505371
local_output_nid generation:  0.005126476287841797
local_in_edges_tensor generation:  0.005029439926147461
mini_batch_src_global generation:  0.003917694091796875
r_  generation:  0.04054403305053711
local_output_nid generation:  0.005070924758911133
local_in_edges_tensor generation:  0.0049359798431396484
mini_batch_src_global generation:  0.0056154727935791016
r_  generation:  0.04425048828125
local_output_nid generation:  0.007188081741333008
local_in_edges_tensor generation:  0.007213592529296875
mini_batch_src_global generation:  0.007179975509643555
r_  generation:  0.07320237159729004
----------------------check_connections_block total spend ----------------------------- 1.2846009731292725
generate_one_block  0.06511139869689941
generate_one_block  0.03537797927856445
generate_one_block  0.0655679702758789
generate_one_block  0.04122161865234375
generate_one_block  0.04655027389526367
generate_one_block  0.03309297561645508
generate_one_block  0.027229785919189453
generate_one_block  0.03090977668762207
generate_one_block  0.11771249771118164
generate_one_block  0.11329269409179688
generate_one_block  0.14989161491394043
generate_one_block  0.11436629295349121
generate_one_block  0.03943634033203125
generate_one_block  0.057914018630981445
generate_one_block  0.05747509002685547
generate_one_block  0.09557080268859863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05082368850708008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

connection checking time:  1.2846009731292725
block generation total time  1.0907211303710938
average batch blocks generation time:  0.06817007064819336
block dataloader generation time/epoch 21.09633493423462
pseudo mini batch 0 input nodes size: 27506
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.045124053955078125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.045124053955078125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.058795928955078125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0588383674621582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.025640010833740234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([27506, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1103, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06803512573242188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06803512573242188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06908702850341797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07750225067138672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1209, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07812929153442383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07812929153442383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1209, 128]), torch.Size([1, 1209, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07928228378295898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09657716751098633  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1209, 128])
m.shape torch.Size([1094, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0975656509399414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0975656509399414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09860897064208984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12156200408935547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([930, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12281417846679688  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12281417846679688  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12370109558105469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14942169189453125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([811, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15091180801391602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15091180801391602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15168523788452148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17952871322631836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([804, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1814422607421875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1814422607421875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.18220901489257812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2154216766357422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([644, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.21718788146972656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.21718788146972656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2178020477294922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24911975860595703  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([585, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.25104427337646484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.25104427337646484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2516021728515625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.28467321395874023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([552, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.28676319122314453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.28676319122314453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2872896194458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.32131385803222656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([4990, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3448448181152344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3448448181152344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 4990, 128]), torch.Size([1, 4990, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.34960365295410156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6954154968261719  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 4990, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6590614318847656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6711940765380859  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6833267211914062  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6710991859436035  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([12722, 256])
first layer input nodes number: 27506
first layer output nodes number: 12722
edges number: 83458
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6835336685180664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6956663131713867  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6986994743347168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6986994743347168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([775, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7441072463989258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7441072463989258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 775, 256]), torch.Size([1, 775, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7455854415893555  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7574877738952637  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 775, 256])
m.shape torch.Size([724, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7582454681396484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7582454681396484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 724, 256]), torch.Size([1, 724, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7596263885498047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.780364990234375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 724, 256])
m.shape torch.Size([573, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7815518379211426  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7815518379211426  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7826447486877441  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8071894645690918  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([465, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8085322380065918  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8085322380065918  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8094191551208496  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8359236717224121  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([354, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.837181568145752  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.837181568145752  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8378567695617676  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8633179664611816  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([357, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8650393486022949  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8650393486022949  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.865720272064209  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8949999809265137  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([251, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8963484764099121  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8963484764099121  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.896827220916748  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9207644462585449  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9222016334533691  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9222016334533691  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9226174354553223  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9463181495666504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([218, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9479961395263672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9479961395263672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9484119415283203  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9750232696533203  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9762668609619141  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9762668609619141  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9765548706054688  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9970035552978516  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([168, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9986357688903809  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9986357688903809  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9989562034606934  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0239500999450684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([156, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0255894660949707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0255894660949707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0258870124816895  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0511784553527832  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0525665283203125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0525665283203125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0528011322021484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0743846893310547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0756101608276367  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0756101608276367  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0757989883422852  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0944929122924805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0957393646240234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0957393646240234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.095916748046875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1147193908691406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.115614891052246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.115614891052246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.115736961364746  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.129530906677246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1306629180908203  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1306629180908203  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1308021545410156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1475105285644531  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([77, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.148773193359375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.148773193359375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1489200592041016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.167572021484375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1686534881591797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1686534881591797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1687679290771484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.184103012084961  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1847572326660156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1847572326660156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1848278045654297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1947784423828125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1960148811340332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1960148811340332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1961350440979004  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2139191627502441  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2148590087890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2148590087890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2149486541748047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2288436889648438  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.229771614074707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.229771614074707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2298555374145508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2434511184692383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2441473007202148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2441473007202148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2442083358764648  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2545232772827148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([471, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2658100128173828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2658100128173828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2667083740234375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4248199462890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 471, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3855891227722168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3864378929138184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.38728666305542  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3863954544067383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5693, 40])
input nodes number: 12722
output nodes number: 5693
edges number: 46230
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.386559009552002  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3865599632263184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.028502464294433594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 1 input nodes size: 21222
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.025667190551757812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.025667190551757812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03578662872314453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.035830020904541016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022115707397460938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023034095764160156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023034095764160156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023034095764160156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([21222, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023034095764160156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([790, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.060083866119384766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.060083866119384766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0608372688293457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06722593307495117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([988, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06779146194458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06779146194458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06873369216918945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08302831649780273  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([970, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08394479751586914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08394479751586914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0848698616027832  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1059422492980957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([884, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.10716581344604492  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.10716581344604492  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.10800886154174805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1324763298034668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([793, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.13394546508789062  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.13394546508789062  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.13470172882080078  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1619272232055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([721, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1644425392150879  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1644425392150879  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1651301383972168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19507408142089844  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([645, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1968832015991211  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1968832015991211  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19749832153320312  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.22920465469360352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([553, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23100662231445312  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23100662231445312  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23153400421142578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2628650665283203  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([450, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.26453256607055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.26453256607055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.26496171951293945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.29242753982543945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([4435, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.31336069107055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.31336069107055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 4435, 128]), torch.Size([1, 4435, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.31759023666381836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6248641014099121  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 4435, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5917000770568848  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6024088859558105  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6131176948547363  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6023249626159668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([11229, 256])
first layer input nodes number: 21222
first layer output nodes number: 11229
edges number: 74842
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6132779121398926  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6239867210388184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6274547576904297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6274547576904297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([587, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6754918098449707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6754918098449707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6766114234924316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6858177185058594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([596, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.687014102935791  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.687014102935791  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6881508827209473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.705202579498291  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7066493034362793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7066493034362793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7077498435974121  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.731961727142334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([496, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7333488464355469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7333488464355469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7342948913574219  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7625226974487305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([443, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7641787528991699  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7641787528991699  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7650237083435059  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7957596778869629  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([391, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7975921630859375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7975921630859375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7983379364013672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8305473327636719  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([339, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8324556350708008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8324556350708008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8331022262573242  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8656902313232422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([267, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8674201965332031  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8674201965332031  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8679294586181641  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8980765342712402  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([226, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9000535011291504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9000535011291504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.900484561920166  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.928072452545166  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([233, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9300966262817383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9300966262817383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9305410385131836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9620943069458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([195, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9639339447021484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9639339447021484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9643058776855469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.993316650390625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([145, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9948034286499023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9948034286499023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9950799942016602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0185880661010742  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([147, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0202865600585938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0202865600585938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0205669403076172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0463619232177734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([133, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0480117797851562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0480117797851562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0482654571533203  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0733795166015625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.074507236480713  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.074507236480713  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0746731758117676  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0922627449035645  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([99, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0937023162841797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0937023162841797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0938911437988281  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1152286529541016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1165885925292969  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1165885925292969  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1167583465576172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1371288299560547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([75, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1383419036865234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1383419036865234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1384849548339844  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1566524505615234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.157585620880127  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.157585620880127  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1576905250549316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1717476844787598  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([81, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1732525825500488  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1732525825500488  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1734070777893066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1951909065246582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([57, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1962642669677734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1962642669677734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1963729858398438  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.21246337890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2132763862609863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2132763862609863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2133545875549316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.225475788116455  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.226254940032959  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.226254940032959  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.226325511932373  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2377581596374512  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2386689186096191  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2386689186096191  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2387471199035645  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2519631385803223  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([375, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.260934829711914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.260934829711914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2616500854492188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3931884765625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 375, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.351412296295166  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.352278709411621  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3531451225280762  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3522353172302246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5812, 40])
input nodes number: 11229
output nodes number: 5812
edges number: 48312
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3523802757263184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3523807525634766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02480602264404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 2 input nodes size: 29367
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022133350372314453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022133350372314453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.036136627197265625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0361781120300293  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.026015281677246094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.027014732360839844  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.027014732360839844  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.027014732360839844  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([29367, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.027014732360839844  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1447, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0737614631652832  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0737614631652832  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1447, 128]), torch.Size([1, 1447, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07514142990112305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08618927001953125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1447, 128])
m.shape torch.Size([1439, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08757543563842773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08757543563842773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1439, 128]), torch.Size([1, 1439, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08894777297973633  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.10953283309936523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1439, 128])
m.shape torch.Size([1313, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11152458190917969  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11152458190917969  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1313, 128]), torch.Size([1, 1313, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1127767562866211  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14075374603271484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1313, 128])
m.shape torch.Size([1207, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14242982864379883  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14242982864379883  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1207, 128]), torch.Size([1, 1207, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14358091354370117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17696237564086914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1207, 128])
m.shape torch.Size([999, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17876863479614258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17876863479614258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 999, 128]), torch.Size([1, 999, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17972135543823242  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2140192985534668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 999, 128])
m.shape torch.Size([844, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2159576416015625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2159576416015625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.21676254272460938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2522926330566406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([727, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2543168067932129  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2543168067932129  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.25501012802124023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.29030704498291016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([677, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2925429344177246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2925429344177246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.29318857192993164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3299899101257324  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([546, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.33201026916503906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.33201026916503906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3325309753417969  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3672671318054199  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([5538, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3934140205383301  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3934140205383301  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 5538, 128]), torch.Size([1, 5538, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3986954689025879  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7737574577331543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 5538, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.733062744140625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7471170425415039  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7611713409423828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.747006893157959  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([14737, 256])
first layer input nodes number: 29367
first layer output nodes number: 14737
edges number: 93950
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7613921165466309  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7754464149475098  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7791333198547363  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7791333198547363  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([971, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8196573257446289  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8196573257446289  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 971, 256]), torch.Size([1, 971, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8215093612670898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8363256454467773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 971, 256])
m.shape torch.Size([780, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8371844291687012  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8371844291687012  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 780, 256]), torch.Size([1, 780, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8386721611022949  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8610720634460449  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 780, 256])
m.shape torch.Size([630, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8622837066650391  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8622837066650391  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8634853363037109  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8899211883544922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([473, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8912758827209473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8912758827209473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8921780586242676  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9186291694641113  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([396, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9200811386108398  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9200811386108398  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9208364486694336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9499330520629883  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([297, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.951268196105957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.951268196105957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9518346786499023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9773244857788086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([213, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9784746170043945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9784746170043945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9788808822631836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9991941452026367  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0005826950073242  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0005826950073242  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0009775161743164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.023482322692871  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0247125625610352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0247125625610352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0250272750854492  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0451688766479492  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.046520709991455  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.046520709991455  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0468201637268066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0680813789367676  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.069295883178711  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.069295883178711  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0695419311523438  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0887336730957031  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0903215408325195  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0903215408325195  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0905389785766602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1090211868286133  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1099390983581543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1099390983581543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1100897789001465  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1239523887634277  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.124922752380371  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.124922752380371  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1250638961791992  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1390371322631836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1400213241577148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1400213241577148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1401605606079102  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1549196243286133  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1557574272155762  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1557574272155762  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.155869960784912  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.168586254119873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1696085929870605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1696085929870605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1697344779968262  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1848406791687012  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1856775283813477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1856775283813477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.185776710510254  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1983728408813477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1992363929748535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1992363929748535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1993317604064941  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.212110996246338  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.21290922164917  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.21290922164917  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2129931449890137  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2248263359069824  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.225471019744873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.225471019744873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2255358695983887  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2351336479187012  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2357144355773926  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2357144355773926  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2357697486877441  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2443432807922363  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2449350357055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2449350357055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2449884414672852  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2536401748657227  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2542595863342285  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2542595863342285  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2543129920959473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.263338565826416  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([414, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2732596397399902  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2732596397399902  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2740492820739746  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4143729209899902  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 414, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3800954818725586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3809247016906738  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.381753921508789  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3808832168579102  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5562, 40])
input nodes number: 14737
output nodes number: 5562
edges number: 40072
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.380997657775879  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.380998134613037  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.028888702392578125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 3 input nodes size: 22510
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02597808837890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02597808837890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.036711692810058594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03675508499145508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022710323333740234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023746013641357422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023746013641357422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023746013641357422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([22510, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023746013641357422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([991, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06721782684326172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06721782684326172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06816291809082031  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07572364807128906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([1094, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07629919052124023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07629919052124023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07734251022338867  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09299230575561523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1081, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09401702880859375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09401702880859375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0950479507446289  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11772823333740234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([942, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11900949478149414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11900949478149414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11990785598754883  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14596033096313477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([929, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14772605895996094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14772605895996094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14861202239990234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.18050670623779297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([767, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.18225812911987305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.18225812911987305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.18298959732055664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.21544265747070312  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([703, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2174234390258789  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2174234390258789  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2180938720703125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2525143623352051  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([611, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.25450992584228516  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.25450992584228516  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2550926208496094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2897515296936035  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([532, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.29174327850341797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.29174327850341797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2922506332397461  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3253822326660156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([5374, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3507537841796875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3507537841796875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 5374, 128]), torch.Size([1, 5374, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3558788299560547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7203817367553711  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 5374, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6819276809692383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6943483352661133  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7067689895629883  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6942510604858398  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([13024, 256])
first layer input nodes number: 22510
first layer output nodes number: 13024
edges number: 87774
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7069387435913086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7193593978881836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7224645614624023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7224645614624023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([697, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7725777626037598  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7725777626037598  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7739071846008301  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7863211631774902  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 697, 256])
m.shape torch.Size([628, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7868809700012207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7868809700012207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.788078784942627  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8060460090637207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([552, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8070530891418457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8070530891418457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8081059455871582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8327679634094238  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([442, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8339409828186035  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8339409828186035  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8347840309143066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8609452247619629  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([391, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8624029159545898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8624029159545898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8631486892700195  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.890838623046875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8923172950744629  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8923172950744629  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8929295539855957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9202895164489746  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([290, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9219346046447754  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9219346046447754  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.922487735748291  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9512410163879395  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([254, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9529175758361816  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9529175758361816  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.953402042388916  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9810166358947754  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([222, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9826951026916504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9826951026916504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9831185340881348  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0102181434631348  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([199, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0121407508850098  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0121407508850098  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0125203132629395  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0394692420959473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([167, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0410451889038086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0410451889038086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0413637161254883  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.066208839416504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([141, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.067676067352295  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.067676067352295  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0679450035095215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0908045768737793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0922694206237793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0922694206237793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0925135612487793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1149744987487793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([124, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1165213584899902  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1165213584899902  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.116757869720459  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1401724815368652  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1416258811950684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1416258811950684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.141833782196045  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1638712882995605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.165013313293457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.165013313293457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1651678085327148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1826257705688477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.184068202972412  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.184068202972412  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1842455863952637  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2055315971374512  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2066540718078613  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2066540718078613  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2067875862121582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2237439155578613  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2247991561889648  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2247991561889648  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2249040603637695  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2389612197875977  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([72, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.240293025970459  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.240293025970459  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2404303550720215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.259793758392334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2609968185424805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2609968185424805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2611169815063477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2789011001586914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2795815467834473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2795815467834473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2796483039855957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2899956703186035  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.290891170501709  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.290891170501709  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.290971279144287  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3039488792419434  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3048315048217773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3048315048217773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3049077987670898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3178014755249023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([586, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3318438529968262  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3318438529968262  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3329615592956543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5321803092956543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 586, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.48820161819458  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4890666007995605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.489931583404541  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.489023208618164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5802, 40])
input nodes number: 13024
output nodes number: 5802
edges number: 51163
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4891996383666992  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.4892001152038574  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.025723934173583984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 4 input nodes size: 32707
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02274608612060547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02274608612060547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03834199905395508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03838539123535156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.027608394622802734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.028701305389404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.028701305389404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.028701305389404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([32707, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.028701305389404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1107, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07761669158935547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07761669158935547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07867240905761719  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08711814880371094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1198, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08831310272216797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08831310272216797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08945560455322266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1069021224975586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1143, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1081547737121582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1081547737121582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.10924482345581055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1336073875427246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1005, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.135833740234375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.135833740234375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.13679218292236328  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1648406982421875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([966, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16666460037231445  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16666460037231445  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 966, 128]), torch.Size([1, 966, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1675858497619629  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20102453231811523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 966, 128])
m.shape torch.Size([829, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20293569564819336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20293569564819336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.20372629165649414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23772192001342773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([757, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2398533821105957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2398533821105957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24057531356811523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.277432918548584  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([722, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.27982616424560547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.27982616424560547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2805147171020508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.32001399993896484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([614, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.32230472564697266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.32230472564697266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3228902816772461  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3617539405822754  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([6143, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.39075326919555664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.39075326919555664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 6143, 128]), torch.Size([1, 6143, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.39661169052124023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8125596046447754  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 6143, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7709722518920898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.784785270690918  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7985982894897461  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7846770286560059  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([14484, 256])
first layer input nodes number: 32707
first layer output nodes number: 14484
edges number: 98787
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7988443374633789  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.812657356262207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8161106109619141  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8161106109619141  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([771, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8630738258361816  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8630738258361816  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 771, 256]), torch.Size([1, 771, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8645443916320801  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8763089179992676  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 771, 256])
m.shape torch.Size([705, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8769564628601074  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8769564628601074  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 705, 256]), torch.Size([1, 705, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8783011436462402  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8986468315124512  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 705, 256])
m.shape torch.Size([554, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8999428749084473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8999428749084473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9009995460510254  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9256892204284668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([498, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9271321296691895  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9271321296691895  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9280819892883301  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9560236930847168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9574041366577148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9574041366577148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9581403732299805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9862527847290039  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9876551628112793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9876551628112793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9882407188415527  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0155386924743652  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([283, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0171499252319336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0171499252319336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0176897048950195  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0454702377319336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([244, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.04707670211792  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.04707670211792  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0475420951843262  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0740694999694824  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([226, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.076566219329834  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.076566219329834  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0769972801208496  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1045851707458496  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([196, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1062536239624023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1062536239624023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1066274642944336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1331701278686523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1345481872558594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1345481872558594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1348304748535156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1568489074707031  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1583919525146484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1583919525146484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.158670425415039  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1823406219482422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1838006973266602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1838006973266602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1840448379516602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2065057754516602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2079715728759766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2079715728759766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2081966400146484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.230478286743164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.231764316558838  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.231764316558838  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2319493293762207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2515606880187988  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2526216506958008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2526216506958008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2527647018432617  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2689294815063477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.270197868347168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.270197868347168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2703542709350586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2891225814819336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2899270057678223  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2899270057678223  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2900242805480957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3023781776428223  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3033204078674316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3033204078674316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3034234046936035  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3172249794006348  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.31831693649292  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.31831693649292  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3184237480163574  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.333484172821045  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3344402313232422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3344402313232422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3345355987548828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3486499786376953  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3495330810546875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3495330810546875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3496170043945312  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3626251220703125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3632245063781738  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3632245063781738  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3632798194885254  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3722405433654785  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3729510307312012  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3729510307312012  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3730120658874512  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3833270072937012  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([522, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3958392143249512  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3958392143249512  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.3968348503112793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5720667839050293  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 522, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5313458442687988  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5322108268737793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5330758094787598  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5321674346923828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5802, 40])
input nodes number: 14484
output nodes number: 5802
edges number: 47846
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5323190689086914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.5323195457458496  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.030785560607910156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 5 input nodes size: 22828
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.027608394622802734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.027608394622802734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03849363327026367  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.038537025451660156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022897720336914062  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023710250854492188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023710250854492188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023710250854492188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([22828, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.023710250854492188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1321, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05884838104248047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05884838104248047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1321, 128]), torch.Size([1, 1321, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.060108184814453125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0709524154663086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1321, 128])
m.shape torch.Size([1460, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07171487808227539  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07171487808227539  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.07310724258422852  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09399271011352539  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([1284, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09513330459594727  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09513330459594727  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1284, 128]), torch.Size([1, 1284, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09635782241821289  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12329721450805664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1284, 128])
m.shape torch.Size([1132, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12484407424926758  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12484407424926758  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12592363357543945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15723085403442383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([946, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15894651412963867  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15894651412963867  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 946, 128]), torch.Size([1, 946, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15984869003295898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19268465042114258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 946, 128])
m.shape torch.Size([785, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19447946548461914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19447946548461914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19522809982299805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2276005744934082  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([659, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2302875518798828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2302875518798828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.23091602325439453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.26352787017822266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([621, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2655825614929199  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2655825614929199  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2661747932434082  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3002943992614746  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([506, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3021697998046875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3021697998046875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.30265235900878906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.33353614807128906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([3411, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3495597839355469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3495597839355469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 3411, 128]), torch.Size([1, 3411, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3531479835510254  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5842700004577637  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 3411, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5553922653198242  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.56695556640625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5785188674926758  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5668649673461914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([12125, 256])
first layer input nodes number: 22828
first layer output nodes number: 12125
edges number: 70306
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5786910057067871  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5902543067932129  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5931453704833984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5931453704833984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([898, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6313772201538086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6313772201538086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6330900192260742  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6467924118041992  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([836, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6475887298583984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6475887298583984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6491832733154297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6731014251708984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([665, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6745386123657227  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6745386123657227  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 665, 256]), torch.Size([1, 665, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.675806999206543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7040653228759766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 665, 256])
m.shape torch.Size([516, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7054152488708496  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7054152488708496  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7063994407653809  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7356200218200684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([448, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7372808456420898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7372808456420898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7381353378295898  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7700872421264648  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7716035842895508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7716035842895508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7722463607788086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8010292053222656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([279, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8025851249694824  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8025851249694824  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8031172752380371  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8299307823181152  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([281, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8318257331848145  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8318257331848145  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8323616981506348  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8631863594055176  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8646917343139648  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8646917343139648  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8650827407836914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8901071548461914  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8915648460388184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8915648460388184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8918929100036621  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9151854515075684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9172296524047852  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9172296524047852  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9175043106079102  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9389276504516602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9401860237121582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9401860237121582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9404168128967285  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9600338935852051  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9611682891845703  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9611682891845703  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9613590240478516  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9789066314697266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9798746109008789  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9798746109008789  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9800252914428711  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9949426651000977  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9960784912109375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9960784912109375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9962387084960938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0132217407226562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0142335891723633  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0142335891723633  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.014369010925293  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0296716690063477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0305519104003906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0305519104003906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0306625366210938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0439376831054688  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.044851303100586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.044851303100586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0449581146240234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.058523178100586  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.059237003326416  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.059237003326416  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0593171119689941  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.070051670074463  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.070838451385498  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.070838451385498  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.070920467376709  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0824847221374512  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0831303596496582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0831303596496582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0831952095031738  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0927929878234863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0933527946472168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0933527946472168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0934062004089355  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1016840934753418  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1021881103515625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1021881103515625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.10223388671875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.109649658203125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1101112365722656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1101112365722656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1101512908935547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1169204711914062  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([244, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1227636337280273  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1227636337280273  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1232290267944336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2051382064819336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 244, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1734519004821777  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1743144989013672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1751770973205566  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1742711067199707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5786, 40])
input nodes number: 12125
output nodes number: 5786
edges number: 38633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1744027137756348  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.174403190612793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02531576156616211  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 6 input nodes size: 22192
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022895336151123047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022895336151123047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0334773063659668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03352022171020508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022591590881347656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02323150634765625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02323150634765625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02323150634765625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([22192, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02323150634765625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1650, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05167818069458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05167818069458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1650, 128]), torch.Size([1, 1650, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05325174331665039  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06584024429321289  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1650, 128])
m.shape torch.Size([1676, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06665182113647461  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06665182113647461  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1676, 128]), torch.Size([1, 1676, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06825017929077148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09311056137084961  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1676, 128])
m.shape torch.Size([1368, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0942683219909668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.0942683219909668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1368, 128]), torch.Size([1, 1368, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.09557294845581055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12490034103393555  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1368, 128])
m.shape torch.Size([1034, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12630796432495117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12630796432495117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.12729406356811523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15639829635620117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([863, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15796279907226562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15796279907226562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15878582000732422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1884145736694336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([684, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.18996000289916992  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.18996000289916992  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1906123161315918  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.21939611434936523  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([560, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.22093915939331055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.22093915939331055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.22147321701049805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2490687370300293  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([456, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.25054121017456055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.25054121017456055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2509760856628418  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.27576398849487305  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([371, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.27713871002197266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.27713871002197266  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2774925231933594  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3001365661621094  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([2368, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.311251163482666  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.311251163482666  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 2368, 128]), torch.Size([1, 2368, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.313509464263916  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4774141311645508  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 2368, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4552326202392578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.46575164794921875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4762706756591797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4656691551208496  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([11030, 256])
first layer input nodes number: 22192
first layer output nodes number: 11030
edges number: 56248
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.476438045501709  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4869570732116699  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.48958683013916016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.48958683013916016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1219, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5193514823913574  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5193514823913574  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1219, 256]), torch.Size([1, 1219, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5219812393188477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5405817031860352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1219, 256])
m.shape torch.Size([1026, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5414719581604004  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5414719581604004  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1026, 256]), torch.Size([1, 1026, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5435962677001953  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.574030876159668  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1026, 256])
m.shape torch.Size([763, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5760049819946289  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5760049819946289  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5774602890014648  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.609562873840332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([543, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6109228134155273  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6109228134155273  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6119585037231445  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6428823471069336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([430, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6444311141967773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6444311141967773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6452512741088867  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6754579544067383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([316, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6768703460693359  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6768703460693359  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6774730682373047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7033901214599609  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([252, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7047843933105469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7047843933105469  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7052650451660156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7292976379394531  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([202, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7306108474731445  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7306108474731445  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7309961318969727  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7529573440551758  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7541403770446777  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7541403770446777  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7544436454772949  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7738528251647949  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.775395393371582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.775395393371582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7756643295288086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7947587966918945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7955021858215332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7955021858215332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7956604957580566  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8080086708068848  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([91, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8090214729309082  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8090214729309082  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8091950416564941  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8239483833312988  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8247737884521484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8247737884521484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8249130249023438  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8377227783203125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8385682106018066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8385682106018066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8386979103088379  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8515381813049316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8522377014160156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8522377014160156  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8523387908935547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8630542755126953  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8636035919189453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8636035919189453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.863677978515625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8720836639404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8726348876953125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8726348876953125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8727035522460938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8809432983398438  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8813934326171875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8813934326171875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8814468383789062  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8882293701171875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8886961936950684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8886961936950684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8887476921081543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8956484794616699  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8959879875183105  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8959879875183105  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.896024227142334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9011340141296387  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9014997482299805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9014997482299805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9015359878540039  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9068994522094727  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9071354866027832  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9071354866027832  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.907158374786377  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9107060432434082  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9110045433044434  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9110045433044434  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9110312461853027  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9153571128845215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9156670570373535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9156670570373535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9156937599182129  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9202065467834473  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([114, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9229326248168945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9229326248168945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9231500625610352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9614191055297852  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 114, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.938908576965332  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9397644996643066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9406204223632812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9397215843200684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5741, 40])
input nodes number: 11030
output nodes number: 5741
edges number: 29504
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9398403167724609  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9398407936096191  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.024562835693359375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 7 input nodes size: 20170
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022584915161132812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022584915161132812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.032202720642089844  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03224611282348633  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.021621227264404297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022432804107666016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022432804107666016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022432804107666016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([20170, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.022432804107666016  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([1198, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05650043487548828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05650043487548828  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.05764293670654297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06678295135498047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1263, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06798076629638672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06798076629638672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1263, 128]), torch.Size([1, 1263, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.06918525695800781  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08725261688232422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1263, 128])
m.shape torch.Size([1167, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08858966827392578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08858966827392578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.08970260620117188  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11432075500488281  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1088, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11583948135375977  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11583948135375977  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1088, 128]), torch.Size([1, 1088, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.11687707901000977  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.14843988418579102  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 1088, 128])
m.shape torch.Size([923, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15012168884277344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.15012168884277344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1510019302368164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1835474967956543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([767, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1853017807006836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1853017807006836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1860332489013672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2184906005859375  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([637, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.22025108337402344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.22025108337402344  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.22085857391357422  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2512331008911133  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([596, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2532029151916504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2532029151916504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2537713050842285  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.28693628311157227  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([502, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2888064384460449  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2888064384460449  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.28928518295288086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.31992483139038086  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([3373, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3357691764831543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3357691764831543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 3373, 128]), torch.Size([1, 3373, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3392167091369629  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5703749656677246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 3373, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5412535667419434  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5522341728210449  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5632147789001465  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5521483421325684  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([11514, 256])
first layer input nodes number: 20170
first layer output nodes number: 11514
edges number: 68269
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5633673667907715  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.574347972869873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5774083137512207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.5774083137512207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6178035736083984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6178035736083984  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6193828582763672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6320171356201172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([744, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6334724426269531  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6334724426269531  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6348915100097656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.65625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([631, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6578865051269531  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6578865051269531  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6590900421142578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6858425140380859  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([532, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.687286376953125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.687286376953125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6883010864257812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7186164855957031  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([433, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7201900482177734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7201900482177734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7210159301757812  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.751460075378418  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([357, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7531061172485352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7531061172485352  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7537870407104492  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7830667495727539  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([316, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7848525047302246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7848525047302246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.7854552268981934  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8165602684020996  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([275, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8183736801147461  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8183736801147461  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8188982009887695  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8503708839416504  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([222, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8520293235778809  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8520293235778809  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8524527549743652  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8795523643493652  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([196, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8812246322631836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8812246322631836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.8815984725952148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9081411361694336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([164, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9096884727478027  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9096884727478027  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.910001277923584  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9344000816345215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9358124732971191  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9358124732971191  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9360718727111816  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9581208229064941  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9594283103942871  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9594283103942871  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9596476554870605  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9798274040222168  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9808750152587891  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9808750152587891  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9810390472412109  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9972782135009766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9984941482543945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9984941482543945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.9986658096313477  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.016861915588379  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0179448127746582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0179448127746582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.018089771270752  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0344700813293457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0352964401245117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0352964401245117  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0354013442993164  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.047989845275879  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.048612117767334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.048612117767334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0486865043640137  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.058133602142334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0590643882751465  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0590643882751465  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0591654777526855  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.07271146774292  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0735068321228027  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0735068321228027  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0735907554626465  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0854239463806152  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0859270095825195  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0859270095825195  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0859785079956055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0936002731323242  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0943570137023926  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0943570137023926  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0944275856018066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1053662300109863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1059722900390625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1059722900390625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.106027603149414  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1149883270263672  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1154451370239258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1154451370239258  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1154851913452148  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1222543716430664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.128674030303955  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.128674030303955  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1291851997375488  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.2205939292907715  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1866564750671387  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1875171661376953  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.188377857208252  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.1874737739562988  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([5774, 40])
input nodes number: 11514
output nodes number: 5774
edges number: 40491
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.187607765197754  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.187608242034912  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.02402496337890625  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

pseudo mini batch 8 input nodes size: 56370
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.021625995635986328  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.021625995635986328  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.048505306243896484  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04854869842529297  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.03888750076293945  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04135847091674805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04135847091674805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04135847091674805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([56370, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.04135847091674805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([942, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16696405410766602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.16696405410766602  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1678624153137207  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1750493049621582  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([934, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1754908561706543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1754908561706543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 934, 128]), torch.Size([1, 934, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.17638158798217773  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.1897425651550293  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 934, 128])
m.shape torch.Size([949, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19068431854248047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19068431854248047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.19158935546875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2115001678466797  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([969, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.21289587020874023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.21289587020874023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2138199806213379  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24216413497924805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([922, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24390029907226562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.24390029907226562  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2447795867919922  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2772665023803711  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([944, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2795276641845703  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2795276641845703  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.2804279327392578  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.31991004943847656  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([925, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.32254743576049805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.32254743576049805  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.32342958450317383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.3679361343383789  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([883, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.37114763259887695  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.37114763259887695  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.37198972702026367  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.41998910903930664  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([883, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4233574867248535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.4233574867248535  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.42419958114624023  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.47867774963378906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([21483, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.580695629119873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.580695629119873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 21483, 128]), torch.Size([1, 21483, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 0.6011834144592285  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.055816173553467  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 21483, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9371070861816406  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9655590057373047  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9940109252929688  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9653363227844238  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

torch.Size([29834, 256])
first layer input nodes number: 56370
first layer output nodes number: 29834
edges number: 256123
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.9944329261779785  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0228848457336426  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0307374000549316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.0307374000549316  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

m.shape torch.Size([565, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.104057788848877  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.104057788848877  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.105135440826416  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.114631175994873  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([448, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1149535179138184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1149535179138184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1158080101013184  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1303305625915527  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([364, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1312246322631836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1312246322631836  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1319189071655273  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1521358489990234  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([289, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1531105041503906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1531105041503906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1536617279052734  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1709394454956055  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([242, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1718268394470215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1718268394470215  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.172288417816162  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1889052391052246  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([226, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.190117359161377  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.190117359161377  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.1905484199523926  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2090840339660645  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([187, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2101268768310547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2101268768310547  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2104835510253906  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2283172607421875  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([168, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.229430675506592  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.229430675506592  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2297511100769043  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.248015880584717  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2492313385009766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2492313385009766  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2495346069335938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2689437866210938  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([146, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2702136039733887  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2702136039733887  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2704920768737793  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2902636528015137  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.291435718536377  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.291435718536377  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.2916722297668457  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.310120105743408  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3114781379699707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3114781379699707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3117222785949707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3324742317199707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([118, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3338265419006348  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3338265419006348  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3340516090393066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.354757785797119  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.356071949005127  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.356071949005127  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.356274127960205  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3762898445129395  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([100, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3776307106018066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3776307106018066  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.377821445465088  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.3980393409729004  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([109, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4005727767944336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4005727767944336  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.40078067779541  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4242734909057617  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([90, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.425640106201172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.425640106201172  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.425811767578125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4464111328125  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4479517936706543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4479517936706543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4481310844421387  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4709010124206543  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([84, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4723453521728516  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4723453521728516  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.472505569458008  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4939746856689453  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([105, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.495913028717041  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.495913028717041  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.4961133003234863  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5243515968322754  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([85, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5259671211242676  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5259671211242676  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5261292457580566  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.550123691558838  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.551117420196533  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.551117420196533  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.551212787628174  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.5659947395324707  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([64, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.56815242767334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.56815242767334  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.56827449798584  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.58804988861084  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([74, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.589695930480957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.589695930480957  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.589837074279785  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.6136903762817383  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([1658, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.653458595275879  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.653458595275879  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

 h.shape torch.Size([1, 1658, 256]), torch.Size([1, 1658, 256])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 2.656620979309082  GigaBytes
Max Memory Allocated: 3.2620062828063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 3.223782539367676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1658, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 3.1556105613708496  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 3.156472682952881  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 3.157334804534912  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 3.1564292907714844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5783, 40])
input nodes number: 29834
output nodes number: 5783
edges number: 75482
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 3.1566967964172363  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 3.1566972732543945  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.0455474853515625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

pseudo mini batch 9 input nodes size: 60319
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03888893127441406  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03888893127441406  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.06765127182006836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.06769275665283203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04077005386352539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.042856693267822266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.042856693267822266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.042856693267822266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([60319, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.042856693267822266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1269, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15346145629882812  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15346145629882812  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1269, 128]), torch.Size([1, 1269, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15467166900634766  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1643533706665039  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1269, 128])
m.shape torch.Size([1321, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1650080680847168  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1650080680847168  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1321, 128]), torch.Size([1, 1321, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.16626787185668945  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1851649284362793  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1321, 128])
m.shape torch.Size([1259, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18633604049682617  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18633604049682617  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1259, 128]), torch.Size([1, 1259, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18753671646118164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.21395158767700195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1259, 128])
m.shape torch.Size([1191, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2156229019165039  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2156229019165039  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1191, 128]), torch.Size([1, 1191, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.21675872802734375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2497396469116211  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1191, 128])
m.shape torch.Size([1092, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.25177526473999023  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.25177526473999023  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.25281667709350586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2910933494567871  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1044, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.29355955123901367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.29355955123901367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2945551872253418  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.33780765533447266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([958, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.34050750732421875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.34050750732421875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.34142112731933594  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3871021270751953  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([918, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.39014720916748047  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.39014720916748047  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3910226821899414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4412555694580078  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([875, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.44457292556762695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.44457292556762695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4454073905944824  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4989128112792969  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([17888, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5837922096252441  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5837922096252441  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 17888, 128]), torch.Size([1, 17888, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6008515357971191  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8136658668518066  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 17888, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7102746963500977  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7368011474609375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7633275985717773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7365937232971191  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([27815, 256])
first layer input nodes number: 60319
first layer output nodes number: 27815
edges number: 224981
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7637791633605957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7903056144714355  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7969374656677246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7969374656677246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([740, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8507299423217773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8507299423217773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8521413803100586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8634328842163086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 740, 256])
m.shape torch.Size([612, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8639097213745117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8639097213745117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.865077018737793  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8834104537963867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([520, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8843417167663574  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8843417167663574  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.88533353805542  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.909874439239502  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([386, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9109830856323242  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9109830856323242  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9117193222045898  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9350404739379883  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([345, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9363303184509277  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9363303184509277  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.936988353729248  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9614157676696777  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([234, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9624361991882324  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9624361991882324  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9628825187683105  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.98207426071167  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([208, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.983250617980957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.983250617980957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.983647346496582  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.003483772277832  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([161, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.004554271697998  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.004554271697998  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.004861354827881  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.022365093231201  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.024439811706543  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.024439811706543  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.024765968322754  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.045639991760254  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([138, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0468034744262695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0468034744262695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0470666885375977  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0657548904418945  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.067018985748291  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.067018985748291  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0672707557678223  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0869088172912598  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0890369415283203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0890369415283203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.089263916015625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1085567474365234  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.10964298248291  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.10964298248291  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.10982608795166  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.12667179107666  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1277618408203125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1277618408203125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1279125213623047  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1428298950195312  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.143850326538086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.143850326538086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1439952850341797  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.159360885620117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.160365104675293  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.160365104675293  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.16049861907959  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1755857467651367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.177126884460449  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.177126884460449  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1772680282592773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1942052841186523  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1951727867126465  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1951727867126465  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1952872276306152  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2098212242126465  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.210878372192383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.210878372192383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2109947204589844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2265853881835938  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.227565288543701  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.227565288543701  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.227668285369873  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2421908378601074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.243927478790283  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.243927478790283  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2440381050109863  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.260410785675049  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2611594200134277  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2611594200134277  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2612318992614746  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2724661827087402  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.273336410522461  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.273336410522461  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2734146118164062  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.286083221435547  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2868518829345703  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2868518829345703  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2869186401367188  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2982006072998047  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([1009, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3224120140075684  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3224120140075684  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1009, 256]), torch.Size([1, 1009, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.324336528778076  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.665626049041748  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1009, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6173582077026367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.618180751800537  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6190032958984375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6181392669677734  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5517, 40])
input nodes number: 27815
output nodes number: 5517
edges number: 54993
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6183485984802246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.618349075317383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.046448707580566406  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

pseudo mini batch 10 input nodes size: 68207
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04073047637939453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04073047637939453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.07325410842895508  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.07329607009887695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.044492244720458984  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04692983627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04692983627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04692983627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([68207, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04692983627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1204, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17761468887329102  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17761468887329102  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17876291275024414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18794870376586914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1317, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1886305809020996  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1886305809020996  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1317, 128]), torch.Size([1, 1317, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18988656997680664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2087264060974121  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1317, 128])
m.shape torch.Size([1312, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2099752426147461  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2099752426147461  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1312, 128]), torch.Size([1, 1312, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2112264633178711  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2387533187866211  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1312, 128])
m.shape torch.Size([1172, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.24036312103271484  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.24036312103271484  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1172, 128]), torch.Size([1, 1172, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.24148082733154297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2738943099975586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1172, 128])
m.shape torch.Size([1242, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.27629661560058594  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.27629661560058594  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1242, 128]), torch.Size([1, 1242, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2774810791015625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3210897445678711  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1242, 128])
m.shape torch.Size([1176, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.32386207580566406  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.32386207580566406  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3249835968017578  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.37329673767089844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([1085, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3763575553894043  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3763575553894043  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3773922920227051  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4313230514526367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1111, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4350438117980957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4350438117980957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.43610334396362305  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.49797487258911133  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1094, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5021400451660156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5021400451660156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5031833648681641  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5716562271118164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([21387, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6731157302856445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6731157302856445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 21387, 128]), torch.Size([1, 21387, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.693511962890625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1416444778442383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 21387, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0193428993225098  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.050816059112549  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0814290046691895  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0497164726257324  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([32100, 256])
first layer input nodes number: 68207
first layer output nodes number: 32100
edges number: 265927
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.081939220428467  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1125521659851074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1205878257751465  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1205878257751465  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([686, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1802139282226562  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1802139282226562  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 686, 256]), torch.Size([1, 686, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1815223693847656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.19331693649292  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 686, 256])
m.shape torch.Size([567, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.193830966949463  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.193830966949463  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1949124336242676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.211214542388916  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([476, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2122278213500977  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2122278213500977  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2131357192993164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.236353874206543  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([326, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.237496852874756  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.237496852874756  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2381186485290527  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.257896900177002  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([325, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.259148120880127  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.259148120880127  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.259768009185791  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2836952209472656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([253, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.285759925842285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.285759925842285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2862424850463867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.306992530822754  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([187, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.308009624481201  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.308009624481201  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.308366298675537  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.326200008392334  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([173, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3273520469665527  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3273520469665527  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3276820182800293  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3464903831481934  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([142, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3475537300109863  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3475537300109863  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3478245735168457  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3651585578918457  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([135, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.366321086883545  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.366321086883545  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3665785789489746  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3848605155944824  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3861379623413086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3861379623413086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3863916397094727  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4061784744262695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4076271057128906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4076271057128906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4078292846679688  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4250144958496094  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4261322021484375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4261322021484375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.426309585571289  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.442628860473633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4437246322631836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4437246322631836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.443892478942871  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4605093002319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.461737632751465  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.461737632751465  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.461911201477051  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.48030948638916  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([87, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.481560707092285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.481560707092285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.48172664642334  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5004777908325195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([78, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.501669406890869  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.501669406890869  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5018181800842285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5196709632873535  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([89, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.52113676071167  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.52113676071167  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5213065147399902  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.54286527633667  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.544229030609131  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.544229030609131  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5443549156188965  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5612235069274902  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.562333583831787  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.562333583831787  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5624499320983887  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.578855037689209  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([71, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.580230236053467  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.580230236053467  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.5803656578063965  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6004080772399902  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6013131141662598  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6013131141662598  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.601400852203369  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6150002479553223  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.616044521331787  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.616044521331787  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6161322593688965  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6303458213806152  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([47, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6314339637756348  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6314339637756348  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.631523609161377  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6466736793518066  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([1203, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.675534725189209  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.675534725189209  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1203, 256]), torch.Size([1, 1203, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6778292655944824  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 3.085181713104248  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1203, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 3.030945301055908  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 3.0317764282226562  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 3.0326075553894043  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 3.0317344665527344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5575, 40])
input nodes number: 32100
output nodes number: 5575
edges number: 61115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 3.032024383544922  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 3.03202486038208  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.05124187469482422  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

pseudo mini batch 11 input nodes size: 69289
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04450082778930664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04450082778930664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.07754039764404297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.07758188247680664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04501628875732422  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.047142982482910156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.047142982482910156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.047142982482910156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([69289, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.047142982482910156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1362, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1632704734802246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1632704734802246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1362, 128]), torch.Size([1, 1362, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.16456937789916992  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17578792572021484  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1362, 128])
m.shape torch.Size([1478, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17654800415039062  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17654800415039062  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1478, 128]), torch.Size([1, 1478, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17795753479003906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.19910049438476562  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1478, 128])
m.shape torch.Size([1400, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2007913589477539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2007913589477539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1400, 128]), torch.Size([1, 1400, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.20212650299072266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2318429946899414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1400, 128])
m.shape torch.Size([1340, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.23373126983642578  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.23373126983642578  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1340, 128]), torch.Size([1, 1340, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.23500919342041016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.27284717559814453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1340, 128])
m.shape torch.Size([1258, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.27520751953125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.27520751953125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.27640724182128906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3200559616088867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1258, 128])
m.shape torch.Size([1150, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.32274627685546875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.32274627685546875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.32384300231933594  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3714771270751953  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1103, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.37461042404174805  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.37461042404174805  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.37566232681274414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4301261901855469  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1006, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4334378242492676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4334378242492676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.43439722061157227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.48964929580688477  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([965, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.49331092834472656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.49331092834472656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4942312240600586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5533261299133301  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([18464, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6409091949462891  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6409091949462891  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 18464, 128]), torch.Size([1, 18464, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6585178375244141  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.908731460571289  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 18464, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8008394241333008  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8289976119995117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8571557998657227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8287773132324219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([29526, 256])
first layer input nodes number: 69289
first layer output nodes number: 29526
edges number: 236162
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8576741218566895  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8858323097229004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8934922218322754  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8934922218322754  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([818, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.941744327545166  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.941744327545166  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9433045387268066  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.957960605621338  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([747, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9587159156799316  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9587159156799316  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 747, 256]), torch.Size([1, 747, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9601407051086426  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9815125465393066  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 747, 256])
m.shape torch.Size([518, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.982452392578125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.982452392578125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9834403991699219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.005176544189453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([413, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0065174102783203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0065174102783203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.007305145263672  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.033834457397461  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([332, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0353755950927734  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0353755950927734  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.036008834838867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0628795623779297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([268, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0641088485717773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0641088485717773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.064620018005371  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0897483825683594  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([232, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0910539627075195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0910539627075195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.091496467590332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.113621711730957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([180, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1147847175598145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1147847175598145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1151280403137207  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.134697437286377  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.135953426361084  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.135953426361084  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.136268138885498  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.156409740447998  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.157684803009033  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.157684803009033  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1579689979553223  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1781468391418457  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.179410934448242  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.179410934448242  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1796646118164062  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.199451446533203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2006049156188965  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2006049156188965  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2008166313171387  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2188124656677246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2198562622070312  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2198562622070312  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.22003173828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.236175537109375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2368955612182617  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2368955612182617  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2370100021362305  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2483396530151367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2494049072265625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2494049072265625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2495460510253906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.264507293701172  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.265252113342285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.265252113342285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.265353202819824  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2767763137817383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2775754928588867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2775754928588867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.277674674987793  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.289576530456543  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2904958724975586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.2904958724975586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.290602684020996  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3041677474975586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.305191993713379  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.305191993713379  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.305304527282715  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3203840255737305  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3211545944213867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3211545944213867  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3212366104125977  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.33280086517334  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.333688735961914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.333688735961914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3337764739990234  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.346761703491211  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3474159240722656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3474159240722656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3474788665771484  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3572349548339844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.357999324798584  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.357999324798584  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3580679893493652  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3691916465759277  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3698954582214355  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3698954582214355  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3699564933776855  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3802714347839355  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([815, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3999242782592773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3999242782592773  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.4014787673950195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6820878982543945  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 815, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6395764350891113  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.6403989791870117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.641221523284912  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.640357494354248  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5517, 40])
input nodes number: 29526
output nodes number: 5517
edges number: 49150
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.640610694885254  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.640611171722412  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.05086708068847656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

pseudo mini batch 12 input nodes size: 30576
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04500770568847656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04500770568847656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.05958747863769531  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.05962991714477539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.02654886245727539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.02739858627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.02739858627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.02739858627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([30576, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.02739858627319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1584, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.06833982467651367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.06833982467651367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1584, 128]), torch.Size([1, 1584, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.06985044479370117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.08193540573120117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1584, 128])
m.shape torch.Size([1571, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.08311033248901367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.08311033248901367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1571, 128]), torch.Size([1, 1571, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.08460855484008789  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10708189010620117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1571, 128])
m.shape torch.Size([1465, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1084284782409668  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1084284782409668  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1465, 128]), torch.Size([1, 1465, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10982561111450195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1409616470336914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1465, 128])
m.shape torch.Size([1266, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.14275789260864258  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.14275789260864258  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1439652442932129  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17897844314575195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([1109, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18101882934570312  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18101882934570312  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18207645416259766  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.22106218338012695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([894, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.22309112548828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.22309112548828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.22394371032714844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2613792419433594  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([780, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.26355648040771484  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.26355648040771484  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2643003463745117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3020448684692383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([667, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3048391342163086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3048391342163086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.30547523498535156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.34230709075927734  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([519, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.34421634674072266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.34421634674072266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3447113037109375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.37730836868286133  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([3981, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3965921401977539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3965921401977539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 3981, 128]), torch.Size([1, 3981, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4003887176513672  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6759777069091797  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 3981, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6413545608520508  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6545495986938477  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6677446365356445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6544461250305176  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([13836, 256])
first layer input nodes number: 30576
first layer output nodes number: 13836
edges number: 80371
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6679744720458984  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6811695098876953  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6844682693481445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.6844682693481445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1077, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7181034088134766  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7181034088134766  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1077, 256]), torch.Size([1, 1077, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7201576232910156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7374744415283203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1077, 256])
m.shape torch.Size([846, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7385144233703613  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7385144233703613  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7401280403137207  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7648415565490723  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([701, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7661323547363281  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7661323547363281  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7674694061279297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.797454833984375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([531, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7990398406982422  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.7990398406982422  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8000526428222656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8294277191162109  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([467, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8311657905578613  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8311657905578613  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8320565223693848  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.864173412322998  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8655910491943359  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8655910491943359  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8662071228027344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8931827545166016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([275, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8947253227233887  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8947253227233887  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8952498435974121  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9215426445007324  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([222, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9229874610900879  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9229874610900879  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9234108924865723  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9475464820861816  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([187, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9489526748657227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9489526748657227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9493093490600586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9721364974975586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.973505973815918  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.973505973815918  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9738130569458008  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9956159591674805  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9965729713439941  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9965729713439941  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9967732429504395  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0123944282531738  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.013505458831787  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.013505458831787  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0137057304382324  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.030728816986084  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0325417518615723  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0325417518615723  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0327210426330566  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0492157936096191  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0502433776855469  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0502433776855469  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0504016876220703  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0660743713378906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.066716194152832  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.066716194152832  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0668115615844727  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.076920509338379  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0778570175170898  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0778570175170898  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0779790878295898  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0917730331420898  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0924310684204102  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0924310684204102  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.092514991760254  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.102585792541504  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1032705307006836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1032705307006836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1033506393432617  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1135244369506836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1140689849853516  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1140689849853516  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1141300201416016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1223087310791016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1228361129760742  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1228361129760742  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1228914260864258  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.130690574645996  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.130885124206543  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.130885124206543  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.130906105041504  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1340112686157227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1344027519226074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1344027519226074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1344389915466309  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1400561332702637  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.140347957611084  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.140347957611084  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1403746604919434  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.144700527191162  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1450562477111816  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1450562477111816  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1450867652893066  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1502442359924316  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([191, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1548185348510742  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1548185348510742  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1551828384399414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2193002700805664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 191, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1923198699951172  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1931676864624023  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1940155029296875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1931252479553223  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5689, 40])
input nodes number: 13836
output nodes number: 5689
edges number: 33658
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1932964324951172  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1932969093322754  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.029127120971679688  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

pseudo mini batch 13 input nodes size: 41223
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.026574134826660156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.026574134826660156  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04623079299926758  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04627275466918945  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.031650543212890625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03274345397949219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03274345397949219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03274345397949219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([41223, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03274345397949219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1426, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.08699703216552734  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.08699703216552734  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1426, 128]), torch.Size([1, 1426, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.08835697174072266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.09923648834228516  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1426, 128])
m.shape torch.Size([1641, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10012149810791016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10012149810791016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10168647766113281  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.12516117095947266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([1470, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.12676095962524414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.12676095962524414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1470, 128]), torch.Size([1, 1470, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.12816286087036133  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15900468826293945  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1470, 128])
m.shape torch.Size([1285, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.16076040267944336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.16076040267944336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1619858741760254  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1975245475769043  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1149, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.19965124130249023  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.19965124130249023  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.20074701309204102  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.24037790298461914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([960, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.24257659912109375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.24257659912109375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.24349212646484375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2831592559814453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([849, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2855353355407715  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2855353355407715  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2863450050354004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.32756900787353516  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([777, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.33012819290161133  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.33012819290161133  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.330869197845459  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3742189407348633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([705, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3768739700317383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3768739700317383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3775463104248047  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4222402572631836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([6505, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.45292234420776367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.45292234420776367  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 6505, 128]), torch.Size([1, 6505, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.45912599563598633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9097084999084473  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 6505, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8612356185913086  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8772258758544922  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8932161331176758  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.877100944519043  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([16767, 256])
first layer input nodes number: 41223
first layer output nodes number: 16767
edges number: 109317
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.8935256004333496  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9095158576965332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9135136604309082  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9135136604309082  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([932, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9503650665283203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9503650665283203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 932, 256]), torch.Size([1, 932, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9521427154541016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9664335250854492  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 932, 256])
m.shape torch.Size([868, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9673986434936523  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9673986434936523  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 868, 256]), torch.Size([1, 868, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9690542221069336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9953088760375977  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 868, 256])
m.shape torch.Size([639, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9966187477111816  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9966187477111816  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 639, 256]), torch.Size([1, 639, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9978375434875488  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0253396034240723  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 639, 256])
m.shape torch.Size([528, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0269947052001953  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0269947052001953  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0280017852783203  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0579109191894531  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([438, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0595126152038574  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0595126152038574  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0603480339050293  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0917677879333496  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([288, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0930109024047852  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0930109024047852  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0935602188110352  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1184206008911133  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1199021339416504  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1199021339416504  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1203999519348145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1461925506591797  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([209, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1475510597229004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1475510597229004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1479496955871582  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1706719398498535  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1720819473266602  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1720819473266602  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1724367141723633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1951417922973633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([132, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.196521282196045  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.196521282196045  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1967730522155762  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.214648723602295  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2157707214355469  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2157707214355469  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2159957885742188  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.233551025390625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2345805168151855  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2345805168151855  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.234769344329834  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2508196830749512  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2518248558044434  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2518248558044434  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2519927024841309  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2674345970153809  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2685890197753906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2685890197753906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2687644958496094  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2861366271972656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.287766456604004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.287766456604004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2879152297973633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.303685188293457  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3044567108154297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3044567108154297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3045616149902344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.316415786743164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.317131519317627  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.317131519317627  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3172211647033691  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3279786109924316  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.328747272491455  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.328747272491455  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3288369178771973  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.340221881866455  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3408713340759277  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3408713340759277  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3409438133239746  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3506560325622559  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3513121604919434  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3513121604919434  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3513808250427246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3610625267028809  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3616943359375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3616943359375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3617572784423828  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.371072769165039  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.371612548828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.371612548828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.371664047241211  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3796463012695312  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3801732063293457  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3801732063293457  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.380220890045166  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3879456520080566  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.388545036315918  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.388545036315918  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.388596534729004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3972997665405273  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([300, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4044828414916992  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4044828414916992  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.405055046081543  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.506850242614746  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 300, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.476323127746582  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.477156639099121  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4779901504516602  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4771146774291992  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5591, 40])
input nodes number: 16767
output nodes number: 5591
edges number: 37173
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4772672653198242  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4772677421569824  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03484487533569336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

pseudo mini batch 14 input nodes size: 39289
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03163623809814453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03163623809814453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.05104207992553711  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.05108499526977539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.031386375427246094  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.032614707946777344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.032614707946777344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.032614707946777344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([39289, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.032614707946777344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1410, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.09382057189941406  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.09382057189941406  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1410, 128]), torch.Size([1, 1410, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.09516525268554688  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10592269897460938  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1410, 128])
m.shape torch.Size([1466, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10664844512939453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.10664844512939453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1466, 128]), torch.Size([1, 1466, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1080465316772461  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.12901782989501953  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1466, 128])
m.shape torch.Size([1249, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.13080596923828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.13080596923828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1249, 128]), torch.Size([1, 1249, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.13199710845947266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1582021713256836  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1249, 128])
m.shape torch.Size([1158, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15981531143188477  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15981531143188477  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1609196662902832  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.19336557388305664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([1081, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1953907012939453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1953907012939453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.19642162322998047  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.23450946807861328  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([908, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.23659181594848633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.23659181594848633  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2374577522277832  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.27520227432250977  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([785, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2773895263671875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2773895263671875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2781381607055664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.31563663482666016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([783, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3182492256164551  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3182492256164551  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.31899595260620117  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3617844581604004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([644, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.36417484283447266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.36417484283447266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3647890090942383  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.40474748611450195  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([8248, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4437699317932129  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4437699317932129  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 8248, 128]), torch.Size([1, 8248, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.45163583755493164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.010115146636963  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 8248, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9553565979003906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9722671508789062  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9891777038574219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9721345901489258  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([17732, 256])
first layer input nodes number: 39289
first layer output nodes number: 17732
edges number: 123609
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.9894723892211914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.006382942199707  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.010610580444336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.010610580444336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([958, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0512886047363281  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0512886047363281  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0531158447265625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0681171417236328  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 958, 256])
m.shape torch.Size([810, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0695505142211914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0695505142211914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 810, 256]), torch.Size([1, 810, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0710954666137695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0983667373657227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 810, 256])
m.shape torch.Size([580, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0992670059204102  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.0992670059204102  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1003732681274414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.124711036682129  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([478, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.126312255859375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.126312255859375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1272239685058594  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1545791625976562  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([439, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.156233310699463  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.156233310699463  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1570706367492676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.190396785736084  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([341, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1919445991516113  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1919445991516113  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.1925950050354004  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2236847877502441  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2250752449035645  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2250752449035645  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2255616188049316  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.249880313873291  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([249, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2515521049499512  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2515521049499512  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2520270347595215  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2790980339050293  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([174, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2803659439086914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2803659439086914  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.2806978225708008  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3019380569458008  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.303290843963623  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.303290843963623  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3035922050476074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.324988842010498  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3267221450805664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3267221450805664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.326991081237793  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3479681015014648  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3490562438964844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3490562438964844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3492584228515625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3664436340332031  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3675923347473145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3675923347473145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3677830696105957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3853306770324707  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3861103057861328  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3861103057861328  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3862342834472656  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.398508071899414  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3993544578552246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3993544578552246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.3994746208190918  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4122118949890137  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.413012981414795  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.413012981414795  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4131197929382324  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.42518949508667  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4259042739868164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4259042739868164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4259939193725586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.436751365661621  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4376235008239746  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4376235008239746  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4377245903015137  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4505629539489746  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4513707160949707  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4513707160949707  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.451460361480713  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.463472843170166  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4642548561096191  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4642548561096191  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.46433687210083  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4759011268615723  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.476607322692871  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.476607322692871  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4766778945922852  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4871225357055664  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4878063201904297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4878063201904297  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4878711700439453  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4979228973388672  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4983329772949219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4983329772949219  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.4983711242675781  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5045509338378906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.505293369293213  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.505293369293213  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5053563117980957  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.515993595123291  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([423, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5261263847351074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5261263847351074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.526933193206787  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6701154708862305  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 423, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6358146667480469  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6366658210754395  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.637516975402832  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6366229057312012  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5710, 40])
input nodes number: 17732
output nodes number: 5710
edges number: 41126
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6368160247802734  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6368165016174316  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03492259979248047  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

pseudo mini batch 15 input nodes size: 60469
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03140401840209961  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.03140401840209961  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.060237884521484375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.06027984619140625  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04083108901977539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.0426945686340332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.0426945686340332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.0426945686340332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([60469, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.0426945686340332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([1411, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.14153337478637695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.14153337478637695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1411, 128]), torch.Size([1, 1411, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.14287900924682617  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15364408493041992  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1411, 128])
m.shape torch.Size([1515, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15512609481811523  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.15512609481811523  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1515, 128]), torch.Size([1, 1515, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.1565709114074707  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17824316024780273  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1515, 128])
m.shape torch.Size([1374, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17963409423828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.17963409423828125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1374, 128]), torch.Size([1, 1374, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.18094444274902344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2103710174560547  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1374, 128])
m.shape torch.Size([1210, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.21202373504638672  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.21202373504638672  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1210, 128]), torch.Size([1, 1210, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.21317768096923828  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2466421127319336  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1210, 128])
m.shape torch.Size([1190, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2489023208618164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2489023208618164  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 1190, 128]), torch.Size([1, 1190, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.25003719329833984  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2916603088378906  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 1190, 128])
m.shape torch.Size([984, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.29390811920166016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.29390811920166016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.2948465347290039  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.33596134185791016  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([939, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3386263847351074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3386263847351074  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3395218849182129  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3845176696777344  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([857, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.38733911514282227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.38733911514282227  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.3881564140319824  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.43474245071411133  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([863, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4380373954772949  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4380373954772949  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4388604164123535  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.4915337562561035  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([15413, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5653409957885742  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5653409957885742  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 15413, 128]), torch.Size([1, 15413, 128])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.5800399780273438  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6236677169799805  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 15413, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.53240966796875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5569725036621094  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5815353393554688  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5567803382873535  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([25756, 256])
first layer input nodes number: 60469
first layer output nodes number: 25756
edges number: 200583
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.5819878578186035  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.606550693511963  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6126914024353027  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6126914024353027  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

m.shape torch.Size([906, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6611766815185547  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6611766815185547  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 906, 256]), torch.Size([1, 906, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6629047393798828  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6767969131469727  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 906, 256])
m.shape torch.Size([769, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6774849891662598  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6774849891662598  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.6789517402648926  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.702681064605713  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 769, 256])
m.shape torch.Size([534, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7035107612609863  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7035107612609863  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7045292854309082  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7294387817382812  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([404, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7305631637573242  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7305631637573242  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7313337326049805  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7624621391296387  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([353, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7637734413146973  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7637734413146973  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.76444673538208  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.789106845855713  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([252, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7902235984802246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7902235984802246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.7907042503356934  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8113722801208496  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([217, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8125920295715332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8125920295715332  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8130059242248535  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8337006568908691  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([162, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8347415924072266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8347415924072266  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8350505828857422  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8526630401611328  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([149, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8538079261779785  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8538079261779785  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8540921211242676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8722805976867676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([135, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8734383583068848  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8734383583068848  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8736958503723145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8919777870178223  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.893167495727539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.893167495727539  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.8933944702148438  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9110984802246094  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9122886657714844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9122886657714844  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9125041961669922  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9308242797851562  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9317927360534668  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9317927360534668  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9319491386413574  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.946338176727295  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9473376274108887  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9473376274108887  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9474902153015137  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9625964164733887  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9636101722717285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9636101722717285  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9637455940246582  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.978100299835205  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9788479804992676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9788479804992676  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9789490699768066  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9903721809387207  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9910736083984375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9910736083984375  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 1.9911613464355469  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.001689910888672  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.00266695022583  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.00266695022583  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.002779483795166  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.01707124710083  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0179829597473145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0179829597473145  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0180840492248535  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.031630039215088  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0323486328125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0323486328125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0324249267578125  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.043182373046875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.043729782104492  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.043729782104492  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0437850952148438  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.051971435546875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0527052879333496  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0527052879333496  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.052773952484131  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0634169578552246  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.063957691192627  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.063957691192627  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.06400728225708  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.0720410346984863  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.072754383087158  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.072754383087158  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.072815418243408  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.083130359649658  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([867, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1039323806762695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.1039323806762695  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

 h.shape torch.Size([1, 867, 256]), torch.Size([1, 867, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.105586051940918  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.39731502532959  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

rst.shape  torch.Size([1, 867, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.35467529296875  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes
Using backend: pytorch

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3555078506469727  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3563404083251953  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.355465888977051  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

torch.Size([5587, 40])
input nodes number: 25756
output nodes number: 5587
edges number: 49302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.3556814193725586  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 2.355681896209717  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04599809646606445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04599809646606445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 0.04599809646606445  GigaBytes
Max Memory Allocated: 3.263312339782715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014326110482215881 |0.0029709190130233765 |0.11831887066364288 |9.192526340484619e-05 |0.07242441177368164 |0.002759218215942383 |
----------------------------------------------------------pseudo_mini_loss sum 3.78004789352417
Total (block generation + training)time/epoch 24.48759412765503
Training time/epoch 3.4201505184173584
Training time without block to device /epoch 3.3726158142089844
Training time without total dataloading part /epoch 3.0561225414276123
load block tensor time/epoch 0.2292177677154541
block to device time/epoch 0.04753470420837402
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  918475
Number of first layer input nodes during this epoch:  624244
Number of first layer output nodes during this epoch:  294231
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
