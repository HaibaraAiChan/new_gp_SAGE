[05:30:43] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 16 parts and get 6736143 edge cuts
main start at this time 1651555821.9896793
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03447723388671875
global_2_local spend time (sec) 0.035887718200683594
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004594326019287109
A = g.adjacency_matrix() spent  0.00759577751159668
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0764009952545166
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2970852851867676
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1994411945343018

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.273 seconds
Metis partitioning: 5.621 seconds
Split the graph: 1.196 seconds
Construct subgraphs: 0.073 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.176603078842163
5517
5518
5823
5517
5537
5517
5517
5837
5854
5525
5517
5854
5853
5854
5853
5848
total k batches seeds list generation spend  18.01602029800415
after graph partition
graph partition algorithm spend time 18.12025737762451
5517
5518
5823
5517
5537
5517
5517
5837
5854
5525
5517
5854
5853
5854
5853
5848
partition_len_list
[29547, 25127, 27492, 28287, 15118, 11866, 24077, 18055, 12558, 12005, 11110, 10970, 11347, 13695, 9869, 12671]
shared_neighbor_graph_partition_s0 selection method  spend 18.20771884918213
time for parepare:  0.018522977828979492
local_output_nid generation:  0.0011756420135498047
local_in_edges_tensor generation:  0.0016813278198242188
mini_batch_src_global generation:  0.0022182464599609375
r_  generation:  0.018737077713012695
local_output_nid generation:  0.001439809799194336
local_in_edges_tensor generation:  0.0013194084167480469
mini_batch_src_global generation:  0.001984119415283203
r_  generation:  0.014796972274780273
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.001455068588256836
mini_batch_src_global generation:  0.002137899398803711
r_  generation:  0.02465963363647461
local_output_nid generation:  0.0016329288482666016
local_in_edges_tensor generation:  0.0013778209686279297
mini_batch_src_global generation:  0.0019185543060302734
r_  generation:  0.019144058227539062
local_output_nid generation:  0.0016906261444091797
local_in_edges_tensor generation:  0.0012929439544677734
mini_batch_src_global generation:  0.0013668537139892578
r_  generation:  0.014963626861572266
local_output_nid generation:  0.001613616943359375
local_in_edges_tensor generation:  0.0011873245239257812
mini_batch_src_global generation:  0.0013349056243896484
r_  generation:  0.010059833526611328
local_output_nid generation:  0.0015616416931152344
local_in_edges_tensor generation:  0.0012362003326416016
mini_batch_src_global generation:  0.0013508796691894531
r_  generation:  0.016345977783203125
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.001276254653930664
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.014689445495605469
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0013072490692138672
mini_batch_src_global generation:  0.0013909339904785156
r_  generation:  0.016724586486816406
local_output_nid generation:  0.001493692398071289
local_in_edges_tensor generation:  0.00119781494140625
mini_batch_src_global generation:  0.0013980865478515625
r_  generation:  0.01371002197265625
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0012042522430419922
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.013666868209838867
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0012302398681640625
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.016550064086914062
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0012059211730957031
mini_batch_src_global generation:  0.0013327598571777344
r_  generation:  0.013785600662231445
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0011518001556396484
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.013872385025024414
local_output_nid generation:  0.001409292221069336
local_in_edges_tensor generation:  0.001190185546875
mini_batch_src_global generation:  0.0012340545654296875
r_  generation:  0.010569572448730469
local_output_nid generation:  0.0014467239379882812
local_in_edges_tensor generation:  0.0012001991271972656
mini_batch_src_global generation:  0.0012509822845458984
r_  generation:  0.014802217483520508
----------------------check_connections_block total spend ----------------------------- 0.4045109748840332
generate_one_block  0.028560161590576172
generate_one_block  0.021225690841674805
generate_one_block  0.03488349914550781
generate_one_block  0.027332067489624023
generate_one_block  0.025408506393432617
generate_one_block  0.014613628387451172
generate_one_block  0.022150754928588867
generate_one_block  0.02039813995361328
generate_one_block  0.02201080322265625
generate_one_block  0.018672704696655273
generate_one_block  0.018213987350463867
generate_one_block  0.021670818328857422
generate_one_block  0.018201112747192383
generate_one_block  0.018221616744995117
generate_one_block  0.01425313949584961
generate_one_block  0.019060373306274414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07588911056518555
gen group dst list time:  0.008149862289428711
time for parepare:  0.02303290367126465
local_output_nid generation:  0.0050694942474365234
local_in_edges_tensor generation:  0.02340531349182129
mini_batch_src_global generation:  0.00768733024597168
r_  generation:  0.08035445213317871
local_output_nid generation:  0.007035732269287109
local_in_edges_tensor generation:  0.008376598358154297
mini_batch_src_global generation:  0.008035421371459961
r_  generation:  0.06781339645385742
local_output_nid generation:  0.007176637649536133
local_in_edges_tensor generation:  0.007612705230712891
mini_batch_src_global generation:  0.016272544860839844
r_  generation:  0.08141541481018066
local_output_nid generation:  0.007383584976196289
local_in_edges_tensor generation:  0.007908344268798828
mini_batch_src_global generation:  0.00891733169555664
r_  generation:  0.08000302314758301
local_output_nid generation:  0.0042874813079833984
local_in_edges_tensor generation:  0.0037491321563720703
mini_batch_src_global generation:  0.0049512386322021484
r_  generation:  0.03744196891784668
local_output_nid generation:  0.0033953189849853516
local_in_edges_tensor generation:  0.002786397933959961
mini_batch_src_global generation:  0.0025534629821777344
r_  generation:  0.025852441787719727
local_output_nid generation:  0.006031513214111328
local_in_edges_tensor generation:  0.005372524261474609
mini_batch_src_global generation:  0.0062713623046875
r_  generation:  0.06404519081115723
local_output_nid generation:  0.004844188690185547
local_in_edges_tensor generation:  0.004750251770019531
mini_batch_src_global generation:  0.005566596984863281
r_  generation:  0.04456758499145508
local_output_nid generation:  0.0035588741302490234
local_in_edges_tensor generation:  0.003033876419067383
mini_batch_src_global generation:  0.003314495086669922
r_  generation:  0.029201745986938477
local_output_nid generation:  0.003276348114013672
local_in_edges_tensor generation:  0.0025763511657714844
mini_batch_src_global generation:  0.002397775650024414
r_  generation:  0.02672743797302246
local_output_nid generation:  0.002975940704345703
local_in_edges_tensor generation:  0.0026149749755859375
mini_batch_src_global generation:  0.002237081527709961
r_  generation:  0.02556014060974121
local_output_nid generation:  0.0028314590454101562
local_in_edges_tensor generation:  0.0023512840270996094
mini_batch_src_global generation:  0.002255678176879883
r_  generation:  0.025223970413208008
local_output_nid generation:  0.0030069351196289062
local_in_edges_tensor generation:  0.0024442672729492188
mini_batch_src_global generation:  0.0021049976348876953
r_  generation:  0.02396845817565918
local_output_nid generation:  0.0034720897674560547
local_in_edges_tensor generation:  0.0028884410858154297
mini_batch_src_global generation:  0.0023615360260009766
r_  generation:  0.02965712547302246
local_output_nid generation:  0.0025310516357421875
local_in_edges_tensor generation:  0.0021004676818847656
mini_batch_src_global generation:  0.0018665790557861328
r_  generation:  0.018646717071533203
local_output_nid generation:  0.0032372474670410156
local_in_edges_tensor generation:  0.002682924270629883
mini_batch_src_global generation:  0.0020928382873535156
r_  generation:  0.02847599983215332
----------------------check_connections_block total spend ----------------------------- 1.116095781326294
generate_one_block  0.1206047534942627
generate_one_block  0.09902071952819824
generate_one_block  0.10356473922729492
generate_one_block  0.10643410682678223
generate_one_block  0.047528743743896484
generate_one_block  0.03178548812866211
generate_one_block  0.09449529647827148
generate_one_block  0.05954098701477051
generate_one_block  0.038246870040893555
generate_one_block  0.03437376022338867
generate_one_block  0.03261876106262207
generate_one_block  0.03333616256713867
generate_one_block  0.030277729034423828
generate_one_block  0.03792214393615723
generate_one_block  0.0226287841796875
generate_one_block  0.03471970558166504
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.116095781326294
block generation total time  0.9270987510681152
average batch blocks generation time:  0.0579436719417572
pseudo mini batch 0 input nodes size: 62254
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0506591796875 GB
    Memory Allocated: 0.03246259689331055  GigaBytes
Max Memory Allocated: 0.03246259689331055  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0506591796875 GB
    Memory Allocated: 0.03250408172607422  GigaBytes
Max Memory Allocated: 0.03250408172607422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0506591796875 GB
    Memory Allocated: 0.03250408172607422  GigaBytes
Max Memory Allocated: 0.03250408172607422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

torch.Size([62254, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03477001190185547  GigaBytes
Max Memory Allocated: 0.03477001190185547  GigaBytes

m.shape torch.Size([1116, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.15541791915893555  GigaBytes
Max Memory Allocated: 0.1586599349975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.15541791915893555  GigaBytes
Max Memory Allocated: 0.1586599349975586  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.15648221969604492  GigaBytes
Max Memory Allocated: 0.1586599349975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.16499662399291992  GigaBytes
Max Memory Allocated: 0.1655287742614746  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1244, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.1660294532775879  GigaBytes
Max Memory Allocated: 0.16605758666992188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.1660294532775879  GigaBytes
Max Memory Allocated: 0.16605758666992188  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.16721582412719727  GigaBytes
Max Memory Allocated: 0.16721582412719727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1850113868713379  GigaBytes
Max Memory Allocated: 0.1862931251525879  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1225, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1861705780029297  GigaBytes
Max Memory Allocated: 0.1862931251525879  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1861705780029297  GigaBytes
Max Memory Allocated: 0.1862931251525879  GigaBytes

 h.shape torch.Size([1, 1225, 128]), torch.Size([1, 1225, 128])
----------------------------------------3
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.18733882904052734  GigaBytes
Max Memory Allocated: 0.18733882904052734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21304035186767578  GigaBytes
Max Memory Allocated: 0.21479272842407227  GigaBytes

rst.shape  torch.Size([1, 1225, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21456003189086914  GigaBytes
Max Memory Allocated: 0.21479272842407227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21456003189086914  GigaBytes
Max Memory Allocated: 0.21479272842407227  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.21561193466186523  GigaBytes
Max Memory Allocated: 0.21561193466186523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.24611711502075195  GigaBytes
Max Memory Allocated: 0.24881792068481445  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1138, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2483043670654297  GigaBytes
Max Memory Allocated: 0.24881792068481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2483043670654297  GigaBytes
Max Memory Allocated: 0.24881792068481445  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.2493896484375  GigaBytes
Max Memory Allocated: 0.2493896484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.2889900207519531  GigaBytes
Max Memory Allocated: 0.2917032241821289  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1083, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.2915458679199219  GigaBytes
Max Memory Allocated: 0.2917032241821289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.2915458679199219  GigaBytes
Max Memory Allocated: 0.2917032241821289  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.29257869720458984  GigaBytes
Max Memory Allocated: 0.29257869720458984  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.3388710021972656  GigaBytes
Max Memory Allocated: 0.34196949005126953  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([996, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.34167909622192383  GigaBytes
Max Memory Allocated: 0.34196949005126953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.34167909622192383  GigaBytes
Max Memory Allocated: 0.34196949005126953  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.34262895584106445  GigaBytes
Max Memory Allocated: 0.34262895584106445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.3907589912414551  GigaBytes
Max Memory Allocated: 0.39408349990844727  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([992, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.39406824111938477  GigaBytes
Max Memory Allocated: 0.39415693283081055  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.39406824111938477  GigaBytes
Max Memory Allocated: 0.39415693283081055  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.39501428604125977  GigaBytes
Max Memory Allocated: 0.39501428604125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45014429092407227  GigaBytes
Max Memory Allocated: 0.45453882217407227  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([976, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45406579971313477  GigaBytes
Max Memory Allocated: 0.45453882217407227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45406579971313477  GigaBytes
Max Memory Allocated: 0.45453882217407227  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.45499658584594727  GigaBytes
Max Memory Allocated: 0.45499658584594727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.5163979530334473  GigaBytes
Max Memory Allocated: 0.5205864906311035  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([19674, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.6097455024719238  GigaBytes
Max Memory Allocated: 0.6121029853820801  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.6097455024719238  GigaBytes
Max Memory Allocated: 0.6121029853820801  GigaBytes

 h.shape torch.Size([1, 19674, 128]), torch.Size([1, 19674, 128])
----------------------------------------3
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6292767524719238  GigaBytes
Max Memory Allocated: 0.6292767524719238  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9698758125305176  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 19674, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8560705184936523  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8842487335205078  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9124269485473633  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.884028434753418  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

torch.Size([29547, 256])
first layer input nodes number: 62254
first layer output nodes number: 29547
edges number: 244311
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9128928184509277  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9410710334777832  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9481158256530762  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.9481158256530762  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

m.shape torch.Size([675, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.006336212158203  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.006336212158203  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 675, 256]), torch.Size([1, 675, 256])
----------------------------------------3
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.0076236724853516  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.017923355102539  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 675, 256])
m.shape torch.Size([600, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.0185275077819824  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.0185275077819824  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 3.3846435546875 GB
    Memory Allocated: 2.01967191696167  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0368380546569824  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([474, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0376639366149902  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0376639366149902  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0385680198669434  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0597667694091797  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([336, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0606064796447754  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0606064796447754  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0612473487854004  GigaBytes
Max Memory Allocated: 2.0636887550354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0827126502990723  GigaBytes
Max Memory Allocated: 2.084249973297119  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([311, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0839414596557617  GigaBytes
Max Memory Allocated: 2.084249973297119  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0839414596557617  GigaBytes
Max Memory Allocated: 2.084249973297119  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 2.0845346450805664  GigaBytes
Max Memory Allocated: 2.0845346450805664  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.1111536026000977  GigaBytes
Max Memory Allocated: 2.1126909255981445  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([238, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.112405300140381  GigaBytes
Max Memory Allocated: 2.1126909255981445  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.112405300140381  GigaBytes
Max Memory Allocated: 2.1126909255981445  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.1128592491149902  GigaBytes
Max Memory Allocated: 2.1128592491149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1323790550231934  GigaBytes
Max Memory Allocated: 2.1339163780212402  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([181, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1336989402770996  GigaBytes
Max Memory Allocated: 2.1339163780212402  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1336989402770996  GigaBytes
Max Memory Allocated: 2.1339163780212402  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 2.1340441703796387  GigaBytes
Max Memory Allocated: 2.1340441703796387  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.151305675506592  GigaBytes
Max Memory Allocated: 2.1528429985046387  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([162, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.1526803970336914  GigaBytes
Max Memory Allocated: 2.1528429985046387  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.1526803970336914  GigaBytes
Max Memory Allocated: 2.1528429985046387  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.4315185546875 GB
    Memory Allocated: 2.152989387512207  GigaBytes
Max Memory Allocated: 2.152989387512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.1706018447875977  GigaBytes
Max Memory Allocated: 2.1722259521484375  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([143, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.172081470489502  GigaBytes
Max Memory Allocated: 2.1722259521484375  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.172081470489502  GigaBytes
Max Memory Allocated: 2.1722259521484375  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.172354221343994  GigaBytes
Max Memory Allocated: 2.172354221343994  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.189810276031494  GigaBytes
Max Memory Allocated: 2.1915030479431152  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.191376209259033  GigaBytes
Max Memory Allocated: 2.1915030479431152  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.191376209259033  GigaBytes
Max Memory Allocated: 2.1915030479431152  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4647216796875 GB
    Memory Allocated: 2.1916165351867676  GigaBytes
Max Memory Allocated: 2.1916165351867676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.208679676055908  GigaBytes
Max Memory Allocated: 2.20988130569458  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.210029125213623  GigaBytes
Max Memory Allocated: 2.2100348472595215  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.210029125213623  GigaBytes
Max Memory Allocated: 2.2100348472595215  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.210294246673584  GigaBytes
Max Memory Allocated: 2.210294246673584  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.230973720550537  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.2320871353149414  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.2320871353149414  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 2.232293128967285  GigaBytes
Max Memory Allocated: 2.2324318885803223  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.249802589416504  GigaBytes
Max Memory Allocated: 2.2510385513305664  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.251124382019043  GigaBytes
Max Memory Allocated: 2.2511301040649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.251124382019043  GigaBytes
Max Memory Allocated: 2.2511301040649414  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 2.2513418197631836  GigaBytes
Max Memory Allocated: 2.2513418197631836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.271346092224121  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.2724485397338867  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.2724485397338867  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.5428466796875 GB
    Memory Allocated: 2.27262020111084  GigaBytes
Max Memory Allocated: 2.272759437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.289614677429199  GigaBytes
Max Memory Allocated: 2.290816307067871  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([98, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.2909417152404785  GigaBytes
Max Memory Allocated: 2.290947437286377  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.2909417152404785  GigaBytes
Max Memory Allocated: 2.290947437286377  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.5584716796875 GB
    Memory Allocated: 2.291128635406494  GigaBytes
Max Memory Allocated: 2.291128635406494  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.3109421730041504  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.3120946884155273  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.3120946884155273  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.5760498046875 GB
    Memory Allocated: 2.312249183654785  GigaBytes
Max Memory Allocated: 2.3123440742492676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.329707145690918  GigaBytes
Max Memory Allocated: 2.3309431076049805  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.330855369567871  GigaBytes
Max Memory Allocated: 2.3309431076049805  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.330855369567871  GigaBytes
Max Memory Allocated: 2.3309431076049805  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 2.330998420715332  GigaBytes
Max Memory Allocated: 2.330998420715332  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.3481645584106445  GigaBytes
Max Memory Allocated: 2.3493804931640625  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([83, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.349529266357422  GigaBytes
Max Memory Allocated: 2.3495349884033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.349529266357422  GigaBytes
Max Memory Allocated: 2.3495349884033203  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.3496875762939453  GigaBytes
Max Memory Allocated: 2.3496875762939453  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.369792938232422  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.3708643913269043  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.3708643913269043  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 2.3709845542907715  GigaBytes
Max Memory Allocated: 2.371217727661133  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3870863914489746  GigaBytes
Max Memory Allocated: 2.388227939605713  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3882761001586914  GigaBytes
Max Memory Allocated: 2.3882813453674316  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3882761001586914  GigaBytes
Max Memory Allocated: 2.3882813453674316  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.388400077819824  GigaBytes
Max Memory Allocated: 2.388400077819824  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.405880928039551  GigaBytes
Max Memory Allocated: 2.407120704650879  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([69, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.4072117805480957  GigaBytes
Max Memory Allocated: 2.407217502593994  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.4072117805480957  GigaBytes
Max Memory Allocated: 2.407217502593994  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 2.4073433876037598  GigaBytes
Max Memory Allocated: 2.4073433876037598  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.426821231842041  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.4277915954589844  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.4277915954589844  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.427885055541992  GigaBytes
Max Memory Allocated: 2.4282031059265137  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.442371368408203  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.443209171295166  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.443209171295166  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.4432854652404785  GigaBytes
Max Memory Allocated: 2.443399429321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.4556450843811035  GigaBytes
Max Memory Allocated: 2.4565224647521973  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.4565296173095703  GigaBytes
Max Memory Allocated: 2.456533432006836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.4565296173095703  GigaBytes
Max Memory Allocated: 2.456533432006836  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 2.456605911254883  GigaBytes
Max Memory Allocated: 2.456605911254883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4694995880126953  GigaBytes
Max Memory Allocated: 2.4704151153564453  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([1157, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4972620010375977  GigaBytes
Max Memory Allocated: 2.4973697662353516  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4972620010375977  GigaBytes
Max Memory Allocated: 2.4973697662353516  GigaBytes

 h.shape torch.Size([1, 1157, 256]), torch.Size([1, 1157, 256])
----------------------------------------3
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4994688034057617  GigaBytes
Max Memory Allocated: 2.4994688034057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.903684139251709  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1157, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.8502116203308105  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.851034164428711  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8518567085266113  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8509926795959473  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([5517, 40])
input nodes number: 29547
output nodes number: 5517
edges number: 59665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.852077007293701  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8520779609680176  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0422673225402832  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

pseudo mini batch 1 input nodes size: 65888
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0361027717590332  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0361027717590332  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.0675206184387207  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.06756210327148438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.03783559799194336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([65888, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.039571285247802734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([1494, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.13376855850219727  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.13376855850219727  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1351933479309082  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1465916633605957  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1581, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14761734008789062  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14761734008789062  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1581, 128]), torch.Size([1, 1581, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1491250991821289  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17174148559570312  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1581, 128])
m.shape torch.Size([1453, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1730661392211914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1730661392211914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1744518280029297  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20576143264770508  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([1322, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20759010314941406  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20759010314941406  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1322, 128]), torch.Size([1, 1322, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.20885086059570312  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24541282653808594  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1322, 128])
m.shape torch.Size([1168, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24756717681884766  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24756717681884766  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24868106842041016  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.28934574127197266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1086, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.29189586639404297  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.29189586639404297  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.29293155670166016  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.33835506439208984  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([1038, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.34130191802978516  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.34130191802978516  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.34229183197021484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3917875289916992  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([919, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.39479827880859375  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.39479827880859375  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3956747055053711  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.44653987884521484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([854, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4497666358947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4497666358947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.45058107376098633  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.502953052520752  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([14212, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5703139305114746  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5703139305114746  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 14212, 128]), torch.Size([1, 14212, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5838675498962402  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5470023155212402  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 14212, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4613876342773438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4853506088256836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5093135833740234  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4851632118225098  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([25127, 256])
first layer input nodes number: 65888
first layer output nodes number: 25127
edges number: 191083
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5098066329956055  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5337696075439453  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5397605895996094  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5397605895996094  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([962, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5810694694519043  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.5810694694519043  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 962, 256]), torch.Size([1, 962, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.58290433883667  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.598996639251709  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 962, 256])
m.shape torch.Size([819, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.599703311920166  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.599703311920166  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6012654304504395  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.624697208404541  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.625983715057373  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.625983715057373  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6270842552185059  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6544013023376465  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([445, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6559185981750488  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6559185981750488  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6567673683166504  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6834721565246582  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([363, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6847925186157227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6847925186157227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.6854848861694336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7116684913635254  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([286, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7129716873168945  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7129716873168945  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.713517189025879  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.738051414489746  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7394943237304688  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7394943237304688  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.739980697631836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7642993927001953  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7655940055847168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7655940055847168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7659754753112793  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7877192497253418  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([151, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.788835048675537  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.788835048675537  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.7891230583190918  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8075556755065918  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8085651397705078  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8085651397705078  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8087940216064453  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8250446319580078  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8268623352050781  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8268623352050781  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.827077865600586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8438892364501953  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8451080322265625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8451080322265625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.845327377319336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8639717102050781  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.864774227142334  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.864774227142334  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8649134635925293  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.877723217010498  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8785147666931152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8785147666931152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8786368370056152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8907217979431152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8915982246398926  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8915982246398926  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.8917222023010254  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9048638343811035  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9056015014648438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9056015014648438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.90570068359375  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9169082641601562  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.917757511138916  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.917757511138916  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9178624153137207  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9304509162902832  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9311771392822266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9311771392822266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9312629699707031  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9421634674072266  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.943152904510498  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.943152904510498  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.94325590133667  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9570574760437012  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9576597213745117  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9576597213745117  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9577245712280273  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9668684005737305  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9674415588378906  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9674415588378906  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.967498779296875  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9759674072265625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9765310287475586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9765310287475586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9765844345092773  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9848623275756836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.98545503616333  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.98545503616333  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9855084419250488  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9941601753234863  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9945487976074219  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9945487976074219  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9945831298828125  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.000385284423828  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([566, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.0139684677124023  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.0139684677124023  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.015048027038574  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.205348014831543  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 566, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.170102596282959  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1709251403808594  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1717476844787598  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1708836555480957  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([5518, 40])
input nodes number: 25127
output nodes number: 5518
edges number: 41784
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.171112537384033  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1711130142211914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.04273509979248047  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

pseudo mini batch 2 input nodes size: 51093
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.03783559799194336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.03783559799194336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.062198638916015625  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.06224203109741211  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.030782699584960938  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([51093, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.033148765563964844  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14983320236206055  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.14983320236206055  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15062189102172852  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15747976303100586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([808, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15785598754882812  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15785598754882812  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.15862655639648438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17045927047729492  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([848, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17128705978393555  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17128705978393555  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.17209577560424805  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1907191276550293  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([816, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19187116622924805  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19187116622924805  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19264936447143555  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21594953536987305  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([834, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21754884719848633  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21754884719848633  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.21834421157836914  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24712514877319336  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([806, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24903345108032227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.24903345108032227  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2498021125793457  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2828545570373535  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([808, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.28516721725463867  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.28516721725463867  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2859377861022949  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3244662284851074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([773, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3270297050476074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3270297050476074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.32776689529418945  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.37038564682006836  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3735489845275879  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3735489845275879  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.37433385848999023  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4256572723388672  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([20149, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 0.5213427543640137  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 0.5213427543640137  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 20149, 128]), torch.Size([1, 20149, 128])
----------------------------------------3
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 0.5410633087158203  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9277820587158203  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 20149, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.8169641494750977  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.8431825637817383  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.869400978088379  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.842977523803711  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

torch.Size([27492, 256])
first layer input nodes number: 51093
first layer output nodes number: 27492
edges number: 237994
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.869783878326416  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.8960022926330566  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9025568962097168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9025568962097168  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

m.shape torch.Size([502, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.979569435119629  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.979569435119629  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9805269241333008  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9881868362426758  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9884543418884277  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.9884543418884277  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 1.989194393157959  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.001741886138916  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.00241756439209  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.00241756439209  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.003077507019043  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0178446769714355  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([276, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.018606662750244  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.018606662750244  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0191330909729004  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.034489154815674  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([253, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0354418754577637  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0354418754577637  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0359244346618652  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0532965660095215  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([217, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.054306983947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.054306983947754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.054720878601074  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0725183486938477  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([171, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0738625526428223  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0738625526428223  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.074188709259033  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.09049654006958  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0913949012756348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.0913949012756348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.091658115386963  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.106661319732666  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1080784797668457  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1080784797668457  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.108419895172119  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.130270481109619  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.13169527053833  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.13169527053833  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.132011890411377  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.154491901397705  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([149, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1559090614318848  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1559090614318848  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.156193256378174  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1783604621887207  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1799254417419434  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1799254417419434  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.1802077293395996  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.204202175140381  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([127, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2056479454040527  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2056479454040527  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.20589017868042  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.228175640106201  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2294673919677734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2294673919677734  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2296676635742188  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2494945526123047  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2508506774902344  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2508506774902344  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2510433197021484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.271463394165039  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([97, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2728590965270996  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2728590965270996  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2730441093444824  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2939505577087402  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.295410633087158  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.295410633087158  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.2955918312072754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.317335605621338  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([99, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.318957805633545  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.318957805633545  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3191466331481934  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.343127727508545  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([98, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3448233604431152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3448233604431152  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.345010280609131  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3700575828552246  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3717904090881348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3717904090881348  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.371971607208252  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3975205421447754  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3992466926574707  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.3992466926574707  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 2.399418354034424  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4248242378234863  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4260916709899902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4260916709899902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.4569091796875 GB
    Memory Allocated: 2.4262137413024902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.4451346397399902  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.4465770721435547  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.4465770721435547  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.446706771850586  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.4677181243896484  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([77, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.4694294929504395  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.4694294929504395  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.469576358795166  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.494396686553955  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([1774, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.5369491577148438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.5369491577148438  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

 h.shape torch.Size([1, 1774, 256]), torch.Size([1, 1774, 256])
----------------------------------------3
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 2.540332794189453  GigaBytes
Max Memory Allocated: 2.9312691688537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 3.151660919189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1774, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 3.0796589851379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5194091796875 GB
    Memory Allocated: 3.080526828765869  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.081394672393799  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.0804834365844727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5823, 40])
input nodes number: 27492
output nodes number: 5823
edges number: 79381
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.080777168273926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5213623046875 GB
    Memory Allocated: 3.080777645111084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037213802337646484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 3 input nodes size: 60509
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030827999114990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030827999114990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.059680938720703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0597224235534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03531599044799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([60509, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746461868286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1265, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1512761116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1512761116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1265, 128]), torch.Size([1, 1265, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1524825096130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16213369369506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1265, 128])
m.shape torch.Size([1273, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16347026824951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16347026824951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1273, 128]), torch.Size([1, 1273, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16468429565429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18289470672607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1273, 128])
m.shape torch.Size([1203, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18468475341796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18468475341796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18583202362060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21132755279541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1105, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2128615379333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2128615379333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21391534805297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24503850936889648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1058, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24703407287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24703407287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24804306030273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28487300872802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([976, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28716087341308594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28716087341308594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28809165954589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32903099060058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([940, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33170318603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33170318603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3325996398925781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37754249572753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([920, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3806037902832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3806037902832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3814811706542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4317970275878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4348945617675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4348945617675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4356803894042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.48773193359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([18723, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5766172409057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5766172409057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18723, 128]), torch.Size([1, 18723, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5945768356323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8623275756835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18723, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7559328079223633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7829093933105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8098859786987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.782698631286621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28287, 256])
first layer input nodes number: 60509
first layer output nodes number: 28287
edges number: 231572
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8103389739990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.837315559387207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.844059944152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.844059944152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([763, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8994669914245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8994669914245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9009222984313965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.913886547088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([623, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9145379066467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9145379066467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 623, 256]), torch.Size([1, 623, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9157261848449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9393982887268066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 623, 256])
m.shape torch.Size([457, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9403481483459473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9403481483459473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9412198066711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9603962898254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([363, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9615793228149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9615793228149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9622716903686523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9852991104125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([321, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9866409301757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9866409301757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.987253189086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0160608291625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([240, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.017138957977295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.017138957977295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.01759672164917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.037280559539795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([203, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0390405654907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0390405654907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0394277572631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0587873458862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([183, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0600008964538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0600008964538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.060349941253662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0802454948425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([142, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.082035541534424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.082035541534424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.082306385040283  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.099640369415283  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1008410453796387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1008410453796387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1011061668395996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.119929790496826  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.121832847595215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.121832847595215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1220598220825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.139763832092285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.140942096710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.140942096710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.14115571975708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.159313678741455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.161287307739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.161287307739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1614952087402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.180622100830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.181701183319092  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.181701183319092  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1818461418151855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.196197032928467  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.197263717651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.197263717651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1974143981933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2133865356445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2145261764526367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2145261764526367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.214676856994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.231703758239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2326579093933105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2326579093933105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2327780723571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2471976280212402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2483315467834473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2483315467834473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2484631538391113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2651772499084473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2661352157592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2661352157592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.266238212585449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2800397872924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.281161308288574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.281161308288574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.281277656555176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.297682762145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2988357543945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2988357543945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2989501953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.315887451171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.316549301147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.316549301147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3166141510009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3266658782958984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.327606201171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.327606201171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3276901245117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3412857055664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3421435356140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3421435356140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3422179222106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3547892570495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([1085, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3808226585388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3808226585388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1085, 256]), torch.Size([1, 1085, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.383002758026123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.766209125518799  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1085, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7162885665893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.717111110687256  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7179336547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.717069625854492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 28287
output nodes number: 5517
edges number: 56653
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7172765731811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7172770500183105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04113626480102539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 4 input nodes size: 36651
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03527069091796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03527069091796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.052747249603271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.052788734436035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023894309997558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([36651, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1281, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07478713989257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07478713989257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1281, 128]), torch.Size([1, 1281, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07600879669189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08578205108642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1281, 128])
m.shape torch.Size([1334, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08722591400146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08722591400146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1334, 128]), torch.Size([1, 1334, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08849811553955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10841178894042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1334, 128])
m.shape torch.Size([1255, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10957098007202148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10957098007202148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11076784133911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13732528686523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13950204849243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13950204849243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14056730270385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17181634902954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1045, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17377519607543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17377519607543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17477178573608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21133136749267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([869, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2133193016052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2133193016052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21414804458618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24991846084594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([785, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2521243095397949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2521243095397949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25287294387817383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29096317291259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([695, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2932400703430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2932400703430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2939028739929199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3326554298400879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([616, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33496761322021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33496761322021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3355550765991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37483882904052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([6121, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4038419723510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4038419723510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 6121, 128]), torch.Size([1, 6121, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4096794128417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8241376876831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 6121, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7815451622009277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7959628105163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8103804588317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7958498001098633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([15118, 256])
first layer input nodes number: 36651
first layer output nodes number: 15118
edges number: 100430
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8106555938720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8250732421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286776542663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286776542663574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([859, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8714685440063477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8714685440063477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 859, 256]), torch.Size([1, 859, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8731069564819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8862142562866211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 859, 256])
m.shape torch.Size([704, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8869147300720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8869147300720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8882575035095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9089083671569824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([561, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9100866317749023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9100866317749023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9111566543579102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9353876113891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([448, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9367599487304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9367599487304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9376144409179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9654941558837891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([396, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9673800468444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9673800468444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9681353569030762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9962363243103027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.997589111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.997589111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9981613159179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0237674713134766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([260, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256295204162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256295204162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.026125431060791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.053661823272705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0550594329833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0550594329833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0554676055908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0787334442138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0803027153015137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0803027153015137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0806937217712402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1057181358337402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1069645881652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1069645881652832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.107250690460205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1275639533996582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1287107467651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1287107467651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1289434432983398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1470937728881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.14874267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.14874267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1489830017089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1694107055664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1705904006958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1705904006958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1707887649536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1890382766723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1903386116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1903386116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1905369758605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2101750373840332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2112007141113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2112007141113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2113494873046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2271194458007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2282600402832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2282600402832031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2284107208251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2454376220703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2463603019714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2463603019714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.246476650238037  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2604384422302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2611937522888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2611937522888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2612833976745605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2726683616638184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.273573398590088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.273573398590088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2736725807189941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2869629859924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.287874698638916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.287874698638916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2879700660705566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3014168739318848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3021564483642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3021564483642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3022308349609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3132400512695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3139643669128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3139643669128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.314033031463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3246760368347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.325261116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.325261116027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3253145217895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3339662551879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3349084854125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3349084854125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3349885940551758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.348526954650879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([472, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3599190711975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3599190711975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3608193397521973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5205483436584473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 472, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.483841896057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4846673011779785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4854927062988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4846258163452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5537, 40])
input nodes number: 15118
output nodes number: 5537
edges number: 43429
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4847831726074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.48478364944458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027042388916015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 5 input nodes size: 28372
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023897171020507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023897171020507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037425994873046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03746747970581055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01994943618774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28372, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020664691925048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1496, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05389690399169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05389690399169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05532360076904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0670328140258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([1570, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06781673431396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06781673431396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1570, 128]), torch.Size([1, 1570, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06931400299072266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09191513061523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1570, 128])
m.shape torch.Size([1299, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09302473068237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09302473068237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1299, 128]), torch.Size([1, 1299, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09426355361938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12174034118652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1299, 128])
m.shape torch.Size([1072, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12330865859985352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12330865859985352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12433099746704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15467500686645508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([909, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15633106231689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15633106231689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1571979522705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18892240524291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([732, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19068241119384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19068241119384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19138050079345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22139835357666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([632, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2231588363647461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2231588363647461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22376155853271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2548704147338867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([541, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25663280487060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25663280487060547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25714874267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2884531021118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([442, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29009199142456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29009199142456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2905135154724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3174910545349121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([3173, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3324103355407715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3324103355407715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3173, 128]), torch.Size([1, 3173, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3354363441467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5502829551696777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3173, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5226249694824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5339412689208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.545257568359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5338525772094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11866, 256])
first layer input nodes number: 28372
first layer output nodes number: 11866
edges number: 66218
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.54547119140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5567874908447266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5596165657043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5596165657043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1126, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5896792411804199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5896792411804199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1126, 256]), torch.Size([1, 1126, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5924296379089355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6105318069458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1126, 256])
m.shape torch.Size([958, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6117277145385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6117277145385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6135549545288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6412286758422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 958, 256])
m.shape torch.Size([696, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6425995826721191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6425995826721191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6439270973205566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6737351417541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([543, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6751589775085449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6751589775085449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6761946678161621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7071185111999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7085661888122559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7085661888122559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7093462944030762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7378754615783691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7392444610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7392444610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7398262023925781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7675790786743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7689032554626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7689032554626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693610191345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7922492027282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([205, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7935967445373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7935967445373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939877510070801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8162751197814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8176021575927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8176021575927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8179378509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8394222259521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8406195640563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8406195640563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8408904075622559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8601202964782715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610596656799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610596656799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8612523078918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8762784004211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([87, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8771858215332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8771858215332031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8773517608642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8914566040039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8922233581542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8922233581542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8923530578613281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9042854309082031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9049205780029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9049205780029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9050197601318359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9148387908935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9154815673828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9154815673828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9155731201171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9252777099609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9259395599365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9259395599365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9260272979736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9359416961669922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9366168975830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9366168975830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9367008209228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9467716217041016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9472832679748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9472832679748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9473443031311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9550957679748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9555401802062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9555401802062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.955589771270752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9622349739074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9626331329345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9626331329345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9626750946044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9685916900634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.96905517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.96905517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9691009521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9758758544921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9760646820068359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9760646820068359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9760837554931641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9790401458740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9792299270629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9792299270629883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9792470932006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9820280075073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822735786437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822735786437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822945594787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9858403205871582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9891219139099121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9891219139099121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9893832206726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0353732109069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0118489265441895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0126714706420898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0134940147399902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0126299858093262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 11866
output nodes number: 5517
edges number: 29602
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0127573013305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0127577781677246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022138595581054688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 6 input nodes size: 57353
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019946575164794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019946575164794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04729461669921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04733610153198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03376579284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([57353, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035511016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1371, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12694740295410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12694740295410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12825489044189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13871479034423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1535, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14000988006591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14000988006591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1535, 128]), torch.Size([1, 1535, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14147377014160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16343212127685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1535, 128])
m.shape torch.Size([1276, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16467761993408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16467761993408203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1276, 128]), torch.Size([1, 1276, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1658945083618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19266605377197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1276, 128])
m.shape torch.Size([1157, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1943349838256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1943349838256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19543838500976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22743701934814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1136, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22959375381469727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22959375381469727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23067712783813477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26970911026000977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([917, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2717909812927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2717909812927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27266550064086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31122255325317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([922, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31386280059814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31386280059814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3147420883178711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35955810546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([886, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36249828338623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36249828338623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3633432388305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.41304683685302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4169464111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4169464111328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4177112579345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4666614532470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([14075, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5333938598632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5333938598632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14075, 128]), torch.Size([1, 14075, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5468168258666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.499847412109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14075, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4171380996704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4400997161865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4630613327026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4399199485778809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([24077, 256])
first layer input nodes number: 57353
first layer output nodes number: 24077
edges number: 185589
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4634909629821777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.486452579498291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4921932220458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4921932220458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([857, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.539893627166748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.539893627166748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5415282249450684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5546050071716309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([772, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.555318832397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.555318832397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5567913055419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.578878402709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 772, 256])
m.shape torch.Size([565, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.579897403717041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.579897403717041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.58097505569458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6072735786437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([429, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.608384132385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.608384132385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6092023849487305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6347951889038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6366324424743652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6366324424743652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6373419761657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6628851890563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([246, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6639494895935059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6639494895935059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6644186973571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6845946311950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([195, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6857457160949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6857457160949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6861176490783691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.704714298248291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([164, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.705789566040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.705789566040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7061023712158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7239322662353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([142, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7250332832336426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7250332832336426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.725304126739502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.742638111114502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([128, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.743760108947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.743760108947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.744004249572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.761338233947754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7623600959777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7623600959777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.762566089630127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7786335945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([100, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.779714584350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.779714584350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7799053192138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7961177825927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7969970703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7969970703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7971458435058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8108329772949219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.811727523803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.811727523803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8118648529052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.825460433959961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8262138366699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8262138366699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8263225555419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8378467559814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8385000228881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8385000228881836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.838587760925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8485021591186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.849128246307373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.849128246307373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8492064476013184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8585906028747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8594169616699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8594169616699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8595123291015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8716239929199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8725261688232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8725261688232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8726253509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.885915756225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8865966796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8865966796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8866691589355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8968887329101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8975186347961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8975186347961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8975815773010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9068970680236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9075846672058105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9075846672058105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9076495170593262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.917701244354248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9182438850402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9182438850402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9182934761047363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9263272285461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.926971435546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.926971435546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9270267486572266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9363746643066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([883, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.957563877105713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.957563877105713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 883, 256]), torch.Size([1, 883, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9592480659484863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2556653022766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 883, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.213674545288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2144970893859863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2153196334838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2144556045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 24077
output nodes number: 5517
edges number: 48539
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.214676856994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.214677333831787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03864860534667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 7 input nodes size: 39756
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03376579284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03376579284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05329704284667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.053340911865234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025951385498046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([39756, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027215003967285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1481, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08988142013549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08988142013549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1481, 128]), torch.Size([1, 1481, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0912938117980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10259294509887695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1481, 128])
m.shape torch.Size([1473, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10329151153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10329151153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10469627380371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12576770782470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1241, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12684059143066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12684059143066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1241, 128]), torch.Size([1, 1241, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12802410125732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15406131744384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1241, 128])
m.shape torch.Size([1138, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15569591522216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15569591522216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15678119659423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18825435638427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1028, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19016265869140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19016265869140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19114303588867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2276172637939453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([913, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22973918914794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22973918914794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23060989379882812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26842594146728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([802, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27066755294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27066755294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27143239974975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3097500801086426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([765, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3122859001159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3122859001159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3130154609680176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3553023338317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([663, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35778284072875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35778284072875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3584151268005371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.39978790283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([8551, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4402461051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4402461051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 8551, 128]), torch.Size([1, 8551, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.44840097427368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0273966789245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 8551, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9712491035461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9893989562988281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.006617546081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9883327484130859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([18055, 256])
first layer input nodes number: 39756
first layer output nodes number: 18055
edges number: 126531
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0059847831726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.024134635925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0278286933898926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0278286933898926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1007, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.070357322692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.070357322692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1007, 256]), torch.Size([1, 1007, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0722780227661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0876436233520508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1007, 256])
m.shape torch.Size([805, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0891852378845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0891852378845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0907206535339355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1146559715270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([601, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.115621566772461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.115621566772461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1167678833007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1503467559814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1515460014343262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1515460014343262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1524252891540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.177924633026123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([416, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1794843673706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1794843673706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1802778244018555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2100963592529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([343, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2116780281066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2116780281066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2123322486877441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2428669929504395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([269, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2447352409362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2447352409362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2452483177185059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2723722457885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([239, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2739534378051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2739534378051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.274409294128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3003931045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3016963005065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3016963005065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3020339012145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3236403465270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([163, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3250384330749512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3250384330749512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3253493309020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3474230766296387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.348726749420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.348726749420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3489899635314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.369520664215088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.370680809020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.370680809020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.370894432067871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.389052391052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([84, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3899955749511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3899955749511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3901557922363281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4048957824707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4057579040527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4057579040527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4058914184570312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4191093444824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4200663566589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4200663566589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4202017784118652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.434556484222412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4355039596557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4355039596557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4356298446655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.449854850769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.450788974761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.450788974761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4509053230285645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.464867115020752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.465864658355713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.465864658355713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4659810066223145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.480757236480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4817585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4817585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4818692207336426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4966931343078613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4975223541259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4975223541259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.497610092163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5099811553955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.510805606842041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.510805606842041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.510887622833252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5230259895324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5237040519714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5237040519714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5237689018249512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.533820629119873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5343852043151855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5343852043151855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5344367027282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5427794456481934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5435380935668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5435380935668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5436029434204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5545625686645508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([451, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5653672218322754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5653672218322754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5662274360656738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7184081077575684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 451, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6824140548706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6832842826843262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6841545104980469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6832404136657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5837, 40])
input nodes number: 18055
output nodes number: 5837
edges number: 42995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.683466911315918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6834673881530762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02961444854736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 8 input nodes size: 21930
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025999069213867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025999069213867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03645610809326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.036499977111816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01692485809326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21930, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017932891845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([949, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05950641632080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05950641632080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06041145324707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06765174865722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0682377815246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0682377815246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06927633285522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08538293838500977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1087, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08641862869262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08641862869262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08745527267456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11067724227905273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([929, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11193084716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11193084716796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11281681060791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13851356506347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([873, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1401519775390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1401519775390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14098453521728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17095661163330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([776, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1727604866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1727604866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17350053787231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20563507080078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([676, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2075214385986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2075214385986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20816612243652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24059104919433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([605, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24257659912109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24257659912109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24315357208251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2765235900878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([514, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2784409523010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2784409523010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2789311408996582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3115706443786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([5060, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33545351028442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33545351028442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 5060, 128]), torch.Size([1, 5060, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3406224250793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6871304512023926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 5060, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6502165794372559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6621928215026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6741690635681152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6620988845825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12558, 256])
first layer input nodes number: 21930
first layer output nodes number: 12558
edges number: 83923
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6743345260620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6863107681274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6893048286437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6893048286437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([665, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7394509315490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7394509315490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 665, 256]), torch.Size([1, 665, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7407193183898926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7514286041259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 665, 256])
m.shape torch.Size([624, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7523708343505859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7523708343505859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7535610198974609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7720851898193359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([585, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7731771469116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7731771469116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7742929458618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.79962158203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8008208274841309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8008208274841309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8016924858093262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.827115535736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([401, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286070823669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286070823669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8293719291687012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8577885627746582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8601260185241699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8601260185241699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8607687950134277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8886561393737793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([292, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8902993202209473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8902993202209473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8908562660217285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.919217586517334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([266, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9209847450256348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9209847450256348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9214920997619629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9508843421936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([239, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526982307434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526982307434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9531540870666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9823288917541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([196, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9839849472045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9839849472045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9843587875366211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0109014511108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([162, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124273300170898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124273300170898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0127363204956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0368375778198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([149, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0384016036987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0384016036987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0386857986450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0628423690795898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([125, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0642623901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0642623901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0645008087158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.086435317993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([135, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881328582763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881328582763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0883903503417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.113882064819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1153826713562012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1153826713562012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.115598201751709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.138444423675537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1395912170410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1395912170410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1397457122802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1572036743164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([88, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.158564567565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.158564567565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1587324142456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1788740158081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1799321174621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1799321174621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1800580024719238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1960453987121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1969504356384277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1969504356384277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1970515251159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2105975151062012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2118544578552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2118544578552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2119841575622559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.230271816253662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2314386367797852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2314386367797852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2315549850463867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.248774528503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2494568824768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2494568824768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.249523639678955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.259871006011963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2607440948486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2607440948486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2608222961425781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2734909057617188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.274397850036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.274397850036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2744760513305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2876920700073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([574, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.301445484161377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.301445484161377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3025403022766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4958233833312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 574, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4522619247436523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.453134536743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4540071487426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4530906677246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 12558
output nodes number: 5854
edges number: 51261
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.453230857849121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4532313346862793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019837379455566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 9 input nodes size: 23168
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016927242279052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016927242279052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027974605560302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028016090393066406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017515182495117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23168, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018377304077148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1330, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.055609703063964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.055609703063964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1330, 128]), torch.Size([1, 1330, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.056878089904785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06796646118164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1330, 128])
m.shape torch.Size([1248, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06852245330810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06852245330810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1248, 128]), torch.Size([1, 1248, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06971263885498047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08756542205810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1248, 128])
m.shape torch.Size([1108, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08919048309326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08919048309326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09024715423583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1134939193725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([944, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11476612091064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11476612091064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11566638946533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14177417755126953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([840, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1433267593383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1433267593383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14412784576416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17296695709228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([660, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1744546890258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1744546890258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17508411407470703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2029428482055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([589, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20459413528442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20459413528442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2051558494567871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23373794555664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([524, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23545598983764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23545598983764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23595571517944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.265561580657959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([395, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26700687408447266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26700687408447266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2673835754394531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2914924621582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([4367, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31212759017944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31212759017944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4367, 128]), torch.Size([1, 4367, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31629228591918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6235361099243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4367, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5913610458374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6028099060058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6142587661743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6027202606201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12005, 256])
first layer input nodes number: 23168
first layer output nodes number: 12005
edges number: 74626
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6144332885742188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6258821487426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6287446022033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6287446022033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([983, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6692852973937988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6692852973937988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6711602210998535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6867423057556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([755, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6881742477416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6881742477416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6896142959594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7116222381591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([599, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7132382392883301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7132382392883301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7143807411193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.740786075592041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7419414520263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7419414520263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7427978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7683238983154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7697510719299316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7697510719299316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7704873085021973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7969918251037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([284, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7982616424560547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7982616424560547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7988033294677734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8225002288818359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([222, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823723316192627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823723316192627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8241467475891113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8453183174133301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([197, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8466215133666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8466215133666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8469972610473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8684148788452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([150, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8695249557495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8695249557495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8698110580444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8881216049194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8894686698913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8894686698913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8897643089294434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9107546806335449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9120025634765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9120025634765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9122543334960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9318923950195312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9333386421203613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9333386421203613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9335503578186035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9515461921691895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526276588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526276588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9528088569641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9694790840148926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9703707695007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9703707695007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9705100059509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9842944145202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9853205680847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9853205680847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9854655265808105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.000831127166748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0018200874328613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0018200874328613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0019516944885254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0168232917785645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([77, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0180158615112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0180158615112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.018162727355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0357866287231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0365958213806152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0365958213806152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0366930961608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0490469932556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0499300956726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0499300956726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0500273704528809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0630621910095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639748573303223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639748573303223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.064070224761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.077517032623291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0783982276916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0783982276916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0784859657287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0914711952209473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0920405387878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0920405387878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0920958518981934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1006693840026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.101283073425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.101283073425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1013383865356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1102991104125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1109404563903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1109404563903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1109957695007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1203436851501465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([427, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1305761337280273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1305761337280273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1313905715942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2747316360473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 427, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2404069900512695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2412304878234863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2420539855957031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2411890029907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5525, 40])
input nodes number: 12005
output nodes number: 5525
edges number: 40873
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2412710189819336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2412714958190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01999950408935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 10 input nodes size: 23598
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017466068267822266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017466068267822266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02871847152709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02875995635986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01767110824584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23598, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1051, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0537571907043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0537571907043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05475950241088867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1097, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06353473663330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06353473663330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06458091735839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08027362823486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1101, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08184003829956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08184003829956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08289003372192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10665178298950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([832, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10771369934082031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10771369934082031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10850715637207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13154029846191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([739, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1329054832458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1329054832458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13361024856567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1589818000793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([616, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16039180755615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16039180755615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1609792709350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18641424179077148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([546, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1879429817199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1879429817199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18846368789672852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21550321578979492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([517, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21721506118774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21721506118774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21770811080932617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24649667739868164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([461, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2482285499572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2482285499572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24866819381713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27680540084838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([4150, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2963743209838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2963743209838867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4150, 128]), torch.Size([1, 4150, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30033206939697266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.582094669342041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4150, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5514035224914551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5619988441467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.572594165802002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5619158744812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11110, 256])
first layer input nodes number: 23598
first layer output nodes number: 11110
edges number: 70874
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5727720260620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5833673477172852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5860161781311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5860161781311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([808, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6270303726196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6270303726196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6285715103149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6409006118774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 808, 256])
m.shape torch.Size([716, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6417336463928223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6417336463928223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.643099308013916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6647171974182129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([612, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6662635803222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6662635803222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6674308776855469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6931114196777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([483, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6944746971130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6944746971130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6953959465026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7224507331848145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([380, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7238163948059082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7238163948059082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.724541187286377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7545247077941895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([294, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7558579444885254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7558579444885254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7564187049865723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7814278602600098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([250, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.782829761505127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.782829761505127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7833065986633301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8071484565734863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([226, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8086481094360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8086481094360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8090791702270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8336496353149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([197, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8351383209228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8351383209228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8355140686035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595619201660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610467910766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8610467910766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8613786697387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8849420547485352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([168, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8865523338317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8865523338317871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8868727684020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9118666648864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9133048057556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9133048057556152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9135451316833496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9339728355407715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([117, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9353146553039551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9353146553039551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9355378150939941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9560685157775879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9572758674621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9572758674621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9574627876281738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9759678840637207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9771289825439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9771289825439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.977294921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9948844909667969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9956626892089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9956626892089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9957695007324219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0078392028808594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0087337493896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0087337493896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0088443756103516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0221195220947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0230159759521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0230159759521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0231208801269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0364437103271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.037158489227295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.037158489227295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.037238597869873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0479731559753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0488367080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0488367080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0489263534545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0615663528442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622482299804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622482299804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.06231689453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.072479248046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0733757019042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0733757019042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0734596252441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0864677429199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0869784355163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0869784355163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0870261192321777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0947508811950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0953502655029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0953502655029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0954017639160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.104104995727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([391, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1134743690490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1134743690490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.114220142364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2461819648742676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 391, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2112479209899902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2120704650878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.212893009185791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.212028980255127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 11110
output nodes number: 5517
edges number: 41633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2121524810791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2121529579162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.020146846771240234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 11 input nodes size: 20425
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017670154571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017670154571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02740955352783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02745342254638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016159534454345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([20425, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017101764678955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([738, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05391740798950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05391740798950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.054621219635009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.061007022857666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([923, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06153535842895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06153535842895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06241559982299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07561922073364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([879, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07652139663696289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07652139663696289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07735967636108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09672307968139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([861, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0979461669921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0979461669921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09876728057861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12257957458496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([729, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12390708923339844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12390708923339844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1246023178100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15031099319458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([713, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15200328826904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15200328826904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15268325805664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18192195892333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([622, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18365812301635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18365812301635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1842513084411621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21475648880004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([550, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21655797958374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21655797958374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21708250045776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24735498428344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([460, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24906682968139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24906682968139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24950551986694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27758169174194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([4495, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2987961769104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2987961769104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4495, 128]), torch.Size([1, 4495, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3030829429626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6110553741455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4495, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.578737735748291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5891995429992676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5996613502502441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5891175270080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10970, 256])
first layer input nodes number: 20425
first layer output nodes number: 10970
edges number: 74432
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.599815845489502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6102776527404785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6128931045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6128931045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([539, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6635651588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6635651588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6645932197570801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6733770370483398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([601, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6743049621582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6743049621582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6754512786865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6931672096252441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([523, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6942915916442871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6942915916442871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.695289134979248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7179207801818848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([486, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7192907333374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7192907333374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7202177047729492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7470998764038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([408, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7485971450805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7485971450805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7493753433227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7775583267211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([381, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7793664932250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7793664932250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7800931930541992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.812190055847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([340, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8141145706176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8141145706176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.814763069152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8484563827514648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([269, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8502006530761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8502006530761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8507137298583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8804836273193359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([236, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822689056396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822689056396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8827190399169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9115276336669922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([228, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.914459228515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.914459228515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9148941040039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.945770263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([200, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9476675987243652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9476675987243652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9480490684509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9778037071228027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([167, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9795393943786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9795393943786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9798579216003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0069327354431152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([146, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0085978507995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0085978507995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0088763236999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0344958305358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([131, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0361194610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0361194610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0363693237304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.061105728149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622930526733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0622930526733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0624666213989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0808649063110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([96, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.082437515258789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.103128433227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([99, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1046547889709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1046547889709473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1048436164855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1275029182434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([87, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1289138793945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1289138793945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.129079818725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1501541137695312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512036323547363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512036323547363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1513218879699707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.167168140411377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([76, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1685700416564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1685700416564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.168715000152588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1891541481018066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1904544830322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1904544830322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1905841827392578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2097797393798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2107934951782227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2107934951782227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.210890769958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.225968360900879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2270212173461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2270212173461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2271127700805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2419443130493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2429137229919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2429137229919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.242997646331787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2571806907653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([477, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2686004638671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2686004638671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.269510269165039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.429636001586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 477, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3851070404052734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3859796524047852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3868522644042969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3859357833862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 10970
output nodes number: 5854
edges number: 51935
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3861117362976074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3861122131347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018945693969726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 12 input nodes size: 20936
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01620960235595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01620960235595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026192665100097656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026236534118652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016453266143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([20936, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1246, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.050637245178222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.050637245178222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1246, 128]), torch.Size([1, 1246, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.051825523376464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06140470504760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1246, 128])
m.shape torch.Size([1287, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06203794479370117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06203794479370117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06326532363891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08263254165649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1173, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08369684219360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08369684219360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1173, 128]), torch.Size([1, 1173, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08481550216674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10942602157592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1173, 128])
m.shape torch.Size([1013, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11079883575439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11079883575439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11176490783691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1403970718383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([893, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14205598831176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14205598831176758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14290761947631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1743617057800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([721, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17599868774414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17599868774414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17668628692626953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20641756057739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([636, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20819664001464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20819664001464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2088031768798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23926925659179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([555, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24108314514160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24108314514160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24161243438720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27194976806640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([489, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27378368377685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27378368377685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2742500305175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3040962219238281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([3334, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.319760799407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.319760799407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3334, 128]), torch.Size([1, 3334, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3233942985534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5550775527954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3334, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5263667106628418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5371880531311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5480093955993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5371031761169434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11347, 256])
first layer input nodes number: 20936
first layer output nodes number: 11347
edges number: 66815
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5481677055358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5589890480041504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5622882843017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5622882843017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([871, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6027283668518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6027283668518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 871, 256]), torch.Size([1, 871, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6043896675109863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6176800727844238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 871, 256])
m.shape torch.Size([809, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6184048652648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6184048652648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6199479103088379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6438517570495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([654, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6456327438354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6456327438354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6468801498413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.674616813659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([519, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6759886741638184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6759886741638184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.676978588104248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.705686092376709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([418, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7072000503540039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7072000503540039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7079973220825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7368173599243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([340, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7383794784545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7383794784545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7390279769897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7674474716186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([325, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693099975585938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693099975585938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7699298858642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8024740219116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([254, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8041172027587891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8041172027587891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8046016693115234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8322162628173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([227, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8339376449584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8339376449584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8343706130981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8620805740356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([184, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8636326789855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8636326789855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8639836311340332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8889012336730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([160, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8904175758361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8904175758361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8907227516174316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9145264625549316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9157810211181641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9157810211181641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9160137176513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9357929229736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([116, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9371261596679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9371261596679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.937347412109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.95770263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.958808422088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.958808422088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9589705467224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9750208854675293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9761943817138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9761943817138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9763603210449219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9939498901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9950971603393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9950971603393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9952497482299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124921798706055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0132331848144531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0132331848144531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0133285522460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0247726440429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256075859069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0256075859069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0257048606872559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0380587577819824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.038978099822998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.038978099822998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.039079189300537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0526251792907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0536117553710938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0536117553710938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0537128448486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0679664611816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0686631202697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0686631202697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0687336921691895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0791783332824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.079798698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.079798698425293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0798578262329102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0890226364135742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.089545726776123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.089545726776123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0895934104919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.097318172454834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0977330207824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0977330207824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0977692604064941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.103893756866455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([283, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1106758117675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1106758117675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.111215591430664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.208371639251709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 283, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.174494743347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1753673553466797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1762399673461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.175323486328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5853, 40])
input nodes number: 11347
output nodes number: 5853
edges number: 40754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1754522323608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.175452709197998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.01883840560913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 13 input nodes size: 29775
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016453266143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016453266143798828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030651092529296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.030694961547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02066802978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([29775, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021581649780273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1434, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06254196166992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06254196166992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1434, 128]), torch.Size([1, 1434, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06390953063964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07485008239746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1434, 128])
m.shape torch.Size([1471, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07556915283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07556915283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1471, 128]), torch.Size([1, 1471, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07697200775146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09801483154296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1471, 128])
m.shape torch.Size([1399, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1000676155090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1000676155090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1399, 128]), torch.Size([1, 1399, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10140180587768555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1313319206237793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1399, 128])
m.shape torch.Size([1234, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13301849365234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13301849365234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1234, 128]), torch.Size([1, 1234, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13419532775878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16902542114257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1234, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17091894149780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17091894149780273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17191171646118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20808029174804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([926, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21023321151733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21023321151733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21111631393432617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24912023544311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([724, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2510952949523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2510952949523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2517857551574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28701066970825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([681, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2892632484436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2892632484436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28991270065307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3269791603088379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([540, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32897186279296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32897186279296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3294868469238281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36307668685913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([4245, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38306093215942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38306093215942383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4245, 128]), torch.Size([1, 4245, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38710927963256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.675605297088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4245, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6407022476196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6537628173828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6668233871459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.653660774230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([13695, 256])
first layer input nodes number: 29775
first layer output nodes number: 13695
edges number: 82096
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6670475006103516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6801080703735352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.683445930480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.683445930480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([950, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7239594459533691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7239594459533691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 950, 256]), torch.Size([1, 950, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.725771427154541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.740267276763916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 950, 256])
m.shape torch.Size([800, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7418270111083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7418270111083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7433528900146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7670350074768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([645, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.768132209777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.768132209777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7693624496459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7972002029418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([516, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7985692024230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7985692024230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.799553394317627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8289265632629395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([435, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8305249214172363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8305249214172363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8313546180725098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8618922233581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([367, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8635940551757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8635940551757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8642940521240234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8947658538818359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8962864875793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8962864875793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8968167304992676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9271559715270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([253, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9294791221618652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9294791221618652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9299616813659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9574675559997559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([215, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9590864181518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9590864181518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9594964981079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9857416152954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.987267017364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.987267017364502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9876103401184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.011986255645752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([149, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.013390064239502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.013390064239502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.013674259185791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.035841464996338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0370030403137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0370030403137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0372185707092285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0555386543273926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0567803382873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0567803382873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0569863319396973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0759377479553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0769920349121094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0769920349121094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0771560668945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0933952331542969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.094538688659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.094538688659668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.094700813293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1118860244750977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.112666130065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.112666130065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1127729415893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.124842643737793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1256389617919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1256389617919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1257381439208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1376399993896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1384382247924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1384382247924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1385316848754883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1504011154174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512126922607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1512126922607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1513023376464844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1633148193359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.164039134979248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.164039134979248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1641154289245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.174872875213623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1752386093139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1752386093139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.175276756286621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.180922508239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1814956665039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1814956665039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.181549072265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1898269653320312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.190441608428955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.190441608428955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1904969215393066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1994576454162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2000761032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2000761032104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.200129508972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2091550827026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([325, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.21693754196167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.21693754196167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.217557430267334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.330817699432373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 325, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2969012260437012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.297773838043213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2986464500427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2977299690246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 13695
output nodes number: 5854
edges number: 40364
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2978758811950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2978763580322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023390769958496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 14 input nodes size: 16257
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02066802978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02066802978515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028419971466064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02846384048461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([16257, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014809608459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1506, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0390324592590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0390324592590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1506, 128]), torch.Size([1, 1506, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.040468692779541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05273866653442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1506, 128])
m.shape torch.Size([1556, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05350446701049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05350446701049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1556, 128]), torch.Size([1, 1556, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05498838424682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07724714279174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1556, 128])
m.shape torch.Size([1285, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07834339141845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07834339141845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10744905471801758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1004, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11016845703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13831710815429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([878, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13993167877197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13993167877197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14076900482177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17112350463867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([670, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1726217269897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1726217269897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17326068878173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20172548294067383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([543, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2032184600830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2032184600830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2037363052368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23058748245239258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([428, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23196125030517578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23196125030517578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23236942291259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25563526153564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([358, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25696754455566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25696754455566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2573089599609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2791595458984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([1641, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28681373596191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28681373596191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2883787155151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40270423889160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.383664608001709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3937840461730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4039034843444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3937101364135742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([9869, 256])
first layer input nodes number: 16257
first layer output nodes number: 9869
edges number: 47756
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4033193588256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4134387969970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4150843620300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4150843620300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1077, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4468111991882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4468111991882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1077, 256]), torch.Size([1, 1077, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.44911670684814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46642589569091797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1077, 256])
m.shape torch.Size([964, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.467252254486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.467252254486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 964, 256]), torch.Size([1, 964, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46909093856811523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.496671199798584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 964, 256])
m.shape torch.Size([761, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.49794626235961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.49794626235961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.49939775466918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5313305854797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([595, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5328927040100098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5328927040100098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5340275764465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.567415714263916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 595, 256])
m.shape torch.Size([500, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.569251537322998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.569251537322998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5702052116394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6057066917419434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([378, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6074099540710449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6074099540710449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.608130931854248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6405863761901855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([303, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6422648429870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6422648429870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6428427696228027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6723084449768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([231, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6737957000732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6737957000732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6742362976074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6993503570556641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7007045745849609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7007045745849609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7010517120361328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7232685089111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7245850563049316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7245850563049316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7248806953430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7458710670471191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7468767166137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7468767166137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7470827102661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7631502151489258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7641892433166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7641892433166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7643780708312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.780428409576416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7811713218688965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7811713218688965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7812991142272949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7930560111999512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939743995666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939743995666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7941136360168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8078980445861816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8088088035583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8088088035583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8089385032653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8226866722106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823267936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.823267936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8233480453491211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8324003219604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8330302238464355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8330302238464355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8331084251403809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8424925804138184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8430767059326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8430767059326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8431453704833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8518657684326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8521237373352051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8521237373352051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8521542549133301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8562436103820801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8564977645874023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8564977645874023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8565244674682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8602895736694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8606600761413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8606600761413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8606963157653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8660597801208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.866337776184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.866337776184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8663644790649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8705034255981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8708000183105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8708000183105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8708267211914062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.875152587890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8754854202270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8754854202270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.875514030456543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8803491592407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([81, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822813034057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8822813034057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8824357986450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9096269607543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8855376243591309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8864102363586426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8872828483581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8863663673400879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5853, 40])
input nodes number: 9869
output nodes number: 5853
edges number: 30897
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8864841461181641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8864846229553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.016037464141845703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 15 input nodes size: 25971
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026606082916259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026649951934814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.018854141235351562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([25971, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1161, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.058837890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.058837890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.059945106506347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06930685043334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([1366, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07036924362182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07036924362182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07167196273803711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09121274948120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1223, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09231090545654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09231090545654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09347724914550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12000656127929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([1124, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12157249450683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12157249450683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12264442443847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.153778076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([919, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15543317794799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15543317794799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1563096046447754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18786144256591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([750, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18956899642944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18956899642944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19028425216674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2218317985534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([677, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22373390197753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22373390197753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2243795394897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25666141510009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([650, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2588181495666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2588181495666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25943803787231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29591989517211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([571, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29806041717529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29806041717529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29860496520996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3337826728820801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([4230, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3536806106567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3536806106567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4230, 128]), torch.Size([1, 4230, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3577146530151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6450262069702148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6113600730895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6234440803527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6355280876159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.623349666595459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12671, 256])
first layer input nodes number: 25971
first layer output nodes number: 12671
edges number: 78531
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6357235908508301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6478075981140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6508288383483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6508288383483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([784, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6945767402648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6945767402648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 784, 256]), torch.Size([1, 784, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6960721015930176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7080650329589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 784, 256])
m.shape torch.Size([768, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7087936401367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7087936401367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 768, 256]), torch.Size([1, 768, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7102584838867188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7323541641235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 768, 256])
m.shape torch.Size([621, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7334127426147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7334127426147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7345972061157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7608346939086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([514, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7622189521789551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7622189521789551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7631993293762207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.792290210723877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([453, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939772605895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7939772605895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7948412895202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8266587257385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([312, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.828026294708252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.828026294708252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8286213874816895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8581085205078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595671653747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595671653747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8600649833679199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8857240676879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([271, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8875589370727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8875589370727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8880758285522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9176568984985352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([215, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9192585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9192585945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9196686744689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9459137916564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([193, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9475641250610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9475641250610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.947932243347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9740686416625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9753122329711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9753122329711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9755697250366211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9956541061401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9971632957458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9971632957458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.997434139251709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0204558372497559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([125, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0218825340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0218825340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0221209526062012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.044055461883545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([120, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0455513000488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0455513000488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0457801818847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0684394836425781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0695505142211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0695505142211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0697126388549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.086897850036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([85, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881242752075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0881242752075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0882863998413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1066064834594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1076693534851074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1076693534851074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1078028678894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1238245964050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1249170303344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1249170303344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.125044822692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1412744522094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1422152519226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1422152519226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.142320156097412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1563773155212402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.157247543334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.157247543334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.157339096069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.170248031616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1710500717163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1710500717163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1711301803588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1829862594604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1836867332458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1836867332458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.183753490447998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1941008567810059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1949076652526855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1949076652526855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1949801445007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2067217826843262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes
[05:31:09] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 16 parts and get 6594759 edge cuts

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2074236869812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2074236869812012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2074847221374512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2177996635437012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([377, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2268280982971191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2268280982971191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2275471687316895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3582520484924316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 377, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3209171295166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3217887878417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3226604461669922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3217449188232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5848, 40])
input nodes number: 12671
output nodes number: 5848
edges number: 44485
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3218822479248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.321882724761963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021562576293945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112960815429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112960815429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011991932988166809 |0.022493749856948853 |0.14989101886749268 |9.918212890625e-05 |0.0753268152475357 |0.005780935287475586 |
----------------------------------------------------------pseudo_mini_loss sum 5.340816974639893
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  857730
Number of first layer input nodes during this epoch:  583936
Number of first layer output nodes during this epoch:  273794
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112483978271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0287017822265625
global_2_local spend time (sec) 0.052709341049194336
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.007897138595581055
A = g.adjacency_matrix() spent  0.013360261917114258
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08159470558166504
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.331303596496582
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1834967136383057

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.329 seconds
Metis partitioning: 5.686 seconds
Split the graph: 1.193 seconds
Construct subgraphs: 0.111 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.333370447158813
5854
5845
5854
5794
5746
5652
5569
5621
5852
5686
5518
5517
5854
5517
5528
5534
total k batches seeds list generation spend  18.308476448059082
after graph partition
graph partition algorithm spend time 18.391918182373047
5854
5845
5854
5794
5746
5652
5569
5621
5852
5686
5518
5517
5854
5517
5528
5534
partition_len_list
[11752, 11539, 14170, 11290, 10940, 10277, 12327, 12197, 14503, 12846, 16540, 19036, 26705, 27726, 28172, 27322]
shared_neighbor_graph_partition_s0 selection method  spend 18.49961256980896
time for parepare:  0.017644405364990234
local_output_nid generation:  0.0013709068298339844
local_in_edges_tensor generation:  0.0017633438110351562
mini_batch_src_global generation:  0.0016143321990966797
r_  generation:  0.01475667953491211
local_output_nid generation:  0.0015614032745361328
local_in_edges_tensor generation:  0.0013113021850585938
mini_batch_src_global generation:  0.0013899803161621094
r_  generation:  0.013199329376220703
local_output_nid generation:  0.0017468929290771484
local_in_edges_tensor generation:  0.0013496875762939453
mini_batch_src_global generation:  0.0016529560089111328
r_  generation:  0.016971349716186523
local_output_nid generation:  0.0017981529235839844
local_in_edges_tensor generation:  0.0011878013610839844
mini_batch_src_global generation:  0.0014503002166748047
r_  generation:  0.010999202728271484
local_output_nid generation:  0.0017695426940917969
local_in_edges_tensor generation:  0.0011982917785644531
mini_batch_src_global generation:  0.001310586929321289
r_  generation:  0.015606403350830078
local_output_nid generation:  0.0018069744110107422
local_in_edges_tensor generation:  0.0011658668518066406
mini_batch_src_global generation:  0.0013294219970703125
r_  generation:  0.014418363571166992
local_output_nid generation:  0.0017974376678466797
local_in_edges_tensor generation:  0.0011997222900390625
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.014803647994995117
local_output_nid generation:  0.0018610954284667969
local_in_edges_tensor generation:  0.0011928081512451172
mini_batch_src_global generation:  0.001383066177368164
r_  generation:  0.015493154525756836
local_output_nid generation:  0.001977682113647461
local_in_edges_tensor generation:  0.0012178421020507812
mini_batch_src_global generation:  0.0012040138244628906
r_  generation:  0.013683557510375977
local_output_nid generation:  0.0019197463989257812
local_in_edges_tensor generation:  0.0011703968048095703
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.013233184814453125
local_output_nid generation:  0.002169370651245117
local_in_edges_tensor generation:  0.0011081695556640625
mini_batch_src_global generation:  0.0013124942779541016
r_  generation:  0.010706901550292969
local_output_nid generation:  0.0018107891082763672
local_in_edges_tensor generation:  0.001096963882446289
mini_batch_src_global generation:  0.0012288093566894531
r_  generation:  0.013813257217407227
local_output_nid generation:  0.0018990039825439453
local_in_edges_tensor generation:  0.0019838809967041016
mini_batch_src_global generation:  0.0022530555725097656
r_  generation:  0.024977684020996094
local_output_nid generation:  0.0020134449005126953
local_in_edges_tensor generation:  0.0013315677642822266
mini_batch_src_global generation:  0.002147197723388672
r_  generation:  0.020506858825683594
local_output_nid generation:  0.002074003219604492
local_in_edges_tensor generation:  0.0013308525085449219
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.01873636245727539
local_output_nid generation:  0.0020432472229003906
local_in_edges_tensor generation:  0.0013289451599121094
mini_batch_src_global generation:  0.0018818378448486328
r_  generation:  0.022485733032226562
----------------------check_connections_block total spend ----------------------------- 0.4124000072479248
generate_one_block  0.02696537971496582
generate_one_block  0.019342422485351562
generate_one_block  0.023692846298217773
generate_one_block  0.015784740447998047
generate_one_block  0.019839763641357422
generate_one_block  0.01991105079650879
generate_one_block  0.020104408264160156
generate_one_block  0.020906925201416016
generate_one_block  0.018743515014648438
generate_one_block  0.01772141456604004
generate_one_block  0.0170135498046875
generate_one_block  0.021514892578125
generate_one_block  0.03753829002380371
generate_one_block  0.029880285263061523
generate_one_block  0.026929616928100586
generate_one_block  0.032002925872802734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038690805435180664
gen group dst list time:  0.007806539535522461
time for parepare:  0.02231121063232422
local_output_nid generation:  0.0024733543395996094
local_in_edges_tensor generation:  0.0064890384674072266
mini_batch_src_global generation:  0.002359151840209961
r_  generation:  0.024800539016723633
local_output_nid generation:  0.0032961368560791016
local_in_edges_tensor generation:  0.002580404281616211
mini_batch_src_global generation:  0.0023937225341796875
r_  generation:  0.024199724197387695
local_output_nid generation:  0.003957986831665039
local_in_edges_tensor generation:  0.0036029815673828125
mini_batch_src_global generation:  0.0031280517578125
r_  generation:  0.03451395034790039
local_output_nid generation:  0.0032570362091064453
local_in_edges_tensor generation:  0.002413511276245117
mini_batch_src_global generation:  0.002226114273071289
r_  generation:  0.02366471290588379
local_output_nid generation:  0.0031032562255859375
local_in_edges_tensor generation:  0.0025603771209716797
mini_batch_src_global generation:  0.0019991397857666016
r_  generation:  0.025035619735717773
local_output_nid generation:  0.002790212631225586
local_in_edges_tensor generation:  0.0021228790283203125
mini_batch_src_global generation:  0.0018725395202636719
r_  generation:  0.02239370346069336
local_output_nid generation:  0.003238201141357422
local_in_edges_tensor generation:  0.0025136470794677734
mini_batch_src_global generation:  0.002167940139770508
r_  generation:  0.02824544906616211
local_output_nid generation:  0.0031766891479492188
local_in_edges_tensor generation:  0.0032112598419189453
mini_batch_src_global generation:  0.0024268627166748047
r_  generation:  0.028321504592895508
local_output_nid generation:  0.003879547119140625
local_in_edges_tensor generation:  0.0029909610748291016
mini_batch_src_global generation:  0.0026509761810302734
r_  generation:  0.03232622146606445
local_output_nid generation:  0.0035343170166015625
local_in_edges_tensor generation:  0.002885103225708008
mini_batch_src_global generation:  0.0024862289428710938
r_  generation:  0.027991771697998047
local_output_nid generation:  0.004404544830322266
local_in_edges_tensor generation:  0.004507541656494141
mini_batch_src_global generation:  0.0033750534057617188
r_  generation:  0.037502288818359375
local_output_nid generation:  0.005074262619018555
local_in_edges_tensor generation:  0.00501561164855957
mini_batch_src_global generation:  0.005220890045166016
r_  generation:  0.04751181602478027
local_output_nid generation:  0.0066487789154052734
local_in_edges_tensor generation:  0.007848978042602539
mini_batch_src_global generation:  0.008717775344848633
r_  generation:  0.07880687713623047
local_output_nid generation:  0.007228851318359375
local_in_edges_tensor generation:  0.00769352912902832
mini_batch_src_global generation:  0.009076356887817383
r_  generation:  0.07913899421691895
local_output_nid generation:  0.007512092590332031
local_in_edges_tensor generation:  0.0061838626861572266
mini_batch_src_global generation:  0.009752988815307617
r_  generation:  0.08446979522705078
local_output_nid generation:  0.007313251495361328
local_in_edges_tensor generation:  0.0068895816802978516
mini_batch_src_global generation:  0.010340452194213867
r_  generation:  0.08142566680908203
----------------------check_connections_block total spend ----------------------------- 1.0774774551391602
generate_one_block  0.04233288764953613
generate_one_block  0.03179454803466797
generate_one_block  0.04589104652404785
generate_one_block  0.029874086380004883
generate_one_block  0.032858848571777344
generate_one_block  0.02893543243408203
generate_one_block  0.035568952560424805
generate_one_block  0.03601527214050293
generate_one_block  0.043649911880493164
generate_one_block  0.036170244216918945
generate_one_block  0.051052093505859375
generate_one_block  0.06574368476867676
generate_one_block  0.10697460174560547
generate_one_block  0.1057898998260498
generate_one_block  0.15130257606506348
generate_one_block  0.10571908950805664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027112483978271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

connection checking time:  1.0774774551391602
block generation total time  0.9496731758117676
average batch blocks generation time:  0.059354573488235474
block dataloader generation time/epoch 21.52353596687317
pseudo mini batch 0 input nodes size: 22204
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024402618408203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024402618408203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03499031066894531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0350341796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022606372833251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023460865020751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023460865020751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023460865020751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22204, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023460865020751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1180, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05896615982055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05896615982055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1180, 128]), torch.Size([1, 1180, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.060091495513916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06968927383422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1180, 128])
m.shape torch.Size([1211, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0702815055847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0702815055847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07143640518188477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08967828750610352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1191, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0908045768737793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0908045768737793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1191, 128]), torch.Size([1, 1191, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09194040298461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1169285774230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1191, 128])
m.shape torch.Size([998, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11826419830322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11826419830322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1192159652709961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14750385284423828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([951, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14929533004760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14929533004760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15020227432250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1837911605834961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([784, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18558073043823242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18558073043823242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18632841110229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21927165985107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([679, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22116422653198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22116422653198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22181177139282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25461769104003906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([598, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2565751075744629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2565751075744629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25714540481567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2898392677307129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([531, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29183292388916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29183292388916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2923393249511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3256688117980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([3629, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.34272003173828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.34272003173828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3629, 128]), torch.Size([1, 3629, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.346677303314209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5963306427001953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3629, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5651869773864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5763945579528809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5876021385192871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5763068199157715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11752, 256])
first layer input nodes number: 22204
first layer output nodes number: 11752
edges number: 71232
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5877695083618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5989770889282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6017789840698242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6017789840698242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([789, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6444301605224609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6444301605224609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 789, 256]), torch.Size([1, 789, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.64593505859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6579742431640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 789, 256])
m.shape torch.Size([715, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6594595909118652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6594595909118652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6608233451843262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6819033622741699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([639, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6839137077331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6839137077331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 639, 256]), torch.Size([1, 639, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6851325035095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.712949275970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 639, 256])
m.shape torch.Size([493, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7142353057861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7142353057861328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7151756286621094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7435779571533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([426, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7451553344726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7451553344726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7459678649902344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7752189636230469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([373, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7769637107849121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7769637107849121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7776751518249512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8090014457702637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([344, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8111205101013184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8111205101013184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8117766380310059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8445830345153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([256, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8462233543395996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8462233543395996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8467116355895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8745436668395996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([234, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8763236999511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8763236999511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.87677001953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.90533447265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([203, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9070625305175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9070625305175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9074497222900391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9349403381347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([162, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9364595413208008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9364595413208008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9367685317993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9608697891235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([143, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.962364673614502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.962364673614502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9626374244689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9858212471008301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([127, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.987271785736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.987271785736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9875140190124512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0097994804382324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.010937213897705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.010937213897705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.011110782623291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0282940864562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.029548168182373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.029548168182373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0297255516052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0485281944274902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([89, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0498085021972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0498085021972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.049978256225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0691604614257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0700945854187012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0700945854187012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0702109336853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0841727256774902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0852346420288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0852346420288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0853471755981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0996389389038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1007513999938965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1007513999938965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1008715629577637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1169734001159668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1180477142333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1180477142333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1181602478027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1340274810791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1346778869628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1346778869628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.134744644165039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1446247100830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1452679634094238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1452679634094238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1453289985656738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1547894477844238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1553783416748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1553783416748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1554317474365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.164083480834961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1646337509155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1646337509155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1646814346313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1727399826049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1802854537963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1802854537963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1808862686157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2884750366210938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2522978782653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2531704902648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2540431022644043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.253126621246338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 11752
output nodes number: 5854
edges number: 43344
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2532591819763184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2532601356506348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025135040283203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 1 input nodes size: 22421
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022608280181884766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022608280181884766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03329944610595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03334331512451172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022711753845214844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023473739624023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023473739624023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023473739624023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22421, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023473739624023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1350, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.056288719177246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.056288719177246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1350, 128]), torch.Size([1, 1350, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05757617950439453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06787586212158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1350, 128])
m.shape torch.Size([1473, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06863689422607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06863689422607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07004165649414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09111309051513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1312, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09228754043579102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09228754043579102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1312, 128]), torch.Size([1, 1312, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09353876113891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12120294570922852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1312, 128])
m.shape torch.Size([1130, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12273263931274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12273263931274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1238102912902832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15506219863891602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([878, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1566166877746582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1566166877746582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1574540138244629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18827390670776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([729, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1899409294128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1899409294128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19063615798950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2207350730895996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([620, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2224569320678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2224569320678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22304821014404297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25303173065185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([581, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25495243072509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25495243072509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2555065155029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28847551345825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([482, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2902669906616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2902669906616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2907266616821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3201456069946289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([2984, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33414459228515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33414459228515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 2984, 128]), torch.Size([1, 2984, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3369903564453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5398931503295898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 2984, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5126786231994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5236830711364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5346875190734863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5235967636108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11539, 256])
first layer input nodes number: 22421
first layer output nodes number: 11539
edges number: 64682
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5348567962646484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5458612442016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5486125946044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5486125946044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([954, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.585761547088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.585761547088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 954, 256]), torch.Size([1, 954, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5875811576843262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6021380424499512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 954, 256])
m.shape torch.Size([859, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.602879524230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.602879524230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 859, 256]), torch.Size([1, 859, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.604517936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6291646957397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 859, 256])
m.shape torch.Size([691, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.630338191986084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.630338191986084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 691, 256]), torch.Size([1, 691, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6316561698913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6611084938049316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 691, 256])
m.shape torch.Size([555, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6625833511352539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6625833511352539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6636419296264648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6948175430297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([467, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6965327262878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6965327262878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6974234580993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7306170463562012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([336, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.732109546661377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.732109546661377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.732750415802002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7611479759216309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.762603759765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.762603759765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7631072998046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7892985343933105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([272, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7911381721496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7911381721496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7916569709777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8212285041809082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([197, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8226733207702637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8226733207702637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8230490684509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8470969200134277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([178, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8486199378967285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8486199378967285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8489594459533691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8730645179748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8743119239807129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8743119239807129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8745675086975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.894503116607666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8957247734069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8957247734069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8959479331970215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9149165153503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9160628318786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9160628318786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9162459373474121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9330916404724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9341979026794434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9341979026794434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9343676567077637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9511733055114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9521265029907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9521265029907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9522638320922852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9668207168579102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9677209854125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9677209854125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9678411483764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.981419563293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822421073913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9822421073913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9823451042175293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9947047233581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9955010414123535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9955010414123535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9955945014953613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0074639320373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.008129596710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.008129596710205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0082039833068848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.018171787261963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0186152458190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0186152458190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.018662929534912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0253863334655762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0260891914367676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0260891914367676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0261578559875488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0363202095031738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0368356704711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0368356704711914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0368852615356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.044571876525879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0451221466064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0451221466064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0451717376708984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0532054901123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0536422729492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0536422729492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.053680419921875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0601272583007812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([226, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0655388832092285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0655388832092285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0659699440002441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1418366432189941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 226, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1113524436950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1122236251831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1130948066711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1121797561645508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5845, 40])
input nodes number: 11539
output nodes number: 5845
edges number: 37450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1123085021972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1123089790344238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02500629425048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 2 input nodes size: 33266
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022710323333740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022710323333740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03857278823852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03861665725708008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027881622314453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02900409698486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02900409698486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02900409698486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([33266, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02900409698486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([991, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07771587371826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07771587371826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07866096496582031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08622169494628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([1111, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08752775192260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08752775192260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08858728408813477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10448026657104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1068, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10547828674316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10547828674316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10649681091308594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1289043426513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([970, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13024520874023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13024520874023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13117027282714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1582794189453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([954, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16009140014648438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16009140014648438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16100120544433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19442081451416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([791, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1962289810180664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1962289810180664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19698333740234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22942066192626953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([730, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2319788932800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2319788932800293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23267507553100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2676854133605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([703, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2700190544128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2700190544128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2706894874572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3101649284362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([565, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3122544288635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3122544288635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3127932548522949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3478584289550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([6287, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37756776809692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37756776809692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 6287, 128]), torch.Size([1, 6287, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3835635185241699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8092617988586426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 6287, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7673463821411133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7808599472045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7943735122680664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7807540893554688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14170, 256])
first layer input nodes number: 33266
first layer output nodes number: 14170
edges number: 98502
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7946233749389648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8081369400024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8115153312683105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8115153312683105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([664, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8624215126037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8624215126037598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8636879920959473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8747715950012207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([645, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8754196166992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8754196166992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8766498565673828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8951668739318848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([533, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8961076736450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8961076736450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8971242904663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9200754165649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([468, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9213666915893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9213666915893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9222593307495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9493417739868164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([398, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9508085250854492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9508085250854492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9515676498413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9792976379394531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9808616638183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9808616638183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9815044403076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0094566345214844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([293, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0115485191345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0115485191345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0121073722839355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0425963401794434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0443391799926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0443391799926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0448408126831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.075582504272461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0772089958190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0772089958190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.077622890472412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.104112148284912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([205, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1058759689331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1058759689331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.106266975402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.134028434753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.135450839996338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.135450839996338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1357426643371582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1585049629211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1600661277770996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1600661277770996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1603484153747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.184342861175537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([139, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.185938835144043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.185938835144043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.186203956604004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2105951309204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([129, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2121987342834473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2121987342834473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.21244478225708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2368035316467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([112, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.238295555114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.238295555114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.238509178161621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.261153221130371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([87, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2623844146728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2623844146728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2625503540039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.281301498413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([88, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2826566696166992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2826566696166992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2828245162963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3029661178588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3040070533752441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3040070533752441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.304131031036377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3198761940002441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3208189010620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3208189010620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3209238052368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3349809646606445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.336435317993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.336435317993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3365516662597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.352956771850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3539280891418457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3539280891418457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3540253639221191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.368422031402588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3695788383483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3695788383483887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.369687557220459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3865389823913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3870816230773926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3870816230773926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3871331214904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3954758644104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3963727951049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3963727951049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.396449089050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4093427658081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([619, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.424178123474121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.424178123474121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.425358772277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6343088150024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 619, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5899529457092285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5908255577087402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.591698169708252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5907816886901855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 14170
output nodes number: 5854
edges number: 52051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.590932846069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5909333229064941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.031147480010986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 3 input nodes size: 23617
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027883052825927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027883052825927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03914451599121094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03918790817260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023281574249267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02396249771118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02396249771118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02396249771118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([23617, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02396249771118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1632, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.054913997650146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.054913997650146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.056470394134521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06892156600952148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([1591, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07018756866455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07018756866455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07170486450195312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09446430206298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1308, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09557676315307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09557676315307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1308, 128]), torch.Size([1, 1308, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09682416915893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1242671012878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1308, 128])
m.shape torch.Size([1044, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1257948875427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1257948875427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12679052352905273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15566396713256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([873, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15724754333496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15724754333496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1580801010131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18805217742919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([666, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18954133987426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18954133987426758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19017648696899414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2188568115234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([563, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22041845321655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22041845321655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22095537185668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24811410903930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([484, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24969196319580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24969196319580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2501535415649414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27646350860595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([406, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27797508239746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27797508239746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2783622741699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3031425476074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([2723, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3159332275390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3159332275390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 2723, 128]), torch.Size([1, 2723, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3192143440246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5040297508239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 2723, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4785451889038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.48931217193603516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5000791549682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4892277717590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11290, 256])
first layer input nodes number: 23617
first layer output nodes number: 11290
edges number: 59972
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5002574920654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5110244750976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5137162208557129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5137162208557129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1217, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5453915596008301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5453915596008301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1217, 256]), torch.Size([1, 1217, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5479578971862793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5682053565979004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1217, 256])
m.shape torch.Size([1000, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5693812370300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5693812370300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1000, 256]), torch.Size([1, 1000, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5712885856628418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6005129814147949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1000, 256])
m.shape torch.Size([762, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6017565727233887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6017565727233887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 762, 256]), torch.Size([1, 762, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6032099723815918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6351847648620605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 762, 256])
m.shape torch.Size([554, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6372919082641602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6372919082641602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6383485794067383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6695032119750977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([434, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6710605621337891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6710605621337891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6718883514404297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7025947570800781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7040090560913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7040090560913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7046136856079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7319421768188477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.733302116394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.733302116394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7337732315063477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.757328987121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7586851119995117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7586851119995117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7590799331665039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7815847396850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.782806396484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.782806396484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7831192016601562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8031387329101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([127, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8042030334472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8042030334472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8044452667236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8216438293457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([98, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8225774765014648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8225774765014648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8227643966674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8373441696166992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8383274078369141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8383274078369141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8384933471679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8525981903076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8533401489257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8533401489257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8534660339355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8650474548339844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.865725040435791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.865725040435791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8658299446105957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8762154579162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8770570755004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8770570755004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8771753311157227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8897104263305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8901128768920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8901128768920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8901700973510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8966360092163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.897212028503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.897212028503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.897282600402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9057512283325195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9063043594360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9063043594360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9063692092895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9146051406860352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.915102481842041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.915102481842041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9151577949523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.922569751739502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9228305816650391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9228305816650391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9228591918945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9268932342529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9272222518920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9272222518920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9272546768188477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9320535659790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9323759078979492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9323759078979492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9324064254760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9371366500854492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9376301765441895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9376301765441895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9376740455627441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9447808265686035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9451742172241211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9451742172241211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9452085494995117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9510107040405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([178, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9552707672119141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9552707672119141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9556102752685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0153636932373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 178, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9902811050415039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9911446571350098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9920082092285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9911012649536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5794, 40])
input nodes number: 11290
output nodes number: 5794
edges number: 31294
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9912199974060059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9912204742431641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025363445281982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 4 input nodes size: 21693
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02327251434326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02327251434326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03361654281616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03365945816040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022354602813720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023250102996826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023250102996826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023250102996826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21693, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023250102996826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([776, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.059136390686035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.059136390686035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.059876441955566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0658578872680664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([963, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06640625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06732463836669922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08110380172729492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([934, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08198070526123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08198070526123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 934, 128]), torch.Size([1, 934, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0828714370727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10279273986816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 934, 128])
m.shape torch.Size([893, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1040506362915039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1040506362915039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10490226745605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13039493560791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([786, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13184309005737305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13184309005737305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13259267807006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16033601760864258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([746, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1620955467224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1620955467224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16280698776245117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19339895248413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([622, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19511938095092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19511938095092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19571256637573242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2263188362121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([556, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22814321517944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22814321517944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22867345809936523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2596449851989746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([444, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26128530502319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26128530502319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26170873641967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28880834579467773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([4220, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3087191581726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3087191581726074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4220, 128]), torch.Size([1, 4220, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3127436637878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5984835624694824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4220, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5669164657592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5773496627807617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5877828598022461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.577268123626709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10940, 256])
first layer input nodes number: 21693
first layer output nodes number: 10940
edges number: 72480
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5879464149475098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5983796119689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6018128395080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6018128395080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([597, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6483035087585449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6483035087585449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.649442195892334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6592135429382324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([602, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6600742340087891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6600742340087891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6612224578857422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6784458160400391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([564, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6795058250427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6795058250427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6805815696716309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7048544883728027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([488, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7061929702758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7061929702758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7071237564086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7350320816040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([425, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7366094589233398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7366094589233398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7374200820922852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7666997909545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([391, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7685494422912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7685494422912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7692952156066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8017315864562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([329, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8045001029968262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8045001029968262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8051276206970215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8386979103088379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([259, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8403759002685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8403759002685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8408699035644531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8703756332397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8720059394836426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8720059394836426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8724198341369629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8989090919494629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([241, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9010186195373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9010186195373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9014782905578613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.934114933013916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([213, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9361371994018555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9361371994018555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9365434646606445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9682321548461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([147, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9697246551513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9697246551513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9700050354003906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9938373565673828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([140, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9954466819763184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9954466819763184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9957137107849121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.020280361175537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([114, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0216808319091797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0216808319091797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0218982696533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0434246063232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0446057319641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0446057319641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0447735786437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0625653266906738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([93, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639119148254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639119148254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.064089298248291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0841336250305176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0855646133422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0855646133422852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0857419967651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1070280075073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1082024574279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1082024574279785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1083416938781738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1260247230529785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1269779205322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1269779205322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.127084732055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.141397476196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([75, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1427860260009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1427860260009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1429290771484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1630992889404297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1641383171081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1641383171081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.164243221282959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1797690391540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1805624961853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1805624961853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1806387901306152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1924643516540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.193089485168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.193089485168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1931467056274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2024164199829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2032647132873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2032647132873535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2033371925354004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2155861854553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([378, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.224632740020752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.224632740020752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.225353717803955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3558144569396973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 378, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3154792785644531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.316335678100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3171920776367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3162927627563477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5746, 40])
input nodes number: 10940
output nodes number: 5746
edges number: 47531
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3164100646972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3164105415344238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024964332580566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 5 input nodes size: 19173
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022347450256347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022347450256347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.031534671783447266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.031577110290527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021190166473388672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021983623504638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021983623504638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021983623504638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([19173, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.021983623504638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1031, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05337333679199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05337333679199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05435657501220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06222248077392578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([1141, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06294393539428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06294393539428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06403207778930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08044624328613281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1010, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08134698867797852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08134698867797852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08231019973754883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1035008430480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([874, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10469484329223633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10469484329223633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10552835464477539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1297001838684082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([715, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13098812103271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13098812103271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1316699981689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1571202278137207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([619, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15855026245117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15855026245117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15914058685302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1851053237915039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([529, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1866316795349121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1866316795349121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18713617324829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2127213478088379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([485, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21431922912597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21431922912597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2147817611694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24114608764648438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([449, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2428417205810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2428417205810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2432699203491211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2706747055053711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([3424, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2867875099182129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2867875099182129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3424, 128]), torch.Size([1, 3424, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2900528907775879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5225696563720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3424, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4956016540527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5054025650024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5152034759521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5053257942199707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10277, 256])
first layer input nodes number: 19173
first layer output nodes number: 10277
edges number: 62992
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5153484344482422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5251493453979492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5283489227294922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5283489227294922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([786, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5709261894226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5709261894226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 786, 256]), torch.Size([1, 786, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.572425365447998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5850977897644043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 786, 256])
m.shape torch.Size([758, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5859289169311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5859289169311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5873746871948242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6111211776733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([583, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6120796203613281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6120796203613281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6131916046142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6388435363769531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([497, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.640324592590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.640324592590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6412725448608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6690263748168945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([399, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6704702377319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6704702377319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6712312698364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6992697715759277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([327, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.700775146484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.700775146484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7013988494873047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7283315658569336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7301011085510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7301011085510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7305989265441895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7561039924621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([236, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7576699256896973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7576699256896973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.758120059967041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7837777137756348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([208, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7853522300720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7853522300720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7857489585876465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8111395835876465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8124504089355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8124504089355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8127498626708984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8340110778808594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8355212211608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8355212211608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8358206748962402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8591780662536621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8607125282287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8607125282287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8609910011291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8846611976623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8859090805053711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8859090805053711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8861207962036133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9055986404418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([110, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9069733619689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9069733619689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9071831703186035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9279541969299316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9289884567260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9289884567260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9291391372680664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9451112747192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9460663795471191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9460663795471191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9461941719055176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.960634708404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9615511894226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9615511894226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9616656303405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9753985404968262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9763622283935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9763622283935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9764747619628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9907665252685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.991605281829834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.991605281829834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9916987419128418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0042223930358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.005002498626709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.005002498626709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.00508451461792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.016648769378662  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0175566673278809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0175566673278809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.017646312713623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0309138298034668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.03184175491333  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.03184175491333  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0319294929504395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0455288887023926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0464801788330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0464801788330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0465660095214844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0604705810546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0611658096313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0611658096313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0612268447875977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0715417861938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([389, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0808582305908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0808582305908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0816001892089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2140445709228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 389, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1776719093322754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1785144805908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1793570518493652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1784720420837402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5652, 40])
input nodes number: 10277
output nodes number: 5652
edges number: 43272
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1785774230957031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1785778999328613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02352428436279297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 6 input nodes size: 22634
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02117633819580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02117633819580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03196907043457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03201103210449219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0227813720703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023708343505859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023708343505859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023708343505859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22634, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023708343505859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1091, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06436014175415039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06436014175415039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06540060043334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07372426986694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1188, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07433700561523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07433700561523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1188, 128]), torch.Size([1, 1188, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.075469970703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09246444702148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1188, 128])
m.shape torch.Size([1062, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09341716766357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09341716766357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09442996978759766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11707687377929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([898, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11828327178955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11828327178955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 898, 128]), torch.Size([1, 898, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1191396713256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14418888092041016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 898, 128])
m.shape torch.Size([848, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1461639404296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1461639404296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14697265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17620849609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([698, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17780113220214844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17780113220214844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.178466796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20782184600830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([628, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20958518981933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20958518981933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21018409729003906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24129104614257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([560, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24312782287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24312782287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24366188049316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27440834045410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([488, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27623558044433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27623558044433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2767009735107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3064861297607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([4866, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3294563293457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3294563293457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4866, 128]), torch.Size([1, 4866, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33409690856933594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6800498962402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4866, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6443071365356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6560630798339844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6678190231323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6559710502624512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12327, 256])
first layer input nodes number: 22634
first layer output nodes number: 12327
edges number: 80601
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6679897308349609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6797456741333008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6826848983764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6826848983764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([798, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7256875038146973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7256875038146973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7272095680236816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7393860816955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 798, 256])
m.shape torch.Size([727, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7400894165039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7400894165039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7414760589599609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7625155448913574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([579, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7635226249694824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7635226249694824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7646269798278809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7896552085876465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 579, 256])
m.shape torch.Size([443, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7909083366394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7909083366394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7917532920837402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8168497085571289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([358, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8181476593017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8181476593017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8188304901123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8435516357421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8449287414550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8449287414550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8454971313476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8702468872070312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([277, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8718266487121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8718266487121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8723549842834473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8997225761413574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([231, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9012346267700195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9012346267700195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9016752243041992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9267892837524414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([199, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9282903671264648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9282903671264648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9286699295043945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9529619216918945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([168, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9543871879577637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9543871879577637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9547076225280762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9774584770202637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([162, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.979011058807373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.979011058807373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9793200492858887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0034213066101074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0048460960388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0048460960388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0050806999206543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.025022029876709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([118, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.026379108428955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.026379108428955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.026604175567627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0473103523254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([112, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0487051010131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0487051010131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0489187240600586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0700674057006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0712871551513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0712871551513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.071462631225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0900630950927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([84, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0912671089172363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0912671089172363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0914273262023926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1095318794250488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([79, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1107425689697266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1107425689697266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1108932495117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1289749145507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1298341751098633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1298341751098633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1299371719360352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1430177688598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.143824577331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.143824577331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1439142227172852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1559267044067383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1570162773132324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1570162773132324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1571288108825684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1729960441589355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.17402982711792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.17402982711792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1741328239440918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1893763542175293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1898326873779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1898326873779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1898784637451172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1969738006591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.197636604309082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.197636604309082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1976957321166992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2072744369506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.208052635192871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.208052635192871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2081193923950195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2194013595581055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([417, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2293877601623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2293877601623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2301831245422363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3729586601257324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 417, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3360676765441895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.336897850036621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3377280235290527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3368558883666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5569, 40])
input nodes number: 12327
output nodes number: 5569
edges number: 43709
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.336977481842041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3369779586791992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025457382202148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 7 input nodes size: 22607
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02276897430419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02276897430419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.033548831939697266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03359079360961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022756099700927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023691654205322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023691654205322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023691654205322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22607, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023691654205322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1123, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06312131881713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06312131881713867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06419229507446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07276010513305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1094, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07344579696655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07344579696655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07448911666870117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0903778076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1063, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09137678146362305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09137678146362305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09239053726196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11469316482543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([932, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11596393585205078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11596393585205078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1168527603149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1428842544555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([873, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14452123641967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14452123641967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1453537940979004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17532587051391602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([725, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17698383331298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17698383331298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 725, 128]), torch.Size([1, 725, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1776752471923828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20758628845214844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 725, 128])
m.shape torch.Size([622, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20931673049926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20931673049926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20990991592407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24041128158569336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([557, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24223947525024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24223947525024414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24277067184448242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2735114097595215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([474, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2752799987792969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2752799987792969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27573204040527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30466270446777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([4734, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3270101547241211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3270101547241211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4734, 128]), torch.Size([1, 4734, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3315248489379883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6520681381225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4734, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6175518035888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6291837692260742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6408157348632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6290926933288574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12197, 256])
first layer input nodes number: 22607
first layer output nodes number: 12197
edges number: 79359
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.640986442565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.652618408203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6555266380310059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6555266380310059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([824, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7009024620056152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7009024620056152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 824, 256]), torch.Size([1, 824, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7024741172790527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7150473594665527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 824, 256])
m.shape torch.Size([677, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7157444953918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7157444953918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7170357704162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7368817329406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 677, 256])
m.shape torch.Size([595, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7383327484130859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7383327484130859  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7394676208496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7650833129882812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 595, 256])
m.shape torch.Size([442, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7667026519775391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7667026519775391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7675457000732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7928524017333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([395, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7943291664123535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7943291664123535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7950825691223145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8224873542785645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([310, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8238987922668457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8238987922668457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8244900703430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8545536994934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8558731079101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8558731079101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8563308715820312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8792190551757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8807387351989746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8807387351989746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.881141185760498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.904080867767334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([193, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9055495262145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9055495262145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9059176445007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9294772148132324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([171, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9309368133544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9309368133544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9312629699707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9544200897216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9556846618652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9556846618652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9559421539306641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9760265350341797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9773283004760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9773283004760742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.977564811706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9976682662963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9987874031066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9987874031066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9989762306213379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0163483619689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0174922943115234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0174922943115234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0176677703857422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0350399017333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0362787246704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0362787246704102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.036454200744629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0550546646118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.05588960647583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.05588960647583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0560040473937988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0689358711242676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([79, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.070169448852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.070169448852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0703201293945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0884017944335938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0893993377685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0893993377685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.089517593383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1045360565185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1055727005004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1055727005004883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.105687141418457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1210222244262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1220993995666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1220993995666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1222119331359863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1380791664123535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1390728950500488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1390728950500488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.139172077178955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.15385103225708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1545419692993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1545419692993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1546087265014648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1649560928344727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1657629013061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1657629013061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1658353805541992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.177577018737793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.178278923034668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.178278923034668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.178339958190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.188654899597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([544, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2016959190368652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2016959190368652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2027335166931152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3916678428649902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 544, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3523750305175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.353212833404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.354050636291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3531708717346191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5621, 40])
input nodes number: 12197
output nodes number: 5621
edges number: 46152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.353311538696289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3533120155334473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025484561920166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 8 input nodes size: 34036
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022763729095458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022763729095458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03899335861206055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.039037227630615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028215408325195312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02917003631591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02917003631591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02917003631591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([34036, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02917003631591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1391, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07388639450073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07388639450073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1391, 128]), torch.Size([1, 1391, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07521295547485352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08647394180297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1391, 128])
m.shape torch.Size([1576, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08731365203857422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08731365203857422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1576, 128]), torch.Size([1, 1576, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08881664276123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11136150360107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1576, 128])
m.shape torch.Size([1400, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11354637145996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11354637145996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1400, 128]), torch.Size([1, 1400, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11488151550292969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1450939178466797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1400, 128])
m.shape torch.Size([1219, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14675140380859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14675140380859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1219, 128]), torch.Size([1, 1219, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14791393280029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1825580596923828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1219, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18448257446289062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18448257446289062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1854848861694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22173023223876953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([870, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22371816635131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22371816635131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2245478630065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2602248191833496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([750, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2623133659362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2623133659362793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.263028621673584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.29885053634643555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([680, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3010869026184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3010869026184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30173540115356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33890819549560547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([610, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3412017822265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3412017822265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3417835235595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38004493713378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([4956, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40338611602783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40338611602783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4956, 128]), torch.Size([1, 4956, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40905094146728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7552614212036133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4956, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7160754203796387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7299065589904785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7437376976013184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7297983169555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14503, 256])
first layer input nodes number: 34036
first layer output nodes number: 14503
edges number: 89834
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7439932823181152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7578244209289551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7612824440002441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7612824440002441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([976, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7991824150085449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7991824150085449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 976, 256]), torch.Size([1, 976, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8010439872741699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8159365653991699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 976, 256])
m.shape torch.Size([883, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8168807029724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8168807029724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 883, 256]), torch.Size([1, 883, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8185648918151855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8438277244567871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 883, 256])
m.shape torch.Size([666, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.844977855682373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.844977855682373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8462481498718262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8742785453796387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([556, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8761706352233887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8761706352233887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8772311210632324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9083976745605469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([469, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9101214408874512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9101214408874512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9110159873962402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9438977241516113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9453134536743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9453134536743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9459295272827148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9737234115600586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.975151538848877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.975151538848877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9756436347961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0004887580871582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0020499229431152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0020499229431152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0024981498718262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0280470848083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([198, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0295357704162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0295357704162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0299134254455566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0540833473205566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0555191040039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0555191040039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0558414459228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0787277221679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0800151824951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0800151824951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0802764892578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1006584167480469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1018314361572266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1018314361572266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1020469665527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1203670501708984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1215453147888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1215453147888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1217379570007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1394610404968262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1403875350952148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1403875350952148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1405324935913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1548833847045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1557912826538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1557912826538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1559209823608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1696691513061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1705732345581055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1705732345581055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1706933975219727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1842718124389648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.185126781463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.185126781463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1852335929870605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1980509757995605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1988630294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1988630294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.198958396911621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2110700607299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2117528915405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2117528915405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2118291854858398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2220525741577148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2228412628173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2228412628173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2229232788085938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.234487533569336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2350726127624512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2350726127624512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2351317405700684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.243882656097412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2442550659179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2442550659179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2442913055419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.249908447265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.250288486480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.250288486480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2503228187561035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2558846473693848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.25632905960083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.25632905960083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2563672065734863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2628140449523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2696189880371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2696189880371094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2701606750488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3664922714233398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.335235595703125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3361077308654785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.336979866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3360638618469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5852, 40])
input nodes number: 14503
output nodes number: 5852
edges number: 38208
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3362503051757812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3362507820129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.031088829040527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 9 input nodes size: 28255
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028249740600585938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028249740600585938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.041722774505615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04176521301269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025491714477539062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026329994201660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026329994201660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026329994201660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28255, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026329994201660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1455, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06412649154663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06412649154663086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1455, 128]), torch.Size([1, 1455, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06551408767700195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07735729217529297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1455, 128])
m.shape torch.Size([1478, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07807302474975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07807302474975586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1478, 128]), torch.Size([1, 1478, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0794825553894043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10062551498413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1478, 128])
m.shape torch.Size([1339, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1018362045288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1018362045288086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1339, 128]), torch.Size([1, 1339, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10311317443847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13120651245117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1339, 128])
m.shape torch.Size([1079, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1328601837158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1328601837158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13388919830322266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16373062133789062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1030, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16567182540893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16567182540893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16665410995483398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20272111892700195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([798, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2045130729675293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2045130729675293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20527410507202148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23838376998901367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([690, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24030637741088867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24030637741088867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24096441268920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27400636672973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([583, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27590131759643555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27590131759643555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2764573097229004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30870962142944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([508, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3112831115722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3112831115722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.311767578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3427734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([3886, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36106109619140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36106109619140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3886, 128]), torch.Size([1, 3886, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36476707458496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6278915405273438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3886, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5958647727966309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6081156730651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6203665733337402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6080198287963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12846, 256])
first layer input nodes number: 28255
first layer output nodes number: 12846
edges number: 75608
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6205792427062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6328301429748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6358928680419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6358928680419922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1000, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6734132766723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6734132766723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1000, 256]), torch.Size([1, 1000, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6753206253051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6932573318481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1000, 256])
m.shape torch.Size([818, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6939606666564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6939606666564941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6955208778381348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7189240455627441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([655, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7200326919555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7200326919555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 655, 256]), torch.Size([1, 655, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7212820053100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7487668991088867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 655, 256])
m.shape torch.Size([507, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7501983642578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7501983642578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7511653900146484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7792091369628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([451, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7808933258056641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7808933258056641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7817535400390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8127212524414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([333, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8146333694458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8146333694458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8152685165405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8437376022338867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.845210075378418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.845210075378418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8457174301147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.871668815612793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([233, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8732070922851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8732070922851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8736515045166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8989830017089844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([203, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9005169868469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9005169868469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9009041786193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9256844520568848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9269614219665527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9269614219665527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.927253246307373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9479727745056152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9490113258361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9490113258361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9492249488830566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9658875465393066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9669919013977051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9669919013977051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9671921730041504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.984215259552002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9854898452758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9854898452758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9856996536254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0050020217895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0061354637145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0061354637145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0063109397888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0236830711364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0245471000671387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0245471000671387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0246729850769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0380167961120605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0388922691345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0388922691345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.039008617401123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0521559715270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.05289888381958  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.05289888381958  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.052992343902588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0642075538635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0649051666259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0649051666259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0649871826171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0754032135009766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0761113166809082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0761113166809082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0761895179748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0866684913635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0873985290527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0873985290527344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0874748229980469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0982322692871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0986180305480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0986180305480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0986580848693848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.104586124420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1050524711608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1050524711608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1050963401794434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.11189603805542  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1123828887939453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1123828887939453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1124267578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1195335388183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1199960708618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1199960708618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1200361251831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.126805305480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([260, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1330327987670898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1330327987670898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.133528709411621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2233924865722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 260, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1926770210266113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1935243606567383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1943717002868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1934819221496582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5686, 40])
input nodes number: 12846
output nodes number: 5686
edges number: 36807
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1935954093933105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1935958862304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.027980804443359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 10 input nodes size: 42831
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0254669189453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0254669189453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04589033126831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04593181610107422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032416343688964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03343391418457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03343391418457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03343391418457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([42831, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03343391418457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1741, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08536720275878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08536720275878906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1741, 128]), torch.Size([1, 1741, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08702754974365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1003103256225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1741, 128])
m.shape torch.Size([1715, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10171222686767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10171222686767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1715, 128]), torch.Size([1, 1715, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1033477783203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12788105010986328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1715, 128])
m.shape torch.Size([1469, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1293625831604004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1293625831604004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1469, 128]), torch.Size([1, 1469, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13076353073120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1619582176208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1469, 128])
m.shape torch.Size([1279, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16397762298583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16397762298583984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1279, 128]), torch.Size([1, 1279, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16519737243652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20057010650634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1279, 128])
m.shape torch.Size([1167, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2027425765991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2027425765991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2038555145263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24415016174316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([879, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2461085319519043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2461085319519043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2469468116760254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28304624557495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([795, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.285280704498291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.285280704498291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.286038875579834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32470035552978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([763, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32723188400268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32723188400268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3279595375061035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37035512924194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([558, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37238597869873047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37238597869873047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37291812896728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40802717208862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([6174, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.43720102310180664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.43720102310180664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 6174, 128]), torch.Size([1, 6174, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.44308900833129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8611359596252441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 6174, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8160619735717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8318357467651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8476095199584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8317122459411621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([16540, 256])
first layer input nodes number: 42831
first layer output nodes number: 16540
edges number: 104234
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.847930908203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8637046813964844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8685159683227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8685159683227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1151, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.901421070098877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.901421070098877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1151, 256]), torch.Size([1, 1151, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9050984382629395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9257397651672363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1151, 256])
m.shape torch.Size([926, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9257535934448242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9257535934448242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 926, 256]), torch.Size([1, 926, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9275197982788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9556188583374023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 926, 256])
m.shape torch.Size([662, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9566450119018555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9566450119018555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9579076766967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9877233505249023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([527, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9891180992126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9891180992126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9901232719421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.019273281097412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([434, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0208563804626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0208563804626465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.021684169769287  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0532240867614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([266, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0543441772460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0543441772460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0548515319824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.078439712524414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([241, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0798077583312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0798077583312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0802674293518066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1032509803771973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([197, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1045360565185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1045360565185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1049118041992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1263294219970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([135, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1273093223571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1273093223571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1275668144226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1440463066101074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([125, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1453824043273926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1453824043273926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1456208229064941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.162548542022705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([91, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1633915901184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1633915901184082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1635651588439941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1771035194396973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([91, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1780667304992676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1780667304992676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1782402992248535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1929936408996582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1937565803527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1937565803527832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1938862800598145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2058186531066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.206453800201416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.206453800201416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2065529823303223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.216372013092041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2170004844665527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2170004844665527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.217090129852295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2265925407409668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.227055549621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.227055549621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2271184921264648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2342309951782227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2347064018249512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2347064018249512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2347655296325684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2418608665466309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.242471694946289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.242471694946289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2425422668457031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.251504898071289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2521090507507324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2521090507507324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2521758079528809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2611212730407715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2616839408874512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2616839408874512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2617430686950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2700800895690918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2704949378967285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2704949378967285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2705368995666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.276747226715088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2772550582885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2772550582885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2773027420043945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.284693717956543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2850899696350098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2850899696350098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2851262092590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.29099702835083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.291440486907959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.291440486907959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2914786338806152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2979254722595215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([252, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3046674728393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3046674728393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3051481246948242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3897428512573242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 252, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3631300926208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.36395263671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3647751808166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3639111518859863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5518, 40])
input nodes number: 16540
output nodes number: 5518
edges number: 32236
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.364051342010498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3640518188476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03541994094848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 11 input nodes size: 44399
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03239154815673828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03239154815673828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05356264114379883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0536041259765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03313922882080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03445148468017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03445148468017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03445148468017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([44399, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03445148468017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1459, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10207176208496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10207176208496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1459, 128]), torch.Size([1, 1459, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10346317291259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1145944595336914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1459, 128])
m.shape torch.Size([1460, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11562919616699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11562919616699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11702156066894531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1379070281982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([1226, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13896465301513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13896465301513672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14013385772705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16668033599853516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1147, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16828346252441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16828346252441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16937732696533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20109939575195312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([996, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2029271125793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2029271125793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20387697219848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23883676528930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([924, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24100542068481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24100542068481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24188661575317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2806534767150879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([809, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2829132080078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2829132080078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28368473052978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32226085662841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([783, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.324862003326416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.324862003326416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3256087303161621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.368288516998291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([704, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37093639373779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37093639373779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37160778045654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4152979850769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([9528, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46039533615112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46039533615112305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 9528, 128]), torch.Size([1, 9528, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4694819450378418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.114631175994873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 9528, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0536150932312012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0717692375183105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.08992338180542  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.071627140045166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([19036, 256])
first layer input nodes number: 44399
first layer output nodes number: 19036
edges number: 136712
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0902562141418457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.108410358428955  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1129488945007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1129488945007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([987, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1517891883850098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1517891883850098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1536717414855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1698145866394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 987, 256])
m.shape torch.Size([809, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.17057466506958  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.17057466506958  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1721177101135254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1954598426818848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([602, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.19677734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.19677734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1979255676269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2241020202636719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([471, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2255487442016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2255487442016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2264471054077148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2524995803833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([371, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.253833293914795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.253833293914795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2545409202575684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2809014320373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([347, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2825489044189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2825489044189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2832107543945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3122882843017578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([235, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3135385513305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3135385513305664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3139867782592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3363981246948242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3377890586853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3377890586853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3381896018981934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.361020565032959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([155, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3621888160705566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3621888160705566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3624844551086426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3814053535461426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([135, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3826260566711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3826260566711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3828835487365723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.40116548538208  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4024114608764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4024114608764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4026594161987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4219999313354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([94, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4230709075927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4230709075927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4232501983642578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4384899139404297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4391999244689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4391999244689941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4393219947814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4505524635314941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4512853622436523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4512853622436523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4513978958129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.462538719177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.46327543258667  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.46327543258667  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4633803367614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4745001792907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.475308895111084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.475308895111084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4754157066345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.487485408782959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.488396167755127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.488396167755127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.488508701324463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5020127296447754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5027523040771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5027523040771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5028400421142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5139827728271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.514669418334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.514669418334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5147457122802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5249691009521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5256037712097168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5256037712097168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5256705284118652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.535083293914795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5356554985046387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5356554985046387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.535712718963623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5441813468933105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5447449684143066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5447449684143066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5447983741760254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5530762672424316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5534257888793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5534257888793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5534582138061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.558711051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5593409538269043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5593409538269043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.559394359588623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5684199333190918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([454, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5793023109436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5793023109436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5801682472229004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7364115715026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 454, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7037453651428223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7045679092407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.705390453338623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.704526424407959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 19036
output nodes number: 5517
edges number: 39189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7047100067138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7047104835510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03687620162963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 12 input nodes size: 51491
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03313922882080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03313922882080078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05769205093383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05773591995239258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03652334213256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.038805484771728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.038805484771728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.038805484771728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([51491, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.038805484771728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([815, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15121746063232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15121746063232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1519947052001953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1582932472229004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([875, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1587390899658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1587390899658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15957355499267578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1720905303955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([850, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17288923263549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17288923263549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17369985580444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19191980361938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([861, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19315671920776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19315671920776367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19397783279418945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2177901268005371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([857, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2194228172302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2194228172302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22024011611938477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2496628761291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([808, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25156593322753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25156593322753906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2523365020751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28547096252441406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([850, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28792285919189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28792285919189453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28873348236083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3300628662109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([757, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33254528045654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33254528045654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3332672119140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3756074905395508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([772, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37855958938598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37855958938598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37929582595825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.42685365676879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([19260, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5183243751525879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5183243751525879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19260, 128]), torch.Size([1, 19260, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5366921424865723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.840803623199463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19260, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7345366477966309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7600045204162598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7854723930358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7598052024841309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([26705, 256])
first layer input nodes number: 51491
first layer output nodes number: 26705
edges number: 229246
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.785858154296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.811326026916504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8181233406066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8181233406066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([515, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8928232192993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8928232192993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8938055038452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9027509689331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([407, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9030423164367676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9030423164367676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9038186073303223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9201092720031738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([353, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.920766830444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.920766830444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9214401245117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9362525939941406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([304, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9370884895324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9370884895324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9376683235168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9545645713806152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([269, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9555678367614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9555678367614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9560809135437012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9764461517333984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([226, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9774932861328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9774932861328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9779243469238281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9964599609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([190, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9975228309631348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9975228309631348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9978852272033691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.016005039215088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([162, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0170698165893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0170698165893555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.017378807067871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0349912643432617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.037177085876465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.037177085876465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0375490188598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0613527297973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([164, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0627431869506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0627431869506836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.063055992126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0852651596069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.08742094039917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.08742094039917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0876898765563965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1086668968200684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([151, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.110274314880371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.110274314880371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.110562324523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.135043144226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([132, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1365485191345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1365485191345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1368002891540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1599631309509277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([114, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1613712310791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1613712310791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.161588668823242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.183115005493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([109, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1845779418945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1845779418945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.184785842895508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2068233489990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([115, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2084879875183105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2084879875183105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.208707332611084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2334933280944824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([99, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2353577613830566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2353577613830566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.235546588897705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2582058906555176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.259737968444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.259737968444824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2599172592163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.282687187194824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([91, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.284259796142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.284259796142578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.284433364868164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3076915740966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3094310760498047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3094310760498047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.309612274169922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3351612091064453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([88, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.337667942047119  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.337667942047119  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3378357887268066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3626770973205566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3638620376586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3638620376586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.36397647857666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3817148208618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3830060958862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3830060958862305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.383122444152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.401970863342285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.403458595275879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.403458595275879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.4035863876342773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.4251832962036133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([1652, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.4648141860961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.4648141860961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1652, 256]), torch.Size([1, 1652, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.4679651260375977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 3.03688907623291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1652, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.9673757553100586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.9682483673095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.969120979309082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.9682044982910156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 26705
output nodes number: 5854
edges number: 76959
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.9684977531433105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.9684982299804688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04275941848754883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 13 input nodes size: 56715
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03657341003417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03657341003417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06361722946166992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0636587142944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0390620231628418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04120206832885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04120206832885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04120206832885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([56715, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04120206832885742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1202, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15358638763427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15358638763427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1202, 128]), torch.Size([1, 1202, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15473270416259766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16390323638916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1202, 128])
m.shape torch.Size([1200, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16524362564086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16524362564086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16638803482055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18355417251586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1121, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1845855712890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1845855712890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1856546401977539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2092432975769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1047, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21070575714111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21070575714111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21170425415039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24137210845947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([1011, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24328327178955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24328327178955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2442474365234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2789573669433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([922, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2811131477355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2811131477355957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28199243545532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3199887275695801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([887, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.322509765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.322509765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32335567474365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3674492835998535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([871, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3703489303588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3703489303588867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37117958068847656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.41852664947509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([838, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4217076301574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4217076301574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.42250680923461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4740324020385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([18627, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5624532699584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5624532699584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18627, 128]), torch.Size([1, 18627, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5802173614501953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8414678573608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18627, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7362170219421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7626585960388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.789100170135498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7624516487121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([27726, 256])
first layer input nodes number: 56715
first layer output nodes number: 27726
edges number: 228729
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.789525032043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8159666061401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8228492736816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8228492736816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([745, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8798918724060059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8798918724060059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8813128471374512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.894151210784912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([625, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8946971893310547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8946971893310547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8958892822265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9137706756591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 625, 256])
m.shape torch.Size([449, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.914651870727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.914651870727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9155082702636719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9348382949829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([353, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9359078407287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9359078407287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9365811347961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.960944652557373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([303, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.962064266204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.962064266204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9626421928405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9848504066467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([233, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9859051704406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9859051704406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9863495826721191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0054593086242676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([200, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.007448673248291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.007448673248291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0078301429748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0269036293029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([168, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0280046463012695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0280046463012695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.028325080871582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0465898513793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([149, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.048692226409912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.048692226409912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.048976421356201  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.067164897918701  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([134, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0683107376098633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0683107376098633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.06856632232666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0867128372192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.088852882385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.088852882385254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0891122817993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1093454360961914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.11057710647583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.11057710647583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.110802173614502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1299328804016113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([85, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.130887985229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.130887985229492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1310501098632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.145965576171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.147043228149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.147043228149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.147195816040039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.162302017211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1633849143981934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1633849143981934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1635375022888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1797118186950684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1804966926574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1804966926574707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.180603504180908  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1926732063293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.193404197692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.193404197692871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.193495750427246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.204482078552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([72, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.206630229949951  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.206630229949951  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2067675590515137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.224208354949951  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2252984046936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2252984046936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2254128456115723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2407479286193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.241849422454834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.241849422454834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2419543266296387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2567458152770996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2578845024108887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2578845024108887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2579970359802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2746520042419434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.275463104248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.275463104248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.275541305541992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2876625061035156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2887825965881348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2887825965881348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.288881778717041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3049492835998535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3059206008911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3059206008911133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.306004524230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.320187568664551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([1172, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.348306655883789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.348306655883789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1172, 256]), torch.Size([1, 1172, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.350811004638672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7567992210388184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1172, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7051563262939453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7059788703918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.706801414489746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.705937385559082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 27726
output nodes number: 5517
edges number: 58370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7061357498168945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7061362266540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.044834136962890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 14 input nodes size: 63060
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03901195526123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03901195526123047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06908130645751953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0691227912902832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0420374870300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04410982131958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04410982131958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04410982131958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([63060, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04410982131958008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1353, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15493440628051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15493440628051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1353, 128]), torch.Size([1, 1353, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15622472763061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16654729843139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1353, 128])
m.shape torch.Size([1469, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16730308532714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16730308532714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1469, 128]), torch.Size([1, 1469, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16870403289794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18971824645996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1469, 128])
m.shape torch.Size([1376, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1917581558227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1917581558227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1376, 128]), torch.Size([1, 1376, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1930704116821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22239017486572266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1376, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22393131256103516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22393131256103516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22502994537353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25689029693603516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1172, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25913524627685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25913524627685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1172, 128]), torch.Size([1, 1172, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2602529525756836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3004903793334961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1172, 128])
m.shape torch.Size([1043, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3029155731201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3029155731201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3039102554321289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3466815948486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([1017, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.349578857421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.349578857421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35054874420166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.39951086044311523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([983, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40303897857666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40303897857666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4039764404296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.45897579193115234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([875, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4622621536254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4622621536254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46309661865234375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5165023803710938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([17732, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6006379127502441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6006379127502441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17732, 128]), torch.Size([1, 17732, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6175484657287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8191494941711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17732, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.716153621673584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7430205345153809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7698874473571777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7428102493286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([28172, 256])
first layer input nodes number: 63060
first layer output nodes number: 28172
edges number: 225323
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7703595161437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7972264289855957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.803943157196045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.803943157196045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([821, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8555693626403809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8555693626403809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 821, 256]), torch.Size([1, 821, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.85713529586792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8696627616882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 821, 256])
m.shape torch.Size([702, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8704771995544434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8704771995544434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8718161582946777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8919177055358887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([529, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8928608894348145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8928608894348145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8938698768615723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.920504093170166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([356, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9216375350952148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9216375350952148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.922316551208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9429473876953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([332, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.945145606994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.945145606994629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9457788467407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.969101905822754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([241, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.970238208770752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.970238208770752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9706978797912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9904637336730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([217, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9916939735412598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9916939735412598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.99210786819458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0128026008605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([175, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0139412879943848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0139412879943848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.014275074005127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0333008766174316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([141, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0343708992004395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0343708992004395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.034639835357666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.051851749420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([138, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.053043842315674  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.053043842315674  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.053307056427002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.071995258331299  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([102, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0730137825012207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0730137825012207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0732083320617676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.088383197784424  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0895586013793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0895586013793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.089768409729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.107602119445801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1087698936462402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1087698936462402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1089625358581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.126685619354248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1275315284729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1275315284729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1276650428771973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.140882968902588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1420888900756836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1420888900756836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.142256736755371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.160048484802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1609182357788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1609182357788086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.161036491394043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1743993759155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1755213737487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1755213737487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1756415367126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.190061092376709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1911826133728027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1911826133728027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.19130277633667  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2065634727478027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2077531814575195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2077531814575195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.207859992980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.222172737121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2229652404785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2229652404785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2230491638183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.234882354736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.235668182373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.235668182373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.235746383666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2473201751708984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.248042583465576  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.248042583465576  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2481112480163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.258754253387451  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2594494819641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2594494819641113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.259512424468994  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2697091102600098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2704391479492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2704391479492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2705020904541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.281139373779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([974, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.304511547088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.304511547088623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 974, 256]), torch.Size([1, 974, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3063693046569824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.6438136100769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 974, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5978164672851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5986404418945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5994644165039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5985989570617676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5528, 40])
input nodes number: 28172
output nodes number: 5528
edges number: 52660
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5988521575927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5988526344299316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04774045944213867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 15 input nodes size: 57755
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.042038917541503906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.042038917541503906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06957864761352539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06962013244628906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03950929641723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0417017936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0417017936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0417017936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([57755, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0417017936706543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([968, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15415096282958984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15415096282958984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1550741195678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1624593734741211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([1126, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16375494003295898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16375494003295898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16482877731323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.181182861328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1017, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18210077285766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18210077285766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18307065963745117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2044081687927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([944, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20572376251220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20572376251220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20662403106689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23342227935791016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([984, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23531818389892578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23531818389892578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23625659942626953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27080249786376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([849, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2727622985839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2727622985839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2735719680786133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3084869384765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([883, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31102943420410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31102943420410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3118715286254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3539762496948242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([859, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35683202743530273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35683202743530273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3576512336730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4043459892272949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([911, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40784597396850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40784597396850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40871477127075195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.46583080291748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([18781, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5549511909484863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5549511909484863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18781, 128]), torch.Size([1, 18781, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5728621482849121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8445401191711426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18781, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.738842487335205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7648987770080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7909550666809082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.764695167541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([27322, 256])
first layer input nodes number: 57755
first layer output nodes number: 27322
edges number: 229123
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7913875579833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.81744384765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.823957920074463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.823957920074463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([604, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8872556686401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8872556686401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8884077072143555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9004335403442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([553, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.901106834411621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.901106834411621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9021615982055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.917983055114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([415, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9188365936279297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9188365936279297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9196281433105469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9373769760131836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([306, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9384994506835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9384994506835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9390830993652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9608259201049805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([291, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.962618350982666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.962618350982666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9631733894348145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9832806587219238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([210, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9851431846618652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9851431846618652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9855437278747559  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0027670860290527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([183, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.003798484802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.003798484802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.004147529602051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.021599769592285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([157, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.023453712463379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.023453712463379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0237531661987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0408220291137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.042151927947998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.042151927947998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.042478084564209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.063352108001709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([131, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.064971923828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.064971923828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0652217864990234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0829620361328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.084317684173584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.084317684173584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0845847129821777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1054129600524902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.107062339782715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.107062339782715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1072912216186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.12674617767334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.127869129180908  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.127869129180908  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1280579566955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.145430088043213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1473593711853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1473593711853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.147548198699951  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1662421226501465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1673879623413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1673879623413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1675519943237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.184939384460449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1868786811828613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1868786811828613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.18705415725708  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.206882953643799  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2080044746398926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2080044746398926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2081456184387207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2250828742980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([88, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.227065086364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.227065086364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2272329330444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.248549461364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.24983549118042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.24983549118042  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.249978542327881  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2691473960876465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.270967960357666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.270967960357666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2710976600646973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2893853187561035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([78, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2908949851989746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2908949851989746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.291043758392334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3130621910095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.314016342163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.314016342163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.314107894897461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.328298568725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.329939842224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.329939842224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.330031394958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.344862937927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([52, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3460168838500977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3460168838500977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.346116065979004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.36287784576416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([1346, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3956165313720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3956165313720703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1346, 256]), torch.Size([1, 1346, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.3989505767822266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.8571267127990723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1346, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.798715591430664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7995405197143555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.800365447998047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.799499034881592  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5534, 40])
input nodes number: 27322
output nodes number: 5534
edges number: 65018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.7997450828552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.799745559692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.045484066009521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.045484066009521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.045484066009521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012323155999183655 |0.002342209219932556 |0.11599381268024445 |8.884072303771973e-05 |0.07690626382827759 |0.0046994686126708984 |
----------------------------------------------------------pseudo_mini_loss sum 4.797278881072998[05:31:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 16 parts and get 6547557 edge cuts

Total (block generation + training)time/epoch 24.935035228729248
Training time/epoch 3.4112045764923096
Training time without block to device /epoch 3.3737292289733887
Training time without total dataloading part /epoch 3.092522144317627
load block tensor time/epoch 0.19717049598693848
block to device time/epoch 0.0374753475189209
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  833499
Number of first layer input nodes during this epoch:  566157
Number of first layer output nodes during this epoch:  267342
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04548358917236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026543378829956055
global_2_local spend time (sec) 0.0511164665222168
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004419088363647461
A = g.adjacency_matrix() spent  0.014742374420166016
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08489561080932617
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3530583381652832
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1607465744018555

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.201 seconds
Metis partitioning: 5.661 seconds
Split the graph: 0.999 seconds
Construct subgraphs: 0.034 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.907573461532593
5854
5854
5854
5853
5854
5541
5524
5854
5799
5517
5517
5561
5517
5798
5517
5527
total k batches seeds list generation spend  17.712463855743408
after graph partition
graph partition algorithm spend time 17.803858280181885
5854
5854
5854
5853
5854
5541
5524
5854
5799
5517
5517
5561
5517
5798
5517
5527
partition_len_list
[13016, 11140, 14114, 11528, 10848, 11275, 12054, 12806, 12724, 18333, 22509, 12608, 24896, 30392, 27892, 23699]
shared_neighbor_graph_partition_s0 selection method  spend 17.909371852874756
time for parepare:  0.01752185821533203
local_output_nid generation:  0.0013706684112548828
local_in_edges_tensor generation:  0.0015063285827636719
mini_batch_src_global generation:  0.001825094223022461
r_  generation:  0.017045021057128906
local_output_nid generation:  0.0015234947204589844
local_in_edges_tensor generation:  0.0014641284942626953
mini_batch_src_global generation:  0.0014963150024414062
r_  generation:  0.0150299072265625
local_output_nid generation:  0.0016067028045654297
local_in_edges_tensor generation:  0.0013866424560546875
mini_batch_src_global generation:  0.0019059181213378906
r_  generation:  0.01914501190185547
local_output_nid generation:  0.00170135498046875
local_in_edges_tensor generation:  0.0013227462768554688
mini_batch_src_global generation:  0.0016660690307617188
r_  generation:  0.014956951141357422
local_output_nid generation:  0.0016434192657470703
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0014891624450683594
r_  generation:  0.016616344451904297
local_output_nid generation:  0.0016477108001708984
local_in_edges_tensor generation:  0.0012645721435546875
mini_batch_src_global generation:  0.0013628005981445312
r_  generation:  0.014443397521972656
local_output_nid generation:  0.0016341209411621094
local_in_edges_tensor generation:  0.0011763572692871094
mini_batch_src_global generation:  0.0011060237884521484
r_  generation:  0.013069391250610352
local_output_nid generation:  0.0017247200012207031
local_in_edges_tensor generation:  0.0013058185577392578
mini_batch_src_global generation:  0.0014147758483886719
r_  generation:  0.017035722732543945
local_output_nid generation:  0.0017325878143310547
local_in_edges_tensor generation:  0.0012536048889160156
mini_batch_src_global generation:  0.0012061595916748047
r_  generation:  0.021814823150634766
local_output_nid generation:  0.0036661624908447266
local_in_edges_tensor generation:  0.0021238327026367188
mini_batch_src_global generation:  0.0015978813171386719
r_  generation:  0.014702796936035156
local_output_nid generation:  0.003009796142578125
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.0013594627380371094
r_  generation:  0.015576601028442383
local_output_nid generation:  0.0029251575469970703
local_in_edges_tensor generation:  0.0014233589172363281
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.010907173156738281
local_output_nid generation:  0.002852201461791992
local_in_edges_tensor generation:  0.0015320777893066406
mini_batch_src_global generation:  0.0015645027160644531
r_  generation:  0.02109503746032715
local_output_nid generation:  0.0029709339141845703
local_in_edges_tensor generation:  0.0016903877258300781
mini_batch_src_global generation:  0.0028350353240966797
r_  generation:  0.02785181999206543
local_output_nid generation:  0.0030236244201660156
local_in_edges_tensor generation:  0.0023758411407470703
mini_batch_src_global generation:  0.0019524097442626953
r_  generation:  0.01994466781616211
local_output_nid generation:  0.0028650760650634766
local_in_edges_tensor generation:  0.0018298625946044922
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.01474618911743164
----------------------check_connections_block total spend ----------------------------- 0.4484553337097168
generate_one_block  0.024317502975463867
generate_one_block  0.017352581024169922
generate_one_block  0.023955345153808594
generate_one_block  0.02654123306274414
generate_one_block  0.03174710273742676
generate_one_block  0.020034313201904297
generate_one_block  0.017658472061157227
generate_one_block  0.023347139358520508
generate_one_block  0.018209218978881836
generate_one_block  0.022055387496948242
generate_one_block  0.02387547492980957
generate_one_block  0.015954256057739258
generate_one_block  0.029506444931030273
generate_one_block  0.038400888442993164
generate_one_block  0.029772043228149414
generate_one_block  0.022249221801757812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03244352340698242
gen group dst list time:  0.008882761001586914
time for parepare:  0.020732402801513672
local_output_nid generation:  0.0033037662506103516
local_in_edges_tensor generation:  0.007342100143432617
mini_batch_src_global generation:  0.0026535987854003906
r_  generation:  0.02808213233947754
local_output_nid generation:  0.0039522647857666016
local_in_edges_tensor generation:  0.002560853958129883
mini_batch_src_global generation:  0.0025720596313476562
r_  generation:  0.021931886672973633
local_output_nid generation:  0.005173206329345703
local_in_edges_tensor generation:  0.003459453582763672
mini_batch_src_global generation:  0.00322723388671875
r_  generation:  0.03674006462097168
local_output_nid generation:  0.004310131072998047
local_in_edges_tensor generation:  0.0032591819763183594
mini_batch_src_global generation:  0.0025360584259033203
r_  generation:  0.02425384521484375
local_output_nid generation:  0.004141330718994141
local_in_edges_tensor generation:  0.002518892288208008
mini_batch_src_global generation:  0.0021419525146484375
r_  generation:  0.024640560150146484
local_output_nid generation:  0.004151821136474609
local_in_edges_tensor generation:  0.011162757873535156
mini_batch_src_global generation:  0.0024340152740478516
r_  generation:  0.025739192962646484
local_output_nid generation:  0.00451207160949707
local_in_edges_tensor generation:  0.0038557052612304688
mini_batch_src_global generation:  0.004115581512451172
r_  generation:  0.030183792114257812
local_output_nid generation:  0.004479408264160156
local_in_edges_tensor generation:  0.0031921863555908203
mini_batch_src_global generation:  0.0029511451721191406
r_  generation:  0.03035140037536621
local_output_nid generation:  0.00461578369140625
local_in_edges_tensor generation:  0.002864360809326172
mini_batch_src_global generation:  0.002247333526611328
r_  generation:  0.02694392204284668
local_output_nid generation:  0.006349325180053711
local_in_edges_tensor generation:  0.006685733795166016
mini_batch_src_global generation:  0.004857301712036133
r_  generation:  0.045179128646850586
local_output_nid generation:  0.008125543594360352
local_in_edges_tensor generation:  0.006901979446411133
mini_batch_src_global generation:  0.006507396697998047
r_  generation:  0.07028675079345703
local_output_nid generation:  0.006593942642211914
local_in_edges_tensor generation:  0.004080533981323242
mini_batch_src_global generation:  0.005685567855834961
r_  generation:  0.03362417221069336
local_output_nid generation:  0.011576175689697266
local_in_edges_tensor generation:  0.0077056884765625
mini_batch_src_global generation:  0.00828862190246582
r_  generation:  0.07443976402282715
local_output_nid generation:  0.01018834114074707
local_in_edges_tensor generation:  0.013244867324829102
mini_batch_src_global generation:  0.012330055236816406
r_  generation:  0.09726929664611816
local_output_nid generation:  0.00977945327758789
local_in_edges_tensor generation:  0.008667230606079102
mini_batch_src_global generation:  0.011783599853515625
r_  generation:  0.08611035346984863
local_output_nid generation:  0.008957147598266602
local_in_edges_tensor generation:  0.0072994232177734375
mini_batch_src_global generation:  0.009039640426635742
r_  generation:  0.07023406028747559
----------------------check_connections_block total spend ----------------------------- 1.2020237445831299
generate_one_block  0.05914711952209473
generate_one_block  0.030478239059448242
generate_one_block  0.047019243240356445
generate_one_block  0.03230166435241699
generate_one_block  0.0332334041595459
generate_one_block  0.03266286849975586
generate_one_block  0.034467220306396484
generate_one_block  0.03811526298522949
generate_one_block  0.03574681282043457
generate_one_block  0.062462568283081055
generate_one_block  0.08203363418579102
generate_one_block  0.03678607940673828
generate_one_block  0.09605908393859863
generate_one_block  0.12057900428771973
generate_one_block  0.11005544662475586
generate_one_block  0.08935546875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04548358917236328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

connection checking time:  1.2020237445831299
block generation total time  0.9405031204223633
average batch blocks generation time:  0.058781445026397705
block dataloader generation time/epoch 21.303889751434326
pseudo mini batch 0 input nodes size: 27450
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03950929641723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03950929641723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05259847640991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0526423454284668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02506113052368164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02597951889038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02597951889038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02597951889038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([27450, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02597951889038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1190, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06670045852661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06670045852661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1190, 128]), torch.Size([1, 1190, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06783533096313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07691431045532227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1190, 128])
m.shape torch.Size([1401, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07824945449829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07824945449829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1401, 128]), torch.Size([1, 1401, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07958555221557617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09962701797485352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1401, 128])
m.shape torch.Size([1277, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10078573226928711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10078573226928711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1277, 128]), torch.Size([1, 1277, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10200357437133789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12945079803466797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1277, 128])
m.shape torch.Size([1138, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1310124397277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1310124397277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13209772109985352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16357088088989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([969, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16533851623535156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16533851623535156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16626262664794922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19970941543579102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([793, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20151615142822266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20151615142822266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2022724151611328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23571014404296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([709, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23822546005249023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23822546005249023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23890161514282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27330827713012695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([679, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2755603790283203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2755603790283203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27620792388916016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31322288513183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([572, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3153538703918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3153538703918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3158993721008301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3509488105773926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([4288, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3711228370666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3711228370666504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4288, 128]), torch.Size([1, 4288, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3752427101135254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6662583351135254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4288, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6311097145080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6435227394104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6559357643127441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.643425464630127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([13016, 256])
first layer input nodes number: 27450
first layer output nodes number: 13016
edges number: 80401
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6561422348022461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6685552597045898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6716585159301758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6716585159301758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([783, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.713660717010498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.713660717010498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7151541709899902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7273344993591309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([789, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.728642463684082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.728642463684082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 789, 256]), torch.Size([1, 789, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7301473617553711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.752720832824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 789, 256])
m.shape torch.Size([633, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7542142868041992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7542142868041992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 633, 256]), torch.Size([1, 633, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7554216384887695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7819833755493164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 633, 256])
m.shape torch.Size([545, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7836852073669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7836852073669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7847247123718262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8156905174255371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([454, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8173527717590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8173527717590332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8182187080383301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.850130558013916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([345, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8516874313354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8516874313354492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8523454666137695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8812952041625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([288, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.882904052734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.882904052734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.883453369140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9113540649414062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([281, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9132404327392578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9132404327392578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9137763977050781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9450435638427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([210, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9465923309326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9465923309326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9469928741455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9726276397705078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([183, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9741864204406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9741864204406738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9745354652404785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9993176460266113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([146, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0006871223449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0006871223449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0009655952453613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.02268648147583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([133, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0240812301635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0240812301635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0243349075317383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0458974838256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.047132968902588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.047132968902588  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0473408699035645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0664677619934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([101, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.067723274230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.067723274230957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.067915916442871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0869874954223633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([100, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0883331298828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0883331298828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0885238647460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1087417602539062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1099638938903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1099638938903809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1101031303405762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1258368492126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1267738342285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1267738342285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1268901824951172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1408519744873047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1419878005981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1419878005981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1421194076538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1588335037231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.159644603729248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.159644603729248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.159736156463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.172004222869873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1727852821350098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1727852821350098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1728672981262207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.184431552886963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1852383613586426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1852383613586426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1853184700012207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1971745491027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1977477073669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1977477073669434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.197803020477295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.206376552581787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2071008682250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2071008682250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2071657180786133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2176713943481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2181925773620605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2181925773620605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.218238353729248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2259745597839355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([331, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.23390531539917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.23390531539917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2345366477966309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3483309745788574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.312777042388916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3136496543884277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3145222663879395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.313605785369873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 13016
output nodes number: 5854
edges number: 42669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3137946128845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.313795566558838  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02782726287841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 1 input nodes size: 21830
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02510976791381836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02510976791381836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03551912307739258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035562992095947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022429943084716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023136615753173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023136615753173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023136615753173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21830, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023136615753173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1547, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05404472351074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05404472351074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1547, 128]), torch.Size([1, 1547, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.055520057678222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06759262084960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1547, 128])
m.shape torch.Size([1531, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06831502914428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06831502914428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1531, 128]), torch.Size([1, 1531, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06977510452270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09222650527954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1531, 128])
m.shape torch.Size([1271, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09331464767456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09331464767456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1271, 128]), torch.Size([1, 1271, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09452676773071289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12193679809570312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1271, 128])
m.shape torch.Size([978, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12319612503051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12319612503051758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12412881851196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15117692947387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([848, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15273237228393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15273237228393555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15354108810424805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1826624870300293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([707, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1842808723449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1842808723449707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 707, 128]), torch.Size([1, 707, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18495512008666992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21445512771606445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 707, 128])
m.shape torch.Size([602, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2161273956298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2161273956298828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21670150756835938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2462310791015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([461, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24770259857177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24770259857177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24814224243164062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27320194244384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([409, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2747373580932617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2747373580932617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2751274108886719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3000907897949219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([2786, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31318044662475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31318044662475586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 2786, 128]), torch.Size([1, 2786, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31583738327026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5143566131591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 2786, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4888277053833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4994516372680664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.510075569152832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.49936819076538086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11140, 256])
first layer input nodes number: 21830
first layer output nodes number: 11140
edges number: 60259
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5102405548095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5208644866943359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5235204696655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5235204696655273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1121, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5579957962036133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5579957962036133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1121, 256]), torch.Size([1, 1121, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5602588653564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5790510177612305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1121, 256])
m.shape torch.Size([915, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5801339149475098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5801339149475098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 915, 256]), torch.Size([1, 915, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5818791389465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6080574989318848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 915, 256])
m.shape torch.Size([705, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6094107627868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6094107627868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 705, 256]), torch.Size([1, 705, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.610755443572998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6403384208679199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 705, 256])
m.shape torch.Size([524, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6422758102416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6422758102416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.643275260925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6730375289916992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([445, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6746764183044434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6746764183044434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6755251884460449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7073969841003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([360, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7090487480163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7090487480163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7097353935241699  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7396492958068848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([293, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7412776947021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7412776947021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7418365478515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7699174880981445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7713913917541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7713913917541504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7718262672424316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7966141700744629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7985529899597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7985529899597168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7988944053649902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8207449913024902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8219971656799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8219971656799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8222794532775879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8423218727111816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8433651924133301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8433651924133301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8435788154602051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8602414131164551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8614497184753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8614497184753418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8616671562194824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8801493644714355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([86, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8811154365539551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8811154365539551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.881279468536377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8963704109191895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8973650932312012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8973650932312012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8975176811218262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9126238822937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.913701057434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.913701057434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.913853645324707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.930027961730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9307208061218262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9307208061218262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9308161735534668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9415926933288574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9423947334289551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9423947334289551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9424939155578613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9543957710266113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9550728797912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9550728797912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9551529884338379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9653267860412598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.965761661529541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.965761661529541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9658112525939941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9724564552307129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9727587699890137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9727587699890137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9727911949157715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.977363109588623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9778919219970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9778919219970703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9779434204101562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.985565185546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9860258102416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9860258102416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9860696792602539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9928693771362305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9934444427490234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9934444427490234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9934959411621094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0018386840820312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0022282600402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0022282600402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0022625923156738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0080647468566895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([182, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124211311340332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0124211311340332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.012768268585205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.073864459991455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 182, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0462431907653809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0471158027648926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0479884147644043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.047071933746338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 11140
output nodes number: 5854
edges number: 34501
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0471992492675781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0471997261047363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02458047866821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 2 input nodes size: 32999
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022429943084716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022429943084716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03816509246826172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.038208961486816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0277557373046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02887439727783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02887439727783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02887439727783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([32999, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02887439727783203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1013, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07737016677856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07737016677856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07833623886108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08606481552124023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([1120, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08744573593139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08744573593139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08851385116577148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10453557968139648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1046, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10557365417480469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10557365417480469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10657119750976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12851715087890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([967, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12986278533935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12986278533935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1307849884033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15816402435302734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([909, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15987014770507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15987014770507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1607370376586914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19240474700927734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([803, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19426870346069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19426870346069336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19503450393676758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2281479835510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([733, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23021173477172852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23021173477172852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2309107780456543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26650047302246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([692, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26879072189331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26879072189331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.26945066452026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30776548385620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([560, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30983877182006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30983877182006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31037282943725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.34526729583740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([6271, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37490272521972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.37490272521972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 6271, 128]), torch.Size([1, 6271, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.38161659240722656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8062314987182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 6271, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7646331787109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7780933380126953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7915534973144531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7779879570007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([14114, 256])
first layer input nodes number: 32999
first layer output nodes number: 14114
edges number: 98039
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7918014526367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8052616119384766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.808626651763916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.808626651763916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([692, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595657348632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8595657348632812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 692, 256]), torch.Size([1, 692, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8608856201171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8723025321960449  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 692, 256])
m.shape torch.Size([638, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8729996681213379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8729996681213379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 638, 256]), torch.Size([1, 638, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8742165565490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8927388191223145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 638, 256])
m.shape torch.Size([511, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8937315940856934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8937315940856934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8947062492370605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9161486625671387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([451, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9173974990844727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9173974990844727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9182577133178711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.945042610168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([407, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.946568489074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.946568489074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9473447799682617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.976597785949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([331, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.978118896484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.978118896484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9787502288818359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0058975219726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([301, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0076069831848145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0076069831848145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.008181095123291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.039344310760498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([268, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0411181449890137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0411181449890137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0416293144226074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0716605186462402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.073282241821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.073282241821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0736961364746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1001853942871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([206, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1019587516784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1019587516784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1023516654968262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1302485466003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([155, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1318511962890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1318511962890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1321468353271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1552066802978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([158, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.156881332397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.156881332397461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1571826934814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1827983856201172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([122, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1841721534729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1841721534729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1844048500061035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.205812931060791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([133, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.207486629486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.207486629486084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.207740306854248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2328543663024902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([115, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2343854904174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2343854904174805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.234604835510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2578554153442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2590222358703613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2590222358703613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2591805458068848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2770695686340332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([88, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.278428554534912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.278428554534912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2785964012145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2987380027770996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2997612953186035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2997612953186035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2998833656311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3153862953186035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3163518905639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3163518905639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3164567947387695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3305139541625977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3316917419433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3316917419433594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3318138122558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3490257263183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3500146865844727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3500146865844727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.350113868713379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.364792823791504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3659062385559082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3659062385559082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.366011142730713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3822712898254395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3829045295715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3829045295715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3829636573791504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3925423622131348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.393481731414795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.393481731414795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.393561840057373  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4071002006530762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([615, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4218378067016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4218378067016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 615, 256]), torch.Size([1, 615, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4230108261108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.629638671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 615, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5848588943481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5857315063476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.586604118347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5856876373291016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 14114
output nodes number: 5854
edges number: 52063
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5858368873596191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5858373641967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.031009674072265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 3 input nodes size: 21187
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0277557373046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0277557373046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03785848617553711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0379023551940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022123336791992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022933006286621094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022933006286621094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022933006286621094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([21187, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022933006286621094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1267, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05682563781738281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05682563781738281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1267, 128]), torch.Size([1, 1267, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05803394317626953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06770038604736328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1267, 128])
m.shape torch.Size([1291, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06897974014282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06897974014282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1291, 128]), torch.Size([1, 1291, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07021093368530273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08867883682250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1291, 128])
m.shape torch.Size([1208, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09015035629272461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09015035629272461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1208, 128]), torch.Size([1, 1208, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09130239486694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11711263656616211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1208, 128])
m.shape torch.Size([1028, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11849737167358398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11849737167358398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11947774887084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14807653427124023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([925, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14979171752929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14979171752929688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15067386627197266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18255138397216797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([738, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18422174453735352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18422174453735352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18492555618286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21538162231445312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([622, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21710586547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21710586547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2176990509033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24869251251220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([576, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2505931854248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2505931854248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2511425018310547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2829570770263672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([496, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28481101989746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28481101989746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28528404235839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31555747985839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([3377, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3314237594604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3314237594604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3377, 128]), torch.Size([1, 3377, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3346443176269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5657987594604492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3377, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5369105339050293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5479044914245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5588984489440918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5478181838989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11528, 256])
first layer input nodes number: 21187
first layer output nodes number: 11528
edges number: 67834
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.559058666229248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5700526237487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5728011131286621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5728011131286621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([861, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6132330894470215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6132330894470215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.614875316619873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6280131340026855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([784, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6287140846252441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6287140846252441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 784, 256]), torch.Size([1, 784, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6302094459533691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6526398658752441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 784, 256])
m.shape torch.Size([643, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6538753509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6538753509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6551017761230469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6825847625732422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([521, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6842494010925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6842494010925293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6852431297302246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7140612602233887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([442, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7156887054443359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7156887054443359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7165317535400391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7471508979797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([357, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7487883567810059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7487883567810059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7494692802429199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7792696952819824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([326, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7811226844787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7811226844787598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7817444801330566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8135190010070801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8152303695678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8152303695678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8157320022583008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8446893692016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([220, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.846341609954834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.846341609954834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8467612266540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8736166954040527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([186, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8751950263977051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8751950263977051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8755497932434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9007382392883301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([169, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9023480415344238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9023480415344238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9026703834533691  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9278130531311035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.929720401763916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.929720401763916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.929955005645752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9498963356018066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([124, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9513287544250488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9513287544250488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9515652656555176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9733242988586426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9744305610656738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9744305610656738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9746041297912598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9917874336242676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9928684234619141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9928684234619141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9930229187011719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0093994140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0104451179504395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0104451179504395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0105843544006348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.026318073272705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0270166397094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0270166397094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0271062850952148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0378637313842773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.038597583770752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.038597583770752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0386834144592285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.049583911895752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0505638122558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0505638122558594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0506706237792969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0649833679199219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0657954216003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0657954216003418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0658812522888184  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0779833793640137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0785460472106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0785460472106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0786032676696777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0870718955993652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0877838134765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0877838134765625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.087850570678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0981979370117188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0986733436584473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0986733436584473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.098717212677002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1058239936828613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.106332778930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.106332778930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1063766479492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.113790512084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1206169128417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1206169128417969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1211605072021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2170066833496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.183126449584961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1839990615844727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1848716735839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.183955192565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5853, 40])
input nodes number: 11528
output nodes number: 5853
edges number: 40803
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1840853691101074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1840858459472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024530410766601562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 4 input nodes size: 20868
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022123336791992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022123336791992188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032073974609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03211784362792969  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02197122573852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022887706756591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022887706756591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022887706756591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([20868, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022887706756591797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([736, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0589146614074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0589146614074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0596165657043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06536197662353516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([913, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06588172912597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06588172912597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06675243377685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08068656921386719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([926, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08157587051391602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08157587051391602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0824589729309082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10245656967163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([836, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10360956192016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10360956192016602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10440683364868164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12792444229125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([778, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1293807029724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1293807029724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13012266159057617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15683317184448242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([718, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15851640701293945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15851640701293945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15920114517211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1891160011291504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([615, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.190826416015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.190826416015625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19141292572021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22163915634155273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([573, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22353172302246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22353172302246094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22407817840576172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25601768493652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([486, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2578301429748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2578301429748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25829362869262695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28795671463012695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([4267, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3080716133117676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3080716133117676  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4267, 128]), torch.Size([1, 4267, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31214094161987305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.601874828338623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4267, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5700821876525879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5804276466369629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5907731056213379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5803465843200684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([10848, 256])
first layer input nodes number: 20868
first layer output nodes number: 10848
edges number: 72815
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5909309387207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6012763977050781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6038627624511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6038627624511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([561, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6528491973876953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6528491973876953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6539192199707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6629257202148438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([608, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6636190414428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6636190414428711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6647787094116211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6827254295349121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([562, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6838197708129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6838197708129883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6848917007446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7094278335571289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([465, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7106800079345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7106800079345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7115669250488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7372875213623047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([432, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7389202117919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7389202117919922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7397441864013672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7695522308349609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([396, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7714242935180664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7714242935180664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7721796035766602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8047571182250977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([320, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8073105812072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8073105812072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8079209327697754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8385720252990723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([272, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8403582572937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8403582572937012  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8408770561218262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8731017112731934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([243, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8749446868896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8749446868896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8754081726074219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9050712585449219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([223, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9069828987121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9069828987121582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9074082374572754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9376072883605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([232, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.939847469329834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.939847469329834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9402899742126465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9748053550720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([150, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9763145446777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9763145446777344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9766006469726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0009193420410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([152, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0026755332946777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0026755332946777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0029654502868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0296378135681152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([134, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0312962532043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0312962532043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0315518379211426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0568547248840332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0580248832702637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0580248832702637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0581965446472168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.076392650604248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([103, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0778908729553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0778908729553223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.078087329864502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1002869606018066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1017413139343262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1017413139343262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1019225120544434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1236662864685059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([76, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1248908042907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1248908042907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1250357627868652  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1434454917907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1442861557006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1442861557006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1443815231323242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.157160758972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([85, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1587471961975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1587471961975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1589093208312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1817688941955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1828460693359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1828460693359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.182952880859375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.198760986328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1997652053833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1997652053833008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1998605728149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2146425247192383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2154350280761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2154350280761719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2155075073242188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2272491455078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.228158950805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.228158950805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2282371520996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2414531707763672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([420, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2515063285827637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2515063285827637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.252307415008545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.394824504852295  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 420, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3520431518554688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3529157638549805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3537883758544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3528718948364258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 10848
output nodes number: 5854
edges number: 50161
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.352996826171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3529973030090332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0246429443359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 5 input nodes size: 22561
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02197122573852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02197122573852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032729148864746094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032770633697509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.022776126861572266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023607730865478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023607730865478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023607730865478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22561, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023607730865478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1168, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.057852745056152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.057852745056152344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.058966636657714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06787776947021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1257, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06918001174926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06918001174926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1257, 128]), torch.Size([1, 1257, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07037878036499023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08836030960083008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1257, 128])
m.shape torch.Size([1125, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08951139450073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.08951139450073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09058427810668945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11418771743774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([984, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11552810668945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11552810668945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11646652221679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14368057250976562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([755, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14585113525390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14585113525390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14657115936279297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17330265045166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([685, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17490243911743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17490243911743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17555570602416992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20401716232299805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([579, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20562314987182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20562314987182617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2061753273010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23489952087402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([505, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23654985427856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23654985427856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2370314598083496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2644829750061035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2662334442138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2662334442138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2666759490966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2949962615966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([3753, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3126707077026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3126707077026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3753, 128]), torch.Size([1, 3753, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3168215751647949  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5709404945373535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3753, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.541562557220459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5523152351379395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5630679130554199  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5522308349609375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([11275, 256])
first layer input nodes number: 22561
first layer output nodes number: 11275
edges number: 68677
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5632381439208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5739908218383789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5773930549621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5773930549621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([802, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6195144653320312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6195144653320312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6210441589355469  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6336474418640137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([739, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6345295906066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6345295906066895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6359391212463379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6574034690856934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([622, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6588683128356934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6588683128356934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 622, 256]), torch.Size([1, 622, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6600546836853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6863851547241211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 622, 256])
m.shape torch.Size([505, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.687962532043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.687962532043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6889257431030273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7173089981079102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([357, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7185430526733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7185430526733398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7192239761352539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7470712661743164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([301, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.748466968536377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.748466968536377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7490410804748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.774228572845459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([233, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7755093574523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7755093574523926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7759537696838379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7981743812561035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7996129989624023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7996129989624023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8000249862670898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8235082626342773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([211, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8251276016235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8251276016235352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8255300521850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8512868881225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8525180816650391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8525180816650391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8528022766113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8729801177978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8742489814758301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8742489814758301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8744759559631348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8921799659729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([141, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8936929702758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8936929702758789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8939619064331055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9168214797973633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9179491996765137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9179491996765137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9181418418884277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9358649253845215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9368858337402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9368858337402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9370441436767578  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9527168273925781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9536757469177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9536757469177246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9538130760192871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9683699607849121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9692397117614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9692397117614746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9693560600280762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9825034141540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9835567474365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9835567474365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9836864471435547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9992504119873047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0003275871276855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0003275871276855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0004534721374512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0164408683776855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.017601490020752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.017601490020752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0177292823791504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.034853458404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0354242324829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0354242324829102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.035487174987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0443620681762695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0453200340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0453200340270996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0454134941101074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0592455863952637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.059812068939209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.059812068939209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0598673820495605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0684409141540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0693860054016113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0693860054016113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.069469928741455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0830655097961426  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0837159156799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0837159156799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.083773136138916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0934433937072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([443, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1040596961975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1040596961975098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1049046516418457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.259894847869873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 443, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.223829746246338  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2246556282043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2254815101623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.224614143371582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5541, 40])
input nodes number: 11275
output nodes number: 5541
edges number: 42788
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2246932983398438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.224693775177002  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025196552276611328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 6 input nodes size: 25167
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02272939682006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02272939682006836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.034729957580566406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03477144241333008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023972034454345703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024793148040771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024793148040771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024793148040771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([25167, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.024793148040771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1270, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06147050857543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06147050857543945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1270, 128]), torch.Size([1, 1270, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06268167495727539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07237100601196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1270, 128])
m.shape torch.Size([1312, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07333850860595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07333850860595703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1312, 128]), torch.Size([1, 1312, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07458972930908203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09354162216186523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1312, 128])
m.shape torch.Size([1175, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09459686279296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09459686279296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0957174301147461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12122583389282227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1175, 128])
m.shape torch.Size([1067, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12270069122314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12270069122314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.12371826171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1532278060913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([856, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15475988388061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15475988388061523  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.15557622909545898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18514013290405273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([717, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1867833137512207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1867833137512207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18746709823608398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21779203414916992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([575, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21936941146850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21936941146850586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21991777420043945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24751853942871094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([569, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24941492080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24941492080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24995756149291992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28088808059692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([435, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2824835777282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2824835777282715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2828984260559082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3094487190246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([4078, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32877254486083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32877254486083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 4078, 128]), torch.Size([1, 4078, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.33266162872314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6097307205200195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 4078, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5781502723693848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5896458625793457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6011414527893066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5895557403564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12054, 256])
first layer input nodes number: 25167
first layer output nodes number: 12054
edges number: 73541
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6013312339782715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6128268241882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6157007217407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6157007217407227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([937, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6521682739257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6521682739257812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 937, 256]), torch.Size([1, 937, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6539554595947266  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6694545745849609  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 937, 256])
m.shape torch.Size([786, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6701841354370117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6701841354370117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 786, 256]), torch.Size([1, 786, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6716833114624023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6941709518432617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 786, 256])
m.shape torch.Size([694, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.695467472076416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.695467472076416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6967911720275879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7260146141052246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 694, 256])
m.shape torch.Size([526, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7274074554443359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7274074554443359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7284107208251953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7582025527954102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([413, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7596859931945801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7596859931945801  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7604737281799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7890639305114746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7903885841369629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7903885841369629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.790956974029541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.815889835357666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([239, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8172140121459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8172140121459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8176698684692383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8404626846313477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8418498039245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8418498039245605  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8422503471374512  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8650813102722168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([162, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8662824630737305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8662824630737305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8665914535522461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8863668441772461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8878755569458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8878755569458008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8882055282592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9116334915161133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9128961563110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9128961563110352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9131536483764648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9332380294799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9343318939208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9343318939208984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9345340728759766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9517192840576172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526619911193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9526619911193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9528183937072754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9672074317932129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.968071460723877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.968071460723877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9682049751281738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9814229011535645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9824666976928711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9824666976928711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9826135635375977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9981813430786133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9989690780639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9989690780639648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9990758895874023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0111455917358398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.012007236480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.012007236480713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0121140480041504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0249314308166504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0254836082458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0254836082458496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.025550365447998  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0340285301208496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0347075462341309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0347075462341309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0347819328308105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0447497367858887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.045539379119873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.045539379119873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.045621395111084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0571856498718262  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0578713417053223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0578713417053223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0579400062561035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0681023597717285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0685124397277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0685124397277832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0685524940490723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.074760913848877  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.075139045715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.075139045715332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0751733779907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.080735206604004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.081202507019043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.081202507019043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.081242561340332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0880117416381836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0949840545654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0949840545654297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0955390930175781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1960830688476562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.166825771331787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.167649269104004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1684727668762207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1676077842712402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5524, 40])
input nodes number: 12054
output nodes number: 5524
edges number: 36537
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1677370071411133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1677374839782715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026405811309814453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 7 input nodes size: 22420
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023969650268554688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.023969650268554688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03466033935546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03470420837402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02266216278076172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02367877960205078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02367877960205078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02367877960205078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22420, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02367877960205078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1027, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06588268280029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06588268280029297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06686210632324219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07469749450683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([1117, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07527303695678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07527303695678711  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07633829116821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09231710433959961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1074, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09368324279785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09368324279785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09470748901367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11724090576171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([943, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11852741241455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11852741241455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 943, 128]), torch.Size([1, 943, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11942672729492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1455068588256836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 943, 128])
m.shape torch.Size([918, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1472458839416504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1472458839416504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14812135696411133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17963838577270508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([781, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18143510818481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18143510818481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 781, 128]), torch.Size([1, 781, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18217992782592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21498537063598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 781, 128])
m.shape torch.Size([701, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21695280075073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21695280075073242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2176213264465332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25136613845825195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([614, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2533740997314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2533740997314453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.25395965576171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28876686096191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([531, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2907528877258301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2907528877258301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2912592887878418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32448387145996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([5100, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.34854936599731445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.34854936599731445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 5100, 128]), torch.Size([1, 5100, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3535275459289551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7002320289611816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 5100, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6630673408508301  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6752800941467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.687492847442627  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6751842498779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12806, 256])
first layer input nodes number: 22420
first layer output nodes number: 12806
edges number: 85129
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6876621246337891  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6998748779296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7029280662536621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7029280662536621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([723, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7530612945556641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7530612945556641  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 723, 256]), torch.Size([1, 723, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7544403076171875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.765472412109375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 723, 256])
m.shape torch.Size([628, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7660045623779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7660045623779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7672023773193359  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7853012084960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([553, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7865171432495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7865171432495117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.787571907043457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8116960525512695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([441, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8128643035888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8128643035888672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8137054443359375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8389358520507812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([390, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8412384986877441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8412384986877441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.841982364654541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8689718246459961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([335, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8705320358276367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8705320358276367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8711709976196289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8994379043579102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([307, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.90118408203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.90118408203125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9017696380615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.931492805480957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([254, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9331531524658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9331531524658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9336376190185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9612522125244141  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([240, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9633951187133789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9633951187133789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9638528823852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9931497573852539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([189, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9947376251220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9947376251220703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9950981140136719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0206928253173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([170, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0223102569580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0223102569580078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.022634506225586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0479259490966797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([141, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0493903160095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0493903160095215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.049659252166748  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0725188255310059  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([122, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.073908805847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.073908805847168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.074141502380371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0955495834350586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([123, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.09708833694458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.09708833694458  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.097322940826416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1205487251281738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([109, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1220030784606934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1220030784606934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.12221097946167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1442484855651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1453595161437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1453595161437988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.145510196685791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1625370979309082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1639814376831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1639814376831055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.164158821105957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1854448318481445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1865673065185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1865673065185547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1867008209228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2036571502685547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2045769691467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2045769691467285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2046799659729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2184815406799316  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([74, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2198529243469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2198529243469238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.219994068145752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2398953437805176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2410964965820312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2410964965820312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2412166595458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2590007781982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.259702205657959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.259702205657959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2597708702087402  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.270413875579834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2713747024536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2713747024536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2714605331420898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.285365104675293  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.286221981048584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.286221981048584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2862963676452637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2988677024841309  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([576, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3126707077026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3126707077026367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3137693405151367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5076169967651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 576, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4637036323547363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.464576244354248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4654488563537598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4645323753356934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5854, 40])
input nodes number: 12806
output nodes number: 5854
edges number: 51195
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4647212028503418  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4647216796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02564716339111328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 8 input nodes size: 27283
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02271127700805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02271127700805664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0357208251953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035764217376708984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025029659271240234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025866985321044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025866985321044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025866985321044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([27283, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.025866985321044922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1460, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06313657760620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06313657760620117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0645289421081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07736396789550781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([1481, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0780801773071289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0780801773071289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1481, 128]), torch.Size([1, 1481, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07949256896972656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1006784439086914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1481, 128])
m.shape torch.Size([1296, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10182619094848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10182619094848633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10306215286254883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13062715530395508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1296, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13205575942993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13205575942993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13307905197143555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16301584243774414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1045, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16499567031860352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16499567031860352  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16599225997924805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20264339447021484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([833, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2045283317565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2045283317565918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2053227424621582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23995161056518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([672, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24179744720458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24179744720458984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24243831634521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27510738372802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([592, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27704524993896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27704524993896484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27760982513427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3101778030395508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([465, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3118910789489746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3118910789489746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3123345375061035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3407158851623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([3807, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35864734649658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35864734649658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3807, 128]), torch.Size([1, 3807, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3622779846191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6200532913208008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3807, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5892372131347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6013717651367188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6135063171386719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6012768745422363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12724, 256])
first layer input nodes number: 27283
first layer output nodes number: 12724
edges number: 74520
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6137118339538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6258463859558105  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6288800239562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6288800239562988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1007, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6663331985473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6663331985473633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1007, 256]), torch.Size([1, 1007, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6682538986206055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.683619499206543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1007, 256])
m.shape torch.Size([847, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6846470832824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6846470832824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6862626075744629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.712364673614502  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([627, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7133650779724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7133650779724121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7145609855651855  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7415719032287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([522, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7437782287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7437782287597656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7447738647460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7736473083496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([495, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7755284309387207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7755284309387207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7764725685119629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8111100196838379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([358, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8127026557922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8127026557922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8133854866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8440251350402832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([268, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.845487117767334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.845487117767334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8459982872009277  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8723626136779785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8738293647766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8738293647766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8742566108703613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8986096382141113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9000482559204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9000482559204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9004125595092773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9237279891967773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9250164031982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9250164031982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9253082275390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9460277557373047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9470767974853516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9470767974853516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9472923278808594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9641036987304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9653801918029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9653801918029785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.965609073638916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9850640296936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.986386775970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.986386775970459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9866061210632324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0067858695983887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0078606605529785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0078606605529785  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.008028507232666  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0246453285217285  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.025498867034912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.025498867034912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.025622844696045  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.038764476776123  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0395021438598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0395021438598633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0396013259887695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0508089065551758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0516910552978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0516910552978516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0517997741699219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0648460388183594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.065657138824463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.065657138824463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0657525062561035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.077864170074463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.078784465789795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.078784465789795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.078885555267334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0924315452575684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0931692123413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0931692123413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.093247413635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.104273796081543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1046385765075684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1046385765075684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1046767234802246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1103224754333496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1108531951904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1108531951904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1109027862548828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1185894012451172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1190733909606934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1190733909606934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.119117259979248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1262240409851074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1268253326416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1268253326416016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1268768310546875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.135580062866211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([257, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1417298316955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1417298316955566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1422200202941895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.232353687286377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 257, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2015438079833984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2024083137512207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.203272819519043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2023649215698242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5799, 40])
input nodes number: 12724
output nodes number: 5799
edges number: 37717
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2024950981140137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2024955749511719  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02753162384033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 9 input nodes size: 40932
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02502155303955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02502155303955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04455280303955078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04459428787231445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03154134750366211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032826900482177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032826900482177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032826900482177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([40932, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.032826900482177734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1405, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09778404235839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09778404235839844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1405, 128]), torch.Size([1, 1405, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.09912395477294922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10984325408935547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1405, 128])
m.shape torch.Size([1422, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11052942276000977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11052942276000977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1422, 128]), torch.Size([1, 1422, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.11188554763793945  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13222742080688477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1422, 128])
m.shape torch.Size([1216, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13354825973510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13354825973510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1216, 128]), torch.Size([1, 1216, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13470792770385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16022062301635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1216, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1617579460144043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1617579460144043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16280508041381836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19385480880737305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([983, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19567489624023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19567489624023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19661235809326172  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23067426681518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([864, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23267745971679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23267745971679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.23350143432617188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2698020935058594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([771, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27196359634399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27196359634399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27269887924194336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31012630462646484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([775, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3127150535583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3127150535583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31345415115356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35621213912963867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([659, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.358670711517334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.358670711517334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3592991828918457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40003108978271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([9140, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4432997703552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4432997703552246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 9140, 128]), torch.Size([1, 9140, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.45201635360717773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0708937644958496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 9140, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0123109817504883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.029794692993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0472784042358398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0296578407287598  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([18333, 256])
first layer input nodes number: 40932
first layer output nodes number: 18333
edges number: 131316
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0475854873657227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0650691986083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0694403648376465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0694403648376465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([954, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.110142707824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.110142707824707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 954, 256]), torch.Size([1, 954, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1119623184204102  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1274309158325195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 954, 256])
m.shape torch.Size([805, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.128469467163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.128469467163086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1300048828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1541976928710938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([583, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.155503273010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.155503273010254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1566152572631836  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1810789108276367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([429, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.182633876800537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.182633876800537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.1834521293640137  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2127203941345215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.214423656463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.214423656463623  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.215146541595459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2509551048278809  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([296, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2527050971984863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2527050971984863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2532696723937988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2804512977600098  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([243, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.281804084777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.281804084777832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.2822675704956055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3054418563842773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.306809425354004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.306809425354004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.307206153869629  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.329819679260254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3310489654541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3310489654541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3313636779785156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3515052795410156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([152, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.352808952331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.352808952331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3530988693237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.373682975769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.37501859664917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.37501859664917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3752856254577637  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3961138725280762  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([97, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.397099494934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.397099494934082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3972845077514648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.413010597229004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4137678146362305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4137678146362305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4138975143432617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4258298873901367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4266400337219238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4266400337219238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4267640113830566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.439037799835205  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4398412704467773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4398412704467773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.439955711364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4520864486694336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4529829025268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4529829025268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4531011581420898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4664640426635742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.46730375289917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.46730375289917  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4674086570739746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.479997158050537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4807233810424805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4807233810424805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.480809211730957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4917097091674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4925618171691895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4925618171691895  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4926552772521973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5051789283752441  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5059399604797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5059399604797363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5060200691223145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.51731538772583  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5180425643920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5180425643920898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5181150436401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5288419723510742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5294404029846191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5294404029846191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5294976234436035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5383667945861816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5387582778930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5387582778930664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5387945175170898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5446653366088867  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.545454978942871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.545454978942871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5455217361450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5568037033081055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([498, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5687365531921387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5687365531921387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5696864128112793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.737454891204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 498, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.702867031097412  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7036895751953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.704512119293213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7036480903625488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 18333
output nodes number: 5517
edges number: 41161
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.703784465789795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7037849426269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03515625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 10 input nodes size: 54123
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.031499385833740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.031499385833740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05730724334716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05734872817993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03777599334716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.039381980895996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.039381980895996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.039381980895996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([54123, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.039381980895996094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1425, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.123077392578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.123077392578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1425, 128]), torch.Size([1, 1425, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1244363784790039  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1360793113708496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1425, 128])
m.shape torch.Size([1537, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13686561584472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13686561584472656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1537, 128]), torch.Size([1, 1537, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13833141326904297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16031837463378906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1537, 128])
m.shape torch.Size([1333, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16161775588989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16161775588989258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1333, 128]), torch.Size([1, 1333, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1628890037536621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19103384017944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1333, 128])
m.shape torch.Size([1143, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19257831573486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19257831573486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.19366836547851562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2252798080444336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1083, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22731685638427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.22731685638427734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2283496856689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2665271759033203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([922, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.268648624420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.268648624420166  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2695279121398926  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.30836963653564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([876, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3116340637207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3116340637207031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.312469482421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35424041748046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([821, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35695457458496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35695457458496094  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.35773754119873047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40384674072265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([735, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40660953521728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40660953521728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.40731048583984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.45296335220336914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([12634, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5128564834594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5128564834594727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 12634, 128]), torch.Size([1, 12634, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5249052047729492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3803644180297852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 12634, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.303741455078125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3252077102661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3466739654541016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3250398635864258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([22509, 256])
first layer input nodes number: 54123
first layer output nodes number: 22509
edges number: 169672
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3470792770385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3685455322265625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3739123344421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.3739123344421387  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([914, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.419041633605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.419041633605957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 914, 256]), torch.Size([1, 914, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4207849502563477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4362220764160156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 914, 256])
m.shape torch.Size([789, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.43721342086792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.43721342086792  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 789, 256]), torch.Size([1, 789, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.438718318939209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4618606567382812  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 789, 256])
m.shape torch.Size([559, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.462996006011963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.462996006011963  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.464062213897705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4945740699768066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4957714080810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4957714080810547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.4966297149658203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5222511291503906  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([361, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.523557186126709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.523557186126709  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5242457389831543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5492043495178223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([248, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.550290584564209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.550290584564209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5507636070251465  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.571103572845459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([222, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5723609924316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5723609924316406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.572784423828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5939559936523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([168, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5950608253479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.5950608253479004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.595381259918213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6136460304260254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([156, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.614835262298584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.614835262298584  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6151328086853027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6341757774353027  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6353826522827148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6353826522827148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6356515884399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6547460556030273  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6557483673095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6557483673095703  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.65594482421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6712684631347656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([91, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6722259521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6722259521484375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6723995208740234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6871528625488281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6882262229919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6882262229919434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6883769035339355  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7022395133972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7030525207519531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7030525207519531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7031784057617188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7156410217285156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7163424491882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7163424491882324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7164435386657715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.727159023284912  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7279853820800781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7279853820800781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7280941009521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7403793334960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.741011619567871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.741011619567871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7410917282104492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7507047653198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7519049644470215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7519049644470215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7520174980163574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7663092613220215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7670202255249023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7670202255249023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7671003341674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7778348922729492  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.778698444366455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.778698444366455  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7787880897521973  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7914280891418457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7920093536376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7920093536376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7920684814453125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8008193969726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.801572322845459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.801572322845459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.801642894744873  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8125815391540527  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8130989074707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8130989074707031  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8131465911865234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.820871353149414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8215398788452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8215398788452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8215970993041992  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8312673568725586  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([747, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8491878509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8491878509521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 747, 256]), torch.Size([1, 747, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8506126403808594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.111363410949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 747, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0721073150634766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.072929859161377  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0737524032592773  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0728883743286133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 22509
output nodes number: 5517
edges number: 45806
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0730977058410645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0730981826782227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.04229879379272461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 11 input nodes size: 30750
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03777599334716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03777599334716797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05243873596191406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.052480220794677734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.026630878448486328  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02738332748413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02738332748413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02738332748413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([30750, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02738332748413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1591, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06281089782714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06281089782714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06432819366455078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07646656036376953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1630, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07754182815551758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07754182815551758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1630, 128]), torch.Size([1, 1630, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.07909631729125977  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10336542129516602  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1630, 128])
m.shape torch.Size([1391, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1049494743347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1049494743347168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1391, 128]), torch.Size([1, 1391, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.10627603530883789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13596391677856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1391, 128])
m.shape torch.Size([1138, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13747119903564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13747119903564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13855648040771484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17074871063232422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([991, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17256879806518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17256879806518555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.17351388931274414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20797061920166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([741, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20961809158325195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.20961809158325195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 741, 128]), torch.Size([1, 741, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21032476425170898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24160528182983398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 741, 128])
m.shape torch.Size([652, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24342823028564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24342823028564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2440500259399414  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27513980865478516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([593, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27709102630615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27709102630615234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.27765655517578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.31050968170166016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([491, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3123340606689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3123340606689453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3128023147583008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3427705764770508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([3390, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.358701229095459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.358701229095459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 3390, 128]), torch.Size([1, 3390, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36193418502807617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.593076229095459  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 3390, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5634307861328125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5754547119140625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5874786376953125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5753607749938965  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([12608, 256])
first layer input nodes number: 30750
first layer output nodes number: 12608
edges number: 70604
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.587709903717041  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.599733829498291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6031002998352051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6031002998352051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([1123, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.634119987487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.634119987487793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1123, 256]), torch.Size([1, 1123, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.637049674987793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6548528671264648  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1123, 256])
m.shape torch.Size([971, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6559386253356934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6559386253356934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 971, 256]), torch.Size([1, 971, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6577906608581543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6856703758239746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 971, 256])
m.shape torch.Size([718, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.686913013458252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.686913013458252  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.6882824897766113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7187695503234863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([530, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7201228141784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7201228141784668  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 530, 256]), torch.Size([1, 530, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7211337089538574  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7510676383972168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 530, 256])
m.shape torch.Size([436, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7526578903198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7526578903198242  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7534894943237305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7844305038452148  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([293, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7857046127319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7857046127319336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.7862634658813477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8109292984008789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([222, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8121438026428223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8121438026428223  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8125672340393066  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8337388038635254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([206, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.835111141204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.835111141204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8355040550231934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8579001426696777  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([160, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8590879440307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8590879440307617  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8593931198120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8789243698120117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([137, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8800888061523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8800888061523438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8803501129150391  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8989028930664062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8999142646789551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.8999142646789551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9001202583312988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9161877632141113  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9170651435852051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9170651435852051  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9172272682189941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9310078620910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9318890571594238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9318890571594238  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9320359230041504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9455475807189941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.94622802734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.94622802734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9463348388671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9569091796875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9575047492980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9575047492980957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9575905799865723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9666886329650879  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9673995971679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9673995971679688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9674930572509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9780540466308594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9787263870239258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9787263870239258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9788103103637695  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9888811111450195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9893927574157715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9893927574157715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9894537925720215  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9972052574157715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9977774620056152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.9977774620056152  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.997840404510498  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.006274700164795  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0067048072814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0067048072814941  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0067505836486816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0132050514221191  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0136871337890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0136871337890625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0137348175048828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.020792007446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0210857391357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0210857391357422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0211143493652344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0255489349365234  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0257115364074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0257115364074707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0257267951965332  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0281987190246582  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0285372734069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0285372734069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0285658836364746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0334010124206543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([149, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0369672775268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0369672775268555  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0372514724731445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0872697830200195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 149, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.063009262084961  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.063838005065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.064666748046875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0637965202331543  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5561, 40])
input nodes number: 12608
output nodes number: 5561
edges number: 30296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639381408691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.0639386177062988  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.028942108154296875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 12 input nodes size: 49101
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02663707733154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.02663707733154297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05005025863647461  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.05009174346923828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035387516021728516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([49101, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([958, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13963747024536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.13963747024536133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14055109024047852  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14826202392578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([1028, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14878559112548828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.14878559112548828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1497659683227539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16447162628173828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([969, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16536760330200195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.16536760330200195  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1662917137145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18669891357421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([858, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18787336349487305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.18787336349487305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.1886916160583496  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21246862411499023  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([845, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21407413482666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21407413482666016  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.21487998962402344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2440814971923828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([804, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24597883224487305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24597883224487305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.24674558639526367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2799220085144043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([778, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2821354866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.2821354866027832  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.28287744522094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32038068771362305  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([724, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3227715492248535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.3227715492248535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.32346200942993164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36397790908813477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([748, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36684274673461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.36684274673461914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.367556095123291  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.41406679153442383  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([17184, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4956498146057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.4956498146057129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 17184, 128]), torch.Size([1, 17184, 128])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.5120377540588379  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.675581455230713  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 17184, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.579503059387207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.603245735168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.626988410949707  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.603060245513916  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([24896, 256])
first layer input nodes number: 49101
first layer output nodes number: 24896
edges number: 208212
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6273565292358398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6510992050170898  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6573858261108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.6573858261108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([662, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7188434600830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7188434600830078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7201061248779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7320613861083984  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([539, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.732614517211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.732614517211914  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.733642578125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.749063491821289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([427, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7497811317443848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7497811317443848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7505955696105957  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.76948881149292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([310, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.770491123199463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.770491123199463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7710824012756348  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7896409034729004  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([288, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7907295227050781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7907295227050781  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.7912788391113281  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8131599426269531  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([225, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.814183235168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.814183235168457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8146123886108398  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8330659866333008  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([195, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8341636657714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8341636657714844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8345355987548828  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8531322479248047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([153, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8541231155395508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8541231155395508  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.854414939880371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.871048927307129  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8724255561828613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8724255561828613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8727612495422363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8942456245422363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([145, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8955202102661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.8955202102661133  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.895796775817871  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9154329299926758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.916658878326416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.916658878326416  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9169049263000488  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9360966682434082  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([132, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9374961853027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9374961853027344  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9377479553222656  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9591484069824219  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9609451293945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9609451293945312  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9611492156982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9799251556396484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.980980396270752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.980980396270752  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9811444282531738  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9973835945129395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.998469352722168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.998469352722168  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 1.9986238479614258  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.015000343322754  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0160460472106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0160460472106934  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0161852836608887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.031919002532959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([77, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0331077575683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0331077575683594  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.033254623413086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0508785247802734  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.052431583404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.052431583404541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0525593757629395  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.068789005279541  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([69, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0699853897094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0699853897094727  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.0701169967651367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.087752342224121  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.088916778564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.088916778564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.089038848876953  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.106250762939453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.107421398162842  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.107421398162842  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1075377464294434  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1247572898864746  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1257944107055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1257944107055664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1258840560913086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1397790908813477  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.140707015991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.140707015991211  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1407909393310547  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.154386520385742  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.155439853668213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.155439853668213  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1555237770080566  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.1697068214416504  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([1316, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2012863159179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2012863159179688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1316, 256]), torch.Size([1, 1316, 256])
----------------------------------------3
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.2038803100585938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.6533584594726562  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 1316, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.596412181854248  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5972347259521484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.598057270050049  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.5971932411193848  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([5517, 40])
input nodes number: 24896
output nodes number: 5517
edges number: 63044
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.597414016723633  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 2.597414493560791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.040880680084228516  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

pseudo mini batch 13 input nodes size: 57258
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035381317138671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.035381317138671875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0626840591430664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.06272745132446289  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.03927278518676758  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0418086051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0418086051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0418086051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([57258, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5252685546875 GB
    Memory Allocated: 0.0418086051940918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([942, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.17133045196533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.17133045196533203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.17222881317138672  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.17941570281982422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([976, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.17989730834960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.17989730834960938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.18082809448242188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.19478988647460938  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([905, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.1956191062927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.1956191062927246  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.19648218154907227  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.2154698371887207  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([902, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.21675872802734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.21675872802734375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.2176189422607422  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.2437267303466797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([878, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.2453899383544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.2453899383544922  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.24622726440429688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.27706480026245117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([945, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.27934980392456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.27934980392456055  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.28025102615356445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.3190035820007324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([901, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.3215603828430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.3215603828430176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.3224196434020996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.36681556701660156  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([905, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.36983823776245117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.36983823776245117  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.37070131301879883  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.42101430892944336  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([900, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.42444515228271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.42444515228271484  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.42530345916748047  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.4816751480102539  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([22138, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.5868082046508789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.5868082046508789  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 22138, 128]), torch.Size([1, 22138, 128])
----------------------------------------3
 Nvidia-smi: 4.6522216796875 GB
    Memory Allocated: 0.6079206466674805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.122431755065918  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 22138, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.000715732574463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.030012607574463  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.0589966773986816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.029473304748535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

torch.Size([30392, 256])
first layer input nodes number: 57258
first layer output nodes number: 30392
edges number: 262304
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.0594253540039062  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.088409423828125  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.0956554412841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.0956554412841797  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

m.shape torch.Size([565, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.1712422370910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.1712422370910645  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.1723198890686035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.1819310188293457  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([460, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.182276725769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.182276725769043  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.1831541061401367  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.1966686248779297  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([338, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.19720458984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.19720458984375  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.1978492736816406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2135848999023438  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([266, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.214285373687744  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.214285373687744  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2147927284240723  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.230241298675537  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.231078624725342  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.231078624725342  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2315115928649902  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.247098445892334  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([209, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2480874061584473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2480874061584473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.248486042022705  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.265627384185791  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([163, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.267059803009033  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.267059803009033  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2673707008361816  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2829155921936035  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([156, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2839598655700684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.2839598655700684  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.284257411956787  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.301217555999756  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([150, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3023667335510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3023667335510254  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3026528358459473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3209633827209473  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([146, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.322223663330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.322223663330078  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3225021362304688  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.342273712158203  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3435516357421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3435516357421875  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3438072204589844  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3637428283691406  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.365126132965088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.365126132965088  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3653759956359863  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3866143226623535  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3887014389038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3887014389038086  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.3889360427856445  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.410519599914551  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.411801815032959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.411801815032959  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4120001792907715  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.431638240814209  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4329233169555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4329233169555664  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4331064224243164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4525156021118164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([113, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.454162120819092  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.454162120819092  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4543776512145996  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4787325859069824  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4799647331237793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.4799647331237793  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.48012113571167  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.498889446258545  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([96, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.500472068786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.500472068786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.500655174255371  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.523909568786621  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.525425434112549  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.525425434112549  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.5255932807922363  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.5480847358703613  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.5498080253601074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.5498080253601074  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.549987316131592  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.5752673149108887  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([96, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.577115535736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.577115535736084  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.577298641204834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.604398250579834  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.605827808380127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.605827808380127  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.60593843460083  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.6230854988098145  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.6246442794799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.6246442794799805  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.624783515930176  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.6473398208618164  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.6493453979492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.6493453979492188  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.649463653564453  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.6694488525390625  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1768, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.71187162399292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.71187162399292  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

 h.shape torch.Size([1, 1768, 256]), torch.Size([1, 1768, 256])
----------------------------------------3
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 2.7152438163757324  GigaBytes
Max Memory Allocated: 3.1939563751220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 3.3145174980163574  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1768, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 3.244750499725342  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 3.245614528656006  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 3.24647855758667  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 3.2455711364746094  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

torch.Size([5798, 40])
input nodes number: 30392
output nodes number: 5798
edges number: 77833
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 3.245882511138916  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5760498046875 GB
    Memory Allocated: 3.245882987976074  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.04703807830810547  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

pseudo mini batch 14 input nodes size: 61087
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.03931427001953125  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.03931427001953125  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.06861114501953125  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.06865262985229492  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.041306495666503906  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.043419837951660156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.043419837951660156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.043419837951660156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

torch.Size([61087, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.043419837951660156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

m.shape torch.Size([1184, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.15511417388916016  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.15511417388916016  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1184, 128]), torch.Size([1, 1184, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.15624332427978516  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.16527652740478516  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1184, 128])
m.shape torch.Size([1290, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.16673517227172852  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.16673517227172852  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.16796541213989258  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.18641901016235352  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1237, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.18757343292236328  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.18757343292236328  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1237, 128]), torch.Size([1, 1237, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.1887531280517578  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2160019874572754  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1237, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2175426483154297  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2175426483154297  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.21860790252685547  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.24985694885253906  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1105, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.25195884704589844  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.25195884704589844  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.25301265716552734  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.29151248931884766  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1003, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2938551902770996  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2938551902770996  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1003, 128]), torch.Size([1, 1003, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2948117256164551  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.33725547790527344  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1003, 128])
m.shape torch.Size([991, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3400850296020508  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3400850296020508  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3410301208496094  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3889141082763672  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([909, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.391909122467041  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.391909122467041  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3927760124206543  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.44264841079711914  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([946, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.4462747573852539  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.4462747573852539  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 946, 128]), torch.Size([1, 946, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.4471769332885742  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.505305290222168  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 946, 128])
m.shape torch.Size([18110, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.5912094116210938  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.5912094116210938  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 18110, 128]), torch.Size([1, 18110, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.6091928482055664  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8361492156982422  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 18110, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.731184959411621  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7577848434448242  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7843847274780273  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7575769424438477  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

torch.Size([27892, 256])
first layer input nodes number: 61087
first layer output nodes number: 27892
edges number: 227309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7848420143127441  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8114418983459473  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.818091869354248  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.818091869354248  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

m.shape torch.Size([743, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8731575012207031  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8731575012207031  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 743, 256]), torch.Size([1, 743, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8745746612548828  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8859119415283203  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 743, 256])
m.shape torch.Size([610, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8866243362426758  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8866243362426758  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8877878189086914  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9052400588989258  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([493, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.906081199645996  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.906081199645996  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9070215225219727  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9307241439819336  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([368, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9317526817321777  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9317526817321777  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9324545860290527  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9596781730651855  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([318, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.960855484008789  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.960855484008789  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9614620208740234  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9874000549316406  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([250, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9885387420654297  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9885387420654297  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9890155792236328  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.009519577026367  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([200, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0111684799194336  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0111684799194336  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.011549949645996  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.030623435974121  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([174, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.031770706176758  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.031770706176758  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.032102584838867  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0510196685791016  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([138, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0520477294921875  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0520477294921875  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0523109436035156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0691566467285156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0710439682006836  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0710439682006836  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0713109970092773  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0902700424194336  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([126, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0914688110351562  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0914688110351562  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0917091369628906  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.110454559326172  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([101, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.111499309539795  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.111499309539795  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.111691951751709  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1280665397644043  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1300230026245117  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1300230026245117  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.13021183013916  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1475839614868164  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1487412452697754  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1487412452697754  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.148918628692627  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1664795875549316  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([100, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.167832851409912  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.167832851409912  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1680235862731934  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.188241481781006  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1900033950805664  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1900033950805664  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.1901445388793945  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2060937881469727  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.207167148590088  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.207167148590088  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2073006629943848  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2233223915100098  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([83, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.224691867828369  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.224691867828369  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2248501777648926  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.244955539703369  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2468457221984863  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2468457221984863  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2469582557678223  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.262037754058838  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.263026237487793  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.263026237487793  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.263129234313965  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.277651786804199  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.27877140045166  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.27877140045166  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2788820266723633  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.295254707336426  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2960453033447266  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.2960453033447266  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.296121597290039  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3079471588134766  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3087716102600098  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3087716102600098  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3088459968566895  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.320896625518799  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3219242095947266  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3219242095947266  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.322011947631836  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3368396759033203  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([1041, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.361809253692627  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.361809253692627  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1041, 256]), torch.Size([1, 1041, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.3637948036193848  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.73067045211792  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1041, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.6804428100585938  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.681265354156494  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.6820878982543945  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.6812238693237305  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

torch.Size([5517, 40])
input nodes number: 27892
output nodes number: 5517
edges number: 56318
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.681431770324707  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.6814322471618652  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.047052860260009766  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

pseudo mini batch 15 input nodes size: 60533
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.041265010833740234  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.041265010833740234  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.07012939453125  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.07017087936401367  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.04083251953125  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.04247474670410156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.04247474670410156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.04247474670410156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

torch.Size([60533, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.04247474670410156  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

m.shape torch.Size([1536, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.13072824478149414  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.13072824478149414  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1536, 128]), torch.Size([1, 1536, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.13219308853149414  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.14391183853149414  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1536, 128])
m.shape torch.Size([1547, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.14479684829711914  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.14479684829711914  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1547, 128]), torch.Size([1, 1547, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.1462721824645996  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.16840219497680664  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1547, 128])
m.shape torch.Size([1418, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.17005014419555664  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.17005014419555664  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1418, 128]), torch.Size([1, 1418, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.1714024543762207  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2017521858215332  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1418, 128])
m.shape torch.Size([1215, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.20339345932006836  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.20339345932006836  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1215, 128]), torch.Size([1, 1215, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.20455217361450195  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2383723258972168  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1215, 128])
m.shape torch.Size([1127, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2411022186279297  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2411022186279297  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.24217700958251953  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2810544967651367  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2833552360534668  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2833552360534668  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.2843012809753418  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.32560300827026367  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([898, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.328127384185791  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.328127384185791  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 898, 128]), torch.Size([1, 898, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.32898378372192383  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3726515769958496  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 898, 128])
m.shape torch.Size([827, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3753781318664551  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.3753781318664551  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.37616682052612305  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.421724796295166  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([743, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.42451906204223633  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.42451906204223633  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.42522764205932617  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.47130584716796875  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([13396, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.5348286628723145  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.5348286628723145  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 13396, 128]), torch.Size([1, 13396, 128])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.5476040840148926  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.4623894691467285  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 13396, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.3808207511901855  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.4034218788146973  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.426023006439209  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.403244972229004  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

torch.Size([23699, 256])
first layer input nodes number: 60533
first layer output nodes number: 23699
edges number: 178880
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.426476001739502  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.4490771293640137  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.454984188079834  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.454984188079834  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

m.shape torch.Size([980, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.495901107788086  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.495901107788086  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 980, 256]), torch.Size([1, 980, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.4977703094482422  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5127315521240234  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 980, 256])
m.shape torch.Size([798, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5140199661254883  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5140199661254883  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5155420303344727  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5388555526733398  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 798, 256])
m.shape torch.Size([609, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5403194427490234  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5403194427490234  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5414810180664062  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5677032470703125  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 609, 256])
m.shape torch.Size([467, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5690326690673828  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5690326690673828  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5699234008789062  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.595754623413086  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5971260070800781  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5971260070800781  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.5978469848632812  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6252727508544922  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([266, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.62644624710083  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.62644624710083  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6269536018371582  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.650240421295166  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([225, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6515007019042969  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6515007019042969  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6519298553466797  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6733875274658203  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([191, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6746416091918945  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6746416091918945  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6750059127807617  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6957712173461914  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([158, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6969561576843262  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6969561576843262  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.6972575187683105  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7165446281433105  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([128, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7176241874694824  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7176241874694824  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7178683280944824  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7352023124694824  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.736264705657959  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.736264705657959  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.736478328704834  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.753140926361084  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7543492317199707  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7543492317199707  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7545666694641113  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7730488777160645  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([90, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7740650177001953  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7740650177001953  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7742366790771484  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.790029525756836  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7907648086547852  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7907648086547852  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.7908811569213867  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8023996353149414  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.803278923034668  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.803278923034668  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8034029006958008  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.816544532775879  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8172979354858398  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8172979354858398  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.817399024963379  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.828822135925293  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8294744491577148  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8294744491577148  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8295564651489258  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8393983840942383  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.840205192565918  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.840205192565918  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8402986526489258  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.852168083190918  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8529982566833496  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8529982566833496  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8530898094177246  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8653578758239746  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8660235404968262  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8660235404968262  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8660941123962402  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.876044750213623  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8766756057739258  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8766756057739258  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8767385482788086  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8860540390014648  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8865513801574707  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8865513801574707  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.886599063873291  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8939900398254395  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8945856094360352  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.8945856094360352  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.894639015197754  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9032907485961914  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9039101600646973  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9039101600646973  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.903963565826416  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9129891395568848  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([541, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9265751838684082  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9265751838684082  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 1.9276070594787598  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.111419200897217  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

rst.shape  torch.Size([1, 541, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0766124725341797  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0774364471435547  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0782604217529297  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.077394962310791  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

torch.Size([5527, 40])
input nodes number: 23699
output nodes number: 5527
edges number: 41358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.0776147842407227  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 2.077615261077881  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.045472145080566406  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.045472145080566406  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.6522216796875 GB
    Memory Allocated: 0.045472145080566406  GigaBytes
Max Memory Allocated: 3.3566699028015137  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013168081641197205 |0.001987636089324951 |0.1190200001001358 |9.076297283172607e-05 |0.0718470960855484 |0.004868984222412109 |
----------------------------------------------------------pseudo_mini_loss sum 3.8422627449035645
Total (block generation + training)time/epoch 24.694603443145752
Training time/epoch 3.369647979736328
Training time without block to device /epoch 3.337845802307129
Training time without total dataloading part /epoch 3.060194730758667
load block tensor time/epoch 0.21068930625915527
block to device time/epoch 0.03180217742919922
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  845383
Number of first layer input nodes during this epoch:  575549
Number of first layer output nodes during this epoch:  269834
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
