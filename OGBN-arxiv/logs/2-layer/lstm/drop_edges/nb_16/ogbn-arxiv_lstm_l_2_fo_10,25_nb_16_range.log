main start at this time 1651556768.0388656
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02822279930114746
number of batches is  16
batch size is  5684
range selection method spend 0.013780593872070312
time for parepare:  0.017418622970581055
local_output_nid generation:  0.0013384819030761719
local_in_edges_tensor generation:  0.0038299560546875
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.01687908172607422
local_output_nid generation:  0.0014262199401855469
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0017430782318115234
r_  generation:  0.015700340270996094
local_output_nid generation:  0.0014812946319580078
local_in_edges_tensor generation:  0.0008347034454345703
mini_batch_src_global generation:  0.0012507438659667969
r_  generation:  0.015978097915649414
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0008521080017089844
mini_batch_src_global generation:  0.001260519027709961
r_  generation:  0.01582813262939453
local_output_nid generation:  0.001415252685546875
local_in_edges_tensor generation:  0.0008015632629394531
mini_batch_src_global generation:  0.0011734962463378906
r_  generation:  0.0159914493560791
local_output_nid generation:  0.0014088153839111328
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.001346588134765625
r_  generation:  0.016371965408325195
local_output_nid generation:  0.0014247894287109375
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.001337289810180664
r_  generation:  0.01656961441040039
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.001346588134765625
r_  generation:  0.016516447067260742
local_output_nid generation:  0.0014190673828125
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.001233816146850586
r_  generation:  0.017155170440673828
local_output_nid generation:  0.0014331340789794922
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.001331329345703125
r_  generation:  0.016501903533935547
local_output_nid generation:  0.0014619827270507812
local_in_edges_tensor generation:  0.0008482933044433594
mini_batch_src_global generation:  0.0012221336364746094
r_  generation:  0.01661062240600586
local_output_nid generation:  0.0014328956604003906
local_in_edges_tensor generation:  0.0007853507995605469
mini_batch_src_global generation:  0.0014119148254394531
r_  generation:  0.017370939254760742
local_output_nid generation:  0.0014328956604003906
local_in_edges_tensor generation:  0.0007929801940917969
mini_batch_src_global generation:  0.0014104843139648438
r_  generation:  0.0169827938079834
local_output_nid generation:  0.001453399658203125
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.0012710094451904297
r_  generation:  0.0168302059173584
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0013556480407714844
r_  generation:  0.01700282096862793
local_output_nid generation:  0.0014603137969970703
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0014202594757080078
r_  generation:  0.01701831817626953
----------------------check_connections_block total spend ----------------------------- 0.40387749671936035
generate_one_block  0.024461746215820312
generate_one_block  0.026447534561157227
generate_one_block  0.024825334548950195
generate_one_block  0.024812936782836914
generate_one_block  0.02460169792175293
generate_one_block  0.02458667755126953
generate_one_block  0.02440667152404785
generate_one_block  0.024713993072509766
generate_one_block  0.024550914764404297
generate_one_block  0.023917436599731445
generate_one_block  0.024037837982177734
generate_one_block  0.025585412979125977
generate_one_block  0.02512502670288086
generate_one_block  0.023957490921020508
generate_one_block  0.0248563289642334
generate_one_block  0.025628089904785156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02480602264404297
gen group dst list time:  0.01705169677734375
time for parepare:  0.018689393997192383
local_output_nid generation:  0.005899190902709961
local_in_edges_tensor generation:  0.01296234130859375
mini_batch_src_global generation:  0.008972406387329102
r_  generation:  0.09924149513244629
local_output_nid generation:  0.008819341659545898
local_in_edges_tensor generation:  0.01076054573059082
mini_batch_src_global generation:  0.011469602584838867
r_  generation:  0.10666942596435547
local_output_nid generation:  0.009200096130371094
local_in_edges_tensor generation:  0.008528947830200195
mini_batch_src_global generation:  0.010515928268432617
r_  generation:  0.10913634300231934
local_output_nid generation:  0.009499073028564453
local_in_edges_tensor generation:  0.009603261947631836
mini_batch_src_global generation:  0.01133108139038086
r_  generation:  0.11349868774414062
local_output_nid generation:  0.0096435546875
local_in_edges_tensor generation:  0.008085012435913086
mini_batch_src_global generation:  0.012157678604125977
r_  generation:  0.11362957954406738
local_output_nid generation:  0.009835243225097656
local_in_edges_tensor generation:  0.008996248245239258
mini_batch_src_global generation:  0.012432336807250977
r_  generation:  0.11577010154724121
local_output_nid generation:  0.009876251220703125
local_in_edges_tensor generation:  0.00809335708618164
mini_batch_src_global generation:  0.012918710708618164
r_  generation:  0.11609840393066406
local_output_nid generation:  0.010167360305786133
local_in_edges_tensor generation:  0.008325576782226562
mini_batch_src_global generation:  0.01334381103515625
r_  generation:  0.11868023872375488
local_output_nid generation:  0.009974002838134766
local_in_edges_tensor generation:  0.008678197860717773
mini_batch_src_global generation:  0.012888908386230469
r_  generation:  0.11285901069641113
local_output_nid generation:  0.010010957717895508
local_in_edges_tensor generation:  0.00814962387084961
mini_batch_src_global generation:  0.012660026550292969
r_  generation:  0.11529850959777832
local_output_nid generation:  0.010101318359375
local_in_edges_tensor generation:  0.008350372314453125
mini_batch_src_global generation:  0.012776851654052734
r_  generation:  0.11249637603759766
local_output_nid generation:  0.010272741317749023
local_in_edges_tensor generation:  0.008903741836547852
mini_batch_src_global generation:  0.014009952545166016
r_  generation:  0.11923575401306152
local_output_nid generation:  0.010252237319946289
local_in_edges_tensor generation:  0.008442401885986328
mini_batch_src_global generation:  0.013147592544555664
r_  generation:  0.1165003776550293
local_output_nid generation:  0.010194063186645508
local_in_edges_tensor generation:  0.008261919021606445
mini_batch_src_global generation:  0.01299905776977539
r_  generation:  0.11467647552490234
local_output_nid generation:  0.010269641876220703
local_in_edges_tensor generation:  0.00880885124206543
mini_batch_src_global generation:  0.012871265411376953
r_  generation:  0.11962199211120605
local_output_nid generation:  0.010483503341674805
local_in_edges_tensor generation:  0.009367942810058594
mini_batch_src_global generation:  0.014086008071899414
r_  generation:  0.11951589584350586
----------------------check_connections_block total spend ----------------------------- 2.774237632751465
generate_one_block  0.13553190231323242
generate_one_block  0.13423609733581543
generate_one_block  0.14912915229797363
generate_one_block  0.13493037223815918
generate_one_block  0.13676190376281738
generate_one_block  0.13597559928894043
generate_one_block  0.13623428344726562
generate_one_block  0.1373753547668457
generate_one_block  0.13426494598388672
generate_one_block  0.13510560989379883
generate_one_block  0.1352832317352295
generate_one_block  0.1429433822631836
generate_one_block  0.138535737991333
generate_one_block  0.1415114402770996
generate_one_block  0.13428092002868652
generate_one_block  0.1418159008026123
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  2.774237632751465
block generation total time  2.20391583442688
average batch blocks generation time:  0.13774473965168
pseudo mini batch 0 input nodes size: 96559
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.0496525764465332  GigaBytes
Max Memory Allocated: 0.0496525764465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.04969501495361328  GigaBytes
Max Memory Allocated: 0.04969501495361328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.04969501495361328  GigaBytes
Max Memory Allocated: 0.04969501495361328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052158355712890625  GigaBytes
Max Memory Allocated: 0.052158355712890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052158355712890625  GigaBytes
Max Memory Allocated: 0.052158355712890625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052158355712890625  GigaBytes
Max Memory Allocated: 0.052158355712890625  GigaBytes

torch.Size([96559, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052158355712890625  GigaBytes
Max Memory Allocated: 0.052158355712890625  GigaBytes

m.shape torch.Size([1645, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1931757926940918  GigaBytes
Max Memory Allocated: 0.19671869277954102  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1931757926940918  GigaBytes
Max Memory Allocated: 0.19671869277954102  GigaBytes

 h.shape torch.Size([1, 1645, 128]), torch.Size([1, 1645, 128])
----------------------------------------3
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.19474458694458008  GigaBytes
Max Memory Allocated: 0.19671869277954102  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20729494094848633  GigaBytes
Max Memory Allocated: 0.20807933807373047  GigaBytes

rst.shape  torch.Size([1, 1645, 128])
m.shape torch.Size([2117, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20852947235107422  GigaBytes
Max Memory Allocated: 0.20857763290405273  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20852947235107422  GigaBytes
Max Memory Allocated: 0.20857763290405273  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.21054840087890625  GigaBytes
Max Memory Allocated: 0.21054840087890625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.24201107025146484  GigaBytes
Max Memory Allocated: 0.24402999877929688  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2168, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.24410295486450195  GigaBytes
Max Memory Allocated: 0.24417591094970703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.24410295486450195  GigaBytes
Max Memory Allocated: 0.24417591094970703  GigaBytes

 h.shape torch.Size([1, 2168, 128]), torch.Size([1, 2168, 128])
----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.24713134765625  GigaBytes
Max Memory Allocated: 0.24713134765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.2946453094482422  GigaBytes
Max Memory Allocated: 0.2977466583251953  GigaBytes

rst.shape  torch.Size([1, 2168, 128])
m.shape torch.Size([2102, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.2977466583251953  GigaBytes
Max Memory Allocated: 0.29784107208251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.2977466583251953  GigaBytes
Max Memory Allocated: 0.29784107208251953  GigaBytes

 h.shape torch.Size([1, 2102, 128]), torch.Size([1, 2102, 128])
----------------------------------------3
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.29975128173828125  GigaBytes
Max Memory Allocated: 0.29975128173828125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.3591270446777344  GigaBytes
Max Memory Allocated: 0.36313629150390625  GigaBytes

rst.shape  torch.Size([1, 2102, 128])
m.shape torch.Size([2051, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.36313629150390625  GigaBytes
Max Memory Allocated: 0.3632516860961914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.36313629150390625  GigaBytes
Max Memory Allocated: 0.3632516860961914  GigaBytes

 h.shape torch.Size([1, 2051, 128]), torch.Size([1, 2051, 128])
----------------------------------------3
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.36509227752685547  GigaBytes
Max Memory Allocated: 0.36509227752685547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.43896484375  GigaBytes
Max Memory Allocated: 0.44385480880737305  GigaBytes

rst.shape  torch.Size([1, 2051, 128])
m.shape torch.Size([1815, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.44385480880737305  GigaBytes
Max Memory Allocated: 0.44397735595703125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.44385480880737305  GigaBytes
Max Memory Allocated: 0.44397735595703125  GigaBytes

 h.shape torch.Size([1, 1815, 128]), torch.Size([1, 1815, 128])
----------------------------------------3
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.4455857276916504  GigaBytes
Max Memory Allocated: 0.4455857276916504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5200152397155762  GigaBytes
Max Memory Allocated: 0.5252079963684082  GigaBytes

rst.shape  torch.Size([1, 1815, 128])
m.shape torch.Size([1703, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.524834156036377  GigaBytes
Max Memory Allocated: 0.5252079963684082  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.524834156036377  GigaBytes
Max Memory Allocated: 0.5252079963684082  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5264582633972168  GigaBytes
Max Memory Allocated: 0.5264582633972168  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.6080026626586914  GigaBytes
Max Memory Allocated: 0.6136870384216309  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([1569, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.6131758689880371  GigaBytes
Max Memory Allocated: 0.6136870384216309  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.6131758689880371  GigaBytes
Max Memory Allocated: 0.6136870384216309  GigaBytes

 h.shape torch.Size([1, 1569, 128]), torch.Size([1, 1569, 128])
----------------------------------------3
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.6146721839904785  GigaBytes
Max Memory Allocated: 0.6146721839904785  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.6999621391296387  GigaBytes
Max Memory Allocated: 0.7059473991394043  GigaBytes

rst.shape  torch.Size([1, 1569, 128])
m.shape torch.Size([1442, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7054023742675781  GigaBytes
Max Memory Allocated: 0.7059473991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7054023742675781  GigaBytes
Max Memory Allocated: 0.7059473991394043  GigaBytes

 h.shape torch.Size([1, 1442, 128]), torch.Size([1, 1442, 128])
----------------------------------------3
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7067775726318359  GigaBytes
Max Memory Allocated: 0.7067775726318359  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.7957806587219238  GigaBytes
Max Memory Allocated: 0.801969051361084  GigaBytes

rst.shape  torch.Size([1, 1442, 128])
m.shape torch.Size([20529, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8929829597473145  GigaBytes
Max Memory Allocated: 0.8953232765197754  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8929829597473145  GigaBytes
Max Memory Allocated: 0.8953232765197754  GigaBytes

 h.shape torch.Size([1, 20529, 128]), torch.Size([1, 20529, 128])
----------------------------------------3
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9125609397888184  GigaBytes
Max Memory Allocated: 0.9125609397888184  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.3025975227355957  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

rst.shape  torch.Size([1, 20529, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.1721510887145996  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.207571506500244  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.2429919242858887  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.207294464111328  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

torch.Size([37141, 256])
first layer input nodes number: 96559
first layer output nodes number: 37141
edges number: 284677
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.24371337890625  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.2791337966918945  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.2888760566711426  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.2888760566711426  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

m.shape torch.Size([848, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.33396577835083  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.33396577835083  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

 h.shape torch.Size([1, 848, 256]), torch.Size([1, 848, 256])
----------------------------------------3
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.335583209991455  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.348522663116455  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

rst.shape  torch.Size([1, 848, 256])
m.shape torch.Size([734, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.3493003845214844  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.3493003845214844  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

 h.shape torch.Size([1, 734, 256]), torch.Size([1, 734, 256])
----------------------------------------3
 Nvidia-smi: 3.7401123046875 GB
    Memory Allocated: 2.3507003784179688  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.3722190856933594  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

rst.shape  torch.Size([1, 734, 256])
m.shape torch.Size([589, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.3732519149780273  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.3732519149780273  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.374375343322754  GigaBytes
Max Memory Allocated: 2.4004874229431152  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.4001221656799316  GigaBytes
Max Memory Allocated: 2.401981830596924  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([451, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.4014339447021484  GigaBytes
Max Memory Allocated: 2.401981830596924  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.4014339447021484  GigaBytes
Max Memory Allocated: 2.401981830596924  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.402294158935547  GigaBytes
Max Memory Allocated: 2.402294158935547  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.4289112091064453  GigaBytes
Max Memory Allocated: 2.4307708740234375  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.430718421936035  GigaBytes
Max Memory Allocated: 2.4307708740234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.430718421936035  GigaBytes
Max Memory Allocated: 2.4307708740234375  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.4314985275268555  GigaBytes
Max Memory Allocated: 2.4314985275268555  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 2.463505744934082  GigaBytes
Max Memory Allocated: 2.4657278060913086  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([328, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 2.465057849884033  GigaBytes
Max Memory Allocated: 2.4657278060913086  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 2.465057849884033  GigaBytes
Max Memory Allocated: 2.4657278060913086  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 2.4656834602355957  GigaBytes
Max Memory Allocated: 2.4657278060913086  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 2.503459930419922  GigaBytes
Max Memory Allocated: 2.50538969039917  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 2.5050907135009766  GigaBytes
Max Memory Allocated: 2.50538969039917  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 2.5050907135009766  GigaBytes
Max Memory Allocated: 2.50538969039917  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 2.5055809020996094  GigaBytes
Max Memory Allocated: 2.5055809020996094  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7537841796875 GB
    Memory Allocated: 2.5383963584899902  GigaBytes
Max Memory Allocated: 2.540112018585205  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([186, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7537841796875 GB
    Memory Allocated: 2.539581775665283  GigaBytes
Max Memory Allocated: 2.540112018585205  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7537841796875 GB
    Memory Allocated: 2.539581775665283  GigaBytes
Max Memory Allocated: 2.540112018585205  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.7537841796875 GB
    Memory Allocated: 2.5399365425109863  GigaBytes
Max Memory Allocated: 2.540112018585205  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 2.5601582527160645  GigaBytes
Max Memory Allocated: 2.561577320098877  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 2.5616679191589355  GigaBytes
Max Memory Allocated: 2.5616745948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 2.5616679191589355  GigaBytes
Max Memory Allocated: 2.5616745948791504  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.7772216796875 GB
    Memory Allocated: 2.562039852142334  GigaBytes
Max Memory Allocated: 2.562039852142334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 2.585843563079834  GigaBytes
Max Memory Allocated: 2.587517261505127  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([165, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 2.5872435569763184  GigaBytes
Max Memory Allocated: 2.587517261505127  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 2.5872435569763184  GigaBytes
Max Memory Allocated: 2.587517261505127  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 2.5875582695007324  GigaBytes
Max Memory Allocated: 2.5875582695007324  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 2.609902858734131  GigaBytes
Max Memory Allocated: 2.611476421356201  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 2.6112046241760254  GigaBytes
Max Memory Allocated: 2.611476421356201  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 2.6112046241760254  GigaBytes
Max Memory Allocated: 2.611476421356201  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 2.6114678382873535  GigaBytes
Max Memory Allocated: 2.611476421356201  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 2.6319985389709473  GigaBytes
Max Memory Allocated: 2.633446216583252  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 2.633331775665283  GigaBytes
Max Memory Allocated: 2.633446216583252  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 2.633331775665283  GigaBytes
Max Memory Allocated: 2.633446216583252  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 2.6335740089416504  GigaBytes
Max Memory Allocated: 2.6335740089416504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.6541638374328613  GigaBytes
Max Memory Allocated: 2.6556172370910645  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.6551923751831055  GigaBytes
Max Memory Allocated: 2.6556172370910645  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.6551923751831055  GigaBytes
Max Memory Allocated: 2.6556172370910645  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.655367851257324  GigaBytes
Max Memory Allocated: 2.6556172370910645  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.671511650085449  GigaBytes
Max Memory Allocated: 2.672652244567871  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.6725950241088867  GigaBytes
Max Memory Allocated: 2.672652244567871  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.6725950241088867  GigaBytes
Max Memory Allocated: 2.672652244567871  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.6727609634399414  GigaBytes
Max Memory Allocated: 2.6727609634399414  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.6891889572143555  GigaBytes
Max Memory Allocated: 2.6903505325317383  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.6901440620422363  GigaBytes
Max Memory Allocated: 2.6903505325317383  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.6901440620422363  GigaBytes
Max Memory Allocated: 2.6903505325317383  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.690281391143799  GigaBytes
Max Memory Allocated: 2.6903505325317383  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9100341796875 GB
    Memory Allocated: 2.704838275909424  GigaBytes
Max Memory Allocated: 2.7058682441711426  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9100341796875 GB
    Memory Allocated: 2.7058000564575195  GigaBytes
Max Memory Allocated: 2.7058682441711426  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9100341796875 GB
    Memory Allocated: 2.7058000564575195  GigaBytes
Max Memory Allocated: 2.7058682441711426  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9100341796875 GB
    Memory Allocated: 2.705927848815918  GigaBytes
Max Memory Allocated: 2.705927848815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9237060546875 GB
    Memory Allocated: 2.7203683853149414  GigaBytes
Max Memory Allocated: 2.721390724182129  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9237060546875 GB
    Memory Allocated: 2.721268653869629  GigaBytes
Max Memory Allocated: 2.721390724182129  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9237060546875 GB
    Memory Allocated: 2.721268653869629  GigaBytes
Max Memory Allocated: 2.721390724182129  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9237060546875 GB
    Memory Allocated: 2.721381187438965  GigaBytes
Max Memory Allocated: 2.721390724182129  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 2.7348852157592773  GigaBytes
Max Memory Allocated: 2.735841751098633  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 2.7359189987182617  GigaBytes
Max Memory Allocated: 2.7359232902526855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 2.7359189987182617  GigaBytes
Max Memory Allocated: 2.7359232902526855  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 2.736039161682129  GigaBytes
Max Memory Allocated: 2.736039161682129  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.7512998580932617  GigaBytes
Max Memory Allocated: 2.7523813247680664  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.752244472503662  GigaBytes
Max Memory Allocated: 2.7523813247680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.752244472503662  GigaBytes
Max Memory Allocated: 2.7523813247680664  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.752349376678467  GigaBytes
Max Memory Allocated: 2.7523813247680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9666748046875 GB
    Memory Allocated: 2.766406536102295  GigaBytes
Max Memory Allocated: 2.7674031257629395  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9666748046875 GB
    Memory Allocated: 2.7673540115356445  GigaBytes
Max Memory Allocated: 2.7674031257629395  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9666748046875 GB
    Memory Allocated: 2.7673540115356445  GigaBytes
Max Memory Allocated: 2.7674031257629395  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9666748046875 GB
    Memory Allocated: 2.767453193664551  GigaBytes
Max Memory Allocated: 2.767453193664551  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9822998046875 GB
    Memory Allocated: 2.781437873840332  GigaBytes
Max Memory Allocated: 2.7824296951293945  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9822998046875 GB
    Memory Allocated: 2.782196044921875  GigaBytes
Max Memory Allocated: 2.7824296951293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9822998046875 GB
    Memory Allocated: 2.782196044921875  GigaBytes
Max Memory Allocated: 2.7824296951293945  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9822998046875 GB
    Memory Allocated: 2.7822723388671875  GigaBytes
Max Memory Allocated: 2.7824296951293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9940185546875 GB
    Memory Allocated: 2.7935638427734375  GigaBytes
Max Memory Allocated: 2.7943649291992188  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9940185546875 GB
    Memory Allocated: 2.7942447662353516  GigaBytes
Max Memory Allocated: 2.7943649291992188  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9940185546875 GB
    Memory Allocated: 2.7942447662353516  GigaBytes
Max Memory Allocated: 2.7943649291992188  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9940185546875 GB
    Memory Allocated: 2.794309616088867  GigaBytes
Max Memory Allocated: 2.7943649291992188  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.804361343383789  GigaBytes
Max Memory Allocated: 2.805074691772461  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.804992198944092  GigaBytes
Max Memory Allocated: 2.805074691772461  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.804992198944092  GigaBytes
Max Memory Allocated: 2.805074691772461  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.805049419403076  GigaBytes
Max Memory Allocated: 2.805074691772461  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0135498046875 GB
    Memory Allocated: 2.814319133758545  GigaBytes
Max Memory Allocated: 2.8149771690368652  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0135498046875 GB
    Memory Allocated: 2.814913749694824  GigaBytes
Max Memory Allocated: 2.8149771690368652  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0135498046875 GB
    Memory Allocated: 2.814913749694824  GigaBytes
Max Memory Allocated: 2.8149771690368652  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0135498046875 GB
    Memory Allocated: 2.81496524810791  GigaBytes
Max Memory Allocated: 2.8149771690368652  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0233154296875 GB
    Memory Allocated: 2.8236684799194336  GigaBytes
Max Memory Allocated: 2.824286460876465  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([579, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0389404296875 GB
    Memory Allocated: 2.837555408477783  GigaBytes
Max Memory Allocated: 2.8376097679138184  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0389404296875 GB
    Memory Allocated: 2.837555408477783  GigaBytes
Max Memory Allocated: 2.8376097679138184  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 4.0389404296875 GB
    Memory Allocated: 2.8386597633361816  GigaBytes
Max Memory Allocated: 2.8386597633361816  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 3.0330262184143066  GigaBytes
Max Memory Allocated: 3.046830654144287  GigaBytes

rst.shape  torch.Size([1, 579, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2830810546875 GB
    Memory Allocated: 2.994068145751953  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2830810546875 GB
    Memory Allocated: 2.99491548538208  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 2.995762825012207  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 2.994873046875  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

torch.Size([5684, 40])
input nodes number: 37141
output nodes number: 5684
edges number: 45823
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 2.996039867401123  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 2.9960408210754395  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.06020164489746094  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

pseudo mini batch 1 input nodes size: 97452
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.09978723526000977  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.09982967376708984  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.052912235260009766  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.055414676666259766  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.055414676666259766  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.055414676666259766  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

torch.Size([97452, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.055414676666259766  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

m.shape torch.Size([1647, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.1993694305419922  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.1993694305419922  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 1647, 128]), torch.Size([1, 1647, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.20094013214111328  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.2136974334716797  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 1647, 128])
m.shape torch.Size([2112, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.21492624282836914  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.21492624282836914  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 2112, 128]), torch.Size([1, 2112, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.21694040298461914  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.24831438064575195  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 2112, 128])
m.shape torch.Size([2147, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.2503786087036133  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.2503786087036133  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 2147, 128]), torch.Size([1, 2147, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.25298357009887695  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.29955148696899414  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 2147, 128])
m.shape torch.Size([2077, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.3024892807006836  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.3024892807006836  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 2077, 128]), torch.Size([1, 2077, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.3045201301574707  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.3637685775756836  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 2077, 128])
m.shape torch.Size([2083, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.3670535087585449  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.3670535087585449  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 2083, 128]), torch.Size([1, 2083, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.36972808837890625  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.44516611099243164  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 2083, 128])
m.shape torch.Size([1820, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.4501323699951172  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.4501323699951172  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 1820, 128]), torch.Size([1, 1820, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.45186805725097656  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.5290279388427734  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 1820, 128])
m.shape torch.Size([1713, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.5338778495788574  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.5338778495788574  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 1713, 128]), torch.Size([1, 1713, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.5355114936828613  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.6177339553833008  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 1713, 128])
m.shape torch.Size([1689, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.6233601570129395  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.6233601570129395  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 1689, 128]), torch.Size([1, 1689, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.6249709129333496  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.7174553871154785  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 1689, 128])
m.shape torch.Size([1488, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.7230358123779297  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.7230358123779297  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 1488, 128]), torch.Size([1, 1488, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.7244548797607422  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.8169307708740234  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 1488, 128])
m.shape torch.Size([20881, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.9158306121826172  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.9158306121826172  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 20881, 128]), torch.Size([1, 20881, 128])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.9357442855834961  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3496150970458984  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 20881, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.217050075531006  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.252962589263916  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.288875102996826  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.2526817321777344  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

torch.Size([37657, 256])
first layer input nodes number: 97452
first layer output nodes number: 37657
edges number: 289660
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.2896032333374023  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3255157470703125  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3345251083374023  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3345251083374023  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

m.shape torch.Size([872, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.380859851837158  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.380859851837158  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 872, 256]), torch.Size([1, 872, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3825230598449707  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3959121704101562  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 872, 256])
m.shape torch.Size([714, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3965725898742676  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3965725898742676  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.3979344367980957  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4192185401916504  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([579, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4202704429626465  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4202704429626465  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.421374797821045  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.447291374206543  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 579, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4484925270080566  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4484925270080566  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4493489265441895  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4747447967529297  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([408, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4762773513793945  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.4762773513793945  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.477055549621582  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5053439140319824  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([297, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.506760597229004  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.506760597229004  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.507327079772949  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.532681465148926  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.534060478210449  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.534060478210449  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.534531593322754  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5580873489379883  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([233, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5596437454223633  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5596437454223633  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5600881576538086  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5854196548461914  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5867981910705566  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.5867981910705566  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.587151050567627  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.609734058380127  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.611085891723633  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.611085891723633  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.61138916015625  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.6329212188720703  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([156, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.6344189643859863  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.6344189643859863  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.634716510772705  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.6579251289367676  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.6591901779174805  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.6591901779174805  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.659407615661621  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.677889823913574  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.679198741912842  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.679198741912842  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.67940092086792  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.6980013847351074  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.698882579803467  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.698882579803467  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.699021816253662  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.712806224822998  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.713991165161133  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.713991165161133  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7141571044921875  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7317466735839844  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7327628135681152  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7327628135681152  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7328944206237793  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7477660179138184  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7484846115112305  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7484846115112305  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7485761642456055  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7595624923706055  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.760713577270508  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.760713577270508  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.760833740234375  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.776094436645508  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.776966094970703  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.776966094970703  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7770633697509766  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.790098190307617  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.790818691253662  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.790818691253662  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.7908949851989746  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.801652431488037  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.802361488342285  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.802361488342285  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.802432060241699  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8128767013549805  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.813539505004883  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.813539505004883  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8136024475097656  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8233585357666016  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.823902130126953  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.823902130126953  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8239517211914062  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8319854736328125  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8326988220214844  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8326988220214844  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8327598571777344  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8430747985839844  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([606, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.857605457305908  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.857605457305908  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 2.8587613105773926  GigaBytes
Max Memory Allocated: 3.048755645751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5389404296875 GB
    Memory Allocated: 3.066263198852539  GigaBytes
Max Memory Allocated: 3.0807113647460938  GigaBytes

rst.shape  torch.Size([1, 606, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5389404296875 GB
    Memory Allocated: 3.026060104370117  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5389404296875 GB
    Memory Allocated: 3.026907444000244  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5408935546875 GB
    Memory Allocated: 3.027754783630371  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5408935546875 GB
    Memory Allocated: 3.026865005493164  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

torch.Size([5684, 40])
input nodes number: 37657
output nodes number: 5684
edges number: 46134
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5408935546875 GB
    Memory Allocated: 3.027188301086426  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5408935546875 GB
    Memory Allocated: 3.027188777923584  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.060822486877441406  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

pseudo mini batch 2 input nodes size: 97576
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.052912235260009766  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.052912235260009766  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.09978723526000977  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.09982967376708984  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05582571029663086  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05582571029663086  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05582571029663086  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

torch.Size([97576, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05582571029663086  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

m.shape torch.Size([1678, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.19978952407836914  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.19978952407836914  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 1678, 128]), torch.Size([1, 1678, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.20138978958129883  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.21427297592163086  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 1678, 128])
m.shape torch.Size([2091, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.21546697616577148  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.21546697616577148  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.21746110916137695  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.24866580963134766  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2254, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.25089311599731445  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.25089311599731445  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 2254, 128]), torch.Size([1, 2254, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.2534050941467285  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.30420398712158203  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 2254, 128])
m.shape torch.Size([2074, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.3070850372314453  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.3070850372314453  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.3091568946838379  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.36800718307495117  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([2063, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.3710966110229492  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.3710966110229492  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 2063, 128]), torch.Size([1, 2063, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.37390947341918945  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.4490532875061035  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 2063, 128])
m.shape torch.Size([1844, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.45334529876708984  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.45334529876708984  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 1844, 128]), torch.Size([1, 1844, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.45510387420654297  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.5330038070678711  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 1844, 128])
m.shape torch.Size([1727, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.5378890037536621  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.5378890037536621  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 1727, 128]), torch.Size([1, 1727, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.5395359992980957  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.6220302581787109  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 1727, 128])
m.shape torch.Size([1649, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.6275620460510254  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.6275620460510254  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.6291346549987793  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.7214131355285645  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1510, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.727107048034668  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.727107048034668  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 1510, 128]), torch.Size([1, 1510, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.7285470962524414  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.821253776550293  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 1510, 128])
m.shape torch.Size([20877, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.9201431274414062  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.9201431274414062  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 20877, 128]), torch.Size([1, 20877, 128])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.9400529861450195  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.3536529541015625  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 20877, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.220496654510498  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.256514072418213  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.2925314903259277  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.256232261657715  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

torch.Size([37767, 256])
first layer input nodes number: 97576
first layer output nodes number: 37767
edges number: 289938
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.2932605743408203  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.329277992248535  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.3388543128967285  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.3388543128967285  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

m.shape torch.Size([861, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.385180950164795  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.385180950164795  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.3868231773376465  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.4004926681518555  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([689, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.4012045860290527  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.4012045860290527  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 689, 256]), torch.Size([1, 689, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.4025187492370605  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.422426223754883  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 689, 256])
m.shape torch.Size([576, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.423473358154297  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.423473358154297  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.424571990966797  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.4493227005004883  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.450732707977295  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.450732707977295  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.4516119956970215  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.478545665740967  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([415, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.480663776397705  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.480663776397705  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.4814553260803223  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5101065635681152  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([310, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5114989280700684  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5114989280700684  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5120902061462402  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5377554893493652  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([288, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.539397716522217  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.539397716522217  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.539947032928467  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5700531005859375  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([196, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5712857246398926  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.5712857246398926  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.571659564971924  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.592968463897705  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.594356060028076  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.594356060028076  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.594703197479248  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.616919994354248  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.618882179260254  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.618882179260254  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.619168281555176  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.639481544494629  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6407341957092285  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6407341957092285  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6409859657287598  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6606240272521973  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6618709564208984  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6618709564208984  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.662097930908203  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6813907623291016  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6825146675109863  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6825146675109863  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.6827034950256348  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.700075626373291  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7011923789978027  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7011923789978027  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.701364040374756  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7183585166931152  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.719440460205078  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.719440460205078  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.719594955444336  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.735971450805664  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7369093894958496  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7369093894958496  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7370352745056152  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.751260280609131  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.75242280960083  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.75242280960083  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.752565860748291  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7697319984436035  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.770785331726074  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.770785331726074  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.770909309387207  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.786654472351074  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7876334190368652  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7876334190368652  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.7877421379089355  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8023104667663574  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8032612800598145  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8032612800598145  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8033604621887207  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.817345142364502  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.818143367767334  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.818143367767334  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.818223476409912  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8300795555114746  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8306527137756348  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8306527137756348  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8307080268859863  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8392815589904785  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.840005874633789  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.840005874633789  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8400707244873047  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.850576400756836  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.851466655731201  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.851466655731201  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8515429496765137  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.864436626434326  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([575, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8782148361206055  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8782148361206055  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 2.8793115615844727  GigaBytes
Max Memory Allocated: 3.081967830657959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 3.0804052352905273  GigaBytes
Max Memory Allocated: 3.094114303588867  GigaBytes

rst.shape  torch.Size([1, 575, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 3.040231227874756  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 3.041078567504883  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 3.0419259071350098  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 3.0410361289978027  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

torch.Size([5684, 40])
input nodes number: 37767
output nodes number: 5684
edges number: 46371
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 3.041360378265381  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 3.041360855102539  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.06123065948486328  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

pseudo mini batch 3 input nodes size: 97207
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.09967041015625  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.09971284866333008  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05279541015625  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05531501770019531  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05531501770019531  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05531501770019531  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

torch.Size([97207, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5428466796875 GB
    Memory Allocated: 0.05531501770019531  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

m.shape torch.Size([1617, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.19921350479125977  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.19921350479125977  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 1617, 128]), torch.Size([1, 1617, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.20075559616088867  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.2134385108947754  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 1617, 128])
m.shape torch.Size([2071, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.21464252471923828  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.21464252471923828  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 2071, 128]), torch.Size([1, 2071, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.2175769805908203  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.2496490478515625  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 2071, 128])
m.shape torch.Size([2179, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.25162410736083984  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.25162410736083984  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 2179, 128]), torch.Size([1, 2179, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.25370216369628906  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.30054521560668945  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 2179, 128])
m.shape torch.Size([2082, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.30347728729248047  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.30347728729248047  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 2082, 128]), torch.Size([1, 2082, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.305844783782959  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.365450382232666  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 2082, 128])
m.shape torch.Size([2042, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.368527889251709  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.368527889251709  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 2042, 128]), torch.Size([1, 2042, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.37047529220581055  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.4407534599304199  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 2042, 128])
m.shape torch.Size([1907, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.4452357292175293  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.4452357292175293  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 1907, 128]), torch.Size([1, 1907, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.447054386138916  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.5264811515808105  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 1907, 128])
m.shape torch.Size([1742, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.5313863754272461  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.5313863754272461  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 1742, 128]), torch.Size([1, 1742, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.5330476760864258  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.6161127090454102  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 1742, 128])
m.shape torch.Size([1641, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.6215419769287109  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.6215419769287109  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.6231069564819336  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.7151241302490234  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([1546, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.7209763526916504  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.7209763526916504  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 1546, 128]), torch.Size([1, 1546, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.7224507331848145  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.8173689842224121  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 1546, 128])
m.shape torch.Size([20991, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.916724681854248  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.916724681854248  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 20991, 128]), torch.Size([1, 20991, 128])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 0.9367432594299316  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.358062267303467  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 20991, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.2264132499694824  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.2630391120910645  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.299105167388916  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.262197494506836  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

torch.Size([37818, 256])
first layer input nodes number: 97207
first layer output nodes number: 37818
edges number: 291422
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.2998313903808594  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.335897445678711  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.345419406890869  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.345419406890869  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

m.shape torch.Size([816, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.3917031288146973  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.3917031288146973  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 816, 256]), torch.Size([1, 816, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.3932595252990723  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.406886100769043  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 816, 256])
m.shape torch.Size([734, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4076170921325684  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4076170921325684  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 734, 256]), torch.Size([1, 734, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4090170860290527  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4305739402770996  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 734, 256])
m.shape torch.Size([564, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.43167781829834  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.43167781829834  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.432753562927246  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4578099250793457  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([456, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4591245651245117  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4591245651245117  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.459994316101074  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.486339569091797  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4877214431762695  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4877214431762695  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.4884424209594727  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.515536308288574  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.516986846923828  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.516986846923828  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.5175857543945312  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.5443406105041504  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([268, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.545844554901123  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.545844554901123  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.546355724334717  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.5728139877319336  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.574234962463379  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.574234962463379  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.574650764465332  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.59835147857666  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([197, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.5998477935791016  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.5998477935791016  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6002235412597656  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6242713928222656  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.625736713409424  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.625736713409424  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6260647773742676  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.649357318878174  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([154, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.651689052581787  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.651689052581787  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6519827842712402  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.674893856048584  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6760849952697754  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6760849952697754  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6763062477111816  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.695112705230713  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6962890625  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6962890625  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.6964855194091797  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.714559555053711  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.715780258178711  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.715780258178711  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.7159671783447266  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.7344722747802734  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.735517978668213  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.735517978668213  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.735668659210205  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.751640796661377  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.752688407897949  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.752688407897949  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.7528276443481445  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.768561363220215  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.769455909729004  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.769455909729004  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.76956844329834  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.7830724716186523  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.7839159965515137  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.7839159965515137  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.78401517868042  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.7966113090515137  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.797438621520996  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.797438621520996  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.797530174255371  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.809798240661621  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.810713768005371  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.810713768005371  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8108091354370117  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.82425594329834  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8252782821655273  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8252782821655273  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8253793716430664  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8403406143188477  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8409247398376465  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8409247398376465  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.840981960296631  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.849851131439209  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8504638671875  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8504638671875  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8505191802978516  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8594799041748047  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8601903915405273  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8601903915405273  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8602514266967773  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8705663681030273  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([591, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8847365379333496  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.8847365379333496  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 2.885863780975342  GigaBytes
Max Memory Allocated: 3.0961389541625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 3.0892715454101562  GigaBytes
Max Memory Allocated: 3.1033620834350586  GigaBytes

rst.shape  torch.Size([1, 591, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 3.049083709716797  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 3.049931049346924  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 3.050778388977051  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 3.0498886108398438  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

torch.Size([5684, 40])
input nodes number: 37818
output nodes number: 5684
edges number: 46671
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 3.050212860107422  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 3.05021333694458  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.060395240783691406  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

pseudo mini batch 4 input nodes size: 97946
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.05279541015625  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.05279541015625  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.09967041015625  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.09971284866333008  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.055841922760009766  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.055841922760009766  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.055841922760009766  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

torch.Size([97946, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.055841922760009766  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

m.shape torch.Size([1616, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.19974565505981445  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.19974565505981445  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 1616, 128]), torch.Size([1, 1616, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.20128679275512695  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.2139744758605957  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 1616, 128])
m.shape torch.Size([2099, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.21520566940307617  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.21520566940307617  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 2099, 128]), torch.Size([1, 2099, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.2181406021118164  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.2502145767211914  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 2099, 128])
m.shape torch.Size([2191, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.2522163391113281  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.2522163391113281  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 2191, 128]), torch.Size([1, 2191, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.2543058395385742  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.30117368698120117  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 2191, 128])
m.shape torch.Size([2163, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.30425453186035156  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.30425453186035156  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 2163, 128]), torch.Size([1, 2163, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.30657052993774414  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.3674049377441406  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 2163, 128])
m.shape torch.Size([2025, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.37082815170288086  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.37082815170288086  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 2025, 128]), torch.Size([1, 2025, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.3727593421936035  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.44294023513793945  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 2025, 128])
m.shape torch.Size([1867, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.44731616973876953  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.44731616973876953  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 1867, 128]), torch.Size([1, 1867, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.4490966796875  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.5256586074829102  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 1867, 128])
m.shape torch.Size([1753, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.5306196212768555  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.5306196212768555  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 1753, 128]), torch.Size([1, 1753, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.5322914123535156  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.6163411140441895  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 1753, 128])
m.shape torch.Size([1654, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.6218147277832031  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.6218147277832031  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.6233921051025391  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.7157135009765625  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([1488, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.7213106155395508  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.7213106155395508  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 1488, 128]), torch.Size([1, 1488, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.7227296829223633  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.8135499954223633  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 1488, 128])
m.shape torch.Size([21057, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.9132480621337891  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.9132480621337891  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 21057, 128]), torch.Size([1, 21057, 128])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 0.9333295822143555  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.384695053100586  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 21057, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.2528629302978516  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.2891740798950195  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.3253307342529297  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.2887368202209473  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

torch.Size([37913, 256])
first layer input nodes number: 97946
first layer output nodes number: 37913
edges number: 291831
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.3260626792907715  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.3622193336486816  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.3717098236083984  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.3717098236083984  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

m.shape torch.Size([806, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.417984962463379  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.417984962463379  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 806, 256]), torch.Size([1, 806, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.419522285461426  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.4327168464660645  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 806, 256])
m.shape torch.Size([744, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.433412551879883  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.433412551879883  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.4348316192626953  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.4573445320129395  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([584, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.458374500274658  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.458374500274658  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.4594883918762207  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.4879751205444336  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([465, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.489206314086914  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.489206314086914  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.490093231201172  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.517056465148926  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([384, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.518458366394043  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.518458366394043  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.519190788269043  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.5478339195251465  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([277, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.549065113067627  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.549065113067627  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.549593448638916  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.574556827545166  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.5759615898132324  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.5759615898132324  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.57643461227417  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.600085735321045  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.601656436920166  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.601656436920166  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.602104663848877  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6276535987854004  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([180, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6289868354797363  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6289868354797363  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6293301582336426  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6513028144836426  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([168, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6527462005615234  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6527462005615234  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.653066635131836  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6758174896240234  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([147, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6775078773498535  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.6775078773498535  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.677788257598877  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.699657917022705  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7010059356689453  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7010059356689453  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.701251983642578  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.722166061401367  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7233428955078125  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7233428955078125  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.723541259765625  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.741790771484375  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7428221702575684  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7428221702575684  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7429823875427246  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7588438987731934  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.75984525680542  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.75984525680542  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.759988307952881  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7751517295837402  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([82, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.776341438293457  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.776341438293457  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7764978408813477  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7941713333129883  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7952046394348145  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7952046394348145  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.7953343391418457  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8108983039855957  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.811842441558838  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.811842441558838  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.811951160430908  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.825758457183838  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.826854705810547  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.826854705810547  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.826974868774414  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.843076705932617  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8439393043518066  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8439393043518066  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8440308570861816  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8569397926330566  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8579840660095215  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8579840660095215  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8580870628356934  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.873330593109131  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8743367195129395  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8743367195129395  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.87443208694458  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.889214038848877  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.889984607696533  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.889984607696533  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.8900551795959473  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.9014878273010254  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.9021449089050293  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.9021449089050293  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.9022021293640137  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.911872386932373  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([565, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.925419807434082  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.925419807434082  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.6854248046875 GB
    Memory Allocated: 2.926497459411621  GigaBytes
Max Memory Allocated: 3.1049909591674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7127685546875 GB
    Memory Allocated: 3.1250152587890625  GigaBytes
Max Memory Allocated: 3.138485908508301  GigaBytes

rst.shape  torch.Size([1, 565, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7127685546875 GB
    Memory Allocated: 3.0848522186279297  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7127685546875 GB
    Memory Allocated: 3.0856995582580566  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7127685546875 GB
    Memory Allocated: 3.0865468978881836  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7127685546875 GB
    Memory Allocated: 3.0856571197509766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([5684, 40])
input nodes number: 37913
output nodes number: 5684
edges number: 46803
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7127685546875 GB
    Memory Allocated: 3.085982322692871  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7127685546875 GB
    Memory Allocated: 3.0859827995300293  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.06073904037475586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

pseudo mini batch 5 input nodes size: 97232
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09968233108520508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09972476959228516  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05280733108520508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055323123931884766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055323123931884766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055323123931884766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([97232, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055323123931884766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([1674, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19926071166992188  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19926071166992188  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1674, 128]), torch.Size([1, 1674, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.20085716247558594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21374034881591797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1674, 128])
m.shape torch.Size([2068, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21491432189941406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21491432189941406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2068, 128]), torch.Size([1, 2068, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2168865203857422  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.24797821044921875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2068, 128])
m.shape torch.Size([2152, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.25007057189941406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.25007057189941406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2152, 128]), torch.Size([1, 2152, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2527942657470703  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29959869384765625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2152, 128])
m.shape torch.Size([2093, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3025646209716797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3025646209716797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30458879470825195  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3641328811645508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
m.shape torch.Size([1982, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3678603172302246  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3678603172302246  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1982, 128]), torch.Size([1, 1982, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3697504997253418  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.43930768966674805  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1982, 128])
m.shape torch.Size([1835, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44361257553100586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44361257553100586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1835, 128]), torch.Size([1, 1835, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44536256790161133  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5224432945251465  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1835, 128])
m.shape torch.Size([1736, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5273628234863281  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5273628234863281  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5290184020996094  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6117973327636719  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1736, 128])
m.shape torch.Size([1593, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6170463562011719  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6170463562011719  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1593, 128]), torch.Size([1, 1593, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.618565559387207  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7055330276489258  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1593, 128])
m.shape torch.Size([1457, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7110261917114258  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7110261917114258  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1457, 128]), torch.Size([1, 1457, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7124156951904297  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.8024759292602539  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1457, 128])
m.shape torch.Size([21107, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9024271965026855  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9024271965026855  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 21107, 128]), torch.Size([1, 21107, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9225564002990723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.374446392059326  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 21107, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2425456047058105  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.278618335723877  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3145689964294434  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.278214931488037  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([37697, 256])
first layer input nodes number: 97232
first layer output nodes number: 37697
edges number: 290637
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.315295696258545  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3512463569641113  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.360713005065918  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.360713005065918  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([841, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.407022476196289  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.407022476196289  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4086265563964844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.421985626220703  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([729, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.422651767730713  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.422651767730713  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 729, 256]), torch.Size([1, 729, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.424042224884033  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4451003074645996  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 729, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.446321487426758  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.446321487426758  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4474220275878906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4726057052612305  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.47404146194458  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.47404146194458  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4748997688293457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5010733604431152  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5024752616882324  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5024752616882324  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.503201961517334  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5306577682495117  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([297, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5320072174072266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5320072174072266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.532573699951172  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.558659553527832  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5599780082702637  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5599780082702637  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.560431957244873  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.583129405975342  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([219, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5845866203308105  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5845866203308105  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5850043296813965  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.608813762664795  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([187, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610222816467285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610222816467285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610579490661621  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.633406639099121  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([184, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6349968910217285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6349968910217285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.635347843170166  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6602654457092285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6615490913391113  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6615490913391113  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6618123054504395  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.682343006134033  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6836647987365723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6836647987365723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6839051246643066  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7043328285217285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7057700157165527  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7057700157165527  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7059779167175293  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.725104808807373  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7261719703674316  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7261719703674316  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7263379096984863  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7427659034729004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.743879795074463  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.743879795074463  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7440381050109863  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7608189582824707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7618932723999023  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7618932723999023  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7620363235473633  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.778201103210449  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7790122032165527  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7790122032165527  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7791152000427246  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7914748191833496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7922019958496094  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7922019958496094  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.792287826538086  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8031883239746094  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8041815757751465  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8041815757751465  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.804286479949951  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8183436393737793  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.819194793701172  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.819194793701172  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.819284439086914  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8319244384765625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8329343795776367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8329343795776367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8330297470092773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.84714412689209  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8477730751037598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8477730751037598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8478341102600098  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8572945594787598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.858016014099121  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.858016014099121  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8580808639526367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.868586540222168  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8694076538085938  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8694076538085938  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.869478225708008  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8814048767089844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([609, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.896002769470215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.896002769470215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8971643447875977  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.1054253578186035  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 609, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.065220832824707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.066068172454834  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.066915512084961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.066025733947754  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([5684, 40])
input nodes number: 37697
output nodes number: 5684
edges number: 46930
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.066349506378174  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.066349983215332  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.06071138381958008  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

pseudo mini batch 6 input nodes size: 98112
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05280733108520508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05280733108520508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09968233108520508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09972476959228516  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05583906173706055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05583906173706055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05583906173706055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([98112, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05583906173706055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([1599, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19973373413085938  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19973373413085938  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1599, 128]), torch.Size([1, 1599, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.20125865936279297  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21387195587158203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1599, 128])
m.shape torch.Size([2143, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21515321731567383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21515321731567383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2143, 128]), torch.Size([1, 2143, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2181229591369629  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2502293586730957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2143, 128])
m.shape torch.Size([2232, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2522730827331543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2522730827331543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2232, 128]), torch.Size([1, 2232, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.25440168380737305  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30147743225097656  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2232, 128])
m.shape torch.Size([2177, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3045654296875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3045654296875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2177, 128]), torch.Size([1, 2177, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3067054748535156  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36760377883911133  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2177, 128])
m.shape torch.Size([2046, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.37114381790161133  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.37114381790161133  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2046, 128]), torch.Size([1, 2046, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3730950355529785  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44339609146118164  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2046, 128])
m.shape torch.Size([1858, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4477362632751465  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4477362632751465  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1858, 128]), torch.Size([1, 1858, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4495081901550293  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5257010459899902  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1858, 128])
m.shape torch.Size([1736, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5306096076965332  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5306096076965332  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5322651863098145  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6156125068664551  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1736, 128])
m.shape torch.Size([1618, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6209568977355957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6209568977355957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1618, 128]), torch.Size([1, 1618, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.622499942779541  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7104535102844238  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1618, 128])
m.shape torch.Size([1494, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7160935401916504  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7160935401916504  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7175183296203613  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.8090920448303223  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([21017, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9085965156555176  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9085965156555176  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 21017, 128]), torch.Size([1, 21017, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.929600715637207  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3805465698242188  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 21017, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2489519119262695  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2854537963867188  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3216171264648438  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.28483247756958  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([37920, 256])
first layer input nodes number: 98112
first layer output nodes number: 37920
edges number: 291379
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.322350025177002  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.358513355255127  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.368022918701172  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.368022918701172  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([824, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4143147468566895  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4143147468566895  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 824, 256]), torch.Size([1, 824, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.415886402130127  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4287304878234863  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 824, 256])
m.shape torch.Size([723, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4294052124023438  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4294052124023438  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 723, 256]), torch.Size([1, 723, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.430784225463867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4514694213867188  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 723, 256])
m.shape torch.Size([610, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.452605724334717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.452605724334717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4537692070007324  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4803943634033203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([488, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.481688976287842  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.481688976287842  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4826197624206543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5100159645080566  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([364, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5113000869750977  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5113000869750977  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5119943618774414  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5379719734191895  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([282, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5402045249938965  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5402045249938965  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5407423973083496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.565642833709717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([229, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5669150352478027  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5669150352478027  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.567351818084717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.58919095993042  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([227, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5907182693481445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5907182693481445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.591151237487793  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.615830421447754  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.617572784423828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.617572784423828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.617931365966797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.640880584716797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([182, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6424508094787598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6424508094787598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6427979469299316  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6674447059631348  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([131, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.668656349182129  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.668656349182129  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6689062118530273  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6883955001831055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.689608573913574  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.689608573913574  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6898298263549805  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7086362838745117  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7097878456115723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7097878456115723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7099804878234863  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.72770357131958  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7288317680358887  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7288317680358887  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7290053367614746  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7461886405944824  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.747284412384033  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.747284412384033  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.747440814971924  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.76401948928833  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7648797035217285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7648797035217285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.76499605178833  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7781434059143066  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([76, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.779527187347412  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.779527187347412  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.779672145843506  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.797067165374756  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.79811954498291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.79811954498291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.798243522644043  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.81398868560791  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8147120475769043  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8147120475769043  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8147940635681152  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.825784206390381  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8268966674804688  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8268966674804688  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8270111083984375  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8431472778320312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.843998432159424  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.843998432159424  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8440842628479004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8567872047424316  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8575057983398438  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8575057983398438  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.857574462890625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8682174682617188  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8688464164733887  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8688464164733887  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.868903636932373  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.878173351287842  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8789525032043457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8789525032043457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.879019260406494  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.89030122756958  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([595, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.90456485748291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.90456485748291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.9056997299194336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.1101279258728027  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 595, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.069936752319336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.070784091949463  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.07163143157959  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.070741653442383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([5684, 40])
input nodes number: 37920
output nodes number: 5684
edges number: 46742
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0710668563842773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0710673332214355  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.06095123291015625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

pseudo mini batch 7 input nodes size: 98341
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.10021114349365234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.10025358200073242  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.053336143493652344  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055876731872558594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055876731872558594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055876731872558594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([98341, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055876731872558594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([1620, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2016592025756836  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2016592025756836  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1620, 128]), torch.Size([1, 1620, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.20320415496826172  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2159585952758789  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1620, 128])
m.shape torch.Size([2179, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21726417541503906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21726417541503906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2179, 128]), torch.Size([1, 2179, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21934223175048828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.25111913681030273  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2179, 128])
m.shape torch.Size([2211, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.25324296951293945  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.25324296951293945  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2211, 128]), torch.Size([1, 2211, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.25556468963623047  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30245542526245117  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2211, 128])
m.shape torch.Size([2174, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30554771423339844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30554771423339844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2174, 128]), torch.Size([1, 2174, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30764102935791016  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3683605194091797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2174, 128])
m.shape torch.Size([2080, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3720378875732422  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3720378875732422  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2080, 128]), torch.Size([1, 2080, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3743114471435547  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4482870101928711  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2080, 128])
m.shape torch.Size([1869, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.45264244079589844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.45264244079589844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1869, 128]), torch.Size([1, 1869, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4544248580932617  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5323848724365234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1869, 128])
m.shape torch.Size([1782, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5374417304992676  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5374417304992676  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1782, 128]), torch.Size([1, 1782, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5391411781311035  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6241669654846191  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1782, 128])
m.shape torch.Size([1662, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6296572685241699  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6296572685241699  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6312422752380371  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7236323356628418  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([1494, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7292513847351074  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7292513847351074  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7306761741638184  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.821901798248291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([21198, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.922269344329834  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.922269344329834  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 21198, 128]), torch.Size([1, 21198, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9424853324890137  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3953299522399902  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 21198, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2615537643432617  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2980499267578125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3345460891723633  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.297764778137207  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([38269, 256])
first layer input nodes number: 98341
first layer output nodes number: 38269
edges number: 294117
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3352808952331543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.371777057647705  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3812003135681152  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3812003135681152  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4274988174438477  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4274988174438477  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4290781021118164  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4417123794555664  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([718, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4423346519470215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4423346519470215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.443704128265381  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.464272975921631  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([575, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.46530818939209  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.46530818939209  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.466404914855957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.492673873901367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([477, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.494248390197754  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.494248390197754  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4951581954956055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.52249813079834  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 477, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5240087509155273  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5240087509155273  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5247888565063477  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5540990829467773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([279, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5553441047668457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5553441047668457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5558762550354004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.580441474914551  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([275, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5820260047912598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5820260047912598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.582550525665283  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.60892915725708  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([201, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610212802886963  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610212802886963  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610596179962158  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.632448673248291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([210, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6340737342834473  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6340737342834473  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.634474277496338  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.660109043121338  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.661811351776123  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.661811351776123  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6620936393737793  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.682136058807373  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6833696365356445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6833696365356445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.68361759185791  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.702958106994629  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.704195499420166  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.704195499420166  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.704420566558838  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7235512733459473  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.724700927734375  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.724700927734375  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.724893569946289  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.742616653442383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.743475914001465  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.743475914001465  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7436113357543945  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7570180892944336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.758103847503662  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.758103847503662  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.758256435394287  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.774430751800537  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7754158973693848  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7754158973693848  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.775547504425049  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.790419101715088  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7913923263549805  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7913923263549805  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7915124893188477  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.80593204498291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([78, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8072214126586914  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8072214126586914  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.807370185852051  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8262643814086914  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8271031379699707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8271031379699707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8271985054016113  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.839977741241455  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8409690856933594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8409690856933594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8410720825195312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8555946350097656  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8574728965759277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8574728965759277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8575797080993652  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8733878135681152  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.873990058898926  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.873990058898926  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.874049186706543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.883213996887207  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.883847713470459  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.883847713470459  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8839049339294434  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.893174648284912  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.893792152404785  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.893792152404785  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.893845558166504  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.9028711318969727  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([605, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.917381763458252  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.917381763458252  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.9185357093811035  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.1231637001037598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 605, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0829601287841797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0838074684143066  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0846548080444336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0837650299072266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([5684, 40])
input nodes number: 38269
output nodes number: 5684
edges number: 46826
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.084092617034912  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0840930938720703  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.06117963790893555  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

pseudo mini batch 8 input nodes size: 97289
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.053336143493652344  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.053336143493652344  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.10021114349365234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.10025358200073242  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([97289, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([1619, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19774532318115234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19774532318115234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1619, 128]), torch.Size([1, 1619, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19928932189941406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2119131088256836  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1619, 128])
m.shape torch.Size([2162, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21320295333862305  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21320295333862305  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2162, 128]), torch.Size([1, 2162, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21526479721069336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.24733304977416992  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2162, 128])
m.shape torch.Size([2167, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.24939489364624023  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.24939489364624023  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2167, 128]), torch.Size([1, 2167, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2514615058898926  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29799604415893555  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2167, 128])
m.shape torch.Size([2149, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30106163024902344  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30106163024902344  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3034806251525879  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36418628692626953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([2103, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36772871017456055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36772871017456055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2103, 128]), torch.Size([1, 2103, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.37021589279174805  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4445328712463379  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2103, 128])
m.shape torch.Size([1879, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44890594482421875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44890594482421875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1879, 128]), torch.Size([1, 1879, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4506978988647461  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5285396575927734  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1879, 128])
m.shape torch.Size([1682, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5332579612731934  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5332579612731934  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1682, 128]), torch.Size([1, 1682, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5348620414733887  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6166214942932129  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1682, 128])
m.shape torch.Size([1615, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6219801902770996  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6219801902770996  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6235203742980957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.711310863494873  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1504, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7169952392578125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7169952392578125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1504, 128]), torch.Size([1, 1504, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7184295654296875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.8102264404296875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1504, 128])
m.shape torch.Size([20737, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.90911865234375  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.90911865234375  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 20737, 128]), torch.Size([1, 20737, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9288949966430664  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3330154418945312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 20737, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2028231620788574  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2386975288391113  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2745718955993652  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.238417148590088  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([37617, 256])
first layer input nodes number: 97289
first layer output nodes number: 37617
edges number: 288429
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.275299072265625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.311173439025879  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.320220947265625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.320220947265625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([827, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.36651611328125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.36651611328125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.368093490600586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3815436363220215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([770, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3823609352111816  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3823609352111816  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 770, 256]), torch.Size([1, 770, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3838295936584473  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4075217247009277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 770, 256])
m.shape torch.Size([539, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4083938598632812  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4083938598632812  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.409421920776367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.433690071105957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.434948444366455  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.434948444366455  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4358277320861816  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4630274772644043  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.464409351348877  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.464409351348877  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.465132236480713  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4914135932922363  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.493626117706299  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.493626117706299  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.494205951690674  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5240955352783203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.525460720062256  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.525460720062256  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5259299278259277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5493903160095215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5507802963256836  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5507802963256836  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.551180839538574  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.57401180267334  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([197, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5755157470703125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5755157470703125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5758914947509766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5999393463134766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6011838912963867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6011838912963867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.601468086242676  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.621645927429199  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6229209899902344  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6229209899902344  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6231765747070312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6431121826171875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.644460678100586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.644460678100586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.644704818725586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.665456771850586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([113, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6673641204833984  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6673641204833984  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6675796508789062  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.687408447265625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([111, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6887946128845215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6887946128845215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6890063285827637  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7099661827087402  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.711172580718994  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.711172580718994  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.71134614944458  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7297444343566895  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7306418418884277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7306418418884277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7307639122009277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7445578575134277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.745330333709717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.745330333709717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7454276084899902  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7571005821228027  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7581419944763184  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7581419944763184  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7582621574401855  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7735228538513184  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7743945121765137  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7743945121765137  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.774491786956787  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7875266075134277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7884202003479004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7884202003479004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.788513660430908  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8016915321350098  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.802677631378174  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.802677631378174  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8027749061584473  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.817171573638916  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8177361488342285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8177361488342285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.81779146194458  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8263649940490723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.827266216278076  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.827266216278076  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8273463249206543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8403239250183105  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.840999126434326  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.840999126434326  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8410582542419434  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.851050853729248  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([594, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8652944564819336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8652944564819336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.866427421569824  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0741982460021973  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 594, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.034008502960205  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.034855842590332  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.035703182220459  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.034813404083252  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([5684, 40])
input nodes number: 37617
output nodes number: 5684
edges number: 46853
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0351362228393555  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0351366996765137  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.060361385345458984  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

pseudo mini batch 9 input nodes size: 96844
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09949731826782227  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09953975677490234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.052622318267822266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05509233474731445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05509233474731445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05509233474731445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([96844, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05509233474731445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([1642, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19612455368041992  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19612455368041992  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1642, 128]), torch.Size([1, 1642, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.19769048690795898  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21034860610961914  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1642, 128])
m.shape torch.Size([2147, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21161317825317383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21161317825317383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2147, 128]), torch.Size([1, 2147, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2136983871459961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.24572277069091797  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2147, 128])
m.shape torch.Size([2148, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2477703094482422  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2477703094482422  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2148, 128]), torch.Size([1, 2148, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2498188018798828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29624414443969727  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2148, 128])
m.shape torch.Size([2184, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29938554763793945  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29938554763793945  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2184, 128]), torch.Size([1, 2184, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30190324783325195  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3632321357727051  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2184, 128])
m.shape torch.Size([2023, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36701393127441406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36701393127441406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2023, 128]), torch.Size([1, 2023, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.3689432144165039  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.43911266326904297  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2023, 128])
m.shape torch.Size([1793, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44327783584594727  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44327783584594727  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1793, 128]), torch.Size([1, 1793, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.44498777389526367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5185151100158691  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1793, 128])
m.shape torch.Size([1761, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5235381126403809  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5235381126403809  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1761, 128]), torch.Size([1, 1761, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5252175331115723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.609431266784668  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1761, 128])
m.shape torch.Size([1553, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6145157814025879  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6145157814025879  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1553, 128]), torch.Size([1, 1553, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6159968376159668  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7006239891052246  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1553, 128])
m.shape torch.Size([1476, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7062177658081055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7062177658081055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1476, 128]), torch.Size([1, 1476, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7076253890991211  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7977132797241211  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1476, 128])
m.shape torch.Size([20604, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.8952569961547852  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.8952569961547852  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 20604, 128]), torch.Size([1, 20604, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9149065017700195  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.31002140045166  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 20604, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.1805758476257324  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.216177463531494  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.251779079437256  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2158989906311035  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([37331, 256])
first layer input nodes number: 96844
first layer output nodes number: 37331
edges number: 286064
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.252502918243408  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.28810453414917  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.297424793243408  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.297424793243408  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([863, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3420968055725098  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3420968055725098  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 863, 256]), torch.Size([1, 863, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.343742847442627  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.357006549835205  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 863, 256])
m.shape torch.Size([766, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3578429222106934  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3578429222106934  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 766, 256]), torch.Size([1, 766, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3593039512634277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3823599815368652  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 766, 256])
m.shape torch.Size([570, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.383358955383301  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.383358955383301  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.384446144104004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.412726879119873  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([472, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4141430854797363  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4141430854797363  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.415043354034424  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.442509174346924  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([393, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4439477920532227  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4439477920532227  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.444697380065918  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4749441146850586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.476341724395752  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.476341724395752  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4769253730773926  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5113253593444824  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.512836456298828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.512836456298828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5133399963378906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5418477058410645  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.543264865875244  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.543264865875244  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5436787605285645  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5672707557678223  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5690836906433105  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5690836906433105  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.569396495819092  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.589416027069092  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5908937454223633  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5908937454223633  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5912179946899414  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6142396926879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6154837608337402  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6154837608337402  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6157374382019043  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.635524272918701  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.636746883392334  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.636746883392334  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.636970043182373  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6559386253356934  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6569766998291016  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6569766998291016  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6571521759033203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6732959747314453  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6745405197143555  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6745405197143555  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.674729347229004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.693423271179199  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6943817138671875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6943817138671875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.694520950317383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.709280014038086  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.710148811340332  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.710148811340332  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7102651596069336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.72341251373291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.724318504333496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.724318504333496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.724431037902832  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7379350662231445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7397313117980957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7397313117980957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.739841938018799  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7538914680480957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7546215057373047  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7546215057373047  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7547035217285156  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7656936645507812  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7669601440429688  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7669601440429688  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.76708984375  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7853775024414062  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7859787940979004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7859787940979004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.786041736602783  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7953572273254395  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7960238456726074  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7960238456726074  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7960867881774902  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.805842876434326  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8064746856689453  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8064746856689453  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8065319061279297  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8158016204833984  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.816488265991211  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.816488265991211  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.816547393798828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.826539993286133  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([569, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8401827812194824  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8401827812194824  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8412680625915527  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.032698154449463  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 569, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.9941787719726562  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.995026111602783  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.99587345123291  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.994983673095703  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([5684, 40])
input nodes number: 37331
output nodes number: 5684
edges number: 45376
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.995304584503174  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.995305061340332  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.059522151947021484  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

pseudo mini batch 10 input nodes size: 97090
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.052622318267822266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.052622318267822266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09949731826782227  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.09953975677490234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05579519271850586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05579519271850586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05579519271850586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([97090, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05579519271850586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([1631, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.1968240737915039  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.1968240737915039  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1631, 128]), torch.Size([1, 1631, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.1983795166015625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.21100330352783203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1631, 128])
m.shape torch.Size([2154, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2122797966003418  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2122797966003418  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2154, 128]), torch.Size([1, 2154, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2143549919128418  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2464003562927246  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2154, 128])
m.shape torch.Size([2152, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.24845457077026367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.24845457077026367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2152, 128]), torch.Size([1, 2152, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.2505068778991699  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29694604873657227  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2152, 128])
m.shape torch.Size([2113, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29995012283325195  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.29995012283325195  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.30243349075317383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36262989044189453  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([2105, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36600542068481445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36600542068481445  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2105, 128]), torch.Size([1, 2105, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.36865234375  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4441685676574707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2105, 128])
m.shape torch.Size([1855, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4484720230102539  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4484720230102539  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1855, 128]), torch.Size([1, 1855, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.4502410888671875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5273656845092773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1855, 128])
m.shape torch.Size([1641, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5319585800170898  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5319585800170898  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.5335235595703125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6140270233154297  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([1589, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6193060874938965  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.6193060874938965  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1589, 128]), torch.Size([1, 1589, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.620821475982666  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7071986198425293  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1589, 128])
m.shape torch.Size([1433, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7125906944274902  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7125906944274902  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.7139573097229004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.8026480674743652  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([20679, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9005699157714844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9005699157714844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 20679, 128]), torch.Size([1, 20679, 128])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.9202909469604492  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.320484161376953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 20679, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.190366744995117  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2259883880615234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.2616100311279297  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.225709915161133  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([37352, 256])
first layer input nodes number: 97090
first layer output nodes number: 37352
edges number: 286388
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.262335777282715  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.297957420349121  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.307257652282715  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.307257652282715  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([854, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3524680137634277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3524680137634277  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 854, 256]), torch.Size([1, 854, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3540968894958496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3671278953552246  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 854, 256])
m.shape torch.Size([752, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.367795944213867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.367795944213867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 752, 256]), torch.Size([1, 752, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.369230270385742  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.391707420349121  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 752, 256])
m.shape torch.Size([590, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.39272403717041  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.39272403717041  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.3938493728637695  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.420346736907959  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4216384887695312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4216384887695312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4225101470947266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4498066902160645  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([387, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.451231002807617  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.451231002807617  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4519691467285156  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.480001449584961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4814839363098145  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4814839363098145  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.4820961952209473  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5136971473693848  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([236, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5151238441467285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5151238441467285  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5155739784240723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5380806922912598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.539586067199707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.539586067199707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.54001522064209  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.56447696685791  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([155, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5658464431762695  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5658464431762695  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5661420822143555  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5850629806518555  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([164, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.586501121520996  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.586501121520996  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.5868139266967773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.609023094177246  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610304832458496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.610304832458496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6105642318725586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6307973861694336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6319828033447266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6319828033447266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.632200241088867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6506824493408203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6519360542297363  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6519360542297363  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.652143955230713  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6712708473205566  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6724185943603516  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.6724185943603516  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.672595977783203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.690156936645508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.691178798675537  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.691178798675537  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.691323757171631  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7066893577575684  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.707732677459717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.707732677459717  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7078661918640137  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7229533195495605  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7240209579467773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7240209579467773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.724146842956543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.739253044128418  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7402024269104004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7402024269104004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7403111457824707  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7541184425354004  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.755098342895508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.755098342895508  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7552051544189453  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7695178985595703  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.770233631134033  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.770233631134033  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7703099250793457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.781067371368408  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7818164825439453  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7818164825439453  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.781890869140625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7929000854492188  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7937088012695312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7937088012695312  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.7937850952148438  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8056106567382812  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.806191921234131  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.806191921234131  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8062453269958496  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.814897060394287  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.815654754638672  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.815654754638672  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8157196044921875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.826679229736328  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([585, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8407034873962402  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8407034873962402  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 2.8418192863464355  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0471320152282715  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 585, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.008054256439209  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.008901596069336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.009748935699463  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.008859157562256  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([5684, 40])
input nodes number: 37352
output nodes number: 5684
edges number: 45943
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0091800689697266  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.0091805458068848  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.06023740768432617  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

pseudo mini batch 11 input nodes size: 98377
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.10022830963134766  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.10027074813842773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.053353309631347656  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055924415588378906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055924415588378906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055924415588378906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([98377, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 0.055924415588378906  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([1601, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.20355844497680664  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.20355844497680664  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1601, 128]), torch.Size([1, 1601, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.20508527755737305  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.21783876419067383  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1601, 128])
m.shape torch.Size([2004, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.21898651123046875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.21898651123046875  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2004, 128]), torch.Size([1, 2004, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.22089767456054688  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.24981689453125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2004, 128])
m.shape torch.Size([2153, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.2519412040710449  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.2519412040710449  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2153, 128]), torch.Size([1, 2153, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.25487279891967773  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.30089616775512695  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2153, 128])
m.shape torch.Size([2151, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.3039722442626953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.3039722442626953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 2151, 128]), torch.Size([1, 2151, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.30645132064819336  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.36723804473876953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 2151, 128])
m.shape torch.Size([1972, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.37047767639160156  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.37047767639160156  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1972, 128]), torch.Size([1, 1972, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.3723583221435547  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.4418010711669922  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1972, 128])
m.shape torch.Size([1864, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.4461936950683594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.4461936950683594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1864, 128]), torch.Size([1, 1864, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.4479713439941406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.5250511169433594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1864, 128])
m.shape torch.Size([1750, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.530003547668457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.530003547668457  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1750, 128]), torch.Size([1, 1750, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.531672477722168  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.6161594390869141  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1750, 128])
m.shape torch.Size([1607, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.621455192565918  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.621455192565918  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1607, 128]), torch.Size([1, 1607, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.6229877471923828  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.7108564376831055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1607, 128])
m.shape torch.Size([1533, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.7173609733581543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.7173609733581543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 1533, 128]), torch.Size([1, 1533, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.7188229560852051  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.8123898506164551  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 1533, 128])
m.shape torch.Size([21671, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.9149942398071289  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.9149942398071289  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 21671, 128]), torch.Size([1, 21671, 128])
----------------------------------------3
 Nvidia-smi: 4.8572998046875 GB
    Memory Allocated: 0.9360871315002441  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.403449535369873  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 21671, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.268082618713379  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3046140670776367  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3411455154418945  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.304328441619873  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

torch.Size([38306, 256])
first layer input nodes number: 98377
first layer output nodes number: 38306
edges number: 297329
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3418807983398438  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3784122467041016  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3876099586486816  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3876099586486816  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

m.shape torch.Size([825, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4344215393066406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4344215393066406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 825, 256]), torch.Size([1, 825, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.435995101928711  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.449831008911133  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 825, 256])
m.shape torch.Size([702, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.450458526611328  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.450458526611328  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4517974853515625  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.472362518310547  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([588, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.473461151123047  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.473461151123047  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4745826721191406  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.499256134033203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([486, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.500697612762451  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.500697612762451  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.501624584197998  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.529561996459961  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([350, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5308938026428223  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5308938026428223  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5315613746643066  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5596823692321777  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5611653327941895  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5611653327941895  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.56174898147583  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.591487407684326  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5929250717163086  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5929250717163086  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5934152603149414  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6189327239990234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([209, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.621035575866699  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.621035575866699  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.621434211730957  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6441564559936523  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6455836296081543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6455836296081543  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.645942211151123  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.668891429901123  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6701927185058594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6701927185058594  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6704864501953125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6913414001464844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.692600727081299  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.692600727081299  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.692854404449463  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7126412391662598  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([132, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7140369415283203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7140369415283203  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7142887115478516  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.735689163208008  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([119, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7370505332946777  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7370505332946777  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7372775077819824  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7581591606140137  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([68, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.758960723876953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.758960723876953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7590904235839844  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.771930694580078  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.773609161376953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.773609161376953  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7737579345703125  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7895278930664062  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7905149459838867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7905149459838867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.790646553039551  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.80551815032959  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8064327239990234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8064327239990234  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.806547164916992  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.820280075073242  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.821295738220215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.821295738220215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.821413993835449  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.836432456970215  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8372316360473633  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8372316360473633  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8373212814331055  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8493337631225586  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.850461959838867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.850461959838867  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8505783081054688  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.866983413696289  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.868055820465088  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.868055820465088  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8681626319885254  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8839707374572754  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.884488582611084  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.884488582611084  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.88454008102417  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8925223350524902  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8931379318237305  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8931379318237305  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.893193244934082  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.902153968811035  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.903095245361328  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.903095245361328  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9031753540039062  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9167137145996094  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([636, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9319558143615723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9319558143615723  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.933168888092041  GigaBytes
Max Memory Allocated: 3.140758991241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.147280216217041  GigaBytes
Max Memory Allocated: 3.1624436378479004  GigaBytes

rst.shape  torch.Size([1, 636, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1065378189086914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1073851585388184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1082324981689453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1073427200317383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 38306
output nodes number: 5684
edges number: 47640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.107670783996582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1076712608337402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06114768981933594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 12 input nodes size: 98035
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.053353309631347656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.053353309631347656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10022830963134766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10027074813842773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05584859848022461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05584859848022461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05584859848022461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([98035, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05584859848022461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1590, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20059633255004883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20059633255004883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1590, 128]), torch.Size([1, 1590, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20211267471313477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2147212028503418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1590, 128])
m.shape torch.Size([2024, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21589326858520508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21589326858520508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2024, 128]), torch.Size([1, 2024, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21782350540161133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.24691438674926758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2024, 128])
m.shape torch.Size([2182, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.24994707107543945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.24994707107543945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2182, 128]), torch.Size([1, 2182, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25203847885131836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2991805076599121  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2182, 128])
m.shape torch.Size([2089, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3018507957458496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3018507957458496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30416107177734375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36405038833618164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([2073, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3679966926574707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3679966926574707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2073, 128]), torch.Size([1, 2073, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3699812889099121  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4443507194519043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2073, 128])
m.shape torch.Size([1922, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44886112213134766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44886112213134766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45069408416748047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5315713882446289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
m.shape torch.Size([1712, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5363693237304688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5363693237304688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1712, 128]), torch.Size([1, 1712, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5380020141601562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.620391845703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1712, 128])
m.shape torch.Size([1654, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.625885009765625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.625885009765625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6274623870849609  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7198219299316406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([1575, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.725792407989502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.725792407989502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1575, 128]), torch.Size([1, 1575, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7272944450378418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8241806030273438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1575, 128])
m.shape torch.Size([21088, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9239850044250488  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9239850044250488  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21088, 128]), torch.Size([1, 21088, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9440960884094238  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.395786762237549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21088, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.262758255004883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2989110946655273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.335063934326172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.298628330230713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37909, 256])
first layer input nodes number: 98035
first layer output nodes number: 37909
edges number: 292708
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.335796356201172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3719491958618164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.381424903869629  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.381424903869629  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([820, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.42771577835083  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.42771577835083  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4292798042297363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.442413806915283  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([735, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4430975914001465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4430975914001465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4444994926452637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4665684700012207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([581, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4676384925842285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4676384925842285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4687466621398926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.494925022125244  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([440, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.496062755584717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.496062755584717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4969019889831543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.521239757537842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([389, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5226898193359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5226898193359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5234317779541016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.550901412963867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.552283763885498  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.552283763885498  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.552863597869873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.579251289367676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5808186531066895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5808186531066895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5813450813293457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.608558177947998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.609863758087158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.609863758087158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.610252857208252  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6324315071105957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6340017318725586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6340017318725586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6343908309936523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6592931747436523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([135, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6603965759277344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6603965759277344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.660654067993164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.678936004638672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6803722381591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6803722381591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.680654525756836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7026729583740234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7039389610290527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7039389610290527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.704171657562256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7239508628845215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7257771492004395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7257771492004395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7259774208068848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7444024085998535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.745553970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.745553970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7457313537597656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7632923126220703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.764443874359131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.764443874359131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7646079063415527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7819952964782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7831897735595703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7831897735595703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7833480834960938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.801237106323242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8023834228515625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8023834228515625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8025264739990234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.819692611694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8204169273376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8204169273376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.820504665374756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8316473960876465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8326520919799805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8326520919799805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.832756996154785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8468141555786133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847665309906006  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847665309906006  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847754955291748  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8603949546813965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8612184524536133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8612184524536133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.861300468444824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.873438835144043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.87428617477417  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.87428617477417  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.874366283416748  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8867831230163574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8873844146728516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8873844146728516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.887439727783203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8964004516601562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8970651626586914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8970651626586914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.897122383117676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.906792640686035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([592, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9209890365600586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9209890365600586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9221181869506836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.125354766845703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 592, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0851635932922363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0860109329223633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0868582725524902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.085968494415283  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37909
output nodes number: 5684
edges number: 46791
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0862936973571777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.086294174194336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06118440628051758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 13 input nodes size: 96417
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.09929370880126953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.09933614730834961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05241870880126953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.054901123046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.054901123046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.054901123046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96417, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.054901123046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1628, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.19681930541992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.19681930541992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1628, 128]), torch.Size([1, 1628, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.19837188720703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21100425720214844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1628, 128])
m.shape torch.Size([2092, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21231317520141602  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21231317520141602  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2092, 128]), torch.Size([1, 2092, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2143082618713379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.24635934829711914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2092, 128])
m.shape torch.Size([2154, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2476973533630371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2476973533630371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2154, 128]), torch.Size([1, 2154, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2514357566833496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.29800844192504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2154, 128])
m.shape torch.Size([2088, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3009638786315918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3009638786315918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2088, 128]), torch.Size([1, 2088, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.303438663482666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3632340431213379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2088, 128])
m.shape torch.Size([2062, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36638784408569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36638784408569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36913347244262695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4439835548400879  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
m.shape torch.Size([1842, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.448270320892334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.448270320892334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1842, 128]), torch.Size([1, 1842, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4500269889831543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5279402732849121  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1842, 128])
m.shape torch.Size([1691, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5327062606811523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5327062606811523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1691, 128]), torch.Size([1, 1691, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5343189239501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.616187572479248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1691, 128])
m.shape torch.Size([1630, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6215991973876953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6215991973876953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1630, 128]), torch.Size([1, 1630, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6231536865234375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7152690887451172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1630, 128])
m.shape torch.Size([1486, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7208690643310547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7208690643310547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1486, 128]), torch.Size([1, 1486, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7222862243652344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8130588531494141  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1486, 128])
m.shape torch.Size([20701, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9119596481323242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9119596481323242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20701, 128]), torch.Size([1, 20701, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.93170166015625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3333845138549805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20701, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.202110767364502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.237753391265869  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2733960151672363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2374749183654785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37374, 256])
first layer input nodes number: 96417
first layer output nodes number: 37374
edges number: 287249
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2741165161132812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3097591400146484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3194193840026855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3194193840026855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([873, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3644232749938965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3644232749938965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 873, 256]), torch.Size([1, 873, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.366088390350342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.380074977874756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 873, 256])
m.shape torch.Size([765, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3807854652404785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3807854652404785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.38224458694458  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4050369262695312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([548, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4058914184570312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4058914184570312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4069366455078125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4323511123657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([443, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.433551788330078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.433551788330078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.434396743774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4592485427856445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([366, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.460585117340088  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.460585117340088  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4612832069396973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.488403797149658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4898600578308105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4898600578308105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.490457057952881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5211806297302246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([252, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5225777626037598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5225777626037598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5230584144592285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.547091007232666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([237, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.548673152923584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.548673152923584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5491251945495605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5748915672302246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.576274871826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.576274871826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.576629638671875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.599334716796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.600820541381836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.600820541381836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6011505126953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6245784759521484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6259565353393555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6259565353393555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.626217842102051  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.646599769592285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.647864818572998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.647864818572998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6480956077575684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.667712688446045  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.668921947479248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.668921947479248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.669124126434326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6877245903015137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.688901901245117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.688901901245117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6890830993652344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.707021713256836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7080726623535156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7080726623535156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.708221435546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7239913940429688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.725080966949463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.725080966949463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7252163887023926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7405190467834473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([76, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7416934967041016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7416934967041016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7418384552001953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7592334747314453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7599568367004395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7599568367004395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.760044574737549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7711873054504395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7722296714782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7722296714782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7723422050476074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.787421703338623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7882113456726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7882113456726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.788295269012451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.80012845993042  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.800752639770508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.800752639770508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8008155822753906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.810131072998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.810818672180176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.810818672180176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8108835220336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8209352493286133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8218092918395996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8218092918395996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.821887493133545  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8345561027526855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.835209369659424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.835209369659424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.835266590118408  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8449368476867676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([557, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8582921028137207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8582921028137207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8593544960021973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.046955108642578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 557, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0081276893615723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.008975028991699  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.009822368621826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.008932590484619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37374
output nodes number: 5684
edges number: 45714
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.00925350189209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.009253978729248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05997323989868164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 14 input nodes size: 97371
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05241870880126953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05241870880126953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.09929370880126953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.09933614730834961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97371, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1666, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.19980144500732422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.19980144500732422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20139026641845703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21420574188232422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1666, 128])
m.shape torch.Size([2049, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21536540985107422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21536540985107422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21731948852539062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.24832677841186523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([2161, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2504410743713379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2504410743713379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2161, 128]), torch.Size([1, 2161, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2532062530517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30017805099487305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2161, 128])
m.shape torch.Size([2134, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30321788787841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30321788787841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3052659034729004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3656039237976074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([2135, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3696765899658203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3696765899658203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2135, 128]), torch.Size([1, 2135, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3722376823425293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44797611236572266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2135, 128])
m.shape torch.Size([1888, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.453066349029541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.453066349029541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1888, 128]), torch.Size([1, 1888, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.454866886138916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.532289981842041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1888, 128])
m.shape torch.Size([1716, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5371174812316895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5371174812316895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1716, 128]), torch.Size([1, 1716, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5387539863586426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6237168312072754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1716, 128])
m.shape torch.Size([1647, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6291813850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6291813850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1647, 128]), torch.Size([1, 1647, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6307520866394043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7226433753967285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1647, 128])
m.shape torch.Size([1516, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7288236618041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7288236618041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1516, 128]), torch.Size([1, 1516, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7302694320678711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8227987289428711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1516, 128])
m.shape torch.Size([20738, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9216852188110352  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9216852188110352  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20738, 128]), torch.Size([1, 20738, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9424304962158203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.34661865234375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20738, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2145633697509766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.250469207763672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.286375045776367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2501883506774902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37650, 256])
first layer input nodes number: 97371
first layer output nodes number: 37650
edges number: 288998
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.287102699279785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3230085372924805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.332651138305664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.332651138305664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([838, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.378955364227295  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.378955364227295  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 838, 256]), torch.Size([1, 838, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.380553722381592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.394010066986084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 838, 256])
m.shape torch.Size([706, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.394594192504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.394594192504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3959407806396484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.416139602661133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([619, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.41733455657959  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.41733455657959  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.418515205383301  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4448843002319336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([427, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.445983409881592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.445983409881592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4467978477478027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4741263389587402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([424, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.475757122039795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.475757122039795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4765658378601074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5056796073913574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.507080554962158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.507080554962158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5076775550842285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.537868022918701  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([226, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.539107322692871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.539107322692871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5395383834838867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.561091423034668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([231, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.562652111053467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.562652111053467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5630927085876465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5882067680358887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([163, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.589458465576172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.589458465576172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5897693634033203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6096668243408203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.611049175262451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.611049175262451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6113524436950684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6328845024108887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([150, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6343235969543457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6343235969543457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6346096992492676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.656925678253174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6582541465759277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6582541465759277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.658477306365967  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.677445888519287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6788058280944824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6788058280944824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6790060997009277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6974310874938965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6988024711608887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6988024711608887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6989874839782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.71730375289917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7183938026428223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7183938026428223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.718550205230713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.735128879547119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.73618745803833  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.73618745803833  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.736319065093994  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.751190662384033  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7523703575134277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7523703575134277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.752498149871826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7678332328796387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7692394256591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7692394256591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7693634033203125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7851085662841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.785996437072754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.785996437072754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.78609561920166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7993860244750977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8008065223693848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8008065223693848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8009190559387207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.816786289215088  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8176989555358887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8176989555358887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8177905082702637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8313403129577637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8322038650512695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8322038650512695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8322858810424805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.844998359680176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.845620632171631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.845620632171631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8456778526306152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.854947566986084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8555188179016113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8555188179016113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8555684089660645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8639492988586426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([568, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.877572536468506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.877572536468506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8786559104919434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0810675621032715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 568, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.040900707244873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.041748046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.042595386505127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.04170560836792  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37650
output nodes number: 5684
edges number: 46356
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0420289039611816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.04202938079834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0612483024597168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 15 input nodes size: 98971
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10051155090332031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10055398941040039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05363655090332031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.056206703186035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.056206703186035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.056206703186035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([98971, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.056206703186035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1659, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20386600494384766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20386600494384766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20544815063476562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2184276580810547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1659, 128])
m.shape torch.Size([2068, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21960878372192383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21960878372192383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2068, 128]), torch.Size([1, 2068, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22158098220825195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2527012825012207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2068, 128])
m.shape torch.Size([2214, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2548823356628418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2548823356628418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2214, 128]), torch.Size([1, 2214, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25751733779907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3049130439758301  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2214, 128])
m.shape torch.Size([2097, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30785703659057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30785703659057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2097, 128]), torch.Size([1, 2097, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30991268157958984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36895132064819336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2097, 128])
m.shape torch.Size([2033, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37279844284057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37279844284057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2033, 128]), torch.Size([1, 2033, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3747372627258301  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44487810134887695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2033, 128])
m.shape torch.Size([1922, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44940757751464844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44940757751464844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45124053955078125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5325450897216797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
m.shape torch.Size([1657, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5371594429016113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5371594429016113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1657, 128]), torch.Size([1, 1657, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5387396812438965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6194567680358887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1657, 128])
m.shape torch.Size([1594, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6247472763061523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6247472763061523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1594, 128]), torch.Size([1, 1594, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6262674331665039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7138452529907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1594, 128])
m.shape torch.Size([1519, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7196040153503418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7196040153503418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7210526466369629  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.813967227935791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1519, 128])
m.shape torch.Size([21698, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9167585372924805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9167585372924805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21698, 128]), torch.Size([1, 21698, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9374513626098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4073262214660645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21698, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2719125747680664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.308591842651367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.345271110534668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.308305263519287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([38461, 256])
first layer input nodes number: 98971
first layer output nodes number: 38461
edges number: 297524
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.346010684967041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.382689952850342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3918747901916504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3918747901916504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([832, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4383420944213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4383420944213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4399290084838867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4535655975341797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4542064666748047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4542064666748047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4555892944335938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.477285385131836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([588, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.478579521179199  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.478579521179199  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.479701042175293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5053787231445312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([437, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5068368911743164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5068368911743164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5076704025268555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5341062545776367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5362210273742676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5362210273742676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.536957263946533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5650839805603027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5665440559387207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5665440559387207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5671486854553223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.596163272857666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5974626541137695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5974626541137695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.597916603088379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6206140518188477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6221094131469727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6221094131469727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6225366592407227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6468896865844727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6483631134033203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6483631134033203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6487350463867188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6725387573242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6739583015441895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6739583015441895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.674276828765869  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.696892261505127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.697903633117676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.697903633117676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.698105812072754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7138757705688477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7151970863342285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7151970863342285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.715427875518799  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7350449562072754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7361302375793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7361302375793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7363057136535645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7524495124816895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7536673545837402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7536673545837402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.753852367401123  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7721686363220215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7733163833618164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7733163833618164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7734804153442383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.790867805480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7917394638061523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7917394638061523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7918577194213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.805220603942871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.806370735168457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.806370735168457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.806511878967285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.82344913482666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8245787620544434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8245787620544434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8246989250183105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8399596214294434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8408312797546387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8408312797546387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.840928554534912  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8539633750915527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.854607105255127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.854607105255127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.854675769805908  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8643574714660645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.865070343017578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.865070343017578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.865140914916992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8755855560302734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.876248359680176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.876248359680176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8763113021850586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8860673904418945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.88692045211792  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.88692045211792  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8869967460632324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8993563652038574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.900240898132324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.900240898132324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9003171920776367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.913210868835449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([634, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9284067153930664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9284067153930664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9296159744262695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.143983840942383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 634, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.103588581085205  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.104435443878174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1052823066711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1043930053710938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5681, 40])
input nodes number: 38461
output nodes number: 5681
edges number: 47277
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1047215461730957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.104722023010254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06142425537109375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06697463989257812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06697463989257812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026182323694229126 |0.02350008487701416 |0.1543346494436264 |9.85264778137207e-05 |0.07874579727649689 |0.005720853805541992 |
----------------------------------------------------------pseudo_mini_loss sum 5.330964088439941
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2165001
Number of first layer input nodes during this epoch:  1560819
Number of first layer output nodes during this epoch:  604182
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06697416305541992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028576374053955078
number of batches is  16
batch size is  5684
range selection method spend 0.013919353485107422
time for parepare:  0.019435882568359375
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.007134914398193359
mini_batch_src_global generation:  0.001682281494140625
r_  generation:  0.015816450119018555
local_output_nid generation:  0.0016856193542480469
local_in_edges_tensor generation:  0.0012271404266357422
mini_batch_src_global generation:  0.0018563270568847656
r_  generation:  0.016644954681396484
local_output_nid generation:  0.0016744136810302734
local_in_edges_tensor generation:  0.0008449554443359375
mini_batch_src_global generation:  0.0013153553009033203
r_  generation:  0.016707658767700195
local_output_nid generation:  0.0016207695007324219
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.0168454647064209
local_output_nid generation:  0.0016276836395263672
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.0013151168823242188
r_  generation:  0.016358137130737305
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008146762847900391
mini_batch_src_global generation:  0.0012524127960205078
r_  generation:  0.016474246978759766
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.0013022422790527344
r_  generation:  0.01670098304748535
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.0013344287872314453
r_  generation:  0.0171201229095459
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0008075237274169922
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.0164949893951416
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.0013718605041503906
r_  generation:  0.017304420471191406
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0008084774017333984
mini_batch_src_global generation:  0.0014138221740722656
r_  generation:  0.018009662628173828
local_output_nid generation:  0.001550436019897461
local_in_edges_tensor generation:  0.0010576248168945312
mini_batch_src_global generation:  0.0013010501861572266
r_  generation:  0.01721024513244629
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0008063316345214844
mini_batch_src_global generation:  0.001331329345703125
r_  generation:  0.017360925674438477
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.0014057159423828125
r_  generation:  0.017783641815185547
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008246898651123047
mini_batch_src_global generation:  0.0014061927795410156
r_  generation:  0.017395734786987305
local_output_nid generation:  0.0016126632690429688
local_in_edges_tensor generation:  0.0008025169372558594
mini_batch_src_global generation:  0.0013260841369628906
r_  generation:  0.01738429069519043
----------------------check_connections_block total spend ----------------------------- 0.4209275245666504
generate_one_block  0.026144742965698242
generate_one_block  0.0257418155670166
generate_one_block  0.026052236557006836
generate_one_block  0.02653813362121582
generate_one_block  0.02635788917541504
generate_one_block  0.025492191314697266
generate_one_block  0.025417566299438477
generate_one_block  0.0257418155670166
generate_one_block  0.026018381118774414
generate_one_block  0.026502370834350586
generate_one_block  0.026396512985229492
generate_one_block  0.028122901916503906
generate_one_block  0.026491880416870117
generate_one_block  0.025742530822753906
generate_one_block  0.027399539947509766
generate_one_block  0.025981903076171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02199554443359375
gen group dst list time:  0.017460107803344727
time for parepare:  0.019330978393554688
local_output_nid generation:  0.00651860237121582
local_in_edges_tensor generation:  0.015350103378295898
mini_batch_src_global generation:  0.010279655456542969
r_  generation:  0.10567378997802734
local_output_nid generation:  0.009717226028442383
local_in_edges_tensor generation:  0.008108377456665039
mini_batch_src_global generation:  0.011559247970581055
r_  generation:  0.10608720779418945
local_output_nid generation:  0.010422945022583008
local_in_edges_tensor generation:  0.008259057998657227
mini_batch_src_global generation:  0.01108241081237793
r_  generation:  0.11189937591552734
local_output_nid generation:  0.009894132614135742
local_in_edges_tensor generation:  0.00799870491027832
mini_batch_src_global generation:  0.013843297958374023
r_  generation:  0.1143789291381836
local_output_nid generation:  0.010083198547363281
local_in_edges_tensor generation:  0.008297204971313477
mini_batch_src_global generation:  0.01245260238647461
r_  generation:  0.11259007453918457
local_output_nid generation:  0.010079383850097656
local_in_edges_tensor generation:  0.008070707321166992
mini_batch_src_global generation:  0.012566566467285156
r_  generation:  0.11423826217651367
local_output_nid generation:  0.010167598724365234
local_in_edges_tensor generation:  0.008211612701416016
mini_batch_src_global generation:  0.01514887809753418
r_  generation:  0.11306309700012207
local_output_nid generation:  0.010371208190917969
local_in_edges_tensor generation:  0.008953332901000977
mini_batch_src_global generation:  0.01542353630065918
r_  generation:  0.11870217323303223
local_output_nid generation:  0.010237693786621094
local_in_edges_tensor generation:  0.008414030075073242
mini_batch_src_global generation:  0.01298975944519043
r_  generation:  0.1118166446685791
local_output_nid generation:  0.011988162994384766
local_in_edges_tensor generation:  0.009033441543579102
mini_batch_src_global generation:  0.013216733932495117
r_  generation:  0.11727213859558105
local_output_nid generation:  0.010489702224731445
local_in_edges_tensor generation:  0.008630514144897461
mini_batch_src_global generation:  0.014826774597167969
r_  generation:  0.1152961254119873
local_output_nid generation:  0.010450601577758789
local_in_edges_tensor generation:  0.008634567260742188
mini_batch_src_global generation:  0.013465642929077148
r_  generation:  0.11563777923583984
local_output_nid generation:  0.010565757751464844
local_in_edges_tensor generation:  0.008238792419433594
mini_batch_src_global generation:  0.013365745544433594
r_  generation:  0.11608028411865234
local_output_nid generation:  0.010512828826904297
local_in_edges_tensor generation:  0.008607625961303711
mini_batch_src_global generation:  0.01328134536743164
r_  generation:  0.1169126033782959
local_output_nid generation:  0.010764122009277344
local_in_edges_tensor generation:  0.008768796920776367
mini_batch_src_global generation:  0.013498306274414062
r_  generation:  0.12170624732971191
local_output_nid generation:  0.01151132583618164
local_in_edges_tensor generation:  0.009159088134765625
mini_batch_src_global generation:  0.027493715286254883
r_  generation:  0.12670254707336426
----------------------check_connections_block total spend ----------------------------- 2.8268933296203613
generate_one_block  0.15269708633422852
generate_one_block  0.13885140419006348
generate_one_block  0.14193391799926758
generate_one_block  0.14057636260986328
generate_one_block  0.13996601104736328
generate_one_block  0.14158201217651367
generate_one_block  0.1655573844909668
generate_one_block  0.14241909980773926
generate_one_block  0.14058232307434082
generate_one_block  0.13947725296020508
generate_one_block  0.15294718742370605
generate_one_block  0.14009618759155273
generate_one_block  0.13712000846862793
generate_one_block  0.16309666633605957
generate_one_block  0.14102697372436523
generate_one_block  0.14011192321777344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06697416305541992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

connection checking time:  2.8268933296203613
block generation total time  2.3180418014526367
average batch blocks generation time:  0.1448776125907898
block dataloader generation time/epoch 6.246604681015015
pseudo mini batch 0 input nodes size: 97625
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05918550491333008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05918550491333008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10606050491333008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10610294342041016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.058867454528808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06138801574707031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06138801574707031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06138801574707031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97625, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06138801574707031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1642, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20530414581298828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20530414581298828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1642, 128]), torch.Size([1, 1642, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20687007904052734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21965312957763672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1642, 128])
m.shape torch.Size([2061, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22083568572998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22083568572998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2061, 128]), torch.Size([1, 2061, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22375774383544922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2557821273803711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2061, 128])
m.shape torch.Size([2242, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2577476501464844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2577476501464844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2242, 128]), torch.Size([1, 2242, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2598857879638672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3073153495788574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2242, 128])
m.shape torch.Size([2144, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.310335636138916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.310335636138916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2144, 128]), torch.Size([1, 2144, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3123917579650879  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37269163131713867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2144, 128])
m.shape torch.Size([2026, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37602663040161133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37602663040161133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2026, 128]), torch.Size([1, 2026, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3779587745666504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44814538955688477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2026, 128])
m.shape torch.Size([1873, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45253801345825195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45253801345825195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1873, 128]), torch.Size([1, 1873, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45432424545288086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5311322212219238  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1873, 128])
m.shape torch.Size([1710, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5359468460083008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5359468460083008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1710, 128]), torch.Size([1, 1710, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5375776290893555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6204185485839844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1710, 128])
m.shape torch.Size([1636, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6258440017700195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6258440017700195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1636, 128]), torch.Size([1, 1636, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6274042129516602  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7190713882446289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1636, 128])
m.shape torch.Size([1545, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.724921703338623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.724921703338623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1545, 128]), torch.Size([1, 1545, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7263951301574707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8206944465637207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1545, 128])
m.shape torch.Size([21023, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9202032089233398  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9202032089233398  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21023, 128]), torch.Size([1, 21023, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9402523040771484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.391261100769043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21023, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2595367431640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.295682907104492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.331829071044922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2954001426696777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37902, 256])
first layer input nodes number: 97625
first layer output nodes number: 37902
edges number: 291627
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3325586318969727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3687047958374023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.378211498260498  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.378211498260498  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([848, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.424527168273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.424527168273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 848, 256]), torch.Size([1, 848, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.426144599914551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.439424514770508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 848, 256])
m.shape torch.Size([749, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4400854110717773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4400854110717773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.441514015197754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4636735916137695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([588, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.464822769165039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.464822769165039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.465944290161133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4926533699035645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4939565658569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4939565658569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4948129653930664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5211410522460938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([358, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.522433280944824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.522433280944824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.523116111755371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5485005378723145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([288, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5498199462890625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5498199462890625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5503692626953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.575894355773926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([280, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5775036811828613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5775036811828613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.578037738800049  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6058335304260254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6072354316711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6072354316711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.607649326324463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6312413215637207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([180, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.632591724395752  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.632591724395752  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.632935047149658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.654907703399658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.656370162963867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.656370162963867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6566944122314453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.679716110229492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6810660362243652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6810660362243652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6813387870788574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.702613353729248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7039294242858887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7039294242858887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7041430473327637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7223010063171387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7233691215515137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7233691215515137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.723548412322998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7400431632995605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.741178035736084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.741178035736084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.74135160446167  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7585349082946777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7594285011291504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7594285011291504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7595582008361816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.773306369781494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.774364471435547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.774364471435547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.774503707885742  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7902374267578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.79152250289917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.79152250289917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7916483879089355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8067545890808105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8077645301818848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8077645301818848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.807882785797119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8229012489318848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.823627471923828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.823627471923828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.823709487915039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8346996307373047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.835869789123535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.835869789123535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8359899520874023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.852932929992676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8536806106567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8536806106567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.853756904602051  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.865048408508301  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.865708351135254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.865708351135254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8657712936401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8755273818969727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8763585090637207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8763585090637207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8764328956604004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8884835243225098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.889455795288086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.889455795288086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.889537811279297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9033985137939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([587, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9174623489379883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9174623489379883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.918581962585449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1215286254882812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 587, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0813426971435547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0821900367736816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0830373764038086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0821475982666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37902
output nodes number: 5684
edges number: 46526
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0824732780456543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0824742317199707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06637716293334961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 1 input nodes size: 96935
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10509109497070312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.1051335334777832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.058216094970703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06069660186767578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06069660186767578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06069660186767578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96935, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06069660186767578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1598, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20259809494018555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20259809494018555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1598, 128]), torch.Size([1, 1598, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20412206649780273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21663236618041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1598, 128])
m.shape torch.Size([2110, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21796751022338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21796751022338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21997976303100586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2520880699157715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([2178, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25354623794555664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25354623794555664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2178, 128]), torch.Size([1, 2178, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2572159767150879  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3039259910583496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2178, 128])
m.shape torch.Size([2045, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30678796768188477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30678796768188477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2045, 128]), torch.Size([1, 2045, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30873823165893555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36536455154418945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2045, 128])
m.shape torch.Size([2054, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36928653717041016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36928653717041016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2054, 128]), torch.Size([1, 2054, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3716583251953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44550132751464844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2054, 128])
m.shape torch.Size([1810, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44875526428222656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44875526428222656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1810, 128]), torch.Size([1, 1810, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4504814147949219  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5268611907958984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1810, 128])
m.shape torch.Size([1742, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5318126678466797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5318126678466797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1742, 128]), torch.Size([1, 1742, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5334739685058594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6165761947631836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1742, 128])
m.shape torch.Size([1631, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6219673156738281  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6219673156738281  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1631, 128]), torch.Size([1, 1631, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6235227584838867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7156467437744141  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1631, 128])
m.shape torch.Size([1453, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.721104621887207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.721104621887207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7224903106689453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8123416900634766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([20699, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9112582206726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9112582206726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20699, 128]), torch.Size([1, 20699, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9309983253479004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.332545757293701  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20699, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2022790908813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.237870216369629  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.27346134185791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2375917434692383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37320, 256])
first layer input nodes number: 96935
first layer output nodes number: 37320
edges number: 286971
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2741856575012207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.309776782989502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3194379806518555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3194379806518555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([848, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3645405769348145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3645405769348145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 848, 256]), torch.Size([1, 848, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3661580085754395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.380005359649658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 848, 256])
m.shape torch.Size([760, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.380739212036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.380739212036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3821887969970703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4039363861083984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([589, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4049606323242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4049606323242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4060840606689453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.43149471282959  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.432682514190674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.432682514190674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4335389137268066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4588212966918945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([406, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4603443145751953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4603443145751953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.461118698120117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.489534854888916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.490912437438965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.490912437438965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4914960861206055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5227227210998535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([253, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5241332054138184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5241332054138184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.52461576461792  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.548743724822998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([194, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5500497817993164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5500497817993164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.550419807434082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5715112686157227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.572873592376709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.572873592376709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.573209285736084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.594693660736084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([162, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5961132049560547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5961132049560547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5964221954345703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6183605194091797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.619752883911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.619752883911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.620016098022461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6405467987060547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6419615745544434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6419615745544434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.642188549041748  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6614813804626465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6629137992858887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6629137992858887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.663114070892334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6815390586853027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6829833984375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6829833984375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.683147430419922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6993865966796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.700850009918213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.700850009918213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.701019763946533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7190136909484863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.719975471496582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.719975471496582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7201013565063477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7343263626098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7358078956604004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7358078956604004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.73594331741333  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7521939277648926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.753077983856201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.753077983856201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.753182888031006  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.766505718231201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7675585746765137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7675585746765137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7676615715026855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.781463146209717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7823920249938965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7823920249938965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.78248929977417  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7962050437927246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7968225479125977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7968225479125977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7968854904174805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8062009811401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8069100379943848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8069100379943848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.806976795196533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.817324161529541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8178658485412598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8178658485412598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.817915439605713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.825949192047119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.826432228088379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.826432228088379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.826474189758301  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8335657119750977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([591, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847745418548584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847745418548584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.848872661590576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0572047233581543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 591, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.018223285675049  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.019070625305176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0199179649353027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0190281867980957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37320
output nodes number: 5684
edges number: 45837
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0193490982055664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0193495750427246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06590557098388672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 2 input nodes size: 98474
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.058216094970703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.058216094970703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10517215728759766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10521459579467773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.058949947357177734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06150197982788086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06150197982788086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06150197982788086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([98474, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06150197982788086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1634, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20739126205444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20739126205444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1634, 128]), torch.Size([1, 1634, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20894956588745117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22143173217773438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1634, 128])
m.shape torch.Size([2093, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22264862060546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22264862060546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22464466094970703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2565617561340332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
m.shape torch.Size([2196, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2585577964782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2585577964782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2196, 128]), torch.Size([1, 2196, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2612943649291992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3077688217163086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2196, 128])
m.shape torch.Size([2149, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3108205795288086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3108205795288086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.31311511993408203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37362051010131836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([2003, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3769245147705078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3769245147705078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2003, 128]), torch.Size([1, 2003, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37883472442626953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44863224029541016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2003, 128])
m.shape torch.Size([1890, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45308446884155273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45308446884155273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1890, 128]), torch.Size([1, 1890, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45488691329956055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5337691307067871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1890, 128])
m.shape torch.Size([1774, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5387892723083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5387892723083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1774, 128]), torch.Size([1, 1774, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5404810905456543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6256966590881348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1774, 128])
m.shape torch.Size([1608, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6309847831726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6309847831726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1608, 128]), torch.Size([1, 1608, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6325182914733887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7201633453369141  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1608, 128])
m.shape torch.Size([1492, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7266597747802734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7266597747802734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1492, 128]), torch.Size([1, 1492, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7280826568603516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8191471099853516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1492, 128])
m.shape torch.Size([21401, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9204835891723633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9204835891723633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21401, 128]), torch.Size([1, 21401, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9416823387145996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3966565132141113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21401, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2632617950439453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2997303009033203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3361988067626953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.299445152282715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([38240, 256])
first layer input nodes number: 98474
first layer output nodes number: 38240
edges number: 295079
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3369345664978027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3734030723571777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3827295303344727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3827295303344727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([835, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.429168224334717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.429168224334717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 835, 256]), torch.Size([1, 835, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4307608604431152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.443967342376709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 835, 256])
m.shape torch.Size([740, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.444650173187256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.444650173187256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.446061611175537  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.468942165374756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 740, 256])
m.shape torch.Size([541, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.470705509185791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.470705509185791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4717373847961426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.497358798980713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([460, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4986114501953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4986114501953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4994888305664062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.52603816986084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([362, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.527339458465576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.527339458465576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5280299186706543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.553969383239746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.555325508117676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.555325508117676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5558881759643555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5812721252441406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([283, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.582894802093506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.582894802093506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.583434581756592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.612534523010254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6138949394226074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6138949394226074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6142992973327637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.63734769821167  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6387720108032227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6387720108032227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6391305923461914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6620798110961914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.663689613342285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.663689613342285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.663994789123535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.685662269592285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.687042713165283  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.687042713165283  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.687319278717041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7088913917541504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([125, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7101950645446777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7101950645446777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7104334831237793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.730699062347412  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7320046424865723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7320046424865723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.732222080230713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7522263526916504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.75343656539917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.75343656539917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7536234855651855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7721285820007324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7730908393859863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7730908393859863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7732300758361816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7879891395568848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.788968563079834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.788968563079834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7890944480895996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8033194541931152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.804286003112793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.804286003112793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.80440616607666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8188257217407227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.819786548614502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.819786548614502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.819899082183838  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.834190845489502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8351407051086426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8351407051086426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8352437019348145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8490452766418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.849916458129883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.849916458129883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.850008010864258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.862916946411133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8638200759887695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8638200759887695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8639097213745117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8771772384643555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8778514862060547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8778514862060547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8779163360595703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.887968063354492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.888598918914795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.888598918914795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8886561393737793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.897925853729248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.898566246032715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.898566246032715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8986215591430664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9079694747924805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([623, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9229116439819336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9229116439819336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 623, 256]), torch.Size([1, 623, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.924099922180176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.134465217590332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 623, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0941152572631836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0949625968933105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0958099365234375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0949201583862305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 38240
output nodes number: 5684
edges number: 47242
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.095247745513916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.095248222351074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0668339729309082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 3 input nodes size: 98053
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.058949947357177734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.058949947357177734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10582494735717773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10586738586425781  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06141996383666992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06141996383666992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06141996383666992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([98053, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06141996383666992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1573, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2071700096130371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2071700096130371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1573, 128]), torch.Size([1, 1573, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20867013931274414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22126436233520508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1573, 128])
m.shape torch.Size([2113, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22252941131591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22252941131591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22547292709350586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2576289176940918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([2221, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2596440315246582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2596440315246582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2221, 128]), torch.Size([1, 2221, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2617621421813965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3088254928588867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2221, 128])
m.shape torch.Size([2100, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.31177186965942383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.31177186965942383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2100, 128]), torch.Size([1, 2100, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.31395912170410156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.373687744140625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2100, 128])
m.shape torch.Size([2043, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37685346603393555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37685346603393555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2043, 128]), torch.Size([1, 2043, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3788018226623535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44908571243286133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2043, 128])
m.shape torch.Size([1876, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4534788131713867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4534788131713867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1876, 128]), torch.Size([1, 1876, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45526790618896484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.532588005065918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1876, 128])
m.shape torch.Size([1736, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5374879837036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5374879837036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5391435623168945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.621922492980957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1736, 128])
m.shape torch.Size([1629, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6273088455200195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6273088455200195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1629, 128]), torch.Size([1, 1629, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6288623809814453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7207651138305664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1629, 128])
m.shape torch.Size([1479, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7263355255126953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7263355255126953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1479, 128]), torch.Size([1, 1479, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7277460098266602  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8188376426696777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1479, 128])
m.shape torch.Size([21412, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9202327728271484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9202327728271484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21412, 128]), torch.Size([1, 21412, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9406528472900391  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.395742416381836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21412, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2623777389526367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.29879093170166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3352041244506836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.298506259918213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([38182, 256])
first layer input nodes number: 98053
first layer output nodes number: 38182
edges number: 294948
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.335937023162842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3723502159118652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.38167142868042  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.38167142868042  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([762, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.428140640258789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.428140640258789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 762, 256]), torch.Size([1, 762, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.429594039916992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4427947998046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 762, 256])
m.shape torch.Size([722, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4434943199157715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4434943199157715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.444871425628662  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4664416313171387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 722, 256])
m.shape torch.Size([641, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4683732986450195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4683732986450195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4695959091186523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4968137741088867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.498201847076416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.498201847076416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.499058246612549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5249485969543457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5263609886169434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5263609886169434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5270915031433105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.554744243621826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([290, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.556051731109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.556051731109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5566048622131348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5812792778015137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([268, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.58280611038208  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.58280611038208  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.583317279815674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6099143028259277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6114583015441895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6114583015441895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6119046211242676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6373448371887207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6386704444885254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6386704444885254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.639011859893799  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.660862445831299  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6620473861694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6620473861694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.66231632232666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.681410789489746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([154, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6829047203063965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6829047203063965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6831984519958496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7061095237731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.707162380218506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.707162380218506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7073607444763184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.724221706390381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([116, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.725983142852783  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.725983142852783  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7262043952941895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7465596199035645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.747714042663574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.747714042663574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7478933334350586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7656431198120117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.766704559326172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.766704559326172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7668495178222656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.782215118408203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7831883430480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7831883430480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.783318042755127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.797974109649658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.799053192138672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.799053192138672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7991867065429688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8152084350585938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.816283702850342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.816283702850342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8164095878601074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.832396984100342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8333749771118164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8333749771118164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8334836959838867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8480520248413086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8490166664123535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8490166664123535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8491177558898926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8633713722229004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.864410877227783  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.864410877227783  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.864513874053955  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8797574043273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.880488395690918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.880488395690918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.880558967590332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8914976119995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8923468589782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8923468589782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.892423152923584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.904782772064209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9055752754211426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9055752754211426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.905643939971924  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.917248249053955  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([590, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9313907623291016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9313907623291016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.932516098022461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.133974075317383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 590, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0935544967651367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0944018363952637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0952491760253906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0943593978881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 38182
output nodes number: 5684
edges number: 47346
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.094686508178711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.094686985015869  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06670188903808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 4 input nodes size: 98067
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10563087463378906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10567331314086914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05875587463378906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.061280250549316406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.061280250549316406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.061280250549316406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([98067, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.061280250549316406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1669, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20521306991577148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20521306991577148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1669, 128]), torch.Size([1, 1669, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20680475234985352  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21970319747924805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1669, 128])
m.shape torch.Size([2042, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2208547592163086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2208547592163086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2042, 128]), torch.Size([1, 2042, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22280216217041016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2520475387573242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2042, 128])
m.shape torch.Size([2181, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2550029754638672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2550029754638672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2181, 128]), torch.Size([1, 2181, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2579641342163086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30489444732666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2181, 128])
m.shape torch.Size([2199, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.307769775390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.307769775390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2199, 128]), torch.Size([1, 2199, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3101372718811035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37176942825317383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2199, 128])
m.shape torch.Size([2091, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37570619583129883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37570619583129883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37775182723999023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4513087272644043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([1834, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45555877685546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45555877685546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1834, 128]), torch.Size([1, 1834, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4573078155517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5342254638671875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1834, 128])
m.shape torch.Size([1737, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5391488075256348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5391488075256348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1737, 128]), torch.Size([1, 1737, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5408053398132324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.624267578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1737, 128])
m.shape torch.Size([1646, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6297183036804199  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6297183036804199  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6312880516052246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7235407829284668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1474, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7290816307067871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7290816307067871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7304873466491699  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8209166526794434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([21108, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9208645820617676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9208645820617676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21108, 128]), torch.Size([1, 21108, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9409947395324707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.392895221710205  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21108, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.260697841644287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.296919345855713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3331408500671387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2966361045837402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37981, 256])
first layer input nodes number: 98067
first layer output nodes number: 37981
edges number: 292224
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.333873748779297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3700952529907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.379561424255371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.379561424255371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([837, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4258646965026855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4258646965026855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4274611473083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.440765857696533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([699, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4413986206054688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4413986206054688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4427318572998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4629287719726562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([569, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4639077186584473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4639077186584473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4649930000305176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4911293983459473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([485, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.492642402648926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.492642402648926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.49356746673584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5208253860473633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([373, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.52215576171875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.52215576171875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.522867202758789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5503368377685547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([330, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.551884174346924  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.551884174346924  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.552513599395752  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5807695388793945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.582231044769287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.582231044769287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5827345848083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6089706420898438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.610318183898926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.610318183898926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.610714912414551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.633328437805176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.634765148162842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.634765148162842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6351256370544434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6581969261169434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([184, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.659785270690918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.659785270690918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6601362228393555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.685053825378418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.686370849609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.686370849609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.686626434326172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.706562042236328  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7077956199645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7077956199645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7080206871032715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.727151393890381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.728313446044922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.728313446044922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7285079956054688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7464065551757812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.747453212738037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.747453212738037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.747615337371826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7636656761169434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7648391723632812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7648391723632812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.765005111694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.782594680786133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7836036682128906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7836036682128906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7837390899658203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.799041748046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8000197410583496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8000197410583496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8001418113708496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8147902488708496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8157501220703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8157501220703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8158626556396484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8301544189453125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8309202194213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8309202194213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8310060501098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8425073623657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.843329906463623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.843329906463623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8434157371520996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.855517864227295  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.856201648712158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.856201648712158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8562703132629395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8664326667785645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8672866821289062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8672866821289062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8673667907714844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8797836303710938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.880451202392578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.880451202392578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.880512237548828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.890399932861328  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.891292095184326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.891292095184326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8913683891296387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.904262065887451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([586, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.918304443359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.918304443359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.919422149658203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.1213550567626953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 586, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.081171989440918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.082019329071045  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.082866668701172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.081976890563965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37981
output nodes number: 5684
edges number: 46558
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0823025703430176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.082303047180176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06598949432373047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 5 input nodes size: 97406
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05875587463378906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05875587463378906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10563087463378906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10567331314086914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06135892868041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06135892868041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06135892868041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97406, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06135892868041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1723, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20333337783813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20333337783813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1723, 128]), torch.Size([1, 1723, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20497655868530273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21812200546264648  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1723, 128])
m.shape torch.Size([2085, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2193598747253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2193598747253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2085, 128]), torch.Size([1, 2085, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22134828567504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.253084659576416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2085, 128])
m.shape torch.Size([2212, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2544722557067871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2544722557067871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2212, 128]), torch.Size([1, 2212, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.258237361907959  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3052382469177246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2212, 128])
m.shape torch.Size([2086, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30816221237182617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30816221237182617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2086, 128]), torch.Size([1, 2086, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.31038808822631836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3699307441711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2086, 128])
m.shape torch.Size([2085, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37312984466552734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37312984466552734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2085, 128]), torch.Size([1, 2085, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37589597702026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4513735771179199  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2085, 128])
m.shape torch.Size([1824, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4555978775024414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4555978775024414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1824, 128]), torch.Size([1, 1824, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4573373794555664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5341386795043945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1824, 128])
m.shape torch.Size([1704, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5389566421508789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5389566421508789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1704, 128]), torch.Size([1, 1704, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5405817031860352  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6225404739379883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1704, 128])
m.shape torch.Size([1698, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6282052993774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6282052993774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1698, 128]), torch.Size([1, 1698, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6298246383666992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7225236892700195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1698, 128])
m.shape torch.Size([1455, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7279582023620605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7279582023620605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1455, 128]), torch.Size([1, 1455, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7293457984924316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8186421394348145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1455, 128])
m.shape torch.Size([20719, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9175577163696289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9175577163696289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20719, 128]), torch.Size([1, 20719, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.93731689453125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3402185440063477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20719, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.208648204803467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.244497776031494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2803473472595215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2442173957824707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37591, 256])
first layer input nodes number: 97406
first layer output nodes number: 37591
edges number: 288039
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2810750007629395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.316924571990967  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3265762329101562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3265762329101562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([859, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3718042373657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3718042373657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 859, 256]), torch.Size([1, 859, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3734426498413086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.387115478515625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 859, 256])
m.shape torch.Size([739, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3878049850463867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3878049850463867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.389214515686035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4103574752807617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([586, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.411375045776367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.411375045776367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4124927520751953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4390339851379395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([458, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.440265655517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.440265655517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4411392211914062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.468693733215332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([400, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.470179557800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.470179557800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.470942497253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.49906587600708  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5003857612609863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5003857612609863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.500948429107666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.531032085418701  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([263, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5326247215270996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5326247215270996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5331263542175293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5662741661071777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([215, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.567676544189453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.567676544189453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.568086624145508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.591461181640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([187, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.592874050140381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.592874050140381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.593230724334717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.616057872772217  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6173501014709473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6173501014709473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6176419258117676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6383614540100098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6394948959350586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6394948959350586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.639725685119629  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6577272415161133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.659295082092285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.659295082092285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.659541130065918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.680455207824707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.681619167327881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.681619167327881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6818156242370605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.699889659881592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.700854778289795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.700854778289795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.701005458831787  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7159228324890137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.717000961303711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.717000961303711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.717153549194336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.733327865600586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7341437339782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7341437339782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7342543601989746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7467551231384277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7477946281433105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7477946281433105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.747922420501709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7632575035095215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7641282081604004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7641282081604004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7642312049865723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7773118019104004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7782649993896484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7782649993896484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.778369903564453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7924270629882812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.793489933013916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.793489933013916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.793600559234619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8091988563537598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.810051918029785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.810051918029785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8101377487182617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.822840690612793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.823800563812256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.823800563812256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.823890209197998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.837785243988037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.838271141052246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.838271141052246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8383169174194336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8457326889038086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8465867042541504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8465867042541504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8466591835021973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.858908176422119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([571, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8725924491882324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8725924491882324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8736815452575684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.075559616088867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 571, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0364832878112793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0373306274414062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.038177967071533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.037288188934326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37591
output nodes number: 5684
edges number: 45957
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0376110076904297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.037611484527588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06607389450073242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 6 input nodes size: 96782
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10501813888549805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10506057739257812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05814313888549805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06060934066772461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06060934066772461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06060934066772461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96782, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06060934066772461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1662, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20167160034179688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20167160034179688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20325660705566406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21593666076660156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([2142, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21718692779541016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21718692779541016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2142, 128]), torch.Size([1, 2142, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21930837631225586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2512946128845215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2142, 128])
m.shape torch.Size([2226, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25333738327026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25333738327026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2226, 128]), torch.Size([1, 2226, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.255460262298584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.302492618560791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2226, 128])
m.shape torch.Size([2146, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3055243492126465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3055243492126465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2146, 128]), torch.Size([1, 2146, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3076901435852051  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.36812353134155273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2146, 128])
m.shape torch.Size([2053, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3715324401855469  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3715324401855469  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37399721145629883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44759225845336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([1903, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4520578384399414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4520578384399414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1903, 128]), torch.Size([1, 1903, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4538726806640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5337133407592773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1903, 128])
m.shape torch.Size([1722, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5385537147521973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5385537147521973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1722, 128]), torch.Size([1, 1722, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5401959419250488  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6226077079772949  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1722, 128])
m.shape torch.Size([1552, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6277070045471191  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6277070045471191  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1552, 128]), torch.Size([1, 1552, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6291871070861816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7147965431213379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1552, 128])
m.shape torch.Size([1491, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7204551696777344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7204551696777344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1491, 128]), torch.Size([1, 1491, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7218770980834961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8128805160522461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1491, 128])
m.shape torch.Size([20450, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9096827507019043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9096827507019043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20450, 128]), torch.Size([1, 20450, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9291853904724121  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.314187526702881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20450, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.184199810028076  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2198166847229004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2554335594177246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2195382118225098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37347, 256])
first layer input nodes number: 96782
first layer output nodes number: 37347
edges number: 285280
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2561569213867188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.291773796081543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.301553726196289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.301553726196289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([845, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3464226722717285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3464226722717285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.348034381866455  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.361417293548584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([758, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.362147331237793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.362147331237793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.363593101501465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.385279655456543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([591, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3862929344177246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3862929344177246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.387420177459717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4137535095214844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([460, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.414973735809326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.414973735809326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.41585111618042  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4438815116882324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([374, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.445467472076416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.445467472076416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.446180820465088  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.478872299194336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([312, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4805402755737305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4805402755737305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.481135368347168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.513965606689453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([243, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.515303134918213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.515303134918213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5157666206359863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.538940906524658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5403318405151367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5403318405151367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.54073429107666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.563673973083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.565159797668457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.565159797668457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5655317306518555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5893354415893555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5907740592956543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5907740592956543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5910964012145996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.613982677459717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.615302085876465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.615302085876465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6155691146850586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.636397361755371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([130, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.637763500213623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.637763500213623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6380114555358887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.659087657928467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6601510047912598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6601510047912598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.660332202911377  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.677002429962158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.678190231323242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.678190231323242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6783714294433594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.696310043334961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.697387218475342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.697387218475342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6975417137145996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7139182090759277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7148704528808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7148704528808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.714994430541992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.72900390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7300567626953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7300567626953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.730182647705078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.745288848876953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.746333122253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.746333122253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.746455192565918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.761958122253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7629284858703613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7629284858703613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.763031482696533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7768330574035645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.77755069732666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.77755069732666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7776269912719727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.788384437561035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7892346382141113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7892346382141113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.789318561553955  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.80173921585083  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8023738861083984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8023738861083984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8024349212646484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8118953704833984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.812638759613037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.812638759613037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8127055168151855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8235201835632324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.824202060699463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.824202060699463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.82426118850708  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8342537879943848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([554, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847536087036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847536087036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.848592758178711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.038145065307617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 554, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9994277954101562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.000275135040283  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.00112247467041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.000232696533203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37347
output nodes number: 5684
edges number: 45597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.000553607940674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.000554084777832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0650639533996582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 7 input nodes size: 98087
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05814313888549805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05814313888549805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10501813888549805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10506057739257812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0614018440246582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0614018440246582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0614018440246582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([98087, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0614018440246582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1643, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20721721649169922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20721721649169922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1643, 128]), torch.Size([1, 1643, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2087841033935547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2216024398803711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1643, 128])
m.shape torch.Size([2113, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22283411026000977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22283411026000977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22484922409057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25623607635498047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([2156, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2583127021789551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2583127021789551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2156, 128]), torch.Size([1, 2156, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.26090192794799805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30755138397216797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2156, 128])
m.shape torch.Size([2143, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3106107711791992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3106107711791992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2143, 128]), torch.Size([1, 2143, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.31266069412231445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37323951721191406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2143, 128])
m.shape torch.Size([1980, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3769383430480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3769383430480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1980, 128]), torch.Size([1, 1980, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3788266181945801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4483609199523926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1980, 128])
m.shape torch.Size([1893, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4528326988220215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4528326988220215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1893, 128]), torch.Size([1, 1893, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4546380043029785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5328211784362793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1893, 128])
m.shape torch.Size([1712, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.537632942199707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.537632942199707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1712, 128]), torch.Size([1, 1712, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5392656326293945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6222925186157227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1712, 128])
m.shape torch.Size([1604, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6275949478149414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6275949478149414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1604, 128]), torch.Size([1, 1604, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.629124641418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7178831100463867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1604, 128])
m.shape torch.Size([1485, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7234911918640137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7234911918640137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1485, 128]), torch.Size([1, 1485, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.724907398223877  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.815697193145752  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1485, 128])
m.shape torch.Size([21266, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9163932800292969  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9163932800292969  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21266, 128]), torch.Size([1, 21266, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9375677108764648  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3911256790161133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21266, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.257352828979492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2935876846313477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.329822540283203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.293304443359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37995, 256])
first layer input nodes number: 98087
first layer output nodes number: 37995
edges number: 293008
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3305554389953613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.366790294647217  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.376181125640869  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.376181125640869  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([838, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.422492504119873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.422492504119873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 838, 256]), torch.Size([1, 838, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.42409086227417  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.437565326690674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 838, 256])
m.shape torch.Size([730, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4381790161132812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4381790161132812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4395713806152344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4604568481445312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([559, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.461602210998535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.461602210998535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4626684188842773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4887590408325195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([491, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.490255832672119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.490255832672119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.49119234085083  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5186409950256348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([410, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.520143508911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.520143508911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.520925521850586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5500802993774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.551419734954834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.551419734954834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5519919395446777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.579174518585205  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.580617904663086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.580617904663086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5811080932617188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6068334579467773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6082186698913574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6082186698913574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6086230278015137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.63167142868042  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6333718299865723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6333718299865723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6336846351623535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6537041664123535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.655153274536133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.655153274536133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6554718017578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6780872344970703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.679323673248291  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.679323673248291  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6795754432678223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6992135047912598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.70059871673584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.70059871673584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7008485794067383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7220869064331055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([87, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7230491638183594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7230491638183594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.723215103149414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7384815216064453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7394886016845703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7394886016845703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.739643096923828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7549381256103516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.755985736846924  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.755985736846924  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.756134510040283  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.771904468536377  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([72, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.773477077484131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.773477077484131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7736144065856934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.789132595062256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.790126323699951  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.790126323699951  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.790250301361084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8051276206970215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.805844306945801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.805844306945801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8059301376342773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.816830635070801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8175368309020996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8175368309020996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.817615032196045  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.828094005584717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8290162086486816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8290162086486816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8291115760803223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8425583839416504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.843379020690918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.843379020690918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.843461036682129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8555994033813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8561296463012695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8561296463012695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8561811447143555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.864163398742676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8646464347839355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8646464347839355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8646903038024902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8717970848083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8725829124450684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8725829124450684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.872649669647217  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8839316368103027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([646, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.899420738220215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.899420738220215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 646, 256]), torch.Size([1, 646, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9006528854370117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.118454933166504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 646, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.078209400177002  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.079056739807129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.079904079437256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.079014301300049  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37995
output nodes number: 5684
edges number: 46751
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0793399810791016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0793404579162598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06672859191894531  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 8 input nodes size: 96806
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10502958297729492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.105072021484375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05815458297729492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06063413619995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06063413619995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06063413619995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96806, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06063413619995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1655, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2016744613647461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2016744613647461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20325279235839844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2159709930419922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1655, 128])
m.shape torch.Size([2117, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21720075607299805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21720075607299805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2192535400390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2512531280517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2150, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25327205657958984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25327205657958984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2150, 128]), torch.Size([1, 2150, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2553224563598633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3018345832824707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2150, 128])
m.shape torch.Size([2140, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30489110946655273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30489110946655273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30738306045532227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3680119514465332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([2011, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3712921142578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3712921142578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2011, 128]), torch.Size([1, 2011, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37320995330810547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4433107376098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2011, 128])
m.shape torch.Size([1792, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4474787712097168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4474787712097168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1792, 128]), torch.Size([1, 1792, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4491877555847168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5230860710144043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1792, 128])
m.shape torch.Size([1682, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5278458595275879  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5278458595275879  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1682, 128]), torch.Size([1, 1682, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5294499397277832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6109557151794434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1682, 128])
m.shape torch.Size([1541, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6160321235656738  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6160321235656738  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6175017356872559  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7015042304992676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([1502, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7072153091430664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7072153091430664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1502, 128]), torch.Size([1, 1502, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7086477279663086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8003225326538086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1502, 128])
m.shape torch.Size([20716, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8992156982421875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8992156982421875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20716, 128]), torch.Size([1, 20716, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9189720153808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3216705322265625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20716, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.1921606063842773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.227738380432129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2633161544799805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2274603843688965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37306, 256])
first layer input nodes number: 96806
first layer output nodes number: 37306
edges number: 286486
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2640395164489746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.299617290496826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3092703819274902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3092703819274902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([822, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.355557918548584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.355557918548584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 822, 256]), torch.Size([1, 822, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.357125759124756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.370875835418701  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 822, 256])
m.shape torch.Size([728, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3715057373046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3715057373046875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.372894287109375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3937878608703613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([583, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3948493003845215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3948493003845215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.395961284637451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4216551780700684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([493, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4230098724365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4230098724365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4239501953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4516448974609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([393, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.453063488006592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.453063488006592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.453813076019287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4808554649353027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.482332229614258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.482332229614258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4829444885253906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5140762329101562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5155253410339355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5155253410339355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5159945487976074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.539454936981201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([209, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.541020393371582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.541020393371582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.54141902923584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.564141273498535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.565791130065918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.565791130065918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.566136360168457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.588231086730957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5896639823913574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5896639823913574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.589982509613037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.612597942352295  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.613971710205078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.613971710205078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.614248275756836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6358203887939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6372079849243164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6372079849243164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6374425888061523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.657383918762207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6584787368774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6584787368774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.658663749694824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.675684928894043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.676723003387451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.676723003387451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6768832206726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.692744731903076  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.69389009475708  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.69389009475708  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.694052219390869  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7112374305725098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7122902870178223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7122902870178223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7124218940734863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7272934913635254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.728339195251465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.728339195251465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.728468894958496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.744032859802246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.744985580444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.744985580444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.745096206665039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.759145736694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7598395347595215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7598395347595215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.759917736053467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7703967094421387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.771261215209961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.771261215209961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.771350860595703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7839908599853516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7849960327148438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7849960327148438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.78509521484375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.799774169921875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.800380229949951  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.800380229949951  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8004393577575684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8096041679382324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8101272583007812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8101272583007812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8101749420166016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.817899703979492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8184990882873535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8184990882873535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8185505867004395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.827253818511963  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([589, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.841381072998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.841381072998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8425045013427734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0509815216064453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 589, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.010793685913086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.011641025543213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.01248836517334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.011598587036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37306
output nodes number: 5684
edges number: 46111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0119190216064453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0119194984436035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0650777816772461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 9 input nodes size: 97799
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05815458297729492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05815458297729492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10502958297729492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.105072021484375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06139516830444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06139516830444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06139516830444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97799, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06139516830444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1590, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20528841018676758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20528841018676758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1590, 128]), torch.Size([1, 1590, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20680475234985352  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2194066047668457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1590, 128])
m.shape torch.Size([2091, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2206425666809082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2206425666809082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22355318069458008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.2556767463684082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2140, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25767087936401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25767087936401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25971174240112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3062095642089844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([2167, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3093223571777344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3093223571777344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2167, 128]), torch.Size([1, 2167, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.31187009811401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37296199798583984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2167, 128])
m.shape torch.Size([2069, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.376861572265625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.376861572265625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2069, 128]), torch.Size([1, 2069, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37891530990600586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45250511169433594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2069, 128])
m.shape torch.Size([1859, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45683717727661133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45683717727661133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1859, 128]), torch.Size([1, 1859, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.45861005783081055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.536806583404541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1859, 128])
m.shape torch.Size([1714, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5416412353515625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5416412353515625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1714, 128]), torch.Size([1, 1714, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5432758331298828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.625462532043457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1714, 128])
m.shape torch.Size([1580, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6306724548339844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6306724548339844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1580, 128]), torch.Size([1, 1580, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6321792602539062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7192649841308594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1580, 128])
m.shape torch.Size([1474, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7248373031616211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7248373031616211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7262430191040039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8162117004394531  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([21212, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9166555404663086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9166555404663086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21212, 128]), torch.Size([1, 21212, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.936884880065918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.389876365661621  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21212, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.257206916809082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2933473587036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3294878005981445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.293064594268799  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37896, 256])
first layer input nodes number: 97799
first layer output nodes number: 37896
edges number: 292383
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.33021879196167  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.366359233856201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3757758140563965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3757758140563965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([851, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.422095775604248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.422095775604248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4237189292907715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.437039852142334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 851, 256])
m.shape torch.Size([720, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.437681198120117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.437681198120117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 720, 256]), torch.Size([1, 720, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.439054489135742  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.460489273071289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 720, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.461618423461914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.461618423461914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.462718963623047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4892096519470215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([452, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4903974533081055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4903974533081055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4912595748901367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5178518295288086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([422, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.519448757171631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.519448757171631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5202536582946777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.549966335296631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([293, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5512537956237793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5512537956237793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5518126487731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5794148445129395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([228, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.580669403076172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.580669403076172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.581104278564453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6028480529785156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.604276180267334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.604276180267334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.604684352874756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6279501914978027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.629441738128662  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.629441738128662  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6298155784606934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6537413597106934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([168, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6551694869995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6551694869995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.655489921569824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6782407760620117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.679518699645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.679518699645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6797780990600586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7000112533569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([139, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7014851570129395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7014851570129395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7017502784729004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.72428560256958  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.725644588470459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.725644588470459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7258315086364746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.743028163909912  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.74415922164917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.74415922164917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.744332790374756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7615160942077637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7626266479492188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7626266479492188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7627735137939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.778341293334961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.77927303314209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.77927303314209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7793970108032227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7934064865112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.794210910797119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.794210910797119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.794312000274658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8064427375793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8073439598083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8073439598083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8074488639831543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8207716941833496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.821577548980713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.821577548980713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.821667194366455  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.833679676055908  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8345770835876465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8345770835876465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8346705436706543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.847848415374756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8488430976867676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8488430976867676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.848940372467041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8633370399475098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8639650344848633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8639650344848633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8640260696411133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8734865188598633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8741416931152344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8741416931152344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8742008209228516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.883779525756836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8844423294067383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8844423294067383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8844995498657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.894169807434082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([609, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9087743759155273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9087743759155273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.90993595123291  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.116924285888672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 609, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0767159461975098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0775632858276367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0784106254577637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0775208473205566  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37896
output nodes number: 5684
edges number: 46554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.077846050262451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 3.0778465270996094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.06602668762207031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 10 input nodes size: 97074
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10515737533569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.05828237533569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.060803890228271484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.060803890228271484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.060803890228271484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97074, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.060803890228271484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1620, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20470333099365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20470333099365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1620, 128]), torch.Size([1, 1620, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.20624828338623047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.21893882751464844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1620, 128])
m.shape torch.Size([2192, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22025680541992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22025680541992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2192, 128]), torch.Size([1, 2192, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.22325420379638672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25532054901123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2192, 128])
m.shape torch.Size([2188, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25741100311279297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25741100311279297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2188, 128]), torch.Size([1, 2188, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.25949764251708984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3061208724975586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2188, 128])
m.shape torch.Size([2017, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30892467498779297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.30892467498779297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2017, 128]), torch.Size([1, 2017, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3108482360839844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3673410415649414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2017, 128])
m.shape torch.Size([2024, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37120485305786133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.37120485305786133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2024, 128]), torch.Size([1, 2024, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.3731350898742676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4433102607727051  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2024, 128])
m.shape torch.Size([1848, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4476323127746582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.4476323127746582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1848, 128]), torch.Size([1, 1848, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.44939470291137695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5251774787902832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1848, 128])
m.shape torch.Size([1633, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5297470092773438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5297470092773438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1633, 128]), torch.Size([1, 1633, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.5313043594360352  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6111154556274414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1633, 128])
m.shape torch.Size([1608, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6174092292785645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6174092292785645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1608, 128]), torch.Size([1, 1608, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.6189427375793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.706352710723877  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1608, 128])
m.shape torch.Size([1487, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7119674682617188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7119674682617188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1487, 128]), torch.Size([1, 1487, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.7133855819702148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.8044252395629883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1487, 128])
m.shape torch.Size([21170, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9046626091003418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9046626091003418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21170, 128]), torch.Size([1, 21170, 128])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 0.9257798194885254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.378330707550049  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21170, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2466769218444824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2827134132385254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3187499046325684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.2824316024780273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37787, 256])
first layer input nodes number: 97074
first layer output nodes number: 37787
edges number: 291222
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3194751739501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.3555116653442383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.364948272705078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.364948272705078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([831, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4112496376037598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4112496376037598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.412834644317627  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.426309108734131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 831, 256])
m.shape torch.Size([778, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.427041530609131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.427041530609131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 778, 256]), torch.Size([1, 778, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.428525447845459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.450784206390381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 778, 256])
m.shape torch.Size([578, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4518604278564453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4518604278564453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.452962875366211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.4791250228881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([404, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.480207920074463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.480207920074463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.480978488922119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.50370454788208  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([406, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.505270481109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.505270481109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.506044864654541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.534066677093506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([297, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5353922843933105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5353922843933105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.535958766937256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.563352584838867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([231, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5646238327026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5646238327026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5650644302368164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.587094306945801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([241, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5887274742126465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5887274742126465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.5891871452331543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6153883934020996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([174, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.616663932800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.616663932800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6169958114624023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6382360458374023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([146, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6394734382629395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6394734382629395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.63975191116333  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6595234870910645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.660853862762451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.660853862762451  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.661118984222412  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6817984580993652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.683073043823242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.683073043823242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.6833057403564453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.703084945678711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.704141139984131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.704141139984131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7043185234069824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.720637798309326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7218408584594727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7218408584594727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7220239639282227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7401514053344727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7412710189819336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7412710189819336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.74143123626709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7584142684936523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7592263221740723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7592263221740723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7593369483947754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7718377113342285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7729201316833496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7729201316833496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7730460166931152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.7881522178649902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.789142608642578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.789142608642578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.789257049560547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.803791046142578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8046469688415527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8046469688415527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8047423362731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.817521572113037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.818416118621826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.818416118621826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.818509578704834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8316874504089355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8327784538269043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8327784538269043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.832881450653076  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8481249809265137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.84896183013916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.84896183013916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8490419387817383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8614587783813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.862170696258545  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.862170696258545  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8622355461120605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.872741222381592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.873631477355957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.873631477355957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.8737077713012695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.886601448059082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([611, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.901244640350342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.901244640350342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 5.7342529296875 GB
    Memory Allocated: 2.9024100303649902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1119866371154785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 611, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.071779251098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0726265907287598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0734739303588867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0725841522216797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37787
output nodes number: 5684
edges number: 47061
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.072908401489258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.072908878326416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06598377227783203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 11 input nodes size: 97969
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05828237533569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05828237533569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10515737533569336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06139326095581055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06139326095581055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06139326095581055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97969, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06139326095581055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1643, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20531082153320312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20531082153320312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1643, 128]), torch.Size([1, 1643, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2068777084350586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2196788787841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1643, 128])
m.shape torch.Size([2101, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22089910507202148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22089910507202148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22381877899169922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2558412551879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([2145, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2578449249267578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2578449249267578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2145, 128]), torch.Size([1, 2145, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2598905563354492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30640268325805664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2145, 128])
m.shape torch.Size([2117, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.309417724609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.309417724609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31193113327026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37221717834472656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2026, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3754234313964844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3754234313964844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2026, 128]), torch.Size([1, 2026, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37735557556152344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4475421905517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2026, 128])
m.shape torch.Size([1827, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45180320739746094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45180320739746094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1827, 128]), torch.Size([1, 1827, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45354557037353516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5289421081542969  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1827, 128])
m.shape torch.Size([1759, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5339422225952148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5339422225952148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1759, 128]), torch.Size([1, 1759, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5356197357177734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6194953918457031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1759, 128])
m.shape torch.Size([1615, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6248173713684082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6248173713684082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6263575553894043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7150478363037109  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1504, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7207322120666504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7207322120666504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1504, 128]), torch.Size([1, 1504, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7221665382385254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8141016960144043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1504, 128])
m.shape torch.Size([21165, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9143071174621582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9143071174621582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21165, 128]), torch.Size([1, 21165, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9344916343688965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3869900703430176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21165, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2548980712890625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.291044235229492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.327190399169922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2907614707946777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37902, 256])
first layer input nodes number: 97969
first layer output nodes number: 37902
edges number: 292259
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3279223442077637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3640685081481934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.373507499694824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.373507499694824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([855, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.419827461242676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.419827461242676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 855, 256]), torch.Size([1, 855, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4214582443237305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.435185432434082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 855, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4358391761779785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4358391761779785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4372220039367676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4580492973327637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([604, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.459691047668457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.459691047668457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.460843086242676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.488330841064453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([495, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4896578788757324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4896578788757324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4906020164489746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5185747146606445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([352, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5198020935058594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5198020935058594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5204734802246094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.546509265899658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([299, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.547898292541504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.547898292541504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.548468589782715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.574451446533203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([236, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.575754165649414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.575754165649414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.576204299926758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5987110137939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.600146770477295  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.600146770477295  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6005587577819824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.62404203414917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6254711151123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6254711151123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6258316040039062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6489028930664062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([165, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.650308609008789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.650308609008789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.650623321533203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6729679107666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6747007369995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6747007369995117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.674952507019043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6945905685424805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.695779800415039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.695779800415039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6959972381591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.714479446411133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.715582847595215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.715582847595215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7157678604125977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7327890396118164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([77, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7337536811828613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7337536811828613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.733900547027588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7484402656555176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.749563694000244  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.749563694000244  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7497220039367676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.766502857208252  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7675209045410156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7675209045410156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7676563262939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.782958984375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7840514183044434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7840514183044434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.784186840057373  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8004374504089355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.801217555999756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.801217555999756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8013110160827637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.813180446624756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.814284324645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.814284324645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8144044876098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8305063247680664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8314075469970703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8314075469970703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.831502914428711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.844949722290039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8457298278808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8457298278808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8458080291748047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.857381820678711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8579139709472656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8579139709472656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8579654693603516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.865947723388672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8666296005249023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8666296005249023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8666906356811523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8765783309936523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8770556449890137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8770556449890137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8770976066589355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8841891288757324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([619, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8990416526794434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8990416526794434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9002223014831543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.10917329788208  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 619, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.068958282470703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.06980562210083  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.070652961730957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.06976318359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37902
output nodes number: 5684
edges number: 46402
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0700883865356445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0700888633728027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06608247756958008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 12 input nodes size: 96869
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10505962371826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.1051020622253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05818462371826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060675621032714844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060675621032714844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060675621032714844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96869, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060675621032714844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1630, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20260238647460938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20260238647460938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1630, 128]), torch.Size([1, 1630, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20415687561035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21680545806884766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1630, 128])
m.shape torch.Size([2098, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21810054779052734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21810054779052734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2098, 128]), torch.Size([1, 2098, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22010135650634766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2521486282348633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2098, 128])
m.shape torch.Size([2201, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2535824775695801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2535824775695801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2201, 128]), torch.Size([1, 2201, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25729799270629883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3041954040527344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2201, 128])
m.shape torch.Size([2170, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3072848320007324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3072848320007324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2170, 128]), torch.Size([1, 2170, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3095579147338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3704643249511719  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2170, 128])
m.shape torch.Size([2132, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.374176025390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.374176025390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2132, 128]), torch.Size([1, 2132, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37656402587890625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4517698287963867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2132, 128])
m.shape torch.Size([1842, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4560232162475586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4560232162475586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1842, 128]), torch.Size([1, 1842, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4577798843383789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5338239669799805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1842, 128])
m.shape torch.Size([1769, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5388503074645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5388503074645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1769, 128]), torch.Size([1, 1769, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5405373573303223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6248898506164551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1769, 128])
m.shape torch.Size([1637, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6302909851074219  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6302909851074219  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6318521499633789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7242703437805176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1510, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7299699783325195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7299699783325195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1510, 128]), torch.Size([1, 1510, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.731410026550293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8236055374145508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1510, 128])
m.shape torch.Size([20575, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.920994758605957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.920994758605957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20575, 128]), torch.Size([1, 20575, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9406166076660156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.333767890930176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20575, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2029004096984863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2387242317199707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.274548053741455  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2384443283081055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37564, 256])
first layer input nodes number: 96869
first layer output nodes number: 37564
edges number: 287640
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2752718925476074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.311095714569092  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3208160400390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3208160400390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([833, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.367116928100586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.367116928100586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 833, 256]), torch.Size([1, 833, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3687057495117188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3822059631347656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 833, 256])
m.shape torch.Size([682, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3829221725463867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3829221725463867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 682, 256]), torch.Size([1, 682, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.384222984313965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.404086112976074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 682, 256])
m.shape torch.Size([589, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4051637649536133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4051637649536133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.40628719329834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.431241035461426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.432465076446533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.432465076446533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.433323383331299  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4588780403137207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([408, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4604287147521973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4604287147521973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4612069129943848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4921021461486816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4935240745544434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4935240745544434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4941229820251465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.523482322692871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([262, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5249457359313965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5249457359313965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5254454612731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5519676208496094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.553471088409424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.553471088409424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.553905963897705  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5786938667297363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.580137252807617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.580137252807617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.580503463745117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.603940963745117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([182, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6055073738098145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6055073738098145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6058545112609863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6305012702941895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.631723403930664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.631723403930664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6319751739501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.651613235473633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6527676582336426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6527676582336426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6529793739318848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6709752082824707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.672821044921875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.672821044921875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6730079650878906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.690204620361328  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6914029121398926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6914029121398926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6915860176086426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7097134590148926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7108330726623535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7108330726623535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7109932899475098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7279763221740723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.729095935821533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.729095935821533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7292447090148926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.746056079864502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.746978759765625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.746978759765625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7470951080322266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.761056900024414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([77, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.762331008911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.762331008911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7624778747558594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.781129837036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.78184175491333  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.78184175491333  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.781923770904541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7929139137268066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7937188148498535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7937188148498535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7938027381896973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.805635929107666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.806361198425293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.806361198425293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.80643367767334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8171606063842773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8179492950439453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8179492950439453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.818023681640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8295536041259766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8304009437561035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8304009437561035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.830477237701416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.842836856842041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8437447547912598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8437447547912598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.843822956085205  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.857038974761963  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([562, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8705039024353027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8705039024353027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8715758323669434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.060472011566162  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 562, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.020310401916504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.021157741546631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.022005081176758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.021115303039551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37564
output nodes number: 5684
edges number: 46534
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.021437644958496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0214381217956543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.065582275390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 13 input nodes size: 96981
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05818462371826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05818462371826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10505962371826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.1051020622253418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0613703727722168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0613703727722168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0613703727722168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96981, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0613703727722168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1632, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20533275604248047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20533275604248047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20688915252685547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.219573974609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([2058, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22075843811035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22075843811035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2058, 128]), torch.Size([1, 2058, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22272109985351562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25384044647216797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2058, 128])
m.shape torch.Size([2117, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.255887508392334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.255887508392334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25868988037109375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3052034378051758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2048, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30810022354125977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30810022354125977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2048, 128]), torch.Size([1, 2048, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31005334854125977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.36669397354125977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2048, 128])
m.shape torch.Size([2082, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3706812858581543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3706812858581543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2082, 128]), torch.Size([1, 2082, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3726835250854492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44708728790283203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2082, 128])
m.shape torch.Size([1871, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4514474868774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4514474868774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1871, 128]), torch.Size([1, 1871, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4532318115234375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5312051773071289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1871, 128])
m.shape torch.Size([1727, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5360774993896484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5360774993896484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1727, 128]), torch.Size([1, 1727, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.537724494934082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6200742721557617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1727, 128])
m.shape torch.Size([1713, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6257853507995605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6257853507995605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1713, 128]), torch.Size([1, 1713, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6274189949035645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7205367088317871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1713, 128])
m.shape torch.Size([1493, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7261271476745605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7261271476745605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1493, 128]), torch.Size([1, 1493, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7275509834289551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8223471641540527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1493, 128])
m.shape torch.Size([20780, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9212446212768555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9212446212768555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20780, 128]), torch.Size([1, 20780, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9410619735717773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3480939865112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20780, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2160840034484863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2518668174743652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.287649631500244  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2515869140625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37521, 256])
first layer input nodes number: 96981
first layer output nodes number: 37521
edges number: 288957
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.288374423980713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.324157238006592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.333779811859131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.333779811859131  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([855, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3801016807556152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3801016807556152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 855, 256]), torch.Size([1, 855, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.38173246383667  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.395956516265869  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 855, 256])
m.shape torch.Size([721, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3965330123901367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3965330123901367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3979082107543945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4185829162597656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([542, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.41953182220459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.41953182220459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.420565605163574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4447336196899414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([432, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4459147453308105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4459147453308105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4467387199401855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4709858894348145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.472390651702881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.472390651702881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.473111629486084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5010437965393066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([294, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5023789405822754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5023789405822754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5029397010803223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5316319465637207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.533127784729004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.533127784729004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5336313247680664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.565138816833496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([227, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5666327476501465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5666327476501465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.567065715789795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.591744899749756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.593301773071289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.593301773071289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5936927795410156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6187171936035156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.620184898376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.620184898376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6205148696899414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6439428329467773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([151, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.645374298095703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.645374298095703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.645662307739258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6681270599365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6698861122131348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6698861122131348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.670156955718994  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.693178653717041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([117, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.694505214691162  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.694505214691162  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.694728374481201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.715259075164795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7163586616516113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7163586616516113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7165303230285645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.733524799346924  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7345638275146484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7345638275146484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.734712600708008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7504825592041016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([85, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.751715660095215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.751715660095215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.751877784729004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.770197868347168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7709994316101074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7709994316101074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7711024284362793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7834620475769043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7843103408813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7843103408813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.784409523010254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7970056533813477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7980337142944336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7980337142944336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7981462478637695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.813225746154785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8142848014831543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8142848014831543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8143954277038574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.829993724822998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8310084342956543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8310084342956543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8311095237731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8460707664489746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8465914726257324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8465914726257324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8466429710388184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8546252250671387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8555283546447754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8555283546447754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8556084632873535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8685860633850098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8692612648010254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8692612648010254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8693203926086426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8793129920959473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([554, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8925952911376953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8925952911376953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8936519622802734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.080648422241211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 554, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0404953956604004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0413427352905273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0421900749206543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0413002967834473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37521
output nodes number: 5684
edges number: 46622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0416226387023926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.041623115539551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06679964065551758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 14 input nodes size: 97938
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10556936264038086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10561180114746094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05869436264038086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.061231136322021484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.061231136322021484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.061231136322021484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97938, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.061231136322021484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1613, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20702648162841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20702648162841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1613, 128]), torch.Size([1, 1613, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20856475830078125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22127437591552734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1613, 128])
m.shape torch.Size([2062, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2224717140197754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2224717140197754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22443819046020508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2556147575378418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
m.shape torch.Size([2131, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25767993927001953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25767993927001953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2131, 128]), torch.Size([1, 2131, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2604508399963379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3070807456970215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2131, 128])
m.shape torch.Size([2160, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3101844787597656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3101844787597656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2160, 128]), torch.Size([1, 2160, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3122444152832031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3735942840576172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2160, 128])
m.shape torch.Size([2053, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3774590492248535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3774590492248535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3794584274291992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45257043838500977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([1860, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4569129943847656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4569129943847656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1860, 128]), torch.Size([1, 1860, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45868682861328125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5370826721191406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1860, 128])
m.shape torch.Size([1700, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5418701171875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5418701171875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1700, 128]), torch.Size([1, 1700, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5434913635253906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6253643035888672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1700, 128])
m.shape torch.Size([1582, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6305885314941406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6305885314941406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1582, 128]), torch.Size([1, 1582, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6320972442626953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7180938720703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1582, 128])
m.shape torch.Size([1550, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7239913940429688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7239913940429688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1550, 128]), torch.Size([1, 1550, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7254695892333984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8210058212280273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1550, 128])
m.shape torch.Size([21259, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9216375350952148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9216375350952148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21259, 128]), torch.Size([1, 21259, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9419116973876953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3953962326049805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21259, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2605504989624023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2967615127563477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.332972526550293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.296478271484375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37970, 256])
first layer input nodes number: 97938
first layer output nodes number: 37970
edges number: 293291
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3337044715881348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.36991548538208  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.37930965423584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.37930965423584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([827, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4256081581115723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4256081581115723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.427185535430908  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4399328231811523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([734, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4405741691589355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4405741691589355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 734, 256]), torch.Size([1, 734, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.44197416305542  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4637770652770996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 734, 256])
m.shape torch.Size([553, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4648823738098145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4648823738098145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4659371376037598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4901957511901855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([456, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4914751052856445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4914751052856445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.492344856262207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5184245109558105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([397, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.519897937774658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.519897937774658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5206551551818848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5493412017822266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5507965087890625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5507965087890625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.551403045654297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5790982246398926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([237, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.580923080444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.580923080444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5813751220703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6039772033691406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.605443000793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.605443000793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.605862617492676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6297807693481445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.631136894226074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.631136894226074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6314821243286133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6535768508911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([143, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6547789573669434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6547789573669434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6550517082214355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.674417018890381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.675792694091797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.675792694091797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.676065444946289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6973400115966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.698507308959961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.698507308959961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6987228393554688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.717042922973633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([133, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7189536094665527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7189536094665527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.719207286834717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7425456047058105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.743636131286621  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.743636131286621  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.743802070617676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.76023006439209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7614593505859375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7614593505859375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7616329193115234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.780031204223633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.781111240386963  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.781111240386963  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.781254291534424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7974190711975098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.798513889312744  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.798513889312744  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7986416816711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.813976764678955  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8149166107177734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8149166107177734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8150272369384766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8290767669677734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8301172256469727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8301172256469727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8302316665649414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.845566749572754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8465094566345215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8465094566345215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8466086387634277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.860593318939209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.861553192138672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.861553192138672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8616485595703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.875762939453125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.876434326171875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.876434326171875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8764991760253906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8865509033203125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.887424945831299  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.887424945831299  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.887503147125244  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9001717567443848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9007787704467773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9007787704467773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.900832176208496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.909857749938965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([586, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9239115715026855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9239115715026855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9250292778015137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1267666816711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 586, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0865821838378906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0874295234680176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0882768630981445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0873870849609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37970
output nodes number: 5684
edges number: 47016
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0877127647399902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0877132415771484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06655311584472656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 15 input nodes size: 97964
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05869436264038086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05869436264038086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10556936264038086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10561180114746094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06137990951538086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06137990951538086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06137990951538086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97964, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06137990951538086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1640, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20530462265014648  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20530462265014648  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1640, 128]), torch.Size([1, 1640, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20686864852905273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21962404251098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1640, 128])
m.shape torch.Size([2154, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22089624404907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22089624404907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2154, 128]), torch.Size([1, 2154, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22295045852661133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25455808639526367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2154, 128])
m.shape torch.Size([2160, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2566208839416504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2566208839416504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2160, 128]), torch.Size([1, 2160, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25908708572387695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30559873580932617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2160, 128])
m.shape torch.Size([2121, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30861425399780273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30861425399780273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.310671329498291  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3707399368286133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
m.shape torch.Size([2063, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3741278648376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3741278648376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2063, 128]), torch.Size([1, 2063, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37664222717285156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4510464668273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2063, 128])
m.shape torch.Size([1858, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45537853240966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45537853240966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1858, 128]), torch.Size([1, 1858, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4571504592895508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5353422164916992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1858, 128])
m.shape torch.Size([1730, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5402307510375977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5402307510375977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1730, 128]), torch.Size([1, 1730, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5418806076049805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6246871948242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1730, 128])
m.shape torch.Size([1703, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6303586959838867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6303586959838867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6319828033447266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7247247695922852  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([1494, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7303242683410645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7303242683410645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7317490577697754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8237709999084473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([20916, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9227938652038574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9227938652038574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20916, 128]), torch.Size([1, 20916, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9427409172058105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3589816093444824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20916, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2266011238098145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2626872062683105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2987732887268066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2624049186706543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37839, 256])
first layer input nodes number: 97964
first layer output nodes number: 37839
edges number: 290715
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2995052337646484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3355913162231445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.345149040222168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.345149040222168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([882, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.391493797302246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.391493797302246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3931760787963867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.407050132751465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([721, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4076390266418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4076390266418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4090142250061035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4310030937194824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([587, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4320502281188965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4320502281188965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4331698417663574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4595909118652344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([437, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4608564376831055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4608564376831055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4616899490356445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4858617782592773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([400, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.487367630004883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.487367630004883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.488130569458008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5164012908935547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([316, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5178422927856445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5178422927856445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5184450149536133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5458145141601562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([230, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.547060966491699  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.547060966491699  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.547499656677246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.56943416595459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5712227821350098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5712227821350098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5716309547424316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5948967933654785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([200, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5964231491088867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5964231491088867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.596804618835449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.621218681335449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.62246036529541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.62246036529541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.622744560241699  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6429224014282227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6440281867980957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6440281867980957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6442532539367676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.661808490753174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.662907123565674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.662907123565674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.663107395172119  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6801304817199707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6813673973083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6813673973083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6815714836120605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.700347423553467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7016448974609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7016448974609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.70184326171875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7214813232421875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7225122451782227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7225122451782227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7226552963256836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.737818717956543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.738877296447754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.738877296447754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7390127182006836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7543153762817383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7551956176757812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7551956176757812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7553062438964844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7685813903808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([75, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7698240280151367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7698240280151367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7699670791625977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7881345748901367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.789341449737549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.789341449737549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7894749641418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.807365894317627  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.808260440826416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.808260440826416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8083558082580566  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8218026161193848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.822481632232666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.822481632232666  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8225502967834473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8327126502990723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.833460807800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.833460807800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.833531379699707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8444700241088867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.844987392425537  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.844987392425537  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8450350761413574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.852759838104248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8534741401672363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8534741401672363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8535351753234863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8638501167297363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([582, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8778042793273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8778042793273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8789143562316895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.082186222076416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 582, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0420026779174805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.042849540710449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.043696403503418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.042807102203369  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5681, 40])
input nodes number: 37839
output nodes number: 5681
edges number: 46136
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0431313514709473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0431318283081055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06676149368286133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06676149368286133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06676149368286133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026262208819389343 |0.0035038143396377563 |0.12397229671478271 |0.00017449259757995605 |0.07777349650859833 |0.00461888313293457 |
----------------------------------------------------------pseudo_mini_loss sum 4.120520114898682
Total (block generation + training)time/epoch 10.044678926467896
Training time/epoch 3.7977957725524902
Training time without block to device /epoch 3.741734743118286
Training time without total dataloading part /epoch 3.2353434562683105
load block tensor time/epoch 0.4201953411102295
block to device time/epoch 0.0560610294342041
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2165172
Number of first layer input nodes during this epoch:  1560829
Number of first layer output nodes during this epoch:  604343
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06676101684570312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018799781799316406
number of batches is  16
batch size is  5684
range selection method spend 0.015950679779052734
time for parepare:  0.02059459686279297
local_output_nid generation:  0.001619577407836914
local_in_edges_tensor generation:  0.004647731781005859
mini_batch_src_global generation:  0.0016605854034423828
r_  generation:  0.016054868698120117
local_output_nid generation:  0.0017902851104736328
local_in_edges_tensor generation:  0.0012302398681640625
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.016351699829101562
local_output_nid generation:  0.001779794692993164
local_in_edges_tensor generation:  0.0011467933654785156
mini_batch_src_global generation:  0.0013384819030761719
r_  generation:  0.016741514205932617
local_output_nid generation:  0.0017275810241699219
local_in_edges_tensor generation:  0.0008504390716552734
mini_batch_src_global generation:  0.001318216323852539
r_  generation:  0.016678333282470703
local_output_nid generation:  0.001695394515991211
local_in_edges_tensor generation:  0.0010538101196289062
mini_batch_src_global generation:  0.0013267993927001953
r_  generation:  0.017087697982788086
local_output_nid generation:  0.0016956329345703125
local_in_edges_tensor generation:  0.0011360645294189453
mini_batch_src_global generation:  0.0012960433959960938
r_  generation:  0.01692366600036621
local_output_nid generation:  0.0018601417541503906
local_in_edges_tensor generation:  0.006073713302612305
mini_batch_src_global generation:  0.0015790462493896484
r_  generation:  0.029141902923583984
local_output_nid generation:  0.003625154495239258
local_in_edges_tensor generation:  0.002157449722290039
mini_batch_src_global generation:  0.00316619873046875
r_  generation:  0.019600629806518555
local_output_nid generation:  0.0017476081848144531
local_in_edges_tensor generation:  0.0010099411010742188
mini_batch_src_global generation:  0.0013689994812011719
r_  generation:  0.017458677291870117
local_output_nid generation:  0.0017633438110351562
local_in_edges_tensor generation:  0.00099945068359375
mini_batch_src_global generation:  0.0013513565063476562
r_  generation:  0.02704930305480957
local_output_nid generation:  0.0038008689880371094
local_in_edges_tensor generation:  0.0022978782653808594
mini_batch_src_global generation:  0.0042324066162109375
r_  generation:  0.02045893669128418
local_output_nid generation:  0.0017359256744384766
local_in_edges_tensor generation:  0.0010342597961425781
mini_batch_src_global generation:  0.0013852119445800781
r_  generation:  0.017216205596923828
local_output_nid generation:  0.0016422271728515625
local_in_edges_tensor generation:  0.0009751319885253906
mini_batch_src_global generation:  0.0013530254364013672
r_  generation:  0.0283052921295166
local_output_nid generation:  0.002171039581298828
local_in_edges_tensor generation:  0.0011324882507324219
mini_batch_src_global generation:  0.0014472007751464844
r_  generation:  0.016802072525024414
local_output_nid generation:  0.0025777816772460938
local_in_edges_tensor generation:  0.001100778579711914
mini_batch_src_global generation:  0.0014066696166992188
r_  generation:  0.016216516494750977
local_output_nid generation:  0.0020236968994140625
local_in_edges_tensor generation:  0.0011470317840576172
mini_batch_src_global generation:  0.0013806819915771484
r_  generation:  0.016199588775634766
----------------------check_connections_block total spend ----------------------------- 0.4982917308807373
generate_one_block  0.03503298759460449
generate_one_block  0.03112339973449707
generate_one_block  0.02965998649597168
generate_one_block  0.026875019073486328
generate_one_block  0.025855302810668945
generate_one_block  0.026224613189697266
generate_one_block  0.030712366104125977
generate_one_block  0.04436159133911133
generate_one_block  0.027640104293823242
generate_one_block  0.028542518615722656
generate_one_block  0.027126312255859375
generate_one_block  0.027446508407592773
generate_one_block  0.027974843978881836
generate_one_block  0.028167724609375
generate_one_block  0.027954816818237305
generate_one_block  0.028347015380859375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03344988822937012
gen group dst list time:  0.019632577896118164
time for parepare:  0.020233631134033203
local_output_nid generation:  0.006490230560302734
local_in_edges_tensor generation:  0.025505542755126953
mini_batch_src_global generation:  0.012327909469604492
r_  generation:  0.11815023422241211
local_output_nid generation:  0.011644124984741211
local_in_edges_tensor generation:  0.01044154167175293
mini_batch_src_global generation:  0.017225265502929688
r_  generation:  0.11997652053833008
local_output_nid generation:  0.010352849960327148
local_in_edges_tensor generation:  0.010491371154785156
mini_batch_src_global generation:  0.012016534805297852
r_  generation:  0.1246187686920166
local_output_nid generation:  0.01266026496887207
local_in_edges_tensor generation:  0.008517742156982422
mini_batch_src_global generation:  0.012799739837646484
r_  generation:  0.12199020385742188
local_output_nid generation:  0.010484933853149414
local_in_edges_tensor generation:  0.008469343185424805
mini_batch_src_global generation:  0.015257120132446289
r_  generation:  0.1258690357208252
local_output_nid generation:  0.010319232940673828
local_in_edges_tensor generation:  0.008354663848876953
mini_batch_src_global generation:  0.014887332916259766
r_  generation:  0.12352609634399414
local_output_nid generation:  0.010295391082763672
local_in_edges_tensor generation:  0.008719205856323242
mini_batch_src_global generation:  0.014678239822387695
r_  generation:  0.12561798095703125
local_output_nid generation:  0.010057210922241211
local_in_edges_tensor generation:  0.008691072463989258
mini_batch_src_global generation:  0.015088319778442383
r_  generation:  0.12501144409179688
local_output_nid generation:  0.011313915252685547
local_in_edges_tensor generation:  0.012971878051757812
mini_batch_src_global generation:  0.015679597854614258
r_  generation:  0.1280667781829834
local_output_nid generation:  0.011675834655761719
local_in_edges_tensor generation:  0.009290933609008789
mini_batch_src_global generation:  0.016360044479370117
r_  generation:  0.13215398788452148
local_output_nid generation:  0.012068986892700195
local_in_edges_tensor generation:  0.009212493896484375
mini_batch_src_global generation:  0.015229225158691406
r_  generation:  0.16304230690002441
local_output_nid generation:  0.011067628860473633
local_in_edges_tensor generation:  0.009995698928833008
mini_batch_src_global generation:  0.016098737716674805
r_  generation:  0.11795163154602051
local_output_nid generation:  0.010629653930664062
local_in_edges_tensor generation:  0.008525371551513672
mini_batch_src_global generation:  0.015482902526855469
r_  generation:  0.11858177185058594
local_output_nid generation:  0.010948419570922852
local_in_edges_tensor generation:  0.008540868759155273
mini_batch_src_global generation:  0.013370513916015625
r_  generation:  0.12321829795837402
local_output_nid generation:  0.011012077331542969
local_in_edges_tensor generation:  0.008610010147094727
mini_batch_src_global generation:  0.01312875747680664
r_  generation:  0.13249969482421875
local_output_nid generation:  0.01128244400024414
local_in_edges_tensor generation:  0.010657072067260742
mini_batch_src_global generation:  0.014130592346191406
r_  generation:  0.12026500701904297
----------------------check_connections_block total spend ----------------------------- 3.0789804458618164
generate_one_block  0.14805865287780762
generate_one_block  0.13865208625793457
generate_one_block  0.17023730278015137
generate_one_block  0.13970947265625
generate_one_block  0.1398758888244629
generate_one_block  0.13774633407592773
generate_one_block  0.1387031078338623
generate_one_block  0.13616490364074707
generate_one_block  0.1385819911956787
generate_one_block  0.14168953895568848
generate_one_block  0.1441032886505127
generate_one_block  0.13825583457946777
generate_one_block  0.1510472297668457
generate_one_block  0.14020514488220215
generate_one_block  0.14390349388122559
generate_one_block  0.14412856101989746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06676101684570312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

connection checking time:  3.0789804458618164
block generation total time  2.291062831878662
average batch blocks generation time:  0.14319142699241638
block dataloader generation time/epoch 6.412015438079834
pseudo mini batch 0 input nodes size: 97494
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.058867454528808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.058867454528808594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10535621643066406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10539865493774414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05848121643066406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060967445373535156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060967445373535156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060967445373535156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97494, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.060967445373535156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1663, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20291996002197266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20291996002197266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1663, 128]), torch.Size([1, 1663, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20450592041015625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2172842025756836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1663, 128])
m.shape torch.Size([2299, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21868371963500977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21868371963500977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2299, 128]), torch.Size([1, 2299, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2218470573425293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25712013244628906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2299, 128])
m.shape torch.Size([2210, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25931262969970703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25931262969970703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2210, 128]), torch.Size([1, 2210, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.26226139068603516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3088827133178711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2210, 128])
m.shape torch.Size([2203, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3120307922363281  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3120307922363281  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2203, 128]), torch.Size([1, 2203, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31426525115966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.375643253326416  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2203, 128])
m.shape torch.Size([2134, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3795170783996582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3795170783996582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.38174867630004883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4565553665161133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([1898, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.460968017578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.460968017578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1898, 128]), torch.Size([1, 1898, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.46277809143066406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5406112670898438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1898, 128])
m.shape torch.Size([1745, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5455307960510254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5455307960510254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1745, 128]), torch.Size([1, 1745, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5471949577331543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6322956085205078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1745, 128])
m.shape torch.Size([1636, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6377043724060059  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6377043724060059  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1636, 128]), torch.Size([1, 1636, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6392645835876465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.731626033782959  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1636, 128])
m.shape torch.Size([1511, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.737330436706543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.737330436706543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7387714385986328  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8310108184814453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([20517, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9281229972839355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9281229972839355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20517, 128]), torch.Size([1, 20517, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9476895332336426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.336913585662842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20517, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.206940174102783  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.243004322052002  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2790684700012207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.242722511291504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37816, 256])
first layer input nodes number: 97494
first layer output nodes number: 37816
edges number: 287833
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.279797077178955  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.315861225128174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3256092071533203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3256092071533203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3706507682800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3706507682800293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.372230052947998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3854517936706543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([778, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3861732482910156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3861732482910156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 778, 256]), torch.Size([1, 778, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3876571655273438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.411663055419922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 778, 256])
m.shape torch.Size([599, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4126572608947754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4126572608947754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.41379976272583  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4395551681518555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([469, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.44088077545166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.44088077545166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.441775321960449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.468838691711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([397, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.470460891723633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.470460891723633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4712181091308594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5038938522338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([291, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.505411148071289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.505411148071289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5059661865234375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5333762168884277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([254, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5349597930908203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5349597930908203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5354442596435547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5596675872802734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.561094284057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.561094284057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5615081787109375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5851001739501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5865025520324707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5865025520324707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.586857318878174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.609562397003174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([135, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.610682964324951  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.610682964324951  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.610940456390381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6292223930358887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.630626678466797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.630626678466797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6309032440185547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.652475357055664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6534790992736816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6534790992736816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.65366792678833  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6697182655334473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.67086124420166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.67086124420166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6710500717163086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.688422203063965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.689663887023926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.689663887023926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6898279190063477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7060670852661133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7070956230163574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7070956230163574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.707242488861084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7228102684020996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7237954139709473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7237954139709473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7239232063293457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.738363742828369  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.739509105682373  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.739509105682373  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.739650249481201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.756587505340576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7575788497924805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7575788497924805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.757687568664551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7714948654174805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7725448608398438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7725448608398438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7726478576660156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.786449432373047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7873401641845703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7873401641845703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.787433624267578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8006114959716797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.801372528076172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.801372528076172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8014488220214844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8127403259277344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8136115074157715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8136115074157715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8136935234069824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8264060020446777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8271608352661133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8271608352661133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8272294998168945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.838353157043457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8391494750976562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8391494750976562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8392181396484375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8508224487304688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([568, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.864436149597168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.864436149597168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8655195236206055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0571398735046387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 568, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.018220901489258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0190682411193848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0199155807495117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0190258026123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37816
output nodes number: 5684
edges number: 45795
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.019350528717041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0193514823913574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06578302383422852  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 1 input nodes size: 97311
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05848264694213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05848264694213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10535764694213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10540008544921875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97311, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1613, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20531654357910156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20531654357910156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1613, 128]), torch.Size([1, 1613, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20685482025146484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2194652557373047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1613, 128])
m.shape torch.Size([2066, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22066640853881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22066640853881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2066, 128]), torch.Size([1, 2066, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22263669967651367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25383424758911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2066, 128])
m.shape torch.Size([2174, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25595903396606445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25595903396606445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2174, 128]), torch.Size([1, 2174, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25865697860717773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3056797981262207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2174, 128])
m.shape torch.Size([2053, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30855894088745117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30855894088745117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3105807304382324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.36905670166015625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([2051, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37224817276000977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37224817276000977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2051, 128]), torch.Size([1, 2051, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3749246597290039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45011281967163086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2051, 128])
m.shape torch.Size([1810, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4543132781982422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4543132781982422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1810, 128]), torch.Size([1, 1810, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4560394287109375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5337886810302734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1810, 128])
m.shape torch.Size([1679, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5385298728942871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5385298728942871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1679, 128]), torch.Size([1, 1679, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5401310920715332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.62200927734375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1679, 128])
m.shape torch.Size([1597, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6273007392883301  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6273007392883301  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1597, 128]), torch.Size([1, 1597, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6288237571716309  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7156357765197754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1597, 128])
m.shape torch.Size([1518, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7213888168334961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7213888168334961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7228364944458008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8154878616333008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([20910, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9144706726074219  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9144706726074219  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20910, 128]), torch.Size([1, 20910, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9344120025634766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3502464294433594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20910, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.217496395111084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2532315254211426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.288966655731201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2529520988464355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37471, 256])
first layer input nodes number: 97311
first layer output nodes number: 37471
edges number: 288885
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.289693832397461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3254289627075195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.334989547729492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.334989547729492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([827, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.379922866821289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.379922866821289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.381500244140625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3951292037963867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([754, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3960156440734863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3960156440734863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.397453784942627  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4190587997436523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 754, 256])
m.shape torch.Size([603, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4201693534851074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4201693534851074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4213194847106934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4473042488098145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([446, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4487996101379395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4487996101379395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.449650287628174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.477677822113037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([390, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4791269302368164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4791269302368164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4798707962036133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5075087547302246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([342, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5091094970703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5091094970703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5097618103027344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5390357971191406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([232, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.540454864501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.540454864501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5408973693847656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5630226135253906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5644702911376953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5644702911376953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5648841857910156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5884761810302734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.589904308319092  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.589904308319092  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5902647972106934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6133360862731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([165, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.614741802215576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.614741802215576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6150565147399902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6374011039733887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6385550498962402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6385550498962402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.638791561126709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6572394371032715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([141, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.658747673034668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.658747673034668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6590166091918945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6818761825561523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6830062866210938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6830062866210938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.683185577392578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6996803283691406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7013959884643555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7013959884643555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7015810012817383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7198972702026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7210693359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7210693359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7212295532226562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7382125854492188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7391014099121094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7391014099121094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7392215728759766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7527999877929688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.753671646118164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.753671646118164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7537803649902344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.766826629638672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7680373191833496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7680373191833496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.768176555633545  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7858595848083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.786520481109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.786520481109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7865967750549316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7968201637268066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7975125312805176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7975125312805176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7975850105285645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.807804584503174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8087615966796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8087615966796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8088550567626953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8226871490478516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.823148250579834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.823148250579834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8231940269470215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.830289363861084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.830996036529541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.830996036529541  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.831058979034424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8412556648254395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8418703079223633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8418703079223633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.841923713684082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.850949287414551  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([574, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.864715099334717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.864715099334717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.865809917449951  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0673203468322754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 574, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0285019874572754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0293493270874023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0301966667175293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0293068885803223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37471
output nodes number: 5684
edges number: 45686
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0296287536621094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0296292304992676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06677913665771484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 2 input nodes size: 97924
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10556268692016602  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.1056051254272461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.058687686920166016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06122922897338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06122922897338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06122922897338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97924, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06122922897338867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1660, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2070307731628418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2070307731628418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1660, 128]), torch.Size([1, 1660, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20861387252807617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22151517868041992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1660, 128])
m.shape torch.Size([1998, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22262907028198242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22262907028198242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1998, 128]), torch.Size([1, 1998, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2245345115661621  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2534022331237793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1998, 128])
m.shape torch.Size([2203, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2565464973449707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2565464973449707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2203, 128]), torch.Size([1, 2203, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2593827247619629  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30593061447143555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2203, 128])
m.shape torch.Size([2123, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.308929443359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.308929443359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2123, 128]), torch.Size([1, 2123, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31119394302368164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3712005615234375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2123, 128])
m.shape torch.Size([2016, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37441158294677734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37441158294677734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2016, 128]), torch.Size([1, 2016, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37633419036865234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44628047943115234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2016, 128])
m.shape torch.Size([1906, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4507722854614258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4507722854614258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1906, 128]), torch.Size([1, 1906, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4525899887084961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.531956672668457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1906, 128])
m.shape torch.Size([1727, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5368123054504395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5368123054504395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1727, 128]), torch.Size([1, 1727, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.538459300994873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6227045059204102  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1727, 128])
m.shape torch.Size([1616, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6280455589294434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6280455589294434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1616, 128]), torch.Size([1, 1616, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6295866966247559  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7178339958190918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1616, 128])
m.shape torch.Size([1459, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7233247756958008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7233247756958008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1459, 128]), torch.Size([1, 1459, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7247161865234375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8147106170654297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1459, 128])
m.shape torch.Size([21341, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9157767295837402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9157767295837402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21341, 128]), torch.Size([1, 21341, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.936129093170166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3904738426208496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21341, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2571005821228027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.293386936187744  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3296732902526855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2931032180786133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([38049, 256])
first layer input nodes number: 97924
first layer output nodes number: 38049
edges number: 293831
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3304052352905273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3666915893554688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.376046657562256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.376046657562256  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([866, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4223885536193848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4223885536193848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 866, 256]), torch.Size([1, 866, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4240403175354004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4375710487365723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 866, 256])
m.shape torch.Size([664, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4380922317504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4380922317504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.439358711242676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.459299087524414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([618, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.460625171661377  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.460625171661377  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.461803913116455  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.487736225128174  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 618, 256])
m.shape torch.Size([463, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4892992973327637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4892992973327637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.490182399749756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5184130668640137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5198121070861816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5198121070861816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.520542621612549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5489373207092285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([285, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.550215721130371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.550215721130371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5507593154907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.57645320892334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([241, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.577803134918213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.577803134918213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5782628059387207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6012463569641113  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6026391983032227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6026391983032227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.603041648864746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.625981330871582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.627440929412842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.627440929412842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.627807140350342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.651244640350342  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.652397632598877  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.652397632598877  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.652662754058838  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6714863777160645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([151, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.672950267791748  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.672950267791748  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6732382774353027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6957030296325684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.697035312652588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.697035312652588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.697279453277588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.718031406402588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7196426391601562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7196426391601562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7198486328125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.738800048828125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.739929676055908  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.739929676055908  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7400975227355957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.756714344024658  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.757812976837158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.757812976837158  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.757969379425049  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.774548053741455  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7756385803222656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7756385803222656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7757835388183594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.792163848876953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7931370735168457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7931370735168457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.793257236480713  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8076767921447754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8087239265441895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8087239265441895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8088459968566895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8243489265441895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.825333595275879  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.825333595275879  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.825442314147949  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.840010643005371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8410019874572754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8410019874572754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8411011695861816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.855085849761963  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.855844020843506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.855844020843506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8559203147888184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8672118186950684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8677449226379395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8677449226379395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8677964210510254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8757786750793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8765931129455566  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8765931129455566  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8766655921936035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8884072303771973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.889270782470703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.889270782470703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.889345169067383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.90191650390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([609, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9165124893188477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9165124893188477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9176740646362305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.124993324279785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 609, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.084782123565674  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.085629463195801  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0864768028259277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0855870246887207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 38049
output nodes number: 5684
edges number: 47112
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0859131813049316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.08591365814209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06653881072998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 3 input nodes size: 98099
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.058687686920166016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.058687686920166016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10556268692016602  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.1056051254272461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06141519546508789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06141519546508789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06141519546508789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([98099, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06141519546508789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1670, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20721006393432617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20721006393432617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2088027000427246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22175359725952148  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([2054, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2229161262512207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2229161262512207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2054, 128]), torch.Size([1, 2054, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22487497329711914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25590085983276367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2054, 128])
m.shape torch.Size([2230, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25811147689819336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25811147689819336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2230, 128]), torch.Size([1, 2230, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.26076364517211914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30837202072143555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2230, 128])
m.shape torch.Size([2055, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31122827529907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31122827529907227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2055, 128]), torch.Size([1, 2055, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31327152252197266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37125635147094727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2055, 128])
m.shape torch.Size([1981, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3749995231628418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3749995231628418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1981, 128]), torch.Size([1, 1981, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3768887519836426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44655656814575195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1981, 128])
m.shape torch.Size([1832, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4508533477783203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4508533477783203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1832, 128]), torch.Size([1, 1832, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45260047912597656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5277271270751953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1832, 128])
m.shape torch.Size([1753, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5327048301696777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5327048301696777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1753, 128]), torch.Size([1, 1753, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5343766212463379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6179661750793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1753, 128])
m.shape torch.Size([1661, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6234664916992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6234664916992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6250505447387695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7173347473144531  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([1488, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.722928524017334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.722928524017334  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1488, 128]), torch.Size([1, 1488, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7243475914001465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8153128623962402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1488, 128])
m.shape torch.Size([21382, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9165606498718262  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9165606498718262  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21382, 128]), torch.Size([1, 21382, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9369521141052246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3917269706726074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21382, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2583365440368652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.294677257537842  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3310179710388184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2943930625915527  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([38106, 256])
first layer input nodes number: 98099
first layer output nodes number: 38106
edges number: 294356
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3317508697509766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.368091583251953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.377427101135254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.377427101135254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([854, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.423921585083008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.423921585083008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 854, 256]), torch.Size([1, 854, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4255504608154297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4392032623291016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 854, 256])
m.shape torch.Size([716, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4398627281188965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4398627281188965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4412283897399902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4626803398132324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([590, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4639697074890137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4639697074890137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.465095043182373  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.490607738494873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([426, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.491703987121582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.491703987121582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.49251651763916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5180435180664062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([361, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5193724632263184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5193724632263184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5200610160827637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5452628135681152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5473828315734863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5473828315734863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.547976016998291  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5739550590515137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5758891105651855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5758891105651855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.576362133026123  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.600013256072998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([233, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6015686988830566  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6015686988830566  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.602013111114502  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6273446083068848  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.628688335418701  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.628688335418701  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6290335655212402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6511282920837402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([168, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6525707244873047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6525707244873047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.652891159057617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6756420135498047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.676919937133789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.676919937133789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6771793365478516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6974124908447266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.698655605316162  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.698655605316162  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.698882579803467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7181754112243652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7196850776672363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7196850776672363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7198681831359863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7367138862609863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7378334999084473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7378334999084473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7380051612854004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7549996376037598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.755894184112549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.755894184112549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.75602388381958  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7697720527648926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7708301544189453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7708301544189453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7709693908691406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.786703109741211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.787672519683838  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.787672519683838  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.787792682647705  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8022122383117676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8032336235046387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8032336235046387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8033499717712402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8181262016296387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.819218635559082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.819218635559082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.819338798522949  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8354406356811523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.836534023284912  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.836534023284912  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.836648464202881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8527846336364746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.853898525238037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.853898525238037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8540091514587402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8703818321228027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8710031509399414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8710031509399414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8710641860961914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8805246353149414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8811135292053223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8811135292053223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.881166934967041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8898186683654785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8905763626098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8905763626098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.890641212463379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9016008377075195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([615, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9163460731506348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9163460731506348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 615, 256]), torch.Size([1, 615, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9175190925598145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.125649929046631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 615, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0852699279785156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0861172676086426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0869646072387695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0860748291015625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 38106
output nodes number: 5684
edges number: 47283
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0864014625549316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.08640193939209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06671333312988281  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 4 input nodes size: 97967
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10558319091796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10562562942504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05870819091796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06123828887939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06123828887939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06123828887939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97967, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06123828887939453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1639, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2060837745666504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2060837745666504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20764684677124023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2204451560974121  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([2186, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22174835205078125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22174835205078125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2186, 128]), torch.Size([1, 2186, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2238330841064453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25561046600341797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2186, 128])
m.shape torch.Size([2088, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2575550079345703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2575550079345703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2088, 128]), torch.Size([1, 2088, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25959300994873047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30500030517578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2088, 128])
m.shape torch.Size([2149, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3081035614013672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3081035614013672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31089067459106445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3717813491821289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([2117, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37580394744873047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37580394744873047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37830018997192383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45307397842407227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([1863, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45690202713012695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45690202713012695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1863, 128]), torch.Size([1, 1863, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4586787223815918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5360150337219238  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1863, 128])
m.shape torch.Size([1779, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5410647392272949  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5410647392272949  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1779, 128]), torch.Size([1, 1779, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5427613258361816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6275906562805176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1779, 128])
m.shape torch.Size([1655, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6330556869506836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6330556869506836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6346340179443359  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7269954681396484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1655, 128])
m.shape torch.Size([1526, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.732755184173584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.732755184173584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1526, 128]), torch.Size([1, 1526, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7342104911804199  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8275327682495117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1526, 128])
m.shape torch.Size([21080, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9273223876953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9273223876953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21080, 128]), torch.Size([1, 21080, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9474258422851562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3990325927734375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21080, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2667770385742188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3030948638916016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3394126892089844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3028106689453125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([38082, 256])
first layer input nodes number: 97967
first layer output nodes number: 38082
edges number: 292861
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.340144634246826  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.376462459564209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.385941982269287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.385941982269287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4322471618652344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4322471618652344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4338417053222656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4474048614501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([751, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4481210708618164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4481210708618164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4495534896850586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4736127853393555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([528, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.474672794342041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.474672794342041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.475679874420166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5002007484436035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([452, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.501500129699707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.501500129699707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5023622512817383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5287675857543945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([399, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.530254364013672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.530254364013672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.531015396118164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5599889755249023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.561309814453125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.561309814453125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5618724822998047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5870370864868164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5883708000183105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5883708000183105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5888285636901855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6117167472839355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6137514114379883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6137514114379883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.614163398742676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6376466751098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.639075756072998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.639075756072998  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6394362449645996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6625075340270996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.663961410522461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.663961410522461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.664285659790039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.687307357788086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([162, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6888580322265625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6888580322265625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.689167022705078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.713268280029297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.714601993560791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.714601993560791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.714848041534424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.735762119293213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([131, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.737276077270508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.737276077270508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7375259399414062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7605133056640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7618350982666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7618350982666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.762022018432617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.780527114868164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7815728187561035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7815728187561035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7817234992980957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7976956367492676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.798670768737793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.798670768737793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.798800468444824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8134565353393555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.814424514770508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.814424514770508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8145408630371094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.828502655029297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8293962478637695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8293962478637695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.829501152038574  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8428239822387695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8436665534973145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8436665534973145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8437600135803223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.856283664703369  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8573389053344727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8573389053344727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8574399948120117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8716936111450195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8727736473083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8727736473083496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.872880458831787  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.888688564300537  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.889375686645508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.889375686645508  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8894424438476562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.899789810180664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9004859924316406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9004859924316406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9005489349365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.910745620727539  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9112911224365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9112911224365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9113388061523438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9193973541259766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([574, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.933166027069092  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.933166027069092  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.934260845184326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1362624168395996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 574, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0960888862609863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0969362258911133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0977835655212402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.096893787384033  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 38082
output nodes number: 5684
edges number: 46655
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0972204208374023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0972208976745605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06657171249389648  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 5 input nodes size: 97382
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05870819091796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05870819091796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10558319091796875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10562562942504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06138181686401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06138181686401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06138181686401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97382, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06138181686401367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1648, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2053050994873047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2053050994873047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1648, 128]), torch.Size([1, 1648, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2068767547607422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21966266632080078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1648, 128])
m.shape torch.Size([2100, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22087955474853516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22087955474853516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2100, 128]), torch.Size([1, 2100, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22288227081298828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25419139862060547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2100, 128])
m.shape torch.Size([2151, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25626707077026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25626707077026367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2151, 128]), torch.Size([1, 2151, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25890064239501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3055582046508789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2151, 128])
m.shape torch.Size([2049, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3084406852722168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3084406852722168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3104677200317383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.369077205657959  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([2067, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3722515106201172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3722515106201172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2067, 128]), torch.Size([1, 2067, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37499094009399414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4503812789916992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2067, 128])
m.shape torch.Size([1864, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4553093910217285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4553093910217285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1864, 128]), torch.Size([1, 1864, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45708703994750977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5360970497131348  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1864, 128])
m.shape torch.Size([1661, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5407524108886719  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5407524108886719  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5423364639282227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6240344047546387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([1573, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6292428970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6292428970336914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1573, 128]), torch.Size([1, 1573, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6307430267333984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7162504196166992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1573, 128])
m.shape torch.Size([1469, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7218046188354492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7218046188354492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1469, 128]), torch.Size([1, 1469, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.72320556640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8129124641418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1469, 128])
m.shape torch.Size([21129, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9129629135131836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9129629135131836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21129, 128]), torch.Size([1, 21129, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9331130981445312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3852338790893555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21129, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2524824142456055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2884464263916016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3244104385375977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2881650924682617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37711, 256])
first layer input nodes number: 97382
first layer output nodes number: 37711
edges number: 290738
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3251380920410156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3611021041870117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.370558261871338  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.370558261871338  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([842, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4168663024902344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4168663024902344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4184722900390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.431900978088379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([749, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4325714111328125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4325714111328125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.434000015258789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.457249164581299  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([593, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4583029747009277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4583029747009277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 593, 256]), torch.Size([1, 593, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4594340324401855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.487058639526367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 593, 256])
m.shape torch.Size([447, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.488332748413086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.488332748413086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.489185333251953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.51577091217041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([403, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5172815322875977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5172815322875977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.518050193786621  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5460634231567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([302, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5474209785461426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5474209785461426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.547996997833252  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5753331184387207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([236, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5766329765319824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5766329765319824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.577083110809326  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5995898246765137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([198, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6008872985839844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6008872985839844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6012649536132812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.622791290283203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6241164207458496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6241164207458496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.624450206756592  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.645812511444092  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([178, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6473565101623535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6473565101623535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.647696018218994  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6718010902404785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6730542182922363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6730542182922363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6733078956604004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6930947303771973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.694352149963379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.694352149963379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6945810317993164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.714035987854004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7151589393615723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7151589393615723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7153477668762207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.732719898223877  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7337827682495117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7337827682495117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7339468002319336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.750185966491699  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7512717247009277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7512717247009277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7514262199401855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7678027153015137  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7689404487609863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7689404487609863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7690911293029785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7861180305480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7876968383789062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7876968383789062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7878246307373047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.803159713745117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.804030418395996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.804030418395996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.804133415222168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.817214012145996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.817929744720459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.817929744720459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.818009853363037  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.828744411468506  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8298001289367676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8298001289367676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.829908847808838  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.845238208770752  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.845931053161621  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.845931053161621  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.846001625061035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8564462661743164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8571090698242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8571090698242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8571720123291016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8669281005859375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.86773681640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.86773681640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.867809295654297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8795509338378906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8804144859313965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8804144859313965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.880488872528076  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8930602073669434  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([596, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.907343864440918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.907343864440918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.908480644226074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.112947463989258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 596, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.07275390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.073601245880127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.074448585510254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.073558807373047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37711
output nodes number: 5684
edges number: 46460
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.073882579803467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.073883056640625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06676054000854492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 6 input nodes size: 97614
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10541486740112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10545730590820312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05853986740112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0610661506652832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0610661506652832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0610661506652832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97614, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0610661506652832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1600, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2049560546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2049560546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1600, 128]), torch.Size([1, 1600, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20648193359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21911144256591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1600, 128])
m.shape torch.Size([2070, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2203226089477539  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2203226089477539  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2070, 128]), torch.Size([1, 2070, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22323942184448242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2553439140319824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2070, 128])
m.shape torch.Size([2117, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25731801986694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25731801986694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2593369483947754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3057093620300293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2092, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30869007110595703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30869007110595703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2092, 128]), torch.Size([1, 2092, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3113236427307129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3713231086730957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2092, 128])
m.shape torch.Size([2007, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37436485290527344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37436485290527344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2007, 128]), torch.Size([1, 2007, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3762788772583008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44635677337646484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2007, 128])
m.shape torch.Size([1817, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45059823989868164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45059823989868164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1817, 128]), torch.Size([1, 1817, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4523310661315918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5276608467102051  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1817, 128])
m.shape torch.Size([1697, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5324587821960449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5324587821960449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1697, 128]), torch.Size([1, 1697, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5340771675109863  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6155614852905273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1697, 128])
m.shape torch.Size([1608, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6208863258361816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6208863258361816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1608, 128]), torch.Size([1, 1608, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6224198341369629  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7106194496154785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1608, 128])
m.shape torch.Size([1455, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7160968780517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7160968780517578  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1455, 128]), torch.Size([1, 1455, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7174844741821289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8070530891418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1455, 128])
m.shape torch.Size([21269, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9077777862548828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9077777862548828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21269, 128]), torch.Size([1, 21269, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9280614852905273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.381650924682617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21269, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2495899200439453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.285573959350586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3215579986572266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.285292625427246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37732, 256])
first layer input nodes number: 97614
first layer output nodes number: 37732
edges number: 291924
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3222875595092773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.358271598815918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3676609992980957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3676609992980957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([859, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4139885902404785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4139885902404785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 859, 256]), torch.Size([1, 859, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4156270027160645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.429626941680908  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 859, 256])
m.shape torch.Size([731, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4303579330444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4303579330444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4317522048950195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4526662826538086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([556, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4537253379821777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4537253379821777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4547858238220215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4806599617004395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([467, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.482241153717041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.482241153717041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4831318855285645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.509927272796631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([371, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5112648010253906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5112648010253906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.511972427368164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.539163112640381  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.540574073791504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.540574073791504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5411577224731445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.567810535430908  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([263, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5692882537841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5692882537841797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5697898864746094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5964250564575195  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([194, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5976662635803223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5976662635803223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.598036289215088  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6191277503967285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([190, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.620845317840576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.620845317840576  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6212077140808105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6444010734558105  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([163, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.645786762237549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.645786762237549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6460976600646973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6681714057922363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6693692207336426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6693692207336426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6696133613586426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6886563301086426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.68994140625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.68994140625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.690174102783203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7099533081054688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7110118865966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7110118865966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.711191177368164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7276859283447266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.728874683380127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.728874683380127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.729055881500244  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7469944953918457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.747927665710449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.747927665710449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.748063087463379  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.762417793273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.764005661010742  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.764005661010742  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7641448974609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.779878616333008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7808876037597656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7808876037597656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7810134887695312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7961196899414062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7970776557922363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7970776557922363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7971901893615723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8114819526672363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8124852180480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8124852180480957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.812595844268799  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8274197578430176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8283448219299316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8283448219299316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.828442096710205  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8421578407287598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.842916965484619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.842916965484619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8429932594299316  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8542847633361816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.855071544647217  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.855071544647217  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8551459312438965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.866675853729248  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8673243522644043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8673243522644043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8673834800720215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.876962184906006  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8776707649230957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8776707649230957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8777318000793457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8880467414855957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([625, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.903034210205078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.903034210205078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.904226303100586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1150035858154297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 625, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0747838020324707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0756311416625977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0764784812927246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0755887031555176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37732
output nodes number: 5684
edges number: 47048
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0759124755859375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0759129524230957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06591606140136719  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 7 input nodes size: 96824
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05853986740112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05853986740112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10541486740112305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10545730590820312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06134462356567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06134462356567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06134462356567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96824, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06134462356567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1604, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2023615837097168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2023615837097168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1604, 128]), torch.Size([1, 1604, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20389127731323242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21641016006469727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1604, 128])
m.shape torch.Size([2123, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21766996383666992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21766996383666992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2123, 128]), torch.Size([1, 2123, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21973419189453125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2518310546875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2123, 128])
m.shape torch.Size([2171, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25385570526123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25385570526123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2171, 128]), torch.Size([1, 2171, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25592613220214844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.302584171295166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2171, 128])
m.shape torch.Size([2118, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3055887222290039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3055887222290039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30799055099487305  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3681931495666504  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([2053, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37146854400634766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37146854400634766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3740668296813965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44815587997436523  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([1889, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45258140563964844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45258140563964844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1889, 128]), torch.Size([1, 1889, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45438289642333984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5338363647460938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1889, 128])
m.shape torch.Size([1739, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5387401580810547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5387401580810547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1739, 128]), torch.Size([1, 1739, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5403985977172852  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6234936714172363  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1739, 128])
m.shape torch.Size([1576, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6286764144897461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6286764144897461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1576, 128]), torch.Size([1, 1576, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6301794052124023  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7164125442504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1576, 128])
m.shape torch.Size([1486, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7220382690429688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7220382690429688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1486, 128]), torch.Size([1, 1486, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7234554290771484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8144912719726562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1486, 128])
m.shape torch.Size([20570, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9118680953979492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9118680953979492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20570, 128]), torch.Size([1, 20570, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9314851760864258  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3242979049682617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20570, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.194164276123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.229763984680176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2653636932373047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.229485511779785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37329, 256])
first layer input nodes number: 96824
first layer output nodes number: 37329
edges number: 286289
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.266087055206299  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3016867637634277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3114094734191895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3114094734191895  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([861, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.356534481048584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.356534481048584  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3581767082214355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.371634006500244  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([706, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.372319221496582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.372319221496582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3736658096313477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3938732147216797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([566, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3948798179626465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3948798179626465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3959593772888184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.421309471130371  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([466, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.422565460205078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.422565460205078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4234542846679688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4492759704589844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.450627326965332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.450627326965332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4513368606567383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.481121063232422  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([348, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4827733039855957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4827733039855957  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4834370613098145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.517282009124756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([265, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.518733024597168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.518733024597168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5192384719848633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5465621948242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([230, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5480780601501465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5480780601501465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5485167503356934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5735220909118652  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5749292373657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5749292373657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5752878189086914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5982370376586914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6003804206848145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6003804206848145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.600677967071533  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6218037605285645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6229662895202637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6229662895202637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6232028007507324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.641650676727295  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6428589820861816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6428589820861816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.643078327178955  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6617226600646973  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([124, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6631627082824707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6631627082824707  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6633992195129395  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6851582527160645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6862916946411133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6862916946411133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.686469078063965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7040300369262695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.705080509185791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.705080509185791  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.705231189727783  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.721203327178955  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7222046852111816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7222046852111816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7223381996154785  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7374253273010254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7394967079162598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7394967079162598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7396340370178223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7561135292053223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7569103240966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7569103240966797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7570056915283203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7691173553466797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.77001953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.77001953125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7701187133789062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7834091186523438  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.784320831298828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.784320831298828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7844161987304688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.797863006591797  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.798643112182617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.798643112182617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7987213134765625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8102951049804688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8110599517822266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8110599517822266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8111324310302734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.822366714477539  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8230600357055664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8230600357055664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.823122978210449  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.833319664001465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8341188430786133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8341188430786133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8341875076293945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.845791816711426  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([549, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8589491844177246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8589491844177246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8599963188171387  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0451340675354004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 549, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0061826705932617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0070300102233887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0078773498535156  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0069875717163086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37329
output nodes number: 5684
edges number: 45850
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0073084831237793  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0073089599609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06578350067138672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 8 input nodes size: 97689
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10545063018798828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10549306869506836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05857563018798828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06108665466308594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06108665466308594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06108665466308594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97689, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06108665466308594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1653, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20501947402954102  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20501947402954102  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1653, 128]), torch.Size([1, 1653, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20659589767456055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21939897537231445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1653, 128])
m.shape torch.Size([2129, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2206411361694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2206411361694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2129, 128]), torch.Size([1, 2129, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2226715087890625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2541232109069824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2129, 128])
m.shape torch.Size([2232, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2563009262084961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2563009262084961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2232, 128]), torch.Size([1, 2232, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25873565673828125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30604124069213867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2232, 128])
m.shape torch.Size([2157, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30909109115600586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30909109115600586  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2157, 128]), torch.Size([1, 2157, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3111839294433594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3713383674621582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2157, 128])
m.shape torch.Size([2037, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3751664161682129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3751664161682129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2037, 128]), torch.Size([1, 2037, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3771090507507324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4472956657409668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2037, 128])
m.shape torch.Size([1858, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45164012908935547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45164012908935547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1858, 128]), torch.Size([1, 1858, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4534120559692383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5300092697143555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1858, 128])
m.shape torch.Size([1725, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5348811149597168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5348811149597168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1725, 128]), torch.Size([1, 1725, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5365262031555176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6197819709777832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1725, 128])
m.shape torch.Size([1672, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6253376007080078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6253376007080078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1672, 128]), torch.Size([1, 1672, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6269321441650391  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7193069458007812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1672, 128])
m.shape torch.Size([1500, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7249469757080078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7249469757080078  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1500, 128]), torch.Size([1, 1500, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7263774871826172  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8196506500244141  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1500, 128])
m.shape torch.Size([20916, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.918670654296875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.918670654296875  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20916, 128]), torch.Size([1, 20916, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9395923614501953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.355833053588867  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20916, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.224526882171631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.260651111602783  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2967753410339355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.260368824005127  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37879, 256])
first layer input nodes number: 97689
first layer output nodes number: 37879
edges number: 290679
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2975053787231445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.333629608154297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3431873321533203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3431873321533203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([866, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3895163536071777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3895163536071777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 866, 256]), torch.Size([1, 866, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3911681175231934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.405045986175537  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 866, 256])
m.shape torch.Size([722, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4056806564331055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4056806564331055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.407057762145996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4286060333251953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 722, 256])
m.shape torch.Size([559, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4297423362731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4297423362731934  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4308085441589355  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.454963207244873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([460, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4564743041992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4564743041992188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4573516845703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4836082458496094  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4857234954833984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4857234954833984  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.486490249633789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5148067474365234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([299, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.516148090362549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.516148090362549  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5167183876037598  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5439963340759277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([253, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5454134941101074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5454134941101074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.545896053314209  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.570024013519287  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([206, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.571366786956787  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.571366786956787  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5717597007751465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.594155788421631  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([183, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5955424308776855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5955424308776855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5958914756774902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6182303428649902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([152, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6195168495178223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6195168495178223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6198067665100098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6403908729553223  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6418638229370117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6418638229370117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.642155647277832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6649179458618164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6661791801452637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6661791801452637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.666411876678467  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6861910820007324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.687437057495117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.687437057495117  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6876449584960938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7067718505859375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7079825401306152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7079825401306152  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.708158016204834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7255301475524902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.726667881011963  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.726667881011963  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.726830005645752  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7440152168273926  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7451186180114746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7451186180114746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.745265483856201  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7618613243103027  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.762824058532715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.762824058532715  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.762944221496582  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7773637771606445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.778388023376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.778388023376465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7785043716430664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.793280601501465  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7943520545959473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7943520545959473  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.794456958770752  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.80851411819458  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8092117309570312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8092117309570312  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.809286117553711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.819774627685547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8208670616149902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8208670616149902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8209643363952637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8353610038757324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.835947036743164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.835947036743164  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8360042572021484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8448734283447266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.845707416534424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.845707416534424  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8457818031311035  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.857832431793213  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.858464241027832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.858464241027832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8585195541381836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8678674697875977  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([577, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.881704330444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.881704330444336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8828048706054688  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.084033966064453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 577, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0439891815185547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0448365211486816  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0456838607788086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0447940826416016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37879
output nodes number: 5684
edges number: 46319
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.045118808746338  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.045119285583496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06647157669067383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 9 input nodes size: 96560
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05857563018798828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.05857563018798828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10545063018798828  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10549306869506836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06133127212524414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06133127212524414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06133127212524414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([96560, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06133127212524414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1638, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20135927200317383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20135927200317383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1638, 128]), torch.Size([1, 1638, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20292139053344727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21541833877563477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1638, 128])
m.shape torch.Size([2062, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21660375595092773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21660375595092773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.21881341934204102  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25084543228149414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
m.shape torch.Size([2144, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2520260810852051  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2520260810852051  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2144, 128]), torch.Size([1, 2144, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25587892532348633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30243730545043945  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2144, 128])
m.shape torch.Size([2153, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30552148818969727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30552148818969727  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2153, 128]), torch.Size([1, 2153, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3080434799194336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3688998222351074  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2153, 128])
m.shape torch.Size([2034, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3727226257324219  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3727226257324219  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2034, 128]), torch.Size([1, 2034, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3746623992919922  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44489479064941406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2034, 128])
m.shape torch.Size([1752, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44893741607666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.44893741607666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1752, 128]), torch.Size([1, 1752, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4506082534790039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5229692459106445  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1752, 128])
m.shape torch.Size([1684, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5277547836303711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5277547836303711  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5293607711791992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.611241340637207  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
m.shape torch.Size([1610, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6165800094604492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6165800094604492  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1610, 128]), torch.Size([1, 1610, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6181154251098633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.706599235534668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1610, 128])
m.shape torch.Size([1448, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7120456695556641  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7120456695556641  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1448, 128]), torch.Size([1, 1448, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7134265899658203  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8024015426635742  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1448, 128])
m.shape torch.Size([20536, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8996343612670898  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.8996343612670898  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 20536, 128]), torch.Size([1, 20536, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9192190170288086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.30972957611084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 20536, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.180325984954834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.215670108795166  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.251014232635498  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.215393543243408  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([37061, 256])
first layer input nodes number: 96560
first layer output nodes number: 37061
edges number: 284548
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2517356872558594  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.2870798110961914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.296818733215332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.296818733215332  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([853, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3418054580688477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3418054580688477  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3434324264526367  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3566999435424805  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([748, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.357583999633789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.357583999633789  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.359010696411133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.380411148071289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([582, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3814048767089844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3814048767089844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3825149536132812  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.408428192138672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([470, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.409733772277832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.409733772277832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.410630226135254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4372682571411133  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([400, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.438753128051758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.438753128051758  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.439516067504883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4717884063720703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([271, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4732656478881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4732656478881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.473782539367676  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.501241683959961  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([267, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.502779960632324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.502779960632324  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.503289222717285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5301361083984375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([198, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5314040184020996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5314040184020996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5317816734313965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5533080101013184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([183, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.555248737335205  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.555248737335205  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5555977821350098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5779366493225098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([181, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5795021057128906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5795021057128906  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5798473358154297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.604358673095703  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.605581760406494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.605581760406494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6058335304260254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.625471591949463  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.626821994781494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.626821994781494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.627066135406494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.647818088531494  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6488709449768066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6488709449768066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.649050235748291  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6655449867248535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6667470932006836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6667470932006836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6669301986694336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6850576400756836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.686306953430176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.686306953430176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6864843368530273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.705286979675293  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7061209678649902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7061209678649902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.706235408782959  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7191672325134277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.720090389251709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.720090389251709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7202048301696777  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7339377403259277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.735276222229004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.735276222229004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7354135513305664  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.752854347229004  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.75384521484375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.75384521484375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.753955841064453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.768779754638672  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7696666717529297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7696666717529297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7697601318359375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.782938003540039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.783557415008545  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.783557415008545  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7836203575134277  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.792935848236084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.793539047241211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.793539047241211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7935962677001953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8024654388427734  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.803321361541748  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.803321361541748  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8033976554870605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8157572746276855  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8163881301879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8163881301879883  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.81644344329834  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.825791358947754  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([557, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8391475677490234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8391475677490234  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8402099609375  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.0277881622314453  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 557, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9889588356018066  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9898061752319336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9906535148620605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9897637367248535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([5684, 40])
input nodes number: 37061
output nodes number: 5684
edges number: 45712
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9900827407836914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9900832176208496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06580257415771484  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

pseudo mini batch 10 input nodes size: 97809
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10550785064697266  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.10555028915405273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.058632850646972656  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06120491027832031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06120491027832031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06120491027832031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([97809, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.06120491027832031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([1606, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20883941650390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.20883941650390625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2103710174560547  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22314834594726562  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([2040, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22432804107666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.22432804107666016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2040, 128]), torch.Size([1, 2040, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2262735366821289  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.25550174713134766  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2040, 128])
m.shape torch.Size([2183, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2584657669067383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.2584657669067383  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2183, 128]), torch.Size([1, 2183, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.26128482818603516  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.30762290954589844  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2183, 128])
m.shape torch.Size([2153, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31068849563598633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31068849563598633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2153, 128]), torch.Size([1, 2153, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.31303882598876953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3736891746520996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2153, 128])
m.shape torch.Size([2042, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3771052360534668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.3771052360534668  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 2042, 128]), torch.Size([1, 2042, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.37905263900756836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4492964744567871  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 2042, 128])
m.shape torch.Size([1881, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4537043571472168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.4537043571472168  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1881, 128]), torch.Size([1, 1881, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.45549821853637695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5339312553405762  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1881, 128])
m.shape torch.Size([1752, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5388822555541992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.5388822555541992  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1752, 128]), torch.Size([1, 1752, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.540553092956543  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6250677108764648  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1752, 128])
m.shape torch.Size([1669, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6305990219116211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6305990219116211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1669, 128]), torch.Size([1, 1669, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.6321907043457031  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7246408462524414  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1669, 128])
m.shape torch.Size([1484, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7302136421203613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7302136421203613  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.7316288948059082  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.822638988494873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([21618, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9254469871520996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9254469871520996  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 21618, 128]), torch.Size([1, 21618, 128])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 0.9467949867248535  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4105687141418457  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 21618, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.275282859802246  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3119306564331055  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.348578453063965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3116440773010254  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

torch.Size([38428, 256])
first layer input nodes number: 97809
first layer output nodes number: 38428
edges number: 297495
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3493094444274902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3859572410583496  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3951802253723145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.3951802253723145  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

m.shape torch.Size([791, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4418678283691406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4418678283691406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4433765411376953  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.457277297973633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.457962989807129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.457962989807129  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.459345817565918  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.4802026748657227  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([571, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.481259822845459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.481259822845459  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.482348918914795  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.508523464202881  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([479, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.509833812713623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.509833812713623  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5107474327087402  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5381388664245605  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([382, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.539517879486084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.539517879486084  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5402464866638184  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5701098442077637  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([288, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5714941024780273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5714941024780273  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.5720434188842773  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6007680892944336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([254, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6022024154663086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6022024154663086  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.602686882019043  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6269102096557617  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([230, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.62843656539917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.62843656539917  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.628875255584717  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6538805961608887  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([194, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6553397178649902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6553397178649902  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.655709743499756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.679391384124756  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.68072509765625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.68072509765625  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.6810264587402344  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.702423095703125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7037858963012695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7037858963012695  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.704043388366699  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.724127769470215  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.725337028503418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.725337028503418  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.725558280944824  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7443647384643555  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7455787658691406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7455787658691406  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7457809448242188  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7643814086914062  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.76554536819458  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.76554536819458  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7657246589660645  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7834744453430176  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.784567356109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.784567356109619  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.7847237586975098  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.801302433013916  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8023624420166016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8023624420166016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8025035858154297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.818452835083008  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.819559097290039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.819559097290039  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8196964263916016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8361759185791016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.837972640991211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.837972640991211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8380889892578125  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.852865219116211  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.853902816772461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.853902816772461  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8540172576904297  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.869352340698242  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8701605796813965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8701605796813965  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.870246410369873  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8823485374450684  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.883416175842285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.883416175842285  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.88352108001709  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8990468978881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8998403549194336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.8998403549194336  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.899916648864746  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9117422103881836  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.912367343902588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.912367343902588  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9124245643615723  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.921694278717041  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.922311782836914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.922311782836914  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.922365188598633  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9313907623291016  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([614, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.946117401123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.946117401123047  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 2.9472885131835938  GigaBytes
Max Memory Allocated: 3.162956714630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1575870513916016  GigaBytes
Max Memory Allocated: 3.1722259521484375  GigaBytes

rst.shape  torch.Size([1, 614, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1169562339782715  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1178035736083984  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1186509132385254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1177611351013184  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([5684, 40])
input nodes number: 38428
output nodes number: 5684
edges number: 47546
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1180901527404785  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 3.1180906295776367  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06641817092895508  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

pseudo mini batch 11 input nodes size: 96867
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.058632850646972656  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.058632850646972656  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10550785064697266  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10555028915405273  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06134176254272461  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06134176254272461  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06134176254272461  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([96867, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06134176254272461  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([1633, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2023758888244629  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2023758888244629  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1633, 128]), torch.Size([1, 1633, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2039332389831543  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21656274795532227  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1633, 128])
m.shape torch.Size([2181, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2178640365600586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2178640365600586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2181, 128]), torch.Size([1, 2181, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2199559211730957  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2519974708557129  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2181, 128])
m.shape torch.Size([2199, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2540774345397949  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2540774345397949  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2199, 128]), torch.Size([1, 2199, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25617456436157227  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30290794372558594  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2199, 128])
m.shape torch.Size([2107, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3058781623840332  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3058781623840332  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2107, 128]), torch.Size([1, 2107, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30815982818603516  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.36808252334594727  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2107, 128])
m.shape torch.Size([2080, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3713698387145996  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3713698387145996  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2080, 128]), torch.Size([1, 2080, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37403345108032227  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44901180267333984  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2080, 128])
m.shape torch.Size([1835, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45326995849609375  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45326995849609375  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1835, 128]), torch.Size([1, 1835, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4550199508666992  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5322589874267578  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1835, 128])
m.shape torch.Size([1701, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5370616912841797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5370616912841797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1701, 128]), torch.Size([1, 1701, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5386838912963867  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6206088066101074  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1701, 128])
m.shape torch.Size([1566, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6257715225219727  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6257715225219727  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1566, 128]), torch.Size([1, 1566, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6272649765014648  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7123918533325195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1566, 128])
m.shape torch.Size([1474, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7179708480834961  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7179708480834961  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7193765640258789  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8094387054443359  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([20618, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9070501327514648  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9070501327514648  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 20618, 128]), torch.Size([1, 20618, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9267129898071289  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3227758407592773  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 20618, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1926450729370117  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.228306770324707  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2639684677124023  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.228027820587158  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([37394, 256])
first layer input nodes number: 96867
first layer output nodes number: 37394
edges number: 286311
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2646923065185547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.30035400390625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.310053825378418  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.310053825378418  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([853, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.354809284210205  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.354809284210205  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.356436252593994  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.370251178741455  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([727, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.371006965637207  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.371006965637207  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3723936080932617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.393193244934082  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([603, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3942742347717285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3942742347717285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3954243659973145  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.423064708709717  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([440, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4241929054260254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4241929054260254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.425032138824463  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.449507236480713  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([411, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.45113468170166  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.45113468170166  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.451918601989746  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.481504440307617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([283, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4828152656555176  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4828152656555176  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4833550453186035  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.512795925140381  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([265, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5143089294433594  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5143089294433594  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5148143768310547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.541799545288086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([223, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5432615280151367  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5432615280151367  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.543686866760254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5679311752319336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5694141387939453  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5694141387939453  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5697879791259766  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5937137603759766  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([165, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5951128005981445  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5951128005981445  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5954275131225586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.617772102355957  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6191372871398926  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6191372871398926  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6194119453430176  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6408352851867676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([134, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6422438621520996  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6422438621520996  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6424994468688965  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.664224147796631  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6658058166503906  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6658058166503906  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.666013717651367  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.685140609741211  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6863150596618652  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6863150596618652  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6864962577819824  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.704434871673584  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.70562744140625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.70562744140625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7057971954345703  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7237911224365234  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7245521545410156  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7245521545410156  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7246570587158203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.73651123046875  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.737537384033203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.737537384033203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7376632690429688  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7527694702148438  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.753537178039551  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.753537178039551  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.753628730773926  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.765255928039551  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7659406661987305  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7659406661987305  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.766016960144043  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.776240348815918  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7770867347717285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7770867347717285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.777174472808838  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7895455360412598  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.790268898010254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.790268898010254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.790341377258301  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8010683059692383  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.801687717437744  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.801687717437744  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8017468452453613  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8109116554260254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.811412811279297  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.811412811279297  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8114585876464844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8188743591308594  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.819751262664795  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.819751262664795  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8198256492614746  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.832396984100342  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([560, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.845815658569336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.845815658569336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.846883773803711  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.035177230834961  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 560, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9965744018554688  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9974217414855957  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9982690811157227  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9973793029785156  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([5684, 40])
input nodes number: 37394
output nodes number: 5684
edges number: 45470
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9977006912231445  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9977011680603027  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06577730178833008  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

pseudo mini batch 12 input nodes size: 97092
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10516595840454102  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1052083969116211  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.058290958404541016  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06078958511352539  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06078958511352539  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06078958511352539  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([97092, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06078958511352539  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([1638, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2037520408630371  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2037520408630371  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1638, 128]), torch.Size([1, 1638, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20531415939331055  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2180161476135254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1638, 128])
m.shape torch.Size([2159, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21929407119750977  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21929407119750977  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2159, 128]), torch.Size([1, 2159, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22135305404663086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25299072265625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2159, 128])
m.shape torch.Size([2117, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2549896240234375  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2549896240234375  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2570309638977051  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3029909133911133  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2091, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3053550720214844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3053550720214844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30797624588012695  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3684506416320801  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2074, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37239837646484375  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37239837646484375  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37438440322875977  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44954633712768555  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([1922, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45449113845825195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45449113845825195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45632410049438477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5371785163879395  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
m.shape torch.Size([1709, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.541966438293457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.541966438293457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1709, 128]), torch.Size([1, 1709, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5435962677001953  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6258759498596191  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1709, 128])
m.shape torch.Size([1646, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6313400268554688  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6313400268554688  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6329097747802734  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7252025604248047  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1400, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7304258346557617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7304258346557617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1400, 128]), torch.Size([1, 1400, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7317609786987305  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.819727897644043  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1400, 128])
m.shape torch.Size([20839, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9186697006225586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9186697006225586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 20839, 128]), torch.Size([1, 20839, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9385433197021484  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3495702743530273  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 20839, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2177014350891113  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2535548210144043  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2894082069396973  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.253274440765381  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([37595, 256])
first layer input nodes number: 97092
first layer output nodes number: 37595
edges number: 288694
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2901339530944824  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3259873390197754  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3355817794799805  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3355817794799805  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([830, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3818798065185547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3818798065185547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.383462905883789  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3969106674194336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([753, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.397714138031006  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.397714138031006  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3991503715515137  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.420693874359131  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.421687602996826  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.421687602996826  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.422788143157959  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.448751926422119  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([458, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4499950408935547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4499950408935547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.450868606567383  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.477919578552246  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([382, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.479318618774414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.479318618774414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4800472259521484  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.507422924041748  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5093817710876465  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5093817710876465  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5099940299987793  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5371108055114746  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([262, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.538567543029785  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.538567543029785  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.539067268371582  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.568336009979248  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([226, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.56982421875  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.56982421875  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5702552795410156  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5948257446289062  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5960464477539062  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5960464477539062  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.596363067626953  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.616626739501953  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.618178367614746  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.618178367614746  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6184778213500977  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6397390365600586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6410484313964844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6410484313964844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6413116455078125  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6618423461914062  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([109, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.662968158721924  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.662968158721924  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6631760597229004  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.680847644805908  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([81, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.681756019592285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.681756019592285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.681910514831543  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6961240768432617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6972179412841797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6972179412841797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6973838806152344  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7138118743896484  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.714940071105957  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.714940071105957  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7151002883911133  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.732083320617676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7331414222717285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7331414222717285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7332825660705566  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7492318153381348  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7501416206359863  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7501416206359863  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.750256061553955  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.763988971710205  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.764866352081299  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.764866352081299  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7649693489074707  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.778049945831299  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7790212631225586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7790212631225586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.779128074645996  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.793440818786621  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.794785499572754  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.794785499572754  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7949132919311523  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.812932014465332  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8136353492736816  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8136353492736816  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8137078285217285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.824434757232666  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.825160026550293  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.825160026550293  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.825228691101074  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.835871696472168  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8364343643188477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8364343643188477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8364858627319336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8448286056518555  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8453335762023926  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8453335762023926  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8453774452209473  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8527913093566895  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([618, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.867619037628174  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.867619037628174  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.868797779083252  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0793261528015137  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 618, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0391106605529785  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0399580001831055  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0408053398132324  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0399155616760254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([5684, 40])
input nodes number: 37595
output nodes number: 5684
edges number: 46591
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.040238380432129  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.040238857269287  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06622648239135742  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

pseudo mini batch 13 input nodes size: 98393
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.058290958404541016  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.058290958404541016  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1052083969116211  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05891132354736328  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06146049499511719  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06146049499511719  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06146049499511719  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([98393, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06146049499511719  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([1655, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20650434494018555  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20650434494018555  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2080826759338379  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22070932388305664  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1655, 128])
m.shape torch.Size([2017, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22192049026489258  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22192049026489258  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2017, 128]), torch.Size([1, 2017, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22384405136108398  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2530522346496582  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2017, 128])
m.shape torch.Size([2265, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25533056259155273  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25533056259155273  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2265, 128]), torch.Size([1, 2265, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25757932662963867  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.308774471282959  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2265, 128])
m.shape torch.Size([2122, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31185293197631836  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31185293197631836  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2122, 128]), torch.Size([1, 2122, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31394481658935547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37439727783203125  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2122, 128])
m.shape torch.Size([1946, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3780250549316406  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3780250549316406  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1946, 128]), torch.Size([1, 1946, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3798809051513672  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44902610778808594  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1946, 128])
m.shape torch.Size([1938, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4536428451538086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4536428451538086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1938, 128]), torch.Size([1, 1938, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4554910659790039  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5385007858276367  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1938, 128])
m.shape torch.Size([1765, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5434679985046387  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5434679985046387  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5451512336730957  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.629828929901123  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1735, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6356058120727539  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6356058120727539  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1735, 128]), torch.Size([1, 1735, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6372604370117188  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7315740585327148  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1735, 128])
m.shape torch.Size([1505, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7372055053710938  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7372055053710938  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1505, 128]), torch.Size([1, 1505, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7386407852172852  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8312406539916992  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1505, 128])
m.shape torch.Size([21278, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9319844245910645  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9319844245910645  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 21278, 128]), torch.Size([1, 21278, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9522767066955566  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4059605598449707  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 21278, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2717790603637695  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.308234214782715  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.34468936920166  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3079490661621094  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([38226, 256])
first layer input nodes number: 98393
first layer output nodes number: 38226
edges number: 294890
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3454246520996094  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3818798065185547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3912649154663086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3912649154663086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([809, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4375691413879395  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4375691413879395  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4391121864318848  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.452552318572998  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([727, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4537901878356934  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4537901878356934  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.455176830291748  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.478564739227295  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([573, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.479938507080078  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.479938507080078  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4810314178466797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.507272720336914  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([454, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5089802742004395  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5089802742004395  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5098462104797363  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.536409854888916  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5377650260925293  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5377650260925293  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5384745597839355  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5657591819763184  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([310, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.567192554473877  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.567192554473877  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.567783832550049  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.594024181365967  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([280, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5956125259399414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5956125259399414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.596146583557129  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6254472732543945  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([227, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6269259452819824  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6269259452819824  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.627358913421631  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.652038097381592  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6533703804016113  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6533703804016113  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6537117958068848  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6755623817443848  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([187, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.677189350128174  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.677189350128174  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6775460243225098  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7028698921203613  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([126, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.704023838043213  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.704023838043213  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7042641639709473  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7230095863342285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.724365711212158  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.724365711212158  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.724609851837158  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.745361804962158  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.746797561645508  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.746797561645508  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7470054626464844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.766132354736328  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.767226219177246  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.767226219177246  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7673959732055664  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7842016220092773  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7851696014404297  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7851696014404297  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.785308837890625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.800067901611328  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8010597229003906  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8010597229003906  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8011913299560547  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8160629272460938  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8168468475341797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8168468475341797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.816946029663086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.828847885131836  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8297500610351562  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8297500610351562  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.829854965209961  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8431777954101562  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8440022468566895  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8440022468566895  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8440937995910645  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8563618659973145  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8571619987487793  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8571619987487793  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.857245922088623  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.869079113006592  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.870046615600586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.870046615600586  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8701419830322266  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.884256362915039  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8850760459899902  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8850760459899902  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8851542472839355  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.897275447845459  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8979220390319824  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8979220390319824  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8979811668395996  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.907559871673584  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9083147048950195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9083147048950195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.908379554748535  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.919339179992676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([617, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9341325759887695  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9341325759887695  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.935309410095215  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1449432373046875  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 617, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1047072410583496  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1055545806884766  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1064019203186035  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1055121421813965  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([5684, 40])
input nodes number: 38226
output nodes number: 5684
edges number: 47131
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.105839729309082  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1058402061462402  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06601428985595703  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

pseudo mini batch 14 input nodes size: 97358
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05891132354736328  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05891132354736328  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10578632354736328  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10582876205444336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.061376094818115234  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.061376094818115234  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.061376094818115234  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([97358, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.061376094818115234  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([1628, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20531892776489258  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20531892776489258  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1628, 128]), torch.Size([1, 1628, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20687150955200195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2195591926574707  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1628, 128])
m.shape torch.Size([2108, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2207932472229004  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2207932472229004  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2108, 128]), torch.Size([1, 2108, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22280359268188477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2541928291320801  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2108, 128])
m.shape torch.Size([2158, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2562747001647949  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2562747001647949  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2158, 128]), torch.Size([1, 2158, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25887537002563477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30556535720825195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2158, 128])
m.shape torch.Size([2121, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3085818290710449  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3085818290710449  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3106222152709961  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3707098960876465  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
m.shape torch.Size([2066, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37462425231933594  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37462425231933594  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2066, 128]), torch.Size([1, 2066, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37664079666137695  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45109033584594727  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2066, 128])
m.shape torch.Size([1811, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45528650283813477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45528650283813477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1811, 128]), torch.Size([1, 1811, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4570136070251465  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5339264869689941  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1811, 128])
m.shape torch.Size([1691, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5387072563171387  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5387072563171387  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1691, 128]), torch.Size([1, 1691, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5403199195861816  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6222476959228516  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1691, 128])
m.shape torch.Size([1544, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6273312568664551  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6273312568664551  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1544, 128]), torch.Size([1, 1544, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6288037300109863  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7127346992492676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1544, 128])
m.shape torch.Size([1475, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7183284759521484  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7183284759521484  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1475, 128]), torch.Size([1, 1475, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7197351455688477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8097620010375977  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1475, 128])
m.shape torch.Size([21033, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9093518257141113  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9093518257141113  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 21033, 128]), torch.Size([1, 21033, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.929410457611084  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.380524158477783  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 21033, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2479867935180664  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2838783264160156  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.319769859313965  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.283597469329834  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([37635, 256])
first layer input nodes number: 97358
first layer output nodes number: 37635
edges number: 289792
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.320497512817383  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.356389045715332  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3658909797668457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3658909797668457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([822, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4121766090393066  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4121766090393066  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 822, 256]), torch.Size([1, 822, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4137444496154785  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.426791191101074  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 822, 256])
m.shape torch.Size([766, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4276041984558105  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4276041984558105  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 766, 256]), torch.Size([1, 766, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.429065227508545  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4509806632995605  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 766, 256])
m.shape torch.Size([576, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4519476890563965  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4519476890563965  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4530463218688965  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.479905605316162  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([445, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.481177806854248  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.481177806854248  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4820265769958496  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5073118209838867  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.508708953857422  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.508708953857422  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.509431838989258  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.536888599395752  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.538321018218994  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.538321018218994  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.538914203643799  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.564814567565918  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5662336349487305  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5662336349487305  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5667200088500977  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.591038703918457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5924644470214844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5924644470214844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5928783416748047  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6164703369140625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.617837905883789  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.617837905883789  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.618185043334961  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.640401840209961  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.641756534576416  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.641756534576416  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.642059803009033  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6635918617248535  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.664849281311035  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.664849281311035  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.665093421936035  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.684136390686035  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([107, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.685248851776123  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.685248851776123  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.685452938079834  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7028002738952637  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.704085350036621  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.704085350036621  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7042970657348633  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7237749099731445  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7247724533081055  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7247724533081055  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.724928855895996  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.740412712097168  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7416176795959473  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7416176795959473  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7417874336242676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7597813606262207  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7611608505249023  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7611608505249023  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.761307716369629  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7779035568237305  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.779055595397949  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.779055595397949  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.77919864654541  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7963647842407227  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.79740047454834  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.79740047454834  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.79752254486084  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.81302547454834  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8138961791992188  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8138961791992188  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.813993453979492  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.827028274536133  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.828094959259033  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.828094959259033  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8282055854797363  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.843803882598877  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8446974754333496  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8446974754333496  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.844787120819092  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8580546379089355  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.858877182006836  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.858877182006836  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8589553833007812  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8710765838623047  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.871612548828125  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.871612548828125  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.871662139892578  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8796958923339844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8803863525390625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8803863525390625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8804454803466797  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8904380798339844  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([585, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9044651985168457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9044651985168457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.905580997467041  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.108860969543457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 585, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0686826705932617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0695300102233887  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0703773498535156  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0694875717163086  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([5684, 40])
input nodes number: 37635
output nodes number: 5684
edges number: 46634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0698108673095703  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0698113441467285  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0667872428894043  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

pseudo mini batch 15 input nodes size: 97659
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10543632507324219  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10547876358032227  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05856132507324219  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06110095977783203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06110095977783203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06110095977783203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([97659, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06110095977783203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([1603, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20687341690063477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20687341690063477  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1603, 128]), torch.Size([1, 1603, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20840215682983398  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2210860252380371  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1603, 128])
m.shape torch.Size([2003, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22223186492919922  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22223186492919922  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2003, 128]), torch.Size([1, 2003, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22414207458496094  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2530527114868164  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2003, 128])
m.shape torch.Size([2154, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25517892837524414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25517892837524414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2154, 128]), torch.Size([1, 2154, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25810956954956055  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30414342880249023  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2154, 128])
m.shape torch.Size([2130, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30717897415161133  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30717897415161133  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2130, 128]), torch.Size([1, 2130, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30965375900268555  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37006425857543945  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2130, 128])
m.shape torch.Size([2056, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37340402603149414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37340402603149414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 2056, 128]), torch.Size([1, 2056, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3759627342224121  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44940614700317383  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 2056, 128])
m.shape torch.Size([1820, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45363283157348633  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45363283157348633  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1820, 128]), torch.Size([1, 1820, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4553685188293457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5329594612121582  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1820, 128])
m.shape torch.Size([1694, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5377459526062012  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5377459526062012  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1694, 128]), torch.Size([1, 1694, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5393614768981934  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6208043098449707  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1694, 128])
m.shape torch.Size([1658, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6263213157653809  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6263213157653809  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1658, 128]), torch.Size([1, 1658, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6279025077819824  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.720120906829834  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1658, 128])
m.shape torch.Size([1525, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7262120246887207  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7262120246887207  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 1525, 128]), torch.Size([1, 1525, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7276663780212402  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8207449913024902  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 1525, 128])
m.shape torch.Size([21320, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9216794967651367  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9216794967651367  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 21320, 128]), torch.Size([1, 21320, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9426507949829102  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.396775245666504  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 21320, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.263371467590332  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2995758056640625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.335780143737793  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.29929256439209  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([37963, 256])
first layer input nodes number: 97659
first layer output nodes number: 37963
edges number: 293838
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3365097045898438  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.372714042663574  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3820791244506836  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3820791244506836  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

m.shape torch.Size([831, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.428378105163574  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.428378105163574  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4299631118774414  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.443490982055664  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 831, 256])
m.shape torch.Size([689, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4441380500793457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4441380500793457  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 689, 256]), torch.Size([1, 689, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4454522132873535  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4651646614074707  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 689, 256])
m.shape torch.Size([583, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4662604331970215  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4662604331970215  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.467372417449951  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.492774486541748  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([478, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.494086742401123  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.494086742401123  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4949984550476074  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5227694511413574  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([418, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.524322509765625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.524322509765625  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5251197814941406  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5543575286865234  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.555717945098877  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.555717945098877  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5562996864318848  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5832929611206055  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([230, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.584549903869629  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.584549903869629  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.584988594055176  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6069231033325195  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([229, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6084647178649902  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6084647178649902  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6089015007019043  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.633798122406006  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([203, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.636185646057129  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.636185646057129  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.63657283782959  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.66135311126709  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.662755012512207  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.662755012512207  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.663071632385254  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.685551643371582  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.686915874481201  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.686915874481201  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.687190532684326  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.708613872528076  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7098608016967773  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7098608016967773  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.710089683532715  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7295446395874023  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7305798530578613  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7305798530578613  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.73075532913208  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.746899127960205  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.747699737548828  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.747699737548828  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7478256225585938  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7602882385253906  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7612781524658203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7612781524658203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7614173889160156  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7761764526367188  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.776968002319336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.776968002319336  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7770748138427734  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.789144515991211  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.790055274963379  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.790055274963379  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.790167808532715  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8036718368530273  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8046536445617676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8046536445617676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8047680854797363  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8193020820617676  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8202128410339355  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8202128410339355  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8203139305114746  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.833859920501709  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.834751605987549  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.834751605987549  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8348450660705566  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.848022937774658  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8488645553588867  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8488645553588867  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8489484786987305  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8613691329956055  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.862088680267334  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.862088680267334  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8621573448181152  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.872800350189209  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.873473644256592  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.873473644256592  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.873534679412842  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.883422374725342  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.884415626525879  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.884415626525879  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.88449764251709  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.8983583450317383  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([622, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9132628440856934  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9132628440856934  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

 h.shape torch.Size([1, 622, 256]), torch.Size([1, 622, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9144492149353027  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1246085166931152  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

rst.shape  torch.Size([1, 622, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0843892097473145  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.085236072540283  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.086082935333252  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.085193634033203  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

torch.Size([5681, 40])
input nodes number: 37963
output nodes number: 5681
edges number: 46958
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0855188369750977  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.085519313812256  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06640195846557617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06640195846557617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06640195846557617  GigaBytes
Max Memory Allocated: 3.1732845306396484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024692341685295105 |0.002953141927719116 |0.12299568951129913 |8.982419967651367e-05 |0.07328267395496368 |0.0035123825073242188 |
----------------------------------------------------------pseudo_mini_loss sum 3.0940802097320557
Total (block generation + training)time/epoch 10.141732096672058
Training time/epoch 3.6611318588256836
Training time without block to device /epoch 3.6138815879821777
Training time without total dataloading part /epoch 3.1454033851623535
load block tensor time/epoch 0.3950774669647217
block to device time/epoch 0.04725027084350586
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2164519
Number of first layer input nodes during this epoch:  1560042
Number of first layer output nodes during this epoch:  604477
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
