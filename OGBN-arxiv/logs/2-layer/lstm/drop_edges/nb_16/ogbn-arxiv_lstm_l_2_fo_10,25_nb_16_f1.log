[05:24:31] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27741370 edges into 16 parts and get 6450812 edge cuts
main start at this time 1651555448.0461738
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02741217613220215
global_2_local spend time (sec) 0.036316633224487305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004514217376708984
A = g.adjacency_matrix() spent  0.007849693298339844
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07880830764770508
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2853074073791504
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1718440055847168

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18687042, 2.0: 3216437, 3.0: 806435, 4.0: 243588, 5.0: 87963, 6.0: 38056, 7.0: 17712, 8.0: 9211, 9.0: 5018, 10.0: 2773, 11.0: 1603, 12.0: 931, 13.0: 552, 14.0: 368, 15.0: 239, 16.0: 157, 17.0: 127, 18.0: 78, 19.0: 42, 20.0: 15, 21.0: 7})
Convert a graph into a bidirected graph: 1.106 seconds
Metis partitioning: 5.315 seconds
Split the graph: 0.854 seconds
Construct subgraphs: 0.081 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.369635581970215
5517
5811
5854
5517
5842
5854
5854
5826
5762
5772
5517
5517
5519
5517
5517
5745
total k batches seeds list generation spend  19.462481021881104
after graph partition
graph partition algorithm spend time 19.548606872558594
5517
5811
5854
5517
5842
5854
5854
5826
5762
5772
5517
5517
5519
5517
5517
5745
partition_len_list
[10801, 11302, 12512, 11513, 13777, 13982, 11537, 9461, 10872, 14121, 17947, 24577, 25575, 28949, 27949, 26682]
shared_neighbor_graph_partition_s0 selection method  spend 19.63351058959961
time for parepare:  0.01685953140258789
local_output_nid generation:  0.0011687278747558594
local_in_edges_tensor generation:  0.0013611316680908203
mini_batch_src_global generation:  0.0019354820251464844
r_  generation:  0.01665329933166504
local_output_nid generation:  0.0013675689697265625
local_in_edges_tensor generation:  0.0013799667358398438
mini_batch_src_global generation:  0.002235889434814453
r_  generation:  0.021694660186767578
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0013387203216552734
mini_batch_src_global generation:  0.002154827117919922
r_  generation:  0.017506837844848633
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.0011181831359863281
mini_batch_src_global generation:  0.0013966560363769531
r_  generation:  0.01081538200378418
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0012052059173583984
mini_batch_src_global generation:  0.0014128684997558594
r_  generation:  0.015495061874389648
local_output_nid generation:  0.001514434814453125
local_in_edges_tensor generation:  0.001402139663696289
mini_batch_src_global generation:  0.0015652179718017578
r_  generation:  0.016777515411376953
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0011548995971679688
mini_batch_src_global generation:  0.0013549327850341797
r_  generation:  0.018758296966552734
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.0011012554168701172
mini_batch_src_global generation:  0.001280069351196289
r_  generation:  0.010890483856201172
local_output_nid generation:  0.0014772415161132812
local_in_edges_tensor generation:  0.0010724067687988281
mini_batch_src_global generation:  0.0012202262878417969
r_  generation:  0.010447978973388672
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0010607242584228516
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.01322627067565918
local_output_nid generation:  0.0014071464538574219
local_in_edges_tensor generation:  0.0011153221130371094
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.013616561889648438
local_output_nid generation:  0.0014410018920898438
local_in_edges_tensor generation:  0.0010993480682373047
mini_batch_src_global generation:  0.0016388893127441406
r_  generation:  0.02036142349243164
local_output_nid generation:  0.0020971298217773438
local_in_edges_tensor generation:  0.0023369789123535156
mini_batch_src_global generation:  0.002469778060913086
r_  generation:  0.016338109970092773
local_output_nid generation:  0.0016214847564697266
local_in_edges_tensor generation:  0.001435995101928711
mini_batch_src_global generation:  0.0018384456634521484
r_  generation:  0.020778179168701172
local_output_nid generation:  0.0016446113586425781
local_in_edges_tensor generation:  0.0012607574462890625
mini_batch_src_global generation:  0.002077341079711914
r_  generation:  0.021250486373901367
local_output_nid generation:  0.0017445087432861328
local_in_edges_tensor generation:  0.002519369125366211
mini_batch_src_global generation:  0.002945423126220703
r_  generation:  0.024716615676879883
----------------------check_connections_block total spend ----------------------------- 0.4356076717376709
generate_one_block  0.021887779235839844
generate_one_block  0.023277997970581055
generate_one_block  0.024892330169677734
generate_one_block  0.01567244529724121
generate_one_block  0.023922443389892578
generate_one_block  0.02327585220336914
generate_one_block  0.018934011459350586
generate_one_block  0.016347169876098633
generate_one_block  0.013543844223022461
generate_one_block  0.015984535217285156
generate_one_block  0.01934337615966797
generate_one_block  0.02459239959716797
generate_one_block  0.02189493179321289
generate_one_block  0.029997825622558594
generate_one_block  0.029506683349609375
generate_one_block  0.035364389419555664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.060079336166381836
gen group dst list time:  0.007986307144165039
time for parepare:  0.02334904670715332
local_output_nid generation:  0.0020961761474609375
local_in_edges_tensor generation:  0.01920032501220703
mini_batch_src_global generation:  0.002455472946166992
r_  generation:  0.024317264556884766
local_output_nid generation:  0.0032999515533447266
local_in_edges_tensor generation:  0.0025963783264160156
mini_batch_src_global generation:  0.0030379295349121094
r_  generation:  0.026083946228027344
local_output_nid generation:  0.003473997116088867
local_in_edges_tensor generation:  0.003158092498779297
mini_batch_src_global generation:  0.0025339126586914062
r_  generation:  0.028468608856201172
local_output_nid generation:  0.0032689571380615234
local_in_edges_tensor generation:  0.0024416446685791016
mini_batch_src_global generation:  0.0020287036895751953
r_  generation:  0.02420330047607422
local_output_nid generation:  0.003709077835083008
local_in_edges_tensor generation:  0.0029022693634033203
mini_batch_src_global generation:  0.0029468536376953125
r_  generation:  0.031031370162963867
local_output_nid generation:  0.0063629150390625
local_in_edges_tensor generation:  0.0032646656036376953
mini_batch_src_global generation:  0.003141641616821289
r_  generation:  0.033316612243652344
local_output_nid generation:  0.0033218860626220703
local_in_edges_tensor generation:  0.0025162696838378906
mini_batch_src_global generation:  0.0023708343505859375
r_  generation:  0.024705171585083008
local_output_nid generation:  0.0026655197143554688
local_in_edges_tensor generation:  0.002027273178100586
mini_batch_src_global generation:  0.0016431808471679688
r_  generation:  0.017630577087402344
local_output_nid generation:  0.00307464599609375
local_in_edges_tensor generation:  0.002273082733154297
mini_batch_src_global generation:  0.0016520023345947266
r_  generation:  0.02188849449157715
local_output_nid generation:  0.0036668777465820312
local_in_edges_tensor generation:  0.002933502197265625
mini_batch_src_global generation:  0.002451181411743164
r_  generation:  0.03086400032043457
local_output_nid generation:  0.0045702457427978516
local_in_edges_tensor generation:  0.0038111209869384766
mini_batch_src_global generation:  0.006033182144165039
r_  generation:  0.04384756088256836
local_output_nid generation:  0.0062067508697509766
local_in_edges_tensor generation:  0.007272005081176758
mini_batch_src_global generation:  0.008094549179077148
r_  generation:  0.0673520565032959
local_output_nid generation:  0.006933450698852539
local_in_edges_tensor generation:  0.007562398910522461
mini_batch_src_global generation:  0.009853601455688477
r_  generation:  0.07221126556396484
local_output_nid generation:  0.00738215446472168
local_in_edges_tensor generation:  0.009248495101928711
mini_batch_src_global generation:  0.012993812561035156
r_  generation:  0.08817553520202637
local_output_nid generation:  0.008424997329711914
local_in_edges_tensor generation:  0.017841339111328125
mini_batch_src_global generation:  0.011297225952148438
r_  generation:  0.0832664966583252
local_output_nid generation:  0.006983518600463867
local_in_edges_tensor generation:  0.007369518280029297
mini_batch_src_global generation:  0.009717226028442383
r_  generation:  0.08038473129272461
----------------------check_connections_block total spend ----------------------------- 1.1582188606262207
generate_one_block  0.03878450393676758
generate_one_block  0.03735232353210449
generate_one_block  0.03750205039978027
generate_one_block  0.030477523803710938
generate_one_block  0.0401761531829834
generate_one_block  0.05402207374572754
generate_one_block  0.04324483871459961
generate_one_block  0.021999835968017578
generate_one_block  0.02771472930908203
generate_one_block  0.039357662200927734
generate_one_block  0.05995059013366699
generate_one_block  0.09205055236816406
generate_one_block  0.09769320487976074
generate_one_block  0.11283063888549805
generate_one_block  0.1317753791809082
generate_one_block  0.10056304931640625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.1582188606262207
block generation total time  0.9654951095581055
average batch blocks generation time:  0.06034344434738159
pseudo mini batch 0 input nodes size: 22508
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.01351022720336914  GigaBytes
Max Memory Allocated: 0.01351022720336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.013551712036132812  GigaBytes
Max Memory Allocated: 0.013551712036132812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.013551712036132812  GigaBytes
Max Memory Allocated: 0.013551712036132812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014399528503417969  GigaBytes
Max Memory Allocated: 0.014399528503417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014399528503417969  GigaBytes
Max Memory Allocated: 0.014399528503417969  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014399528503417969  GigaBytes
Max Memory Allocated: 0.014399528503417969  GigaBytes

torch.Size([22508, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014399528503417969  GigaBytes
Max Memory Allocated: 0.014399528503417969  GigaBytes

m.shape torch.Size([968, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.049060821533203125  GigaBytes
Max Memory Allocated: 0.049611568450927734  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.049060821533203125  GigaBytes
Max Memory Allocated: 0.049611568450927734  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 1.2362060546875 GB
    Memory Allocated: 0.049983978271484375  GigaBytes
Max Memory Allocated: 0.049983978271484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.05740976333618164  GigaBytes
Max Memory Allocated: 0.057871341705322266  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([1076, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.05797433853149414  GigaBytes
Max Memory Allocated: 0.0579986572265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.05797433853149414  GigaBytes
Max Memory Allocated: 0.0579986572265625  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.059000492095947266  GigaBytes
Max Memory Allocated: 0.059000492095947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07439279556274414  GigaBytes
Max Memory Allocated: 0.07541894912719727  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([987, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07529163360595703  GigaBytes
Max Memory Allocated: 0.07541894912719727  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07529163360595703  GigaBytes
Max Memory Allocated: 0.07541894912719727  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07623291015625  GigaBytes
Max Memory Allocated: 0.07623291015625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.09694099426269531  GigaBytes
Max Memory Allocated: 0.09835290908813477  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([832, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.09805727005004883  GigaBytes
Max Memory Allocated: 0.09835290908813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.09805727005004883  GigaBytes
Max Memory Allocated: 0.09835290908813477  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.09885072708129883  GigaBytes
Max Memory Allocated: 0.09885072708129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12234926223754883  GigaBytes
Max Memory Allocated: 0.12393617630004883  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([674, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12355947494506836  GigaBytes
Max Memory Allocated: 0.12393617630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12355947494506836  GigaBytes
Max Memory Allocated: 0.12393617630004883  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12420225143432617  GigaBytes
Max Memory Allocated: 0.12420225143432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.14734220504760742  GigaBytes
Max Memory Allocated: 0.14894914627075195  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([607, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1487574577331543  GigaBytes
Max Memory Allocated: 0.14894914627075195  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1487574577331543  GigaBytes
Max Memory Allocated: 0.14894914627075195  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1493363380432129  GigaBytes
Max Memory Allocated: 0.1493363380432129  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.1744551658630371  GigaBytes
Max Memory Allocated: 0.1761918067932129  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([554, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17601490020751953  GigaBytes
Max Memory Allocated: 0.1761918067932129  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17601490020751953  GigaBytes
Max Memory Allocated: 0.1761918067932129  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.1765432357788086  GigaBytes
Max Memory Allocated: 0.1765432357788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.20336103439331055  GigaBytes
Max Memory Allocated: 0.20521020889282227  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([540, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.20515680313110352  GigaBytes
Max Memory Allocated: 0.20521020889282227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.20515680313110352  GigaBytes
Max Memory Allocated: 0.20521020889282227  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.2056717872619629  GigaBytes
Max Memory Allocated: 0.2056717872619629  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.23580408096313477  GigaBytes
Max Memory Allocated: 0.23786401748657227  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([478, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.23759794235229492  GigaBytes
Max Memory Allocated: 0.23786401748657227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.23759794235229492  GigaBytes
Max Memory Allocated: 0.23786401748657227  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.2380537986755371  GigaBytes
Max Memory Allocated: 0.2380537986755371  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.2672286033630371  GigaBytes
Max Memory Allocated: 0.26927995681762695  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([4085, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.286531925201416  GigaBytes
Max Memory Allocated: 0.2869892120361328  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.286531925201416  GigaBytes
Max Memory Allocated: 0.2869892120361328  GigaBytes

 h.shape torch.Size([1, 4085, 128]), torch.Size([1, 4085, 128])
----------------------------------------3
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.29042768478393555  GigaBytes
Max Memory Allocated: 0.29042768478393555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5676560401916504  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

rst.shape  torch.Size([1, 4085, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5373287200927734  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5476293563842773  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5579299926757812  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.547548770904541  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

torch.Size([10801, 256])
first layer input nodes number: 22508
first layer output nodes number: 10801
edges number: 69771
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5580997467041016  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5684003829956055  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.5709757804870605  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.5709757804870605  GigaBytes
Max Memory Allocated: 0.5871872901916504  GigaBytes

m.shape torch.Size([733, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6140837669372559  GigaBytes
Max Memory Allocated: 0.6140866279602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6140837669372559  GigaBytes
Max Memory Allocated: 0.6140866279602051  GigaBytes

 h.shape torch.Size([1, 733, 256]), torch.Size([1, 733, 256])
----------------------------------------3
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.6154818534851074  GigaBytes
Max Memory Allocated: 0.6154818534851074  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6266665458679199  GigaBytes
Max Memory Allocated: 0.6273655891418457  GigaBytes

rst.shape  torch.Size([1, 733, 256])
m.shape torch.Size([720, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6273965835571289  GigaBytes
Max Memory Allocated: 0.6274023056030273  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6273965835571289  GigaBytes
Max Memory Allocated: 0.6274023056030273  GigaBytes

 h.shape torch.Size([1, 720, 256]), torch.Size([1, 720, 256])
----------------------------------------3
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6287698745727539  GigaBytes
Max Memory Allocated: 0.6287698745727539  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.6493692398071289  GigaBytes
Max Memory Allocated: 0.6514301300048828  GigaBytes

rst.shape  torch.Size([1, 720, 256])
m.shape torch.Size([587, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.6507568359375  GigaBytes
Max Memory Allocated: 0.6514301300048828  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.6507568359375  GigaBytes
Max Memory Allocated: 0.6514301300048828  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.6518764495849609  GigaBytes
Max Memory Allocated: 0.6518764495849609  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6768007278442383  GigaBytes
Max Memory Allocated: 0.6784801483154297  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6779980659484863  GigaBytes
Max Memory Allocated: 0.6784801483154297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6779980659484863  GigaBytes
Max Memory Allocated: 0.6784801483154297  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6788697242736816  GigaBytes
Max Memory Allocated: 0.6788697242736816  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7045025825500488  GigaBytes
Max Memory Allocated: 0.7062458992004395  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([357, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.705782413482666  GigaBytes
Max Memory Allocated: 0.7062458992004395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.705782413482666  GigaBytes
Max Memory Allocated: 0.7062458992004395  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7064633369445801  GigaBytes
Max Memory Allocated: 0.7064633369445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.7317113876342773  GigaBytes
Max Memory Allocated: 0.7334136962890625  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.7331414222717285  GigaBytes
Max Memory Allocated: 0.7334136962890625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.7331414222717285  GigaBytes
Max Memory Allocated: 0.7334136962890625  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.733726978302002  GigaBytes
Max Memory Allocated: 0.733726978302002  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7596845626831055  GigaBytes
Max Memory Allocated: 0.7614412307739258  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7610468864440918  GigaBytes
Max Memory Allocated: 0.7614412307739258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7610468864440918  GigaBytes
Max Memory Allocated: 0.7614412307739258  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7615160942077637  GigaBytes
Max Memory Allocated: 0.7615160942077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.7849764823913574  GigaBytes
Max Memory Allocated: 0.786618709564209  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.7865414619445801  GigaBytes
Max Memory Allocated: 0.786618709564209  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.7865414619445801  GigaBytes
Max Memory Allocated: 0.786618709564209  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.7869877815246582  GigaBytes
Max Memory Allocated: 0.7869877815246582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0194091796875 GB
    Memory Allocated: 0.8124279975891113  GigaBytes
Max Memory Allocated: 0.8142132759094238  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([215, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0194091796875 GB
    Memory Allocated: 0.8140649795532227  GigaBytes
Max Memory Allocated: 0.8142132759094238  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0194091796875 GB
    Memory Allocated: 0.8140649795532227  GigaBytes
Max Memory Allocated: 0.8142132759094238  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 2.0194091796875 GB
    Memory Allocated: 0.8144750595092773  GigaBytes
Max Memory Allocated: 0.8144750595092773  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0467529296875 GB
    Memory Allocated: 0.8407201766967773  GigaBytes
Max Memory Allocated: 0.8425655364990234  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0467529296875 GB
    Memory Allocated: 0.8419380187988281  GigaBytes
Max Memory Allocated: 0.8425655364990234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0467529296875 GB
    Memory Allocated: 0.8419380187988281  GigaBytes
Max Memory Allocated: 0.8425655364990234  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.0467529296875 GB
    Memory Allocated: 0.8422203063964844  GigaBytes
Max Memory Allocated: 0.8425655364990234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8622627258300781  GigaBytes
Max Memory Allocated: 0.8636741638183594  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([175, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8639721870422363  GigaBytes
Max Memory Allocated: 0.8639798164367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8639721870422363  GigaBytes
Max Memory Allocated: 0.8639798164367676  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8643059730529785  GigaBytes
Max Memory Allocated: 0.8643059730529785  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8903412818908691  GigaBytes
Max Memory Allocated: 0.8921771049499512  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([153, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8919391632080078  GigaBytes
Max Memory Allocated: 0.8921771049499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8919391632080078  GigaBytes
Max Memory Allocated: 0.8921771049499512  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8922309875488281  GigaBytes
Max Memory Allocated: 0.8922309875488281  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.9170360565185547  GigaBytes
Max Memory Allocated: 0.9187870025634766  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.9182772636413574  GigaBytes
Max Memory Allocated: 0.9187870025634766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.9182772636413574  GigaBytes
Max Memory Allocated: 0.9187870025634766  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.9184889793395996  GigaBytes
Max Memory Allocated: 0.9187870025634766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.9379668235778809  GigaBytes
Max Memory Allocated: 0.9393429756164551  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.9392738342285156  GigaBytes
Max Memory Allocated: 0.9393429756164551  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.9392738342285156  GigaBytes
Max Memory Allocated: 0.9393429756164551  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.9394741058349609  GigaBytes
Max Memory Allocated: 0.9394741058349609  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9593009948730469  GigaBytes
Max Memory Allocated: 0.9607028961181641  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9602713584899902  GigaBytes
Max Memory Allocated: 0.9607028961181641  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9602713584899902  GigaBytes
Max Memory Allocated: 0.9607028961181641  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9604086875915527  GigaBytes
Max Memory Allocated: 0.9607028961181641  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9749655723571777  GigaBytes
Max Memory Allocated: 0.9760756492614746  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9760580062866211  GigaBytes
Max Memory Allocated: 0.9760756492614746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9760580062866211  GigaBytes
Max Memory Allocated: 0.9760756492614746  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9761991500854492  GigaBytes
Max Memory Allocated: 0.9761991500854492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.9921483993530273  GigaBytes
Max Memory Allocated: 0.9933004379272461  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.9931964874267578  GigaBytes
Max Memory Allocated: 0.9933004379272461  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.9931964874267578  GigaBytes
Max Memory Allocated: 0.9933004379272461  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.9933204650878906  GigaBytes
Max Memory Allocated: 0.9933204650878906  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 1.0081977844238281  GigaBytes
Max Memory Allocated: 1.0093154907226562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 1.0092625617980957  GigaBytes
Max Memory Allocated: 1.0093154907226562  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 1.0092625617980957  GigaBytes
Max Memory Allocated: 1.0093154907226562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 1.0093865394592285  GigaBytes
Max Memory Allocated: 1.0093865394592285  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 1.0251317024230957  GigaBytes
Max Memory Allocated: 1.0262837409973145  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 1.0260376930236816  GigaBytes
Max Memory Allocated: 1.0262837409973145  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 1.0260376930236816  GigaBytes
Max Memory Allocated: 1.0262837409973145  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 1.0261387825012207  GigaBytes
Max Memory Allocated: 1.0262837409973145  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 1.039684772491455  GigaBytes
Max Memory Allocated: 1.0406451225280762  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 1.0407943725585938  GigaBytes
Max Memory Allocated: 1.0407986640930176  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 1.0407943725585938  GigaBytes
Max Memory Allocated: 1.0407986640930176  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 1.0408954620361328  GigaBytes
Max Memory Allocated: 1.0408954620361328  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0551490783691406  GigaBytes
Max Memory Allocated: 1.0563011169433594  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0562591552734375  GigaBytes
Max Memory Allocated: 1.0563011169433594  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0562591552734375  GigaBytes
Max Memory Allocated: 1.0563011169433594  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0563621520996094  GigaBytes
Max Memory Allocated: 1.0563621520996094  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0716056823730469  GigaBytes
Max Memory Allocated: 1.0726871490478516  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0725483894348145  GigaBytes
Max Memory Allocated: 1.0726871490478516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0725483894348145  GigaBytes
Max Memory Allocated: 1.0726871490478516  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0726380348205566  GigaBytes
Max Memory Allocated: 1.0726871490478516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2908935546875 GB
    Memory Allocated: 1.0865330696105957  GigaBytes
Max Memory Allocated: 1.0875334739685059  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2928466796875 GB
    Memory Allocated: 1.0873947143554688  GigaBytes
Max Memory Allocated: 1.0875334739685059  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2928466796875 GB
    Memory Allocated: 1.0873947143554688  GigaBytes
Max Memory Allocated: 1.0875334739685059  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2928466796875 GB
    Memory Allocated: 1.087472915649414  GigaBytes
Max Memory Allocated: 1.0875334739685059  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 1.1001415252685547  GigaBytes
Max Memory Allocated: 1.1010408401489258  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 1.100794792175293  GigaBytes
Max Memory Allocated: 1.1010408401489258  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 1.100794792175293  GigaBytes
Max Memory Allocated: 1.1010408401489258  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 1.1008520126342773  GigaBytes
Max Memory Allocated: 1.1010408401489258  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 1.1105222702026367  GigaBytes
Max Memory Allocated: 1.1112089157104492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([415, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 1.1204657554626465  GigaBytes
Max Memory Allocated: 1.1205048561096191  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 1.1204657554626465  GigaBytes
Max Memory Allocated: 1.1205048561096191  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 1.1212573051452637  GigaBytes
Max Memory Allocated: 1.1212573051452637  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.2637667655944824  GigaBytes
Max Memory Allocated: 1.2736611366271973  GigaBytes

rst.shape  torch.Size([1, 415, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.2266602516174316  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.227482795715332  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.2283053398132324  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.2274413108825684  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

torch.Size([5517, 40])
input nodes number: 10801
output nodes number: 5517
edges number: 43884
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.2283859252929688  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.2283868789672852  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.01964569091796875  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

pseudo mini batch 1 input nodes size: 21370
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.017150402069091797  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.017150402069091797  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.027340412139892578  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.027383804321289062  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.016609668731689453  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.01757192611694336  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.01757192611694336  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.01757192611694336  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

torch.Size([21370, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.01757192611694336  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

m.shape torch.Size([765, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.055747032165527344  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.055747032165527344  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.056476593017578125  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.06238269805908203  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([922, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.0628972053527832  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.0628972053527832  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.06377649307250977  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.0769658088684082  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([870, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.07801055908203125  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.07801055908203125  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.07884025573730469  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.09719657897949219  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([879, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.09845829010009766  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.09845829010009766  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.09929656982421875  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.12360668182373047  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([764, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.12500905990600586  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.12500905990600586  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.12573766708374023  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.15196752548217773  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([735, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.15370607376098633  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.15370607376098633  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.15440702438354492  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.18476629257202148  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([619, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.18648195266723633  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.18648195266723633  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.1870722770690918  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.21773624420166016  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.21959638595581055  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.21959638595581055  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.22013521194458008  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.2515730857849121  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([457, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.2532649040222168  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.2532649040222168  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.25370073318481445  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.28159379959106445  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([4726, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.3039112091064453  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.3039112091064453  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 4726, 128]), torch.Size([1, 4726, 128])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.30841827392578125  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6284198760986328  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 4726, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.5945324897766113  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6053109169006348  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6160893440246582  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6052265167236328  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

torch.Size([11302, 256])
first layer input nodes number: 21370
first layer output nodes number: 11302
edges number: 77191
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6162505149841309  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6270289421081543  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6303925514221191  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.6303925514221191  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

m.shape torch.Size([565, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.6809148788452148  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.6809148788452148  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.6819925308227539  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.6908102035522461  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([578, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.6915874481201172  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.6915874481201172  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.6926898956298828  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7092266082763672  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([508, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7101898193359375  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7101898193359375  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7111587524414062  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7329254150390625  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([477, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7342748641967773  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7342748641967773  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7351846694946289  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7624311447143555  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 477, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7639083862304688  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7639083862304688  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7646751403808594  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.792637825012207  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([390, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7949347496032715  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7949347496032715  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.7956786155700684  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.827908992767334  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([318, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.829676628112793  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.829676628112793  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8302831649780273  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8609590530395508  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([269, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8627243041992188  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8627243041992188  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8632373809814453  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8931369781494141  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([227, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8948440551757812  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8948440551757812  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.8952770233154297  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9229869842529297  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([231, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9249911308288574  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9249911308288574  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9254317283630371  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9567141532897949  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([210, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.958714485168457  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.958714485168457  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9591150283813477  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9903573989868164  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([151, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9918990135192871  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9918990135192871  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.9921870231628418  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0166678428649902  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([158, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.018498420715332  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.018498420715332  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0187997817993164  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.046525001525879  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([125, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0480566024780273  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0480566024780273  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.048295021057129  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0718984603881836  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0730481147766113  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0730481147766113  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0732159614562988  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0910077095031738  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([98, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0924310684204102  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0924310684204102  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.0926179885864258  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1137399673461914  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([103, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1153297424316406  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1153297424316406  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1155261993408203  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1391010284423828  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([86, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.140491008758545  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.140491008758545  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1406550407409668  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.161487102508545  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1625785827636719  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1625785827636719  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1626968383789062  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1785430908203125  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([79, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1800026893615723  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1800026893615723  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.1801533699035645  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.201399326324463  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.20257568359375  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.20257568359375  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2026939392089844  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2201957702636719  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2210040092468262  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2210040092468262  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2210822105407715  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.233203411102295  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.234048843383789  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.234048843383789  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2341251373291016  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2464847564697266  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2475757598876953  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2475757598876953  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 1.2476654052734375  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.2628154754638672  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([496, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.274688720703125  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.274688720703125  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.275634765625  GigaBytes
Max Memory Allocated: 1.2791738510131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.44435453414917  GigaBytes
Max Memory Allocated: 1.4561800956726074  GigaBytes

rst.shape  torch.Size([1, 496, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.3999390602111816  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.4008049964904785  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 1.4016709327697754  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 1.400761604309082  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

torch.Size([5811, 40])
input nodes number: 11302
output nodes number: 5811
edges number: 51757
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 1.400932788848877  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 1.4009332656860352  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.019442081451416016  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

pseudo mini batch 2 input nodes size: 21733
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.016653060913085938  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.016653060913085938  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.027016162872314453  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.02706003189086914  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.016826629638671875  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.017850875854492188  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.017850875854492188  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.017850875854492188  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

torch.Size([21733, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.017850875854492188  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

m.shape torch.Size([924, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.0599675178527832  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.0599675178527832  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.06084871292114258  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.06853437423706055  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([1019, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.06906557083129883  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.06906557083129883  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.0700373649597168  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.08503389358520508  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([1016, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.08600139617919922  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.08600139617919922  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.08697032928466797  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.10885143280029297  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([891, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.11006641387939453  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.11006641387939453  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.1109161376953125  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.1355581283569336  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([861, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.13718605041503906  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.13718605041503906  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.13800716400146484  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.16810846328735352  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([747, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.16983509063720703  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.16983509063720703  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.1705474853515625  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.20122241973876953  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([700, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.2032027244567871  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.2032027244567871  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.20387029647827148  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.23847484588623047  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([603, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.24044132232666016  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.24044132232666016  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.24101638793945312  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.2743692398071289  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.27628326416015625  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.27628326416015625  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.27677249908447266  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.3096632957458496  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([5238, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.3343954086303711  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.3343954086303711  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 5238, 128]), torch.Size([1, 5238, 128])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.33939075469970703  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.694880485534668  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 5238, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.6575407981872559  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.6694731712341309  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.6814055442810059  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.669379711151123  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

torch.Size([12512, 256])
first layer input nodes number: 21733
first layer output nodes number: 12512
edges number: 85082
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.6815695762634277  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.6935019493103027  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.6970763206481934  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.6970763206481934  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

m.shape torch.Size([671, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7491278648376465  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7491278648376465  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 671, 256]), torch.Size([1, 671, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7504076957702637  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7606463432312012  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 671, 256])
m.shape torch.Size([610, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.761939525604248  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.761939525604248  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7631030082702637  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7807879447937012  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([574, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7822666168212891  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7822666168212891  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.7833614349365234  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8087368011474609  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([425, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8102498054504395  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8102498054504395  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8110604286193848  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8358473777770996  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([404, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8373837471008301  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8373837471008301  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8381543159484863  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8664822578430176  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([324, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8679656982421875  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8679656982421875  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8685836791992188  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8972549438476562  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([304, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8990869522094727  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8990869522094727  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.8996667861938477  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.929234504699707  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([242, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9308056831359863  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9308056831359863  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.931267261505127  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9575772285461426  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([228, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9593191146850586  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9593191146850586  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9597539901733398  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9875860214233398  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([195, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9892430305480957  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9892430305480957  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.9896149635314941  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0160222053527832  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([193, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0178771018981934  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0178771018981934  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0182452201843262  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0469584465026855  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([143, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0484237670898438  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0484237670898438  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.048696517944336  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0718803405761719  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0732808113098145  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0732808113098145  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0735154151916504  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0950989723205566  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([123, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.097489356994629  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.097489356994629  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.0977239608764648  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1209497451782227  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([121, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.12257719039917  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.12257719039917  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1228079795837402  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1472716331481934  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([100, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1486940383911133  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1486940383911133  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1488847732543945  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1704378128051758  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([102, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1720094680786133  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1720094680786133  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1722040176391602  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1955499649047852  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1966466903686523  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1966466903686523  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.1967782974243164  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2134923934936523  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.214533805847168  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.214533805847168  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.214644432067871  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2294683456420898  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([71, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2307782173156738  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2307782173156738  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2309136390686035  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2500081062316895  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2510509490966797  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2510509490966797  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2511558532714844  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2666816711425781  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2674331665039062  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2674331665039062  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2675056457519531  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2787399291992188  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.279726505279541  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.279726505279541  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2798142433166504  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2940278053283691  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.294999122619629  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.294999122619629  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.2950830459594727  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.3092660903930664  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([591, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.3234248161315918  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.3234248161315918  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.324552059173584  GigaBytes
Max Memory Allocated: 1.4605274200439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.525763988494873  GigaBytes
Max Memory Allocated: 1.5398545265197754  GigaBytes

rst.shape  torch.Size([1, 591, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.4798765182495117  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.4807491302490234  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.4816217422485352  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.4807052612304688  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([5854, 40])
input nodes number: 12512
output nodes number: 5854
edges number: 52296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.480849266052246  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.4808497428894043  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01978015899658203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

pseudo mini batch 3 input nodes size: 22974
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01683330535888672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01683330535888672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.02855205535888672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.02859354019165039  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.018186569213867188  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01891326904296875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01891326904296875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01891326904296875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([22974, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01891326904296875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

m.shape torch.Size([1507, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.05145978927612305  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.05145978927612305  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1507, 128]), torch.Size([1, 1507, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.052896976470947266  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.06439447402954102  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1507, 128])
m.shape torch.Size([1424, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.06505107879638672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.06505107879638672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1424, 128]), torch.Size([1, 1424, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.06640911102294922  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.08817195892333984  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1424, 128])
m.shape torch.Size([1290, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.08933830261230469  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.08933830261230469  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.09056854248046875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.11809635162353516  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1031, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.11944770812988281  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.11944770812988281  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.12043094635009766  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.14978981018066406  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([838, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.15129613876342773  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.15129613876342773  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.15209531784057617  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.18215608596801758  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([719, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.18381357192993164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.18381357192993164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.18449926376342773  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.21398401260375977  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([550, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.21547698974609375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.21547698974609375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2160015106201172  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.24225330352783203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.24393272399902344  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.24393272399902344  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.24441814422607422  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.27208709716796875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([409, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.27359962463378906  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.27359962463378906  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2739896774291992  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2989530563354492  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([3236, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.31418848037719727  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.31418848037719727  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 3236, 128]), torch.Size([1, 3236, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.31743431091308594  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5365467071533203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 3236, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5093636512756348  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5203433036804199  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5313229560852051  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5202574729919434  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([11513, 256])
first layer input nodes number: 22974
first layer output nodes number: 11513
edges number: 64816
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5314960479736328  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.542475700378418  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5452208518981934  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5452208518981934  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

m.shape torch.Size([1114, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.578857421875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.578857421875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1114, 256]), torch.Size([1, 1114, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5809822082519531  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5980329513549805  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1114, 256])
m.shape torch.Size([860, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5991606712341309  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.5991606712341309  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 860, 256]), torch.Size([1, 860, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6008009910583496  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6254057884216309  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 860, 256])
m.shape torch.Size([699, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6266012191772461  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6266012191772461  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.627934455871582  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6587533950805664  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([522, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6600937843322754  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6600937843322754  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6610894203186035  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6908974647521973  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([395, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6924047470092773  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6924047470092773  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6931581497192383  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7212982177734375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7226862907409668  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7226862907409668  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7232699394226074  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7484397888183594  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([229, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7496891021728516  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7496891021728516  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7501258850097656  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7719650268554688  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([206, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7733306884765625  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7733306884765625  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7737236022949219  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7961196899414062  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([156, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7972726821899414  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7972726821899414  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7975702285766602  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8166131973266602  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([143, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8178391456604004  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8178391456604004  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8181118965148926  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8374772071838379  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8384060859680176  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8384060859680176  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.838594913482666  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8533234596252441  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([103, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.854494571685791  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.854494571685791  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8546910285949707  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8713898658752441  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8722290992736816  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8722290992736816  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8723721504211426  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8855328559875488  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.886390209197998  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.886390209197998  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8865218162536621  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8995509147644043  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.900364875793457  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.900364875793457  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9004812240600586  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9128141403198242  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9132790565490723  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9132790565490723  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9133439064025879  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9206719398498535  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9213747978210449  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9213747978210449  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9214606285095215  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.931760311126709  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9322018623352051  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9322018623352051  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9322552680969238  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9390377998352051  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.939577579498291  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.939577579498291  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9396367073059082  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9475598335266113  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9481649398803711  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9481649398803711  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9482278823852539  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9571027755737305  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9577980041503906  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9577980041503906  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9578666687011719  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9680290222167969  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9683966636657715  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9683966636657715  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9684329032897949  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9740500450134277  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.974452018737793  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.974452018737793  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9744882583618164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9803590774536133  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9806408882141113  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9806408882141113  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9806656837463379  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.984856128692627  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([222, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.990178108215332  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.990178108215332  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9906015396118164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0651254653930664  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 222, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0389323234558105  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.039754867553711  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0405774116516113  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0397133827209473  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([5517, 40])
input nodes number: 11513
output nodes number: 5517
edges number: 32631
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0397906303405762  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0397911071777344  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.020324230194091797  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

pseudo mini batch 4 input nodes size: 29844
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01813650131225586  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.01813650131225586  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.03236722946166992  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.03241109848022461  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.020650863647460938  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.021643638610839844  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.021643638610839844  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.021643638610839844  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([29844, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.021643638610839844  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

m.shape torch.Size([1260, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.06533050537109375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.06533050537109375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1260, 128]), torch.Size([1, 1260, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.06653213500976562  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.07663917541503906  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1260, 128])
m.shape torch.Size([1388, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.077362060546875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.077362060546875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1388, 128]), torch.Size([1, 1388, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.07868576049804688  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.09859085083007812  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1388, 128])
m.shape torch.Size([1234, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.09969425201416016  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.09969425201416016  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1234, 128]), torch.Size([1, 1234, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.10087108612060547  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.12676143646240234  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1234, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.1284770965576172  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.1284770965576172  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.12952423095703125  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.16057395935058594  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([950, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.16231536865234375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.16231536865234375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.1632213592529297  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.19699478149414062  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([836, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.19893360137939453  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.19893360137939453  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.19973087310791016  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.23451709747314453  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([712, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2364950180053711  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2364950180053711  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.23717403411865234  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2718687057495117  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([701, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2742033004760742  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2742033004760742  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.274871826171875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.31441402435302734  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([578, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3165602684020996  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3165602684020996  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3171114921569824  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3531794548034668  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([5020, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.37684106826782227  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.37684106826782227  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 5020, 128]), torch.Size([1, 5020, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.38162851333618164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7283997535705566  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 5020, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.6904020309448242  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7035408020019531  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.716679573059082  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7034378051757812  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([13777, 256])
first layer input nodes number: 29844
first layer output nodes number: 13777
edges number: 87890
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7169041633605957  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7300429344177246  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7333278656005859  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7333278656005859  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

m.shape torch.Size([845, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7779192924499512  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7779192924499512  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7795310020446777  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7924246788024902  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([757, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7932744026184082  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7932744026184082  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7947182655334473  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8171586990356445  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([602, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8181729316711426  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8181729316711426  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8193211555480957  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8447442054748535  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([518, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8461618423461914  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8461618423461914  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8471498489379883  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8759465217590332  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([404, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8773941993713379  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8773941993713379  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8781647682189941  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9063286781311035  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([326, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9078235626220703  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9078235626220703  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9084453582763672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9359488487243652  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([253, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.937340259552002  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.937340259552002  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9378228187561035  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9619507789611816  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([268, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9637703895568848  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9637703895568848  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9642815589904785  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9944310188293457  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([190, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.995819091796875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.995819091796875  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9961814880371094  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0193748474121094  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0208277702331543  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0208277702331543  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0211520195007324  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0441737174987793  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([149, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0455870628356934  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0455870628356934  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0458712577819824  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0680384635925293  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.069465160369873  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.069465160369873  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0697245597839355  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.091773509979248  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0930185317993164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0930185317993164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0932283401489258  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1125307083129883  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1138525009155273  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1138525009155273  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1140546798706055  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1340703964233398  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1353678703308105  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1353678703308105  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1355528831481934  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1551642417907715  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1561331748962402  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1561331748962402  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1562647819519043  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1711363792419434  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.172067642211914  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.172067642211914  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1721839904785156  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1861457824707031  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1873159408569336  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1873159408569336  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1874513626098633  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2046499252319336  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2056965827941895  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2056965827941895  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.205812931060791  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2214035987854004  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2222490310668945  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2222490310668945  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2223386764526367  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2349786758422852  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2359027862548828  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2359027862548828  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2359943389892578  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2495441436767578  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2503867149353027  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2503867149353027  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2504668235778809  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2628836631774902  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2638607025146484  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2638607025146484  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2639484405517578  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2781620025634766  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2788562774658203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2788562774658203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2789173126220703  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2892322540283203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([434, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2996301651000977  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2996301651000977  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3004579544067383  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.4461488723754883  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 434, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.4079747200012207  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.4088454246520996  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.4097161293029785  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.408801555633545  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([5842, 40])
input nodes number: 13777
output nodes number: 5842
edges number: 45304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.40899658203125  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.4089970588684082  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.023619651794433594  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

pseudo mini batch 5 input nodes size: 32334
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.020699024200439453  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.020699024200439453  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.0361170768737793  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.036160945892333984  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.021886348724365234  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.022980213165283203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.022980213165283203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.022980213165283203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([32334, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.022980213165283203  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

m.shape torch.Size([1048, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.07050657272338867  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.07050657272338867  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.07150602340698242  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.07961702346801758  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([1095, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.08016157150268555  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.08016157150268555  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.08120584487915039  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.09686994552612305  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1095, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.09830522537231445  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.09830522537231445  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.0993494987487793  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.12232351303100586  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([995, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.12369918823242188  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.12369918823242188  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 995, 128]), torch.Size([1, 995, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.1246480941772461  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.15271949768066406  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 995, 128])
m.shape torch.Size([939, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.15448379516601562  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.15448379516601562  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.1553792953491211  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.18847036361694336  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([787, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.19027423858642578  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.19027423858642578  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.1910247802734375  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.22331523895263672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([727, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.22536659240722656  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.22536659240722656  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.2260599136352539  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.26084423065185547  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([679, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.26308774948120117  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.26308774948120117  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.263735294342041  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3006587028503418  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([602, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3029184341430664  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3029184341430664  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.30349254608154297  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3410325050354004  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([6015, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3694272041320801  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3694272041320801  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 6015, 128]), torch.Size([1, 6015, 128])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.3759016990661621  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7837800979614258  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 6015, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7415299415588379  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7548642158508301  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7681984901428223  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7547597885131836  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

torch.Size([13982, 256])
first layer input nodes number: 32334
first layer output nodes number: 13982
edges number: 96009
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7684416770935059  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.781775951385498  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7851095199584961  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.7851095199584961  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

m.shape torch.Size([718, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.834653377532959  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.834653377532959  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8360228538513184  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8469786643981934  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([630, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8475146293640137  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8475146293640137  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8487162590026855  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8682408332824707  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([543, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.869509220123291  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.869509220123291  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8705449104309082  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8955874443054199  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([475, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8968958854675293  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8968958854675293  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.8978018760681152  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9265074729919434  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([417, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9280586242675781  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9280586242675781  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9288539886474609  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9576969146728516  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9591965675354004  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9591965675354004  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9598240852355957  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9882855415344238  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([294, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9899501800537109  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9899501800537109  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9905109405517578  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.019052505493164  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([270, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0212392807006836  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0212392807006836  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.021754264831543  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0520057678222656  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([214, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0535998344421387  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0535998344421387  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0540080070495605  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0801310539245605  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([206, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0819072723388672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0819072723388672  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.0823001861572266  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1101970672607422  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1115655899047852  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1115655899047852  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1118478775024414  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.133866310119629  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([156, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1355247497558594  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1355247497558594  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1358222961425781  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1611137390136719  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([137, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1626768112182617  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1626768112182617  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.162938117980957  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1869783401489258  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1884355545043945  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1884355545043945  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.1886606216430664  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.210942268371582  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2124590873718262  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2124590873718262  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.212674617767334  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.235520839691162  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([82, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2366743087768555  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2366743087768555  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.236830711364746  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2545042037963867  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.255880355834961  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.255880355834961  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2560501098632812  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2764205932617188  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.277425765991211  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.277425765991211  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2775459289550781  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.292806625366211  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2937512397766113  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.2937512397766113  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.293856143951416  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3079133033752441  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([62, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3090529441833496  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3090529441833496  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.309171199798584  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3258452415466309  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3267755508422852  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3267755508422852  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.326869010925293  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3407011032104492  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3416695594787598  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3416695594787598  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3417611122131348  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3559517860412598  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3565692901611328  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3565692901611328  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3566265106201172  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.365896224975586  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.366652011871338  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.366652011871338  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3667168617248535  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3776764869689941  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([574, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3914365768432617  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.3914365768432617  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.392531394958496  GigaBytes
Max Memory Allocated: 1.5419702529907227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.5860586166381836  GigaBytes
Max Memory Allocated: 1.5997438430786133  GigaBytes

rst.shape  torch.Size([1, 574, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.543321132659912  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.5441937446594238  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.5450663566589355  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.5441498756408691  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([5854, 40])
input nodes number: 13982
output nodes number: 5854
edges number: 50583
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.5443000793457031  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.5443005561828613  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.025074481964111328  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

pseudo mini batch 6 input nodes size: 21105
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.021888256072998047  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.021888256072998047  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.031951904296875  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.03199577331542969  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.016533851623535156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.017348289489746094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.017348289489746094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.017348289489746094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([21105, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.017348289489746094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1220, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.05115699768066406  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.05115699768066406  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1220, 128]), torch.Size([1, 1220, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.05232048034667969  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.062172889709472656  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1220, 128])
m.shape torch.Size([1347, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06324625015258789  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06324625015258789  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1347, 128]), torch.Size([1, 1347, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06453084945678711  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.08379983901977539  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1347, 128])
m.shape torch.Size([1185, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.0850839614868164  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.0850839614868164  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1185, 128]), torch.Size([1, 1185, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.08621406555175781  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11107635498046875  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1185, 128])
m.shape torch.Size([1062, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11253690719604492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11253690719604492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11354970932006836  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.14292097091674805  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([926, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1446223258972168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1446223258972168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.14550542831420898  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17753076553344727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([756, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17925214767456055  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17925214767456055  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17997312545776367  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.21104764938354492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([640, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.21282339096069336  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.21282339096069336  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.21343374252319336  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.24459218978881836  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([580, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.24649953842163086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.24649953842163086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.24705266952514648  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.27976369857788086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([507, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2816629409790039  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2816629409790039  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2821464538574219  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3130912780761719  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([3314, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.32865190505981445  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.32865190505981445  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 3314, 128]), torch.Size([1, 3314, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3323807716369629  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5643577575683594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 3314, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5352039337158203  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5462064743041992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5572090148925781  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5461201667785645  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([11537, 256])
first layer input nodes number: 21105
first layer output nodes number: 11537
edges number: 67706
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.557368278503418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5683708190917969  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5711216926574707  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5711216926574707  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([817, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.612022876739502  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.612022876739502  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6135811805725098  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6263289451599121  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 817, 256])
m.shape torch.Size([790, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6278572082519531  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6278572082519531  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.629364013671875  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6519660949707031  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([624, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6537284851074219  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6537284851074219  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6549186706542969  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6815938949584961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([533, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6830482482910156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6830482482910156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6840648651123047  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7140846252441406  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([429, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7156381607055664  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7156381607055664  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.716456413269043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7462902069091797  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([366, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7479920387268066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7479920387268066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.748690128326416  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.779541015625  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([318, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7813315391540527  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7813315391540527  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7819380760192871  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8131709098815918  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([265, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8149056434631348  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8149056434631348  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8154110908508301  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8455319404602051  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([240, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8473553657531738  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8473553657531738  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8478131294250488  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8771100044250488  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([199, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8787941932678223  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8787941932678223  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.879173755645752  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9061226844787598  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([163, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9076566696166992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9076566696166992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9079675674438477  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9322175979614258  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9334812164306641  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9334812164306641  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9337158203125  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9536571502685547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9549770355224609  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9549770355224609  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9551963806152344  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9753761291503906  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9765582084655762  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9765582084655762  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9767413139343262  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9948687553405762  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9961757659912109  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9961757659912109  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9963607788085938  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0159721374511719  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0170793533325195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0170793533325195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.017228126525879  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0340394973754883  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0347824096679688  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0347824096679688  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0348777770996094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0463218688964844  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0470528602600098  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0470528602600098  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0471386909484863  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0580391883850098  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0590190887451172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0590190887451172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0591259002685547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0734386444091797  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0742888450622559  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0742888450622559  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.074378490447998  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0870184898376465  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0875592231750488  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0875592231750488  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0876145362854004  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0958008766174316  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0964922904968262  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0964922904968262  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0965571403503418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1066088676452637  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1071734428405762  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1071734428405762  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.107224941253662  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.115567684173584  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.116072654724121  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.116072654724121  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1161165237426758  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.123530387878418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.130476951599121  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.130476951599121  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1310300827026367  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.2318191528320312  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1974291801452637  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1983017921447754  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.199174404144287  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1982579231262207  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([5854, 40])
input nodes number: 11537
output nodes number: 5854
edges number: 41493
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1983880996704102  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1983885765075684  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.018955230712890625  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

pseudo mini batch 7 input nodes size: 15088
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.016533851623535156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.016533851623535156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.023728370666503906  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.023772239685058594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.013664722442626953  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.014249324798583984  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.014249324798583984  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.014249324798583984  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([15088, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.014249324798583984  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1494, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.03756093978881836  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.03756093978881836  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.0389857292175293  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.0503840446472168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1492, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.0513463020324707  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.0513463020324707  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1492, 128]), torch.Size([1, 1492, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.05276918411254883  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07477617263793945  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1492, 128])
m.shape torch.Size([1212, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07579851150512695  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07579851150512695  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1212, 128]), torch.Size([1, 1212, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07695436477661133  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.10238313674926758  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1212, 128])
m.shape torch.Size([949, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1040811538696289  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1040811538696289  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.10498619079589844  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.13196468353271484  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([800, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.13341951370239258  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.13341951370239258  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.13418245315551758  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.16173982620239258  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([628, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.16315507888793945  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.16315507888793945  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.16375398635864258  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.19016695022583008  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([502, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1915431022644043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1915431022644043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.19202184677124023  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2159590721130371  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([382, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2171769142150879  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2171769142150879  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.21754121780395508  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.23830652236938477  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([341, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.23958778381347656  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.23958778381347656  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2399129867553711  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2607259750366211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([1661, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.26848363876342773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.26848363876342773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2700676918029785  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3851485252380371  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3667874336242676  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3758101463317871  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.38483285903930664  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.37573957443237305  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([9461, 256])
first layer input nodes number: 15088
first layer output nodes number: 9461
edges number: 45927
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3849472999572754  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3939700126647949  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3962259292602539  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3962259292602539  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1092, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4291682243347168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4291682243347168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1092, 256]), torch.Size([1, 1092, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.43169546127319336  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4501528739929199  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1092, 256])
m.shape torch.Size([949, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.45120859146118164  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.45120859146118164  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 949, 256]), torch.Size([1, 949, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4530186653137207  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4802670478820801  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 949, 256])
m.shape torch.Size([739, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4814929962158203  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4814929962158203  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.48290252685546875  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5148305892944336  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([544, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.516758918762207  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.516758918762207  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.517796516418457  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5479974746704102  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([482, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5497951507568359  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5497951507568359  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5507144927978516  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5838108062744141  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([354, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.585392951965332  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.585392951965332  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5860681533813477  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6161413192749023  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([290, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6177549362182617  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6177549362182617  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6183080673217773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6466455459594727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([213, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6480069160461426  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6480069160461426  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6484131813049316  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6715703010559082  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6729764938354492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6729764938354492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6733312606811523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6960363388061523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.697291374206543  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.697291374206543  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.697575569152832  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7177534103393555  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7192344665527344  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7192344665527344  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7194480895996094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7361106872558594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7373075485229492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7373075485229492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.737523078918457  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7558431625366211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7566976547241211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7566976547241211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7568445205688477  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7703561782836914  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.771399974822998  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.771399974822998  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7715582847595215  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7872309684753418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7880458831787109  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7880458831787109  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7881641387939453  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8006992340087891  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8014092445373535  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8014092445373535  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8015046119689941  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8122811317443848  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8130016326904297  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8130016326904297  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8130912780761719  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8238487243652344  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8244094848632812  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8244094848632812  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8244762420654297  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8329544067382812  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.833432674407959  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.833432674407959  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8334860801696777  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8406424522399902  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8410005569458008  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8410005569458008  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.841038703918457  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8464174270629883  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8469233512878418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8469233512878418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8469729423522949  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8543124198913574  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8546895980834961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8546895980834961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8547258377075195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8603429794311523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8606348037719727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8606348037719727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.860661506652832  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8649873733520508  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.865412712097168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.865412712097168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8654489517211914  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8715734481811523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([123, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8745112419128418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8745112419128418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8747458457946777  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9160361289978027  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 123, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8903789520263672  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8912472724914551  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.892115592956543  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8912034034729004  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([5826, 40])
input nodes number: 9461
output nodes number: 5826
edges number: 32474
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8913135528564453  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8913140296936035  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.015461921691894531  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

pseudo mini batch 8 input nodes size: 23249
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.013660430908203125  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.013660430908203125  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.025379180908203125  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.02542257308959961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.018184185028076172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.018851757049560547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.018851757049560547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.018851757049560547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([23249, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.018851757049560547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1456, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.04814291000366211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.04814291000366211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1456, 128]), torch.Size([1, 1456, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.04953145980834961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06063985824584961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1456, 128])
m.shape torch.Size([1540, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.061797142028808594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.061797142028808594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1540, 128]), torch.Size([1, 1540, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06326580047607422  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.08542537689208984  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1540, 128])
m.shape torch.Size([1264, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.08649921417236328  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.08649921417236328  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1264, 128]), torch.Size([1, 1264, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.08770465850830078  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11446857452392578  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1264, 128])
m.shape torch.Size([1042, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11585330963134766  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11585330963134766  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.11684703826904297  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.14566516876220703  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([867, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.14723539352416992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.14723539352416992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.14806222915649414  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1787405014038086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([639, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.18015527725219727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.18015527725219727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.18076467514038086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2077326774597168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([583, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.20937395095825195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.20937395095825195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2099299430847168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.23842144012451172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([477, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.23996305465698242  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.23996305465698242  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2404179573059082  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.26634740829467773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([405, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.26785802841186523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.26785802841186523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.26824426651000977  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.29296350479125977  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([2599, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3051633834838867  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3051633834838867  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 2599, 128]), torch.Size([1, 2599, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.30764198303222656  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.49109601974487305  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 2599, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4661388397216797  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.47650718688964844  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4868755340576172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4764261245727539  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([10872, 256])
first layer input nodes number: 23249
first layer output nodes number: 10872
edges number: 58197
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.48705101013183594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.4974193572998047  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5008397102355957  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5008397102355957  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1098, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.532318115234375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.532318115234375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1098, 256]), torch.Size([1, 1098, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5344123840332031  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5528240203857422  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1098, 256])
m.shape torch.Size([967, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5538344383239746  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5538344383239746  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 967, 256]), torch.Size([1, 967, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5556788444519043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5833449363708496  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 967, 256])
m.shape torch.Size([736, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5845451354980469  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5845451354980469  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 736, 256]), torch.Size([1, 736, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.5859489440917969  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6168327331542969  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 736, 256])
m.shape torch.Size([600, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6184377670288086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6184377670288086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6195821762084961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6527700424194336  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([470, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.654456615447998  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.654456615447998  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6553530693054199  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6887898445129395  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6901469230651855  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6901469230651855  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6907439231872559  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7184634208679199  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([263, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7199344635009766  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7199344635009766  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7204360961914062  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7463006973266602  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7476415634155273  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7476415634155273  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7480363845825195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7705411911010742  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7719788551330566  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7719788551330566  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7723393440246582  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7954106330871582  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7968645095825195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7968645095825195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7971887588500977  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8202104568481445  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8212113380432129  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8212113380432129  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8214211463928223  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8377861976623535  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8385348320007324  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8385348320007324  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8386759757995605  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8506731986999512  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.851564884185791  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.851564884185791  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8517117500305176  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8652234077453613  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8659710884094238  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8659710884094238  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8660874366760254  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8776059150695801  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.878413200378418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.878413200378418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8785276412963867  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8906583786010742  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.891355037689209  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.891355037689209  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8914484977722168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9020094871520996  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9025673866271973  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9025673866271973  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9026379585266113  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9111065864562988  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9118156433105469  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9118156433105469  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9118976593017578  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9223136901855469  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9226746559143066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9226746559143066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9227166175842285  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9283394813537598  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9287800788879395  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9287800788879395  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.928825855255127  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9352803230285645  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9356613159179688  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9356613159179688  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.935699462890625  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.94134521484375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9415802955627441  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9415802955627441  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9416031837463379  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9451508522033691  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9454050064086914  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9454050064086914  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9454278945922852  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9491357803344727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.949378490447998  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.949378490447998  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.949399471282959  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9529452323913574  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9562268257141113  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9562268257141113  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9564881324768066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0024781227111816  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.977813720703125  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9786725044250488  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9795312881469727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9786291122436523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([5762, 40])
input nodes number: 10872
output nodes number: 5762
edges number: 31353
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9787440299987793  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9787445068359375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.02022552490234375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

pseudo mini batch 9 input nodes size: 31219
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.01817464828491211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.01817464828491211  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.03306102752685547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.03310441970825195  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.02134227752685547  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.022243499755859375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.022243499755859375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.022243499755859375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([31219, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.022243499755859375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1518, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06409120559692383  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06409120559692383  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.06553888320922852  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07722854614257812  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([1587, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07825422286987305  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07825422286987305  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1587, 128]), torch.Size([1, 1587, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.07976770401000977  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.10246992111206055  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1587, 128])
m.shape torch.Size([1425, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.10435104370117188  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.10435104370117188  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1425, 128]), torch.Size([1, 1425, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.10571002960205078  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.13619709014892578  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1425, 128])
m.shape torch.Size([1263, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.13792657852172852  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.13792657852172852  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1263, 128]), torch.Size([1, 1263, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.1391310691833496  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17432069778442383  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1263, 128])
m.shape torch.Size([1113, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17637205123901367  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17637205123901367  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.17743349075317383  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.21607065200805664  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([909, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2181406021118164  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2181406021118164  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2190074920654297  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.2572917938232422  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([790, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.25949525833129883  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.25949525833129883  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.26024866104125977  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.29823827743530273  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([685, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3004746437072754  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.3004746437072754  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.30112791061401367  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.33890771865844727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([545, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.34091997146606445  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.34091997146606445  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.34143972396850586  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.37616395950317383  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([4286, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.39634132385253906  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.39634132385253906  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 4286, 128]), torch.Size([1, 4286, 128])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.40042877197265625  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6911487579345703  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 4286, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6556029319763184  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.669069766998291  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6825366020202637  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6689643859863281  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([14121, 256])
first layer input nodes number: 31219
first layer output nodes number: 14121
edges number: 83813
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6827712059020996  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.6962380409240723  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7003254890441895  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7003254890441895  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([998, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7370834350585938  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7370834350585938  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7389869689941406  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7550835609436035  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([831, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.756401538848877  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.756401538848877  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7579865455627441  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.781761646270752  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 831, 256])
m.shape torch.Size([690, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7832422256469727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7832422256469727  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 690, 256]), torch.Size([1, 690, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.7845582962036133  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.814429759979248  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 690, 256])
m.shape torch.Size([511, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.816157341003418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.816157341003418  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8171319961547852  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8454351425170898  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([492, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8473124504089355  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8473124504089355  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8482508659362793  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8821825981140137  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([343, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8836917877197266  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8836917877197266  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.8843460083007812  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9124774932861328  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9140076637268066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9140076637268066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9145340919494629  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9424500465393066  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9439864158630371  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9439864158630371  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9444327354431152  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9698729515075684  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([190, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9712934494018555  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9712934494018555  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9716558456420898  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9948492050170898  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9962058067321777  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9962058067321777  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.9965109825134277  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0181784629821777  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0191679000854492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0191679000854492  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.019373893737793  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0354413986206055  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.036642074584961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.036642074584961  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0368576049804688  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0551776885986328  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0572643280029297  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0572643280029297  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0574665069580078  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0760669708251953  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.077042579650879  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.077042579650879  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.077195167541504  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.092301368713379  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0931477546691895  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0931477546691895  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.0932698249816895  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1062092781066895  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.106917381286621  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.106917381286621  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1070127487182617  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1177892684936523  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1185426712036133  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1185426712036133  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.118636131286621  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1298513412475586  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.130704402923584  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.130704402923584  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1308035850524902  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.143399715423584  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1440258026123047  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1440258026123047  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1440963745117188  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1535530090332031  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1541714668273926  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1541714668273926  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1542363166809082  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1633801460266113  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1637110710144043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1637110710144043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.163745403289795  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1688265800476074  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1692538261413574  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1692538261413574  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1692938804626465  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1755023002624512  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1759910583496094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1759910583496094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.176034927368164  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1831417083740234  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1836967468261719  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1836967468261719  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1837444305419922  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.191802978515625  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([267, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.198194980621338  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.198194980621338  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.1987042427062988  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.289597988128662  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.259434700012207  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.2602949142456055  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.261155128479004  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.260251522064209  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([5772, 40])
input nodes number: 14121
output nodes number: 5772
edges number: 37004
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.260401725769043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.2604022026062012  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.02403736114501953  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

pseudo mini batch 10 input nodes size: 40740
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.021343708038330078  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.021343708038330078  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.04087495803833008  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.04091644287109375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.025986671447753906  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.027219772338867188  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.027219772338867188  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.027219772338867188  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([40740, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 0.027219772338867188  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1474, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.09009456634521484  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.09009456634521484  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.09150028228759766  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.10274600982666016  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([1473, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.10344791412353516  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.10344791412353516  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.10485267639160156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.1264047622680664  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1200, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.12758207321166992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.12758207321166992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.12872648239135742  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.15390348434448242  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1057, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.15534734725952148  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.15534734725952148  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.1563553810119629  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.18558835983276367  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([978, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.18741607666015625  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.18741607666015625  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.18834877014160156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.22280311584472656  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([863, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.2248058319091797  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.2248058319091797  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.22562885284423828  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.2617988586425781  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([771, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.2639608383178711  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.2639608383178711  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.2646961212158203  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.30194854736328125  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([747, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.3044304847717285  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.3044304847717285  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.305142879486084  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.346621036529541  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([659, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.349092960357666  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.349092960357666  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.34972143173217773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.3907504081726074  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([8725, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.4320402145385742  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.4320402145385742  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 8725, 128]), torch.Size([1, 8725, 128])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.44036102294921875  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0323705673217773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 8725, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.9750208854675293  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.9921364784240723  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0092520713806152  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.9920024871826172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

torch.Size([17947, 256])
first layer input nodes number: 40740
first layer output nodes number: 17947
edges number: 126870
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0095577239990234  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0266733169555664  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0309524536132812  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0309524536132812  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

m.shape torch.Size([1039, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.069176197052002  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.069176197052002  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 1039, 256]), torch.Size([1, 1039, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0713162422180176  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0888781547546387  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 1039, 256])
m.shape torch.Size([857, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0888910293579102  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0888910293579102  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.0905256271362305  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.115248680114746  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([571, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1163430213928223  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1163430213928223  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1174321174621582  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.147794246673584  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([419, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1488609313964844  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1488609313964844  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1496601104736328  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1728363037109375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([384, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1742820739746094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1742820739746094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.1750144958496094  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2018184661865234  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2032227516174316  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2032227516174316  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.203808307647705  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.231757640838623  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2331337928771973  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2331337928771973  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2336068153381348  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2572579383850098  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([229, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2587823867797852  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2587823867797852  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2592191696166992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2841157913208008  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2853336334228516  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2853336334228516  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.2856502532958984  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3059139251708984  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([136, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.307063102722168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.307063102722168  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3073225021362305  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.325739860534668  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3269634246826172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3269634246826172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3272075653076172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3462505340576172  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([93, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3472013473510742  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3472013473510742  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3473787307739258  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3624563217163086  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3632550239562988  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3632550239562988  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3633904457092285  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3758492469787598  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3765082359313965  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3765082359313965  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3766112327575684  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.386807918548584  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3875064849853516  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3875064849853516  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3876056671142578  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3981189727783203  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3988075256347656  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3988075256347656  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.3988990783691406  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4092445373535156  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4099340438842773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4099340438842773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.410019874572754  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4203195571899414  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4210381507873535  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4210381507873535  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4211220741271973  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4317803382873535  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4326882362365723  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4326882362365723  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4327874183654785  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.446077823638916  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.446835994720459  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.446835994720459  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.446916103363037  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4582114219665527  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4588580131530762  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4588580131530762  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4589228630065918  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4685206413269043  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4691228866577148  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4691228866577148  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4691801071166992  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4780492782592773  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4783525466918945  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4783525466918945  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4783811569213867  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.483016014099121  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4836249351501465  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4836249351501465  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4836764335632324  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.4923796653747559  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([426, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.5025901794433594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.5025901794433594  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 1.5034027099609375  GigaBytes
Max Memory Allocated: 1.6028738021850586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.6475830078125  GigaBytes
Max Memory Allocated: 1.6577396392822266  GigaBytes

rst.shape  torch.Size([1, 426, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.6156225204467773  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.6164450645446777  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.6172676086425781  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.616403579711914  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

torch.Size([5517, 40])
input nodes number: 17947
output nodes number: 5517
edges number: 38479
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.6165413856506348  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.616541862487793  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.02947092056274414  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

pseudo mini batch 11 input nodes size: 56920
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.02594900131225586  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.02594900131225586  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.053090572357177734  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.053132057189941406  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.033559322357177734  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.03535604476928711  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.03535604476928711  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.03535604476928711  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

torch.Size([56920, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 0.03535604476928711  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

m.shape torch.Size([1330, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13013219833374023  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13013219833374023  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 1330, 128]), torch.Size([1, 1330, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13140058517456055  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1419520378112793  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 1330, 128])
m.shape torch.Size([1533, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.14277982711791992  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.14277982711791992  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 1533, 128]), torch.Size([1, 1533, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1442418098449707  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.16617155075073242  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 1533, 128])
m.shape torch.Size([1309, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1673130989074707  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1673130989074707  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 1309, 128]), torch.Size([1, 1309, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.16856145858764648  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19602537155151367  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 1309, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19754695892333984  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19754695892333984  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19861984252929688  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.22973346710205078  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1136, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.23190546035766602  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.23190546035766602  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.23298883438110352  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2720208168029785  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([945, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2741827964782715  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2741827964782715  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2750840187072754  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3146347999572754  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([896, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.31717491149902344  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.31717491149902344  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.31802940368652344  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.36239051818847656  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([901, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3654003143310547  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3654003143310547  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3662595748901367  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.41651153564453125  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([816, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.419583797454834  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.419583797454834  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.4203619956970215  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.4718756675720215  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([14586, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1854248046875 GB
    Memory Allocated: 0.5417990684509277  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1854248046875 GB
    Memory Allocated: 0.5417990684509277  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 14586, 128]), torch.Size([1, 14586, 128])
----------------------------------------3
 Nvidia-smi: 3.1854248046875 GB
    Memory Allocated: 0.5557093620300293  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5433402061462402  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 14586, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.4567012786865234  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.4801397323608398  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5035781860351562  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.4799561500549316  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

torch.Size([24577, 256])
first layer input nodes number: 56920
first layer output nodes number: 24577
edges number: 190857
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5040044784545898  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5274429321289062  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5333027839660645  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8416748046875 GB
    Memory Allocated: 1.5333027839660645  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

m.shape torch.Size([844, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.582542896270752  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.582542896270752  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 844, 256]), torch.Size([1, 844, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5841526985168457  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5970311164855957  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 844, 256])
m.shape torch.Size([782, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5977449417114258  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5977449417114258  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5992364883422852  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6216096878051758  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 782, 256])
m.shape torch.Size([559, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6225628852844238  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6225628852844238  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.623629093170166  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6503520011901855  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([393, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6517829895019531  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6517829895019531  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6525325775146484  GigaBytes
Max Memory Allocated: 1.6629810333251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6751937866210938  GigaBytes
Max Memory Allocated: 1.6766929626464844  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([348, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6764917373657227  GigaBytes
Max Memory Allocated: 1.6766929626464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6764917373657227  GigaBytes
Max Memory Allocated: 1.6766929626464844  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6771554946899414  GigaBytes
Max Memory Allocated: 1.6771554946899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.703282356262207  GigaBytes
Max Memory Allocated: 1.704941749572754  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([229, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.704437255859375  GigaBytes
Max Memory Allocated: 1.704941749572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.704437255859375  GigaBytes
Max Memory Allocated: 1.704941749572754  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.704874038696289  GigaBytes
Max Memory Allocated: 1.704941749572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7236557006835938  GigaBytes
Max Memory Allocated: 1.7251319885253906  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([198, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.724924087524414  GigaBytes
Max Memory Allocated: 1.7251319885253906  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.724924087524414  GigaBytes
Max Memory Allocated: 1.7251319885253906  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.725301742553711  GigaBytes
Max Memory Allocated: 1.725301742553711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7441844940185547  GigaBytes
Max Memory Allocated: 1.7456607818603516  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([163, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7454819679260254  GigaBytes
Max Memory Allocated: 1.7456607818603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7454819679260254  GigaBytes
Max Memory Allocated: 1.7456607818603516  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7457928657531738  GigaBytes
Max Memory Allocated: 1.7457928657531738  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7635140419006348  GigaBytes
Max Memory Allocated: 1.7649903297424316  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([138, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.76460599899292  GigaBytes
Max Memory Allocated: 1.7649903297424316  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.76460599899292  GigaBytes
Max Memory Allocated: 1.7649903297424316  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.764869213104248  GigaBytes
Max Memory Allocated: 1.7649903297424316  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.781714916229248  GigaBytes
Max Memory Allocated: 1.7829527854919434  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7828302383422852  GigaBytes
Max Memory Allocated: 1.7829527854919434  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7828302383422852  GigaBytes
Max Memory Allocated: 1.7829527854919434  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7830591201782227  GigaBytes
Max Memory Allocated: 1.7830591201782227  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7993097305297852  GigaBytes
Max Memory Allocated: 1.8005475997924805  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([111, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8004426956176758  GigaBytes
Max Memory Allocated: 1.8005475997924805  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8004426956176758  GigaBytes
Max Memory Allocated: 1.8005475997924805  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.800654411315918  GigaBytes
Max Memory Allocated: 1.800654411315918  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8171682357788086  GigaBytes
Max Memory Allocated: 1.8186445236206055  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8185482025146484  GigaBytes
Max Memory Allocated: 1.8186445236206055  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8185482025146484  GigaBytes
Max Memory Allocated: 1.8186445236206055  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8187503814697266  GigaBytes
Max Memory Allocated: 1.8187503814697266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8359355926513672  GigaBytes
Max Memory Allocated: 1.837411880493164  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([85, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8369174003601074  GigaBytes
Max Memory Allocated: 1.837411880493164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8369174003601074  GigaBytes
Max Memory Allocated: 1.837411880493164  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8370795249938965  GigaBytes
Max Memory Allocated: 1.837411880493164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8519949913024902  GigaBytes
Max Memory Allocated: 1.853471279144287  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8527617454528809  GigaBytes
Max Memory Allocated: 1.853471279144287  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8527617454528809  GigaBytes
Max Memory Allocated: 1.853471279144287  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.852881908416748  GigaBytes
Max Memory Allocated: 1.853471279144287  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8647780418395996  GigaBytes
Max Memory Allocated: 1.86561918258667  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8654966354370117  GigaBytes
Max Memory Allocated: 1.86561918258667  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8654966354370117  GigaBytes
Max Memory Allocated: 1.86561918258667  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8655996322631836  GigaBytes
Max Memory Allocated: 1.86561918258667  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8765172958374023  GigaBytes
Max Memory Allocated: 1.8772897720336914  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8773579597473145  GigaBytes
Max Memory Allocated: 1.87736177444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8773579597473145  GigaBytes
Max Memory Allocated: 1.87736177444458  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8774685859680176  GigaBytes
Max Memory Allocated: 1.8774685859680176  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8899693489074707  GigaBytes
Max Memory Allocated: 1.8908543586730957  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8907151222229004  GigaBytes
Max Memory Allocated: 1.8908543586730957  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8907151222229004  GigaBytes
Max Memory Allocated: 1.8908543586730957  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8908085823059082  GigaBytes
Max Memory Allocated: 1.8908543586730957  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9020237922668457  GigaBytes
Max Memory Allocated: 1.902818202972412  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9029459953308105  GigaBytes
Max Memory Allocated: 1.9029498100280762  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9029459953308105  GigaBytes
Max Memory Allocated: 1.9029498100280762  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.903052806854248  GigaBytes
Max Memory Allocated: 1.903052806854248  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9166178703308105  GigaBytes
Max Memory Allocated: 1.917579174041748  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9175701141357422  GigaBytes
Max Memory Allocated: 1.917579174041748  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9175701141357422  GigaBytes
Max Memory Allocated: 1.917579174041748  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.917673110961914  GigaBytes
Max Memory Allocated: 1.917673110961914  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9314746856689453  GigaBytes
Max Memory Allocated: 1.9325237274169922  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9322309494018555  GigaBytes
Max Memory Allocated: 1.9325237274169922  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9322309494018555  GigaBytes
Max Memory Allocated: 1.9325237274169922  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9323110580444336  GigaBytes
Max Memory Allocated: 1.9325237274169922  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9436063766479492  GigaBytes
Max Memory Allocated: 1.9444074630737305  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9441518783569336  GigaBytes
Max Memory Allocated: 1.9444074630737305  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9441518783569336  GigaBytes
Max Memory Allocated: 1.9444074630737305  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9442071914672852  GigaBytes
Max Memory Allocated: 1.9444074630737305  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9523935317993164  GigaBytes
Max Memory Allocated: 1.9529743194580078  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.95306396484375  GigaBytes
Max Memory Allocated: 1.9530668258666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.95306396484375  GigaBytes
Max Memory Allocated: 1.9530668258666992  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9531269073486328  GigaBytes
Max Memory Allocated: 1.9531269073486328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9628829956054688  GigaBytes
Max Memory Allocated: 1.9635753631591797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9634041786193848  GigaBytes
Max Memory Allocated: 1.9635753631591797  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9634041786193848  GigaBytes
Max Memory Allocated: 1.9635753631591797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.963451862335205  GigaBytes
Max Memory Allocated: 1.9635753631591797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9711766242980957  GigaBytes
Max Memory Allocated: 1.9717249870300293  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9719371795654297  GigaBytes
Max Memory Allocated: 1.971940517425537  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9719371795654297  GigaBytes
Max Memory Allocated: 1.971940517425537  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9720020294189453  GigaBytes
Max Memory Allocated: 1.9720020294189453  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.982961654663086  GigaBytes
Max Memory Allocated: 1.9837398529052734  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([944, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.006065845489502  GigaBytes
Max Memory Allocated: 2.0061540603637695  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.006065845489502  GigaBytes
Max Memory Allocated: 2.0061540603637695  GigaBytes

 h.shape torch.Size([1, 944, 256]), torch.Size([1, 944, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.007866382598877  GigaBytes
Max Memory Allocated: 2.007866382598877  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.324760913848877  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 944, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2811713218688965  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.281993865966797  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2828164100646973  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.281952381134033  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

torch.Size([5517, 40])
input nodes number: 24577
output nodes number: 5517
edges number: 50154
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.282177448272705  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2821779251098633  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03856468200683594  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

pseudo mini batch 12 input nodes size: 65732
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.033559322357177734  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.033559322357177734  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06490278244018555  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.06494426727294922  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03776121139526367  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03952646255493164  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03952646255493164  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03952646255493164  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

torch.Size([65732, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.03952646255493164  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

m.shape torch.Size([1589, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.13522577285766602  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.13522577285766602  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1589, 128]), torch.Size([1, 1589, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.13674116134643555  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.1488642692565918  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1589, 128])
m.shape torch.Size([1652, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.14968204498291016  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.14968204498291016  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1652, 128]), torch.Size([1, 1652, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.15125751495361328  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.17488956451416016  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1652, 128])
m.shape torch.Size([1534, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.17636775970458984  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.17636775970458984  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1534, 128]), torch.Size([1, 1534, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.17783069610595703  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.21003055572509766  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1534, 128])
m.shape torch.Size([1322, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.2118206024169922  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.2118206024169922  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1322, 128]), torch.Size([1, 1322, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.21308135986328125  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.2499065399169922  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1322, 128])
m.shape torch.Size([1171, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.25206804275512695  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.25206804275512695  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1171, 128]), torch.Size([1, 1171, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.25318479537963867  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.294158935546875  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1171, 128])
m.shape torch.Size([1047, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.29659605026245117  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.29659605026245117  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.2975945472717285  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.340853214263916  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([951, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.34352827072143555  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.34352827072143555  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.3444352149963379  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.3898491859436035  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([904, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.39284420013427734  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.39284420013427734  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.3937063217163086  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.4436178207397461  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([800, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.44661998748779297  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.44661998748779297  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.44738292694091797  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.4971590042114258  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([14605, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.5670900344848633  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.5670900344848633  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 14605, 128]), torch.Size([1, 14605, 128])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.5810184478759766  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5702710151672363  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 14605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.4828557968139648  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5072460174560547  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5316362380981445  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5070552825927734  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

torch.Size([25575, 256])
first layer input nodes number: 65732
first layer output nodes number: 25575
edges number: 194059
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5321283340454102  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5565185546875  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5634827613830566  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.5634827613830566  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

m.shape torch.Size([948, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6056060791015625  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6056060791015625  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 948, 256]), torch.Size([1, 948, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6074142456054688  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6218795776367188  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 948, 256])
m.shape torch.Size([812, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6229743957519531  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6229743957519531  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6245231628417969  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6477546691894531  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([621, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6489810943603516  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6489810943603516  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6501655578613281  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.676905632019043  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([462, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.678196907043457  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.678196907043457  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.6790781021118164  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7048568725585938  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([350, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7060985565185547  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7060985565185547  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.706766128540039  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7323246002197266  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([265, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7335190773010254  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7335190773010254  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7340245246887207  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7599272727966309  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([202, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7610340118408203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7610340118408203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7614192962646484  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7806835174560547  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7826452255249023  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.7826452255249023  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.783034324645996  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8052129745483398  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([150, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8063163757324219  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8063163757324219  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8066024780273438  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8249130249023438  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([135, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8260679244995117  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8260679244995117  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8263254165649414  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8446073532104492  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([102, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8455572128295898  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8455572128295898  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8457517623901367  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.860926628112793  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([87, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.861833095550537  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.861833095550537  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8619990348815918  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8761038780212402  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8769583702087402  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8769583702087402  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8771014213562012  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8902621269226074  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.891092300415039  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.891092300415039  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.8912200927734375  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9038715362548828  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9049034118652344  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9049034118652344  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9050483703613281  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9204139709472656  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.921095371246338  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.921095371246338  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9211888313293457  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9317498207092285  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9326019287109375  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9326019287109375  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9327068328857422  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9452953338623047  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9459872245788574  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9459872245788574  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9460692405700684  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9564852714538574  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9573941230773926  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9573941230773926  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9574933052062988  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9707837104797363  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9715418815612793  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9715418815612793  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9716219902038574  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.982917308807373  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.98368501663208  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.98368501663208  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9837613105773926  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9950528144836426  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9954590797424316  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9954590797424316  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 1.9954991340637207  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0017075538635254  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.002373218536377  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.002373218536377  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.002432346343994  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0120110511779785  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0127196311950684  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0127196311950684  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0127806663513184  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0230956077575684  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([598, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0374341011047363  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.0374341011047363  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.038574695587158  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.240147113800049  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 598, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.2040505409240723  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.2048730850219727  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.205695629119873  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.204831600189209  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

torch.Size([5519, 40])
input nodes number: 25575
output nodes number: 5519
edges number: 42642
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.205063819885254  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.205064296722412  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.04273509979248047  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

pseudo mini batch 13 input nodes size: 61697
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.03776121139526367  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.03776121139526367  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.06718063354492188  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.06722211837768555  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.03583717346191406  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.03805828094482422  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.03805828094482422  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.03805828094482422  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

torch.Size([61697, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 0.03805828094482422  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

m.shape torch.Size([1158, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.15516138076782227  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.15516138076782227  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.1562657356262207  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.1651005744934082  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([1273, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.16586780548095703  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.16586780548095703  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1273, 128]), torch.Size([1, 1273, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.1670818328857422  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.18529224395751953  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1273, 128])
m.shape torch.Size([1189, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.18691110610961914  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.18691110610961914  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1189, 128]), torch.Size([1, 1189, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.18804502487182617  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.21337080001831055  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1189, 128])
m.shape torch.Size([1064, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.21497058868408203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.21497058868408203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.21598529815673828  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.24626827239990234  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1106, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.2483978271484375  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.2483978271484375  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.2494525909423828  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.2875223159790039  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1074, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.2900676727294922  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.2900676727294922  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.2910919189453125  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.3358116149902344  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1031, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.33874082565307617  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.33874082565307617  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.339724063873291  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.38924407958984375  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([949, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.39237260818481445  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.39237260818481445  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.393277645111084  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.4456925392150879  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([941, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.4492783546447754  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.4492783546447754  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 941, 128]), torch.Size([1, 941, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.45017576217651367  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.5076098442077637  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 941, 128])
m.shape torch.Size([19164, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.5989580154418945  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.5989580154418945  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 19164, 128]), torch.Size([1, 19164, 128])
----------------------------------------3
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.6172342300415039  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9237565994262695  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 19164, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8141884803771973  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8417963981628418  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8694043159484863  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8415803909301758  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

torch.Size([28949, 256])
first layer input nodes number: 61697
first layer output nodes number: 28949
edges number: 238419
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8698663711547852  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8974742889404297  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.90437650680542  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.90437650680542  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

m.shape torch.Size([692, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9625053405761719  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9625053405761719  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 692, 256]), torch.Size([1, 692, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9638252258300781  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9753799438476562  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 692, 256])
m.shape torch.Size([593, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9758634567260742  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9758634567260742  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 593, 256]), torch.Size([1, 593, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.976994514465332  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9952821731567383  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 593, 256])
m.shape torch.Size([438, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9959816932678223  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9959816932678223  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9968171119689941  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.015410900115967  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([340, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0164341926574707  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0164341926574707  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.017082691192627  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.036863327026367  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([293, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.037947177886963  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.037947177886963  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.038506031036377  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0602545738220215  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([245, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0613880157470703  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0613880157470703  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0618553161621094  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.081949234008789  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([205, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.083095073699951  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.083095073699951  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0834860801696777  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.103036403656006  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([172, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.104261875152588  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.104261875152588  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1045899391174316  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1232895851135254  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([155, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1244664192199707  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1244664192199707  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1247620582580566  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1436829566955566  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([134, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1448230743408203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1448230743408203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.145078659057617  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1632251739501953  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1644721031188965  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1644721031188965  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.164720058441162  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.184060573577881  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1852283477783203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1852283477783203  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1854419708251953  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2035999298095703  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2048301696777344  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2048301696777344  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2050342559814453  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2238101959228516  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2249999046325684  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2249999046325684  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2251830101013184  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2433104515075684  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2445168495178223  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2445168495178223  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2446885108947754  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2628846168518066  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([94, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.264244556427002  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.264244556427002  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2644238471984863  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2846837043762207  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2866482734680176  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2866482734680176  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2867817878723145  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3028035163879395  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([85, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3042073249816895  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3042073249816895  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3043694496154785  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3249592781066895  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3259925842285156  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3259925842285156  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.326108932495117  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3416996002197266  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.342794895172119  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.342794895172119  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.342909336090088  GigaBytes
Max Memory Allocated: 2.347721576690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3590455055236816  GigaBytes
Max Memory Allocated: 2.360189914703369  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([70, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.360401153564453  GigaBytes
Max Memory Allocated: 2.3604068756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.360401153564453  GigaBytes
Max Memory Allocated: 2.3604068756103516  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.36053466796875  GigaBytes
Max Memory Allocated: 2.36053466796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3802947998046875  GigaBytes
Max Memory Allocated: 2.3816967010498047  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3813247680664062  GigaBytes
Max Memory Allocated: 2.3816967010498047  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3813247680664062  GigaBytes
Max Memory Allocated: 2.3816967010498047  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3814163208007812  GigaBytes
Max Memory Allocated: 2.3816967010498047  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3956069946289062  GigaBytes
Max Memory Allocated: 2.3967018127441406  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3964457511901855  GigaBytes
Max Memory Allocated: 2.3967018127441406  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3964457511901855  GigaBytes
Max Memory Allocated: 2.3967018127441406  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.396522045135498  GigaBytes
Max Memory Allocated: 2.3967018127441406  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.408881664276123  GigaBytes
Max Memory Allocated: 2.409759044647217  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.4098124504089355  GigaBytes
Max Memory Allocated: 2.409816265106201  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.4098124504089355  GigaBytes
Max Memory Allocated: 2.409816265106201  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.4098925590515137  GigaBytes
Max Memory Allocated: 2.4098925590515137  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.423430919647217  GigaBytes
Max Memory Allocated: 2.4243922233581543  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([1145, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.4509034156799316  GigaBytes
Max Memory Allocated: 2.451010227203369  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.4509034156799316  GigaBytes
Max Memory Allocated: 2.451010227203369  GigaBytes

 h.shape torch.Size([1, 1145, 256]), torch.Size([1, 1145, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.453996181488037  GigaBytes
Max Memory Allocated: 2.453996181488037  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.856919765472412  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 1145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.8032679557800293  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.8040904998779297  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.80491304397583  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.804049015045166  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

torch.Size([5517, 40])
input nodes number: 28949
output nodes number: 5517
edges number: 59554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.8043065071105957  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.804306983947754  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.04189491271972656  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

pseudo mini batch 14 input nodes size: 56975
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.03583717346191406  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.03583717346191406  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.06300497055053711  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.06304645538330078  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.033585548400878906  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.03576850891113281  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.03576850891113281  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.03576850891113281  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

torch.Size([56975, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.03576850891113281  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

m.shape torch.Size([1136, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.14970922470092773  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.14970922470092773  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.15079259872436523  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.15973997116088867  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1167, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.16031122207641602  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.16031122207641602  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.1614241600036621  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.17876672744750977  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1123, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.17981672286987305  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.17981672286987305  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.18088769912719727  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.20444917678833008  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1060, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.20593547821044922  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.20593547821044922  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.20694637298583984  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.23626232147216797  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([979, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.23809099197387695  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.23809099197387695  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.23902463912963867  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.2728729248046875  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([914, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.2750210762023926  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.2750210762023926  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.2758927345275879  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.3140873908996582  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([891, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.31662559509277344  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.31662559509277344  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.3174753189086914  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.36079883575439453  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([831, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.3635439872741699  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.3635439872741699  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.3643364906311035  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.4100203514099121  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([835, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.4132075309753418  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.4132075309753418  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.414003849029541  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.4658975601196289  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([19013, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.5561604499816895  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.5561604499816895  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 19013, 128]), torch.Size([1, 19013, 128])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 0.5742926597595215  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8751988410949707  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 19013, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.7683110237121582  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.7949652671813965  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8216195106506348  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.7947568893432617  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

torch.Size([27949, 256])
first layer input nodes number: 56975
first layer output nodes number: 27949
edges number: 231988
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8220462799072266  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8487005233764648  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8554048538208008  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.8554048538208008  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

m.shape torch.Size([693, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9148411750793457  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9148411750793457  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 693, 256]), torch.Size([1, 693, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9161629676818848  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9284453392028809  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 693, 256])
m.shape torch.Size([565, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9289288520812988  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9289288520812988  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.930006504058838  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9482851028442383  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([451, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.949091911315918  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.949091911315918  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9499521255493164  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9694557189941406  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([354, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9704060554504395  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9704060554504395  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.971081256866455  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.9910879135131836  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([309, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.992915153503418  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.992915153503418  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 1.993504524230957  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.016343116760254  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([245, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0174612998962402  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0174612998962402  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0179286003112793  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.038022518157959  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([205, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0391860008239746  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0391860008239746  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.039577007293701  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0591273307800293  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0598931312561035  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0598931312561035  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.060131549835205  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.073721408843994  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.075021266937256  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.075021266937256  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.075334072113037  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.095353603363037  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([135, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0964951515197754  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.0964951515197754  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.096752643585205  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.115034580230713  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([111, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.116079807281494  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.116079807281494  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1162915229797363  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.132805347442627  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1342105865478516  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1342105865478516  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.13446044921875  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.155698776245117  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.156773567199707  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.156773567199707  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.156956672668457  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.173802375793457  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1748600006103516  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1748600006103516  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.175020217895508  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1908817291259766  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1918187141418457  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1918187141418457  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.1919522285461426  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2061047554016113  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.207022190093994  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.207022190093994  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.207144260406494  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.220938205718994  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2218575477600098  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2218575477600098  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2219719886779785  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2357048988342285  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2367897033691406  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2367897033691406  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2369155883789062  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2529029846191406  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2539725303649902  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2539725303649902  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2540907859802246  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.269937038421631  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([66, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.271146774291992  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.271146774291992  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.271272659301758  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.289022445678711  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2900900840759277  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2900900840759277  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.2901968955993652  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3060050010681152  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.306839942932129  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.306839942932129  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.306920051574707  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3193368911743164  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.320181369781494  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.320181369781494  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3202576637268066  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3326172828674316  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.333630084991455  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.333630084991455  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3337159156799316  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3482213020324707  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([1278, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3788866996765137  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.3788866996765137  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 1278, 256]), torch.Size([1, 1278, 256])
----------------------------------------3
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.381324291229248  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.811164379119873  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 1278, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.7569947242736816  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.757817268371582  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.7586398124694824  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.7577757835388184  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

torch.Size([5517, 40])
input nodes number: 27949
output nodes number: 5517
edges number: 60915
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.758025646209717  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7967529296875 GB
    Memory Allocated: 2.758026123046875  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.03951835632324219  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

pseudo mini batch 15 input nodes size: 52058
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.033585548400878906  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.033585548400878906  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.05840873718261719  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.05845165252685547  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.03124237060546875  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.03349113464355469  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.03349113464355469  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.03349113464355469  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

torch.Size([52058, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.03349113464355469  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

m.shape torch.Size([871, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.14536476135253906  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.14536476135253906  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.1461954116821289  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.15284061431884766  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([889, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.1532731056213379  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.1532731056213379  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.15412092208862305  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.1668381690979004  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([867, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.16783857345581055  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.16783857345581055  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.16866540908813477  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.18699884414672852  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([840, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.18821430206298828  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.18821430206298828  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.18901538848876953  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.21275043487548828  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([856, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.21439075469970703  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.21439075469970703  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.21520709991455078  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.2446298599243164  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([847, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.2466449737548828  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.2466449737548828  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.2474527359008789  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.28308773040771484  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([854, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.2855343818664551  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.2855343818664551  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.286348819732666  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.3275942802429199  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([817, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.3304295539855957  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.3304295539855957  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.3312087059020996  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.3764653205871582  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.37957334518432617  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.37957334518432617  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.38035058975219727  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.4322957992553711  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([19026, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.5226302146911621  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.5226302146911621  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 19026, 128]), torch.Size([1, 19026, 128])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 0.5407748222351074  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.8421645164489746  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 19026, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.73655366897583  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.7619996070861816  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.7874455451965332  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.761800765991211  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

torch.Size([26682, 256])
first layer input nodes number: 52058
first layer output nodes number: 26682
edges number: 228081
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.7878355979919434  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.813281536102295  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.8199610710144043  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.8199610710144043  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

m.shape torch.Size([561, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.8915939331054688  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.8915939331054688  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.8926639556884766  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.901224136352539  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9014678001403809  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9014678001403809  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.90224027633667  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.915515422821045  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([335, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.91609525680542  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.91609525680542  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.916734218597412  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9316496849060059  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([290, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.932490348815918  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.932490348815918  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9330434799194336  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9495677947998047  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([286, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9506659507751465  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9506659507751465  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9512114524841309  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9717354774475098  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([219, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9727258682250977  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9727258682250977  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9731435775756836  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.991105079650879  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([196, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9922151565551758  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.9922151565551758  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 1.992588996887207  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.0112810134887695  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([171, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.012409210205078  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.012409210205078  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.012735366821289  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.0313262939453125  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([168, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.03261661529541  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.03261661529541  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.0329370498657227  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.0534448623657227  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([168, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.0548996925354004  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.0548996925354004  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.055220127105713  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.0779709815979004  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([154, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.079439163208008  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.079439163208008  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.079732894897461  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1026439666748047  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([143, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1041464805603027  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1041464805603027  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.104419231414795  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.127603054046631  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([133, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.129128932952881  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.129128932952881  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.129382610321045  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1527209281921387  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.154512405395508  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.154512405395508  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1547107696533203  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.174348831176758  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([112, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1758646965026855  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1758646965026855  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1760783195495605  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.1987223625183105  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([114, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.200368881225586  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.200368881225586  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2005863189697266  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.225156784057617  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([103, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.226731300354004  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.226731300354004  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2269277572631836  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.250502586364746  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2520828247070312  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2520828247070312  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.252267837524414  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2757644653320312  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([92, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2773523330688477  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2773523330688477  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.2775278091430664  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.301041603088379  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([85, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.30308198928833  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.30308198928833  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.303244113922119  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.326103687286377  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.327859401702881  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.327859401702881  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.328032970428467  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.3537211418151855  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([61, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.354924201965332  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.354924201965332  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.3550405502319336  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.373074531555176  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.3745641708374023  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.3745641708374023  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.374697685241699  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.396327018737793  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.397806167602539  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.397806167602539  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.8553466796875 GB
    Memory Allocated: 2.3979339599609375  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 2.4195308685302734  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([1520, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 2.4559898376464844  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 2.4559898376464844  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

 h.shape torch.Size([1, 1520, 256]), torch.Size([1, 1520, 256])[05:24:58] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27802158 edges into 16 parts and get 7129373 edge cuts

----------------------------------------3
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 2.4588890075683594  GigaBytes
Max Memory Allocated: 2.884218692779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 2.9857921600341797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1520, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 2.919384479522705  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 2.920240879058838  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.9210972785949707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.9201979637145996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5745, 40])
input nodes number: 26682
output nodes number: 5745
edges number: 73727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.920473575592041  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.920474052429199  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.037372589111328125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0429229736328125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0429229736328125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012082546949386597 |0.023379981517791748 |0.1482050120830536 |9.459257125854492e-05 |0.07771952450275421 |0.005796194076538086 |
----------------------------------------------------------pseudo_mini_loss sum 5.329103469848633
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  847103
Number of first layer input nodes during this epoch:  575546
Number of first layer output nodes during this epoch:  271557
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0429224967956543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019283056259155273
global_2_local spend time (sec) 0.04573655128479004
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004182100296020508
A = g.adjacency_matrix() spent  0.007607936859130859
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08059048652648926
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3035733699798584
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1544649600982666

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18720996, 2.0: 3229533, 3.0: 807748, 4.0: 243722, 5.0: 89337, 6.0: 38108, 7.0: 18016, 8.0: 9112, 9.0: 4890, 10.0: 2746, 11.0: 1644, 12.0: 893, 13.0: 552, 14.0: 337, 15.0: 196, 16.0: 180, 17.0: 140, 18.0: 67, 19.0: 54, 20.0: 11, 21.0: 10})
Convert a graph into a bidirected graph: 1.159 seconds
Metis partitioning: 5.242 seconds
Split the graph: 0.779 seconds
Construct subgraphs: 0.099 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.301909685134888
5854
5824
5835
5840
5570
5854
5666
5647
5527
5635
5517
5688
5759
5591
5617
5517
total k batches seeds list generation spend  19.541259765625
after graph partition
graph partition algorithm spend time 19.635281324386597
5854
5824
5835
5840
5570
5854
5666
5647
5527
5635
5517
5688
5759
5591
5617
5517
partition_len_list
[14097, 11114, 12295, 11780, 11445, 12750, 12092, 10189, 24721, 30689, 26052, 29441, 14365, 17001, 17272, 24691]
shared_neighbor_graph_partition_s0 selection method  spend 19.734055519104004
time for parepare:  0.018329381942749023
local_output_nid generation:  0.0014531612396240234
local_in_edges_tensor generation:  0.0015175342559814453
mini_batch_src_global generation:  0.0020437240600585938
r_  generation:  0.01787424087524414
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.001346588134765625
mini_batch_src_global generation:  0.001909494400024414
r_  generation:  0.016214370727539062
local_output_nid generation:  0.001626729965209961
local_in_edges_tensor generation:  0.0011975765228271484
mini_batch_src_global generation:  0.0013744831085205078
r_  generation:  0.015043020248413086
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.0011818408966064453
mini_batch_src_global generation:  0.0016398429870605469
r_  generation:  0.017061948776245117
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0011594295501708984
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.017589807510375977
local_output_nid generation:  0.0016918182373046875
local_in_edges_tensor generation:  0.0012090206146240234
mini_batch_src_global generation:  0.0018053054809570312
r_  generation:  0.019081830978393555
local_output_nid generation:  0.0017163753509521484
local_in_edges_tensor generation:  0.0012063980102539062
mini_batch_src_global generation:  0.0017631053924560547
r_  generation:  0.018321990966796875
local_output_nid generation:  0.0017251968383789062
local_in_edges_tensor generation:  0.001157999038696289
mini_batch_src_global generation:  0.0013861656188964844
r_  generation:  0.014970541000366211
local_output_nid generation:  0.0016167163848876953
local_in_edges_tensor generation:  0.0011150836944580078
mini_batch_src_global generation:  0.001497507095336914
r_  generation:  0.017102479934692383
local_output_nid generation:  0.0016281604766845703
local_in_edges_tensor generation:  0.0012302398681640625
mini_batch_src_global generation:  0.0023355484008789062
r_  generation:  0.020832300186157227
local_output_nid generation:  0.0017693042755126953
local_in_edges_tensor generation:  0.0012841224670410156
mini_batch_src_global generation:  0.002013683319091797
r_  generation:  0.021244525909423828
local_output_nid generation:  0.0018138885498046875
local_in_edges_tensor generation:  0.0016021728515625
mini_batch_src_global generation:  0.0021791458129882812
r_  generation:  0.0246431827545166
local_output_nid generation:  0.0019145011901855469
local_in_edges_tensor generation:  0.0012514591217041016
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.013631105422973633
local_output_nid generation:  0.0018191337585449219
local_in_edges_tensor generation:  0.0012693405151367188
mini_batch_src_global generation:  0.0012445449829101562
r_  generation:  0.013751029968261719
local_output_nid generation:  0.001760721206665039
local_in_edges_tensor generation:  0.0011641979217529297
mini_batch_src_global generation:  0.0013294219970703125
r_  generation:  0.014168024063110352
local_output_nid generation:  0.0016808509826660156
local_in_edges_tensor generation:  0.0011899471282958984
mini_batch_src_global generation:  0.00148773193359375
r_  generation:  0.018465280532836914
----------------------check_connections_block total spend ----------------------------- 0.4470949172973633
generate_one_block  0.027128934860229492
generate_one_block  0.019069671630859375
generate_one_block  0.01693892478942871
generate_one_block  0.020988941192626953
generate_one_block  0.021021366119384766
generate_one_block  0.02292180061340332
generate_one_block  0.021461009979248047
generate_one_block  0.016541719436645508
generate_one_block  0.02223038673400879
generate_one_block  0.02993488311767578
generate_one_block  0.030244112014770508
generate_one_block  0.036652326583862305
generate_one_block  0.017834186553955078
generate_one_block  0.01910710334777832
generate_one_block  0.01965022087097168
generate_one_block  0.02545785903930664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04681062698364258
gen group dst list time:  0.008461475372314453
time for parepare:  0.023789405822753906
local_output_nid generation:  0.0036530494689941406
local_in_edges_tensor generation:  0.011640548706054688
mini_batch_src_global generation:  0.0030748844146728516
r_  generation:  0.03205561637878418
local_output_nid generation:  0.003515958786010742
local_in_edges_tensor generation:  0.002656221389770508
mini_batch_src_global generation:  0.002594470977783203
r_  generation:  0.02264547348022461
local_output_nid generation:  0.003718137741088867
local_in_edges_tensor generation:  0.0025968551635742188
mini_batch_src_global generation:  0.0019490718841552734
r_  generation:  0.025259971618652344
local_output_nid generation:  0.0035104751586914062
local_in_edges_tensor generation:  0.002427339553833008
mini_batch_src_global generation:  0.0024797916412353516
r_  generation:  0.025504589080810547
local_output_nid generation:  0.003411531448364258
local_in_edges_tensor generation:  0.0027570724487304688
mini_batch_src_global generation:  0.00222015380859375
r_  generation:  0.026915311813354492
local_output_nid generation:  0.0035982131958007812
local_in_edges_tensor generation:  0.0029327869415283203
mini_batch_src_global generation:  0.0026395320892333984
r_  generation:  0.028825759887695312
local_output_nid generation:  0.003531932830810547
local_in_edges_tensor generation:  0.0033016204833984375
mini_batch_src_global generation:  0.002379894256591797
r_  generation:  0.030298948287963867
local_output_nid generation:  0.004942655563354492
local_in_edges_tensor generation:  0.0022563934326171875
mini_batch_src_global generation:  0.0020248889923095703
r_  generation:  0.020772933959960938
local_output_nid generation:  0.007102012634277344
local_in_edges_tensor generation:  0.007134437561035156
mini_batch_src_global generation:  0.006510257720947266
r_  generation:  0.06680607795715332
local_output_nid generation:  0.00872802734375
local_in_edges_tensor generation:  0.00878286361694336
mini_batch_src_global generation:  0.009934186935424805
r_  generation:  0.08911585807800293
local_output_nid generation:  0.00782155990600586
local_in_edges_tensor generation:  0.006159543991088867
mini_batch_src_global generation:  0.011202335357666016
r_  generation:  0.07751250267028809
local_output_nid generation:  0.008379697799682617
local_in_edges_tensor generation:  0.006813526153564453
mini_batch_src_global generation:  0.011507749557495117
r_  generation:  0.08758282661437988
local_output_nid generation:  0.004703521728515625
local_in_edges_tensor generation:  0.003622770309448242
mini_batch_src_global generation:  0.0047550201416015625
r_  generation:  0.0334775447845459
local_output_nid generation:  0.005368709564208984
local_in_edges_tensor generation:  0.0039675235748291016
mini_batch_src_global generation:  0.003908634185791016
r_  generation:  0.04149961471557617
local_output_nid generation:  0.005165576934814453
local_in_edges_tensor generation:  0.00394749641418457
mini_batch_src_global generation:  0.004453182220458984
r_  generation:  0.04265308380126953
local_output_nid generation:  0.0071752071380615234
local_in_edges_tensor generation:  0.005434989929199219
mini_batch_src_global generation:  0.006966114044189453
r_  generation:  0.06918740272521973
----------------------check_connections_block total spend ----------------------------- 1.1637370586395264
generate_one_block  0.05649375915527344
generate_one_block  0.030712366104125977
generate_one_block  0.032033443450927734
generate_one_block  0.03242611885070801
generate_one_block  0.0345454216003418
generate_one_block  0.037158966064453125
generate_one_block  0.03615760803222656
generate_one_block  0.026187419891357422
generate_one_block  0.0921626091003418
generate_one_block  0.1191103458404541
generate_one_block  0.09716224670410156
generate_one_block  0.11320018768310547
generate_one_block  0.04227781295776367
generate_one_block  0.052978515625
generate_one_block  0.05550789833068848
generate_one_block  0.09158062934875488
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0429224967956543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

connection checking time:  1.1637370586395264
block generation total time  0.949695348739624
average batch blocks generation time:  0.0593559592962265
block dataloader generation time/epoch 22.868245840072632
pseudo mini batch 0 input nodes size: 31492
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03682565689086914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03682565689086914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05184221267700195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05188608169555664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.027019977569580078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.028066158294677734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.028066158294677734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.028066158294677734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([31492, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.028066158294677734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1149, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07443523406982422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07443523406982422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.075531005859375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08442878723144531  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1226, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08592557907104492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08592557907104492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08709478378295898  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1046595573425293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1227, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.10583019256591797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.10583019256591797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1227, 128]), torch.Size([1, 1227, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.10700035095214844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13336515426635742  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1227, 128])
m.shape torch.Size([1065, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1348114013671875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1348114013671875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13582706451416016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1652812957763672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([995, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1671457290649414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1671457290649414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 995, 128]), torch.Size([1, 995, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.16809463500976562  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20233392715454102  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 995, 128])
m.shape torch.Size([790, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20411968231201172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20411968231201172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20487308502197266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.23726940155029297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([740, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2393627166748047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2393627166748047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2400684356689453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2753925323486328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([698, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.27770233154296875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.27770233154296875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2783679962158203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.31723594665527344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([575, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.31937074661254883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.31937074661254883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3199191093444824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.35698890686035156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([5632, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.38357019424438477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.38357019424438477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 5632, 128]), torch.Size([1, 5632, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.38894128799438477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7755436897277832  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 5632, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7339873313903809  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7474312782287598  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7608752250671387  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7473258972167969  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([14097, 256])
first layer input nodes number: 31492
first layer output nodes number: 14097
edges number: 93516
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7611122131347656  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7745561599731445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7779741287231445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7779741287231445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([781, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8239765167236328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8239765167236328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 781, 256]), torch.Size([1, 781, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8254661560058594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8375120162963867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 781, 256])
m.shape torch.Size([714, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8388452529907227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8388452529907227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8402070999145508  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8618927001953125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([617, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8632926940917969  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8632926940917969  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8644695281982422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8904476165771484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 617, 256])
m.shape torch.Size([505, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8918008804321289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8918008804321289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8927640914916992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9206972122192383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([411, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9221911430358887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9221911430358887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9229750633239746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.953615665435791  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9550867080688477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9550867080688477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9557027816772461  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9832639694213867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([279, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9855990409851074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9855990409851074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9861311912536621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.013465404510498  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([268, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0152602195739746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0152602195739746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0157713890075684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0466971397399902  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([194, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0481200218200684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0481200218200684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.048490047454834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.072171688079834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([198, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0738897323608398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0738897323608398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0742673873901367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1010808944702148  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.103071689605713  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.103071689605713  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1033196449279785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1226601600646973  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([151, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1242780685424805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1242780685424805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1245660781860352  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1490468978881836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.150439739227295  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.150439739227295  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1506743431091309  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.172257900238037  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1735806465148926  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1735806465148926  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1737847328186035  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1939892768859863  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([109, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1954588890075684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1954588890075684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.195666790008545  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2177042961120605  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2186460494995117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2186460494995117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.218775749206543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2334318161010742  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2348880767822266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2348880767822266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2350444793701172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2538127899169922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2548418045043945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2548418045043945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2549638748168945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2704668045043945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2713375091552734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2713375091552734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2714347839355469  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2844696044921875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2853631973266602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2853631973266602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.285456657409668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2986345291137695  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2994155883789062  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2994155883789062  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2994937896728516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3110675811767578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3119168281555176  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3119168281555176  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3119969367980957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.324413776397705  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3248825073242188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3248825073242188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3249263763427734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3320331573486328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3327727317810059  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3327727317810059  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3328356742858887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.343472957611084  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([491, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3552393913269043  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3552393913269043  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3561758995056152  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5218024253845215  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 491, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4821243286132812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.482996940612793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4838695526123047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4829530715942383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5854, 40])
input nodes number: 14097
output nodes number: 5854
edges number: 46834
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4831185340881348  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4831194877624512  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.030096054077148438  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 1 input nodes size: 21093
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02703714370727539  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02703714370727539  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.037095069885253906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03713846206665039  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02207803726196289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022837162017822266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022837162017822266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022837162017822266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([21093, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022837162017822266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1318, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.054251670837402344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.054251670837402344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1318, 128]), torch.Size([1, 1318, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05550861358642578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0657963752746582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1318, 128])
m.shape torch.Size([1431, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06682872772216797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06682872772216797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1431, 128]), torch.Size([1, 1431, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06819343566894531  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08866405487060547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1431, 128])
m.shape torch.Size([1197, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08969402313232422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08969402313232422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1197, 128]), torch.Size([1, 1197, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0908355712890625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11625289916992188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1197, 128])
m.shape torch.Size([1063, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11770963668823242  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11770963668823242  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11872339248657227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14838361740112305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([850, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1499032974243164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1499032974243164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.15071392059326172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18016958236694336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([694, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18174982070922852  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18174982070922852  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18241167068481445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21087121963500977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([602, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21254968643188477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21254968643188477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21312379837036133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24200868606567383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([545, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24380064010620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24380064010620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24432039260864258  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2751307487487793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([454, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.27681922912597656  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.27681922912597656  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.277252197265625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.304962158203125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([2960, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3188600540161133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3188600540161133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 2960, 128]), torch.Size([1, 2960, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3216829299926758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5228290557861328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 2960, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.49660587310791016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5072050094604492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5178041458129883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5071220397949219  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([11114, 256])
first layer input nodes number: 21093
first layer output nodes number: 11114
edges number: 62697
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5179634094238281  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5285625457763672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.531212329864502  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.531212329864502  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([913, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5698761940002441  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5698761940002441  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 913, 256]), torch.Size([1, 913, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.571617603302002  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5855488777160645  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 913, 256])
m.shape torch.Size([849, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5866575241088867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5866575241088867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5882768630981445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6125669479370117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([640, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6139974594116211  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6139974594116211  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 640, 256]), torch.Size([1, 640, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6152181625366211  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6420869827270508  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 640, 256])
m.shape torch.Size([555, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6436104774475098  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6436104774475098  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6446690559387207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.675844669342041  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([433, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.677396297454834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.677396297454834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6782221794128418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7086930274963379  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([338, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7102293968200684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7102293968200684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.710874080657959  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7387862205505371  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7402873039245605  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7402873039245605  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7408041954040527  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7685742378234863  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([256, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7702841758728027  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7702841758728027  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7707724571228027  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7986044883728027  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([220, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8002634048461914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8002634048461914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8006830215454102  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8275384902954102  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([181, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8290848731994629  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8290848731994629  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.829430103302002  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8539414405822754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8552069664001465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8552069664001465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.855466365814209  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.875699520111084  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8769655227661133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8769655227661133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8771963119506836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8968133926391602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8980350494384766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8980350494384766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8982391357421875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9170150756835938  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9181375503540039  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9181375503540039  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9183111190795898  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9354944229125977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9365034103393555  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9365034103393555  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9366483688354492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9520139694213867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9529871940612793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9529871940612793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9531168937683105  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9677729606628418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.968656063079834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.968656063079834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9687666893005371  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9820418357849121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9830245971679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9830245971679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9831390380859375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9976730346679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9984378814697266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9984378814697266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9985237121582031  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0100250244140625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0107898712158203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0107898712158203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0108699798583984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.022165298461914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.022831916809082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.022831916809082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0228986740112305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0327787399291992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0334434509277344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0334434509277344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0335063934326172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0432624816894531  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0437397956848145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0437397956848145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0437836647033691  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0508904457092285  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0514683723449707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0514683723449707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0515179634094238  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.059898853302002  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0658092498779297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0658092498779297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0662803649902344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1491966247558594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1171298027038574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.117997646331787  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1188654899597168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1179542541503906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5824, 40])
input nodes number: 11114
output nodes number: 5824
edges number: 39070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1180758476257324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1180763244628906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.024354934692382812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 2 input nodes size: 25091
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02207326889038086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02207326889038086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03403759002685547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.034081459045410156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023980140686035156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.024741172790527344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.024741172790527344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.024741172790527344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([25091, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.024741172790527344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1587, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.058704376220703125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.058704376220703125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1587, 128]), torch.Size([1, 1587, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.060217857360839844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0723257064819336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1587, 128])
m.shape torch.Size([1646, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07313871383666992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07313871383666992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07470846176147461  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09825468063354492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1395, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09977006912231445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09977006912231445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1395, 128]), torch.Size([1, 1395, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.10110044479370117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1309657096862793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1395, 128])
m.shape torch.Size([1135, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13271331787109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13271331787109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13379573822021484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.16518592834472656  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([932, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.16686677932739258  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.16686677932739258  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1677556037902832  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20051813125610352  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([810, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2023911476135254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2023911476135254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20316362380981445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.23658990859985352  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([630, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.23830652236938477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.23830652236938477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2389073371887207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2705082893371582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([543, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2722792625427246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2722792625427246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2727971076965332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.30310773849487305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([441, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.30474138259887695  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.30474138259887695  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3051619529724121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3320784568786621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([3176, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3470125198364258  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3470125198364258  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 3176, 128]), torch.Size([1, 3176, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.35004138946533203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5650911331176758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 3176, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5369677543640137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5486931800842285  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5604186058044434  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5486011505126953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([12295, 256])
first layer input nodes number: 25091
first layer output nodes number: 12295
edges number: 67607
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.56060791015625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5723333358764648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5753622055053711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5753622055053711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1068, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6098966598510742  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6098966598510742  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1068, 256]), torch.Size([1, 1068, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6126127243041992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6305723190307617  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1068, 256])
m.shape torch.Size([940, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6310214996337891  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6310214996337891  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 940, 256]), torch.Size([1, 940, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6328144073486328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6604881286621094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 940, 256])
m.shape torch.Size([731, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6616997718811035  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6616997718811035  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6630940437316895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.693779468536377  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([542, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6951661109924316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6951661109924316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.696199893951416  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7271027565002441  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([450, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7287487983703613  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7287487983703613  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.729607105255127  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7612605094909668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([364, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7629308700561523  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7629308700561523  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7636251449584961  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7942690849304199  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7957925796508789  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7957925796508789  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7963228225708008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8252339363098145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([244, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8268451690673828  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8268451690673828  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8273105621337891  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8538379669189453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8550848960876465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8550848960876465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8554110527038574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8762850761413574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8775734901428223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8775734901428223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.877861499786377  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8983101844787598  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8994140625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8994140625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8996391296386719  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9171943664550781  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([93, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9182024002075195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9182024002075195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9183797836303711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9334573745727539  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([81, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9343810081481934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9343810081481934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9345355033874512  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9487490653991699  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9495196342468262  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9495196342468262  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9496397972106934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9615359306335449  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9625716209411621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9625716209411621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9627165794372559  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9780821800231934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9785327911376953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9785327911376953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9785976409912109  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9859256744384766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.986628532409668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.986628532409668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9867143630981445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.997014045715332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9975767135620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9975767135620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9976434707641602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0061216354370117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.006727695465088  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.006727695465088  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0067944526672363  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.015739917755127  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0161681175231934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0161681175231934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0162138938903809  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0226683616638184  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0231099128723145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0231099128723145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0231537818908691  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.029646396636963  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0301742553710938  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0301742553710938  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0302238464355469  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0379104614257812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.038482666015625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.038482666015625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.038534164428711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0468769073486328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0472898483276367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0472898483276367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0473260879516602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.053450584411621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([197, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0581660270690918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0581660270690918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0585417747497559  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1246733665466309  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 197, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0968527793884277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0977225303649902  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0985922813415527  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0976786613464355  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5835, 40])
input nodes number: 12295
output nodes number: 5835
edges number: 34320
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0978164672851562  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0978169441223145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.026290416717529297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 3 input nodes size: 21803
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02398204803466797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02398204803466797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0343785285949707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03442239761352539  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022414207458496094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023267745971679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023267745971679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023267745971679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([21803, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023267745971679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1205, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05882596969604492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05882596969604492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1205, 128]), torch.Size([1, 1205, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05997514724731445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0691685676574707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1205, 128])
m.shape torch.Size([1232, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0699162483215332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0699162483215332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1232, 128]), torch.Size([1, 1232, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0710911750793457  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08883905410766602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1232, 128])
m.shape torch.Size([1139, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09057092666625977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09057092666625977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09165716171264648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11641073226928711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1071, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11791038513183594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11791038513183594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11893177032470703  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14917945861816406  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([914, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1508479118347168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1508479118347168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1517195701599121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18345403671264648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([767, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1852126121520996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1852126121520996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1859440803527832  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21752023696899414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([667, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21938085556030273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21938085556030273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2200169563293457  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2522702217102051  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([618, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.25430965423583984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.25430965423583984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2548990249633789  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.288637638092041  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([514, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29054880142211914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29054880142211914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29103899002075195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3241415023803711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([3653, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.34131526947021484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.34131526947021484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 3653, 128]), torch.Size([1, 3653, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3451695442199707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5955862998962402  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 3653, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5648603439331055  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5760946273803711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5873289108276367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5760064125061035  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([11780, 256])
first layer input nodes number: 21803
first layer output nodes number: 11780
edges number: 71311
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5874934196472168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5987277030944824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6015362739562988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6015362739562988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([818, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.643923282623291  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.643923282623291  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6454834938049316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6579651832580566  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([745, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6591219902038574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6591219902038574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6605429649353027  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6818575859069824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([616, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6836366653442383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6836366653442383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6848115921020508  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7132968902587891  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([522, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7147164344787598  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7147164344787598  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7157120704650879  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7449173927307129  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([422, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7464475631713867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7464475631713867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7472524642944336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7771577835083008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([333, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7786760330200195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7786760330200195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7793111801147461  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8066225051879883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([315, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8084244728088379  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8084244728088379  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8090252876281738  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8393893241882324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([265, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8411269187927246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8411269187927246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8416323661804199  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8711161613464355  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([227, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8728270530700684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8728270530700684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8732600212097168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9009699821472168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([205, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9027242660522461  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9027242660522461  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9031152725219727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9308767318725586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([159, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9323625564575195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9323625564575195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9326658248901367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9563207626342773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([140, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9577841758728027  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9577841758728027  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9580512046813965  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9807486534118652  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9821147918701172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9821147918701172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9823436737060547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0034008026123047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0045514106750488  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0045514106750488  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0047307014465332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0224804878234863  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0237751007080078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0237751007080078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0239582061767578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0433673858642578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([85, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0445833206176758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0445833206176758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0447454452514648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.063065528869629  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0639162063598633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0639162063598633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0640249252319336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.077071189880371  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0779685974121094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0779685974121094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.078073501586914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0913963317871094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0924582481384277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0924582481384277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0925745964050293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1081652641296387  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1091647148132324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1091647148132324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.109269618988037  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.124061107635498  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1246142387390137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1246142387390137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.124671459197998  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1331400871276855  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1338305473327637  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1338305473327637  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1338953971862793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1439471244812012  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1445560455322266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1445560455322266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1446113586425781  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1535720825195312  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.154144287109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.154144287109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1541938781738281  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1625747680664062  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([331, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1705036163330078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1705036163330078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1711349487304688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2848901748657227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.248974323272705  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2498445510864258  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2507147789001465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.249800682067871  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5840, 40])
input nodes number: 11780
output nodes number: 5840
edges number: 43037
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2499332427978516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2499337196350098  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.024936676025390625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 4 input nodes size: 22341
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022414684295654297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022414684295654297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03306770324707031  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03310966491699219  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022669315338134766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02359914779663086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02359914779663086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02359914779663086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([22341, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02359914779663086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([834, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06232118606567383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06232118606567383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06311655044555664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07037162780761719  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([899, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.070831298828125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.070831298828125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07168865203857422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0845489501953125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([890, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08555078506469727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08555078506469727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08639955520629883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1050724983215332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([837, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.10624456405639648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.10624456405639648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.10704278945922852  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1304316520690918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([772, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13187313079833984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13187313079833984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13260936737060547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.15955257415771484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([723, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1612529754638672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1612529754638672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1619424819946289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.19298839569091797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([624, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.19472646713256836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.19472646713256836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.19532155990600586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.22507619857788086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([583, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.22700262069702148  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.22700262069702148  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.22755861282348633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.26060056686401367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([477, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.26236963272094727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.26236963272094727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.26282453536987305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29193830490112305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([4806, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.31462764739990234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.31462764739990234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 4806, 128]), torch.Size([1, 4806, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3192110061645508  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6446294784545898  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 4806, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6102681159973145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.621182918548584  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6320977210998535  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6210975646972656  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([11445, 256])
first layer input nodes number: 22341
first layer output nodes number: 11445
edges number: 78233
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6322665214538574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.643181324005127  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6463403701782227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6463403701782227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([647, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6917996406555176  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6917996406555176  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6930336952209473  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7034273147583008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([614, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7040176391601562  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7040176391601562  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7051887512207031  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7227554321289062  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 614, 256])
m.shape torch.Size([535, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7237720489501953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7237720489501953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.72479248046875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7477483749389648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([442, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7490482330322266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7490482330322266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7498912811279297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7743396759033203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([405, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7758646011352539  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7758646011352539  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.776637077331543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8045916557312012  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([370, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8063392639160156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8063392639160156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8070449829101562  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8380775451660156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([302, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.839756965637207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.839756965637207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8403329849243164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.870147705078125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([245, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8717436790466309  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8717436790466309  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8722109794616699  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8988471031188965  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([215, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9004735946655273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9004735946655273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.900883674621582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.927128791809082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([214, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.928980827331543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.928980827331543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9293889999389648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.958369255065918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([180, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9600682258605957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9600682258605957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.960411548614502  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9871907234191895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9885878562927246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9885878562927246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9888472557067871  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0108962059020996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0125551223754883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0125551223754883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0127897262573242  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0343732833862305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.035843849182129  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.035843849182129  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0360689163208008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0583505630493164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0592780113220215  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0592780113220215  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.059415340423584  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.073972225189209  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0751338005065918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0751338005065918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0752863883972168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0925288200378418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([94, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0939884185791016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0939884185791016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.094167709350586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.115682601928711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1166667938232422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1166667938232422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1167774200439453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1308269500732422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.131831169128418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.131831169128418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.131941795349121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1467657089233398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1479601860046387  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1479601860046387  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1480841636657715  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.165565013885498  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1665124893188477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1665124893188477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1666078567504883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1807222366333008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1814570426940918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1814570426940918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1815276145935059  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1924662590026855  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1931829452514648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1931829452514648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1932477951049805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2037534713745117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2046208381652832  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2046208381652832  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.204695224761963  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.21726655960083  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([437, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2277297973632812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2277297973632812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2285633087158203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3752613067626953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 437, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.335770606994629  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3366007804870605  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3374309539794922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3365588188171387  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5570, 40])
input nodes number: 11445
output nodes number: 5570
edges number: 46416
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3366460800170898  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.336646556854248  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.025321483612060547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 5 input nodes size: 22359
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022629261016845703  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022629261016845703  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.033290863037109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03333473205566406  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022639751434326172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023647785186767578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023647785186767578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023647785186767578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([22359, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023647785186767578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1039, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06555795669555664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06555795669555664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1039, 128]), torch.Size([1, 1039, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06654882431030273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0751638412475586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1039, 128])
m.shape torch.Size([1132, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07574796676635742  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07574796676635742  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0768275260925293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09321928024291992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1070, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09421014785766602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09421014785766602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0952305793762207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11768007278442383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([963, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11900663375854492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11900663375854492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11992502212524414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1471095085144043  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([908, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14881515502929688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14881515502929688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14968109130859375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18133544921875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([769, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18310260772705078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.18310260772705078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1838359832763672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2165536880493164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([666, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21841001510620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21841001510620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21904516220092773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2521653175354004  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([587, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.254086971282959  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.254086971282959  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.25464677810668945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.28708410263061523  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([524, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.28905296325683594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.28905296325683594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2895526885986328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.32192277908325195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([5092, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.34595346450805664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.34595346450805664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 5092, 128]), torch.Size([1, 5092, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3509697914123535  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6977295875549316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 5092, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.660675048828125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6728343963623047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6849937438964844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6727390289306641  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([12750, 256])
first layer input nodes number: 22359
first layer output nodes number: 12750
edges number: 84513
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6851625442504883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.697321891784668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7010612487792969  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7010612487792969  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([699, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7511744499206543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7511744499206543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7525076866149902  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7639203071594238  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([635, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7648043632507324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7648043632507324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 635, 256]), torch.Size([1, 635, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7660155296325684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7842879295349121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 635, 256])
m.shape torch.Size([562, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7859783172607422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7859783172607422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7870502471923828  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8119564056396484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([464, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.813204288482666  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.813204288482666  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.814089298248291  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.839754581451416  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8412775993347168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8412775993347168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8420577049255371  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8712124824523926  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8727197647094727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8727197647094727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.873347282409668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9003305435180664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([311, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9021096229553223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9021096229553223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.902702808380127  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9327960014343262  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9345216751098633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9345216751098633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.935023307800293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9642057418823242  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([232, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9659619331359863  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9659619331359863  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9664044380187988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9947247505187988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([201, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9964356422424316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9964356422424316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.996819019317627  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0240387916564941  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([170, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0256447792053223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0256447792053223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0259690284729004  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0512604713439941  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([141, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.052724838256836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.052724838256836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0529937744140625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0758533477783203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([121, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0772309303283691  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0772309303283691  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0774617195129395  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0986943244934082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([120, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.100193977355957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.100193977355957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1004228591918945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.123082160949707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1245107650756836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1245107650756836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1247148513793945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.146347999572754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.147430419921875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.147430419921875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1475772857666016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1641731262207031  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([84, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1654725074768066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1654725074768066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.165632724761963  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.184858798980713  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1859207153320312  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1859207153320312  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1860466003417969  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2020339965820312  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.202847957611084  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.202847957611084  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.202939510345459  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.215207576751709  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([73, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2170896530151367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2170896530151367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.217228889465332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.236861228942871  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([59, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2379827499389648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2379827499389648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2380952835083008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2547502517700195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.255476474761963  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.255476474761963  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.255547046661377  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2664856910705566  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2673349380493164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2673349380493164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.267411231994629  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.279770851135254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2806787490844727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2806787490844727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.280756950378418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2939729690551758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([565, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3075098991394043  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3075098991394043  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3085875511169434  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.499223232269287  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 565, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4553132057189941  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4561858177185059  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4570584297180176  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4561419486999512  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5854, 40])
input nodes number: 12750
output nodes number: 5854
edges number: 50631
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4563236236572266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4563241004943848  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.025594711303710938  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 6 input nodes size: 24824
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02268218994140625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02268218994140625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.034519195556640625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0345616340637207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023856163024902344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02480316162109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02480316162109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02480316162109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([24824, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02480316162109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([999, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06428861618041992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06428861618041992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 999, 128]), torch.Size([1, 999, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06524133682250977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07286310195922852  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 999, 128])
m.shape torch.Size([1112, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07358837127685547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07358837127685547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07464885711669922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09055614471435547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1036, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09157276153564453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.09157276153564453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0925607681274414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11429691314697266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([944, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11564159393310547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11564159393310547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11654186248779297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14395427703857422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([819, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14545679092407227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14545679092407227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14623785018920898  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17435598373413086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([705, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17598247528076172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17598247528076172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17665481567382812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20627117156982422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([649, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2081012725830078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2081012725830078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.20872020721435547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.23969221115112305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([585, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24161434173583984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24161434173583984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2421722412109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.27484655380249023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([485, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.27664899826049805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.27664899826049805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2771115303039551  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3067135810852051  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([4758, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.32917022705078125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.32917022705078125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 4758, 128]), torch.Size([1, 4758, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3337078094482422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6558761596679688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 4758, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.621182918548584  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6327147483825684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6442465782165527  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.632624626159668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([12092, 256])
first layer input nodes number: 24824
first layer output nodes number: 12092
edges number: 79600
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6444334983825684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6559653282165527  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6588482856750488  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6588482856750488  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([727, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7053256034851074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7053256034851074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7067122459411621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7187752723693848  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([644, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7194728851318359  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7194728851318359  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7207012176513672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7400684356689453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([572, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7411456108093262  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7411456108093262  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7422366142272949  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7664780616760254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([462, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7680177688598633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7680177688598633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7688989639282227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7951021194458008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([382, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7964973449707031  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7964973449707031  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7972259521484375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8237214088439941  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8251910209655762  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8251910209655762  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8257975578308105  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8546366691589355  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([251, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8560223579406738  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8560223579406738  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8565011024475098  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8804383277893066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([232, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8821649551391602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8821649551391602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8826074600219727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9078302383422852  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9093737602233887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9093737602233887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9097628593444824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9346652030944824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9362010955810547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9362010955810547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9365444183349609  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9609203338623047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([194, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9628000259399414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9628000259399414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.963170051574707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9920320510864258  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([144, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9935078620910645  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9935078620910645  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9937825202941895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0171284675598145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([138, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0187158584594727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0187158584594727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0189790725708008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0431947708129883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([108, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0445165634155273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0445165634155273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.044722557067871  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0651159286499023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0665559768676758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0665559768676758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0667600631713867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.088393211364746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([89, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0896601676940918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0896601676940918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.089829921722412  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1090121269226074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([81, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1102509498596191  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1102509498596191  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.110405445098877  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1289448738098145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1300787925720215  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1300787925720215  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1302123069763184  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1471686363220215  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1482892036437988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1482892036437988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1484017372131348  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1634812355041504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([70, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1647706031799316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1647706031799316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1649041175842285  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.183729648590088  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1847734451293945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1847734451293945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.1848783493041992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.200404167175293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.201303482055664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.201303482055664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2013893127441406  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2146930694580078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2154459953308105  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2154459953308105  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2155146598815918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2266383171081543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2273883819580078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2273883819580078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2274532318115234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.238412857055664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([464, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2495298385620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2495298385620117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.2504148483276367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4065427780151367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 464, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3661856651306152  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.367030143737793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3678746223449707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.366987705230713  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5666, 40])
input nodes number: 12092
output nodes number: 5666
edges number: 47390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3670921325683594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.3670926094055176  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.026595592498779297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 7 input nodes size: 19612
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02382802963256836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.02382802963256836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.03317975997924805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.033222198486328125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.021342754364013672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022020816802978516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022020816802978516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022020816802978516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([19612, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.022020816802978516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1342, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.049968719482421875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.049968719482421875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1342, 128]), torch.Size([1, 1342, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05124855041503906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06171751022338867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1342, 128])
m.shape torch.Size([1370, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06238412857055664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.06238412857055664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1370, 128]), torch.Size([1, 1370, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0636906623840332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08328866958618164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1370, 128])
m.shape torch.Size([1176, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08431768417358398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08431768417358398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.08543920516967773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11011266708374023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([956, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11137533187866211  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11137533187866211  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.11228704452514648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13872671127319336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([786, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14014482498168945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14014482498168945  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14089441299438477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1679215431213379  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([636, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.16936635971069336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.16936635971069336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.16997289657592773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1964573860168457  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([511, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1978597640991211  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1978597640991211  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.1983470916748047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.22271347045898438  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([457, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2242131233215332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2242131233215332  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.22464895248413086  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24949121475219727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([374, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.25087833404541016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.25087833404541016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2512350082397461  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2740621566772461  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([2581, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2861909866333008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2861909866333008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 2581, 128]), torch.Size([1, 2581, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2886524200439453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.46341419219970703  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 2581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4403395652770996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4500894546508789  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4598064422607422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4499802589416504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([10189, 256])
first layer input nodes number: 19612
first layer output nodes number: 10189
edges number: 55589
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.45995473861694336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4697690010070801  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.47210121154785156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.47210121154785156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1023, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5071845054626465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5071845054626465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1023, 256]), torch.Size([1, 1023, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5091357231140137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.526465892791748  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1023, 256])
m.shape torch.Size([898, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5278053283691406  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5278053283691406  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5295181274414062  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5552101135253906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([686, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5567026138305664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5567026138305664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 686, 256]), torch.Size([1, 686, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5580110549926758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.587738037109375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 686, 256])
m.shape torch.Size([513, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5890564918518066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5890564918518066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5900349617004395  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.618410587310791  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([429, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6199831962585449  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6199831962585449  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6208014488220215  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6509366035461426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.652379035949707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.652379035949707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6529912948608398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6801700592041016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([253, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6815662384033203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6815662384033203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.6820487976074219  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7061767578125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7075042724609375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7075042724609375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7078933715820312  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.730072021484375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7314519882202148  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7314519882202148  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7317991256713867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7540159225463867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7551054954528809  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7551054954528809  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7553343772888184  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7715849876403809  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7726550102233887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7726550102233887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7728686332702637  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7895312309265137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([125, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7908663749694824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.7908663749694824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.791104793548584  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8113703727722168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8122515678405762  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8122515678405762  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8124041557312012  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8264422416687012  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.827427864074707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.827427864074707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8275766372680664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8423051834106445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8430962562561035  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8430962562561035  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8432106971740723  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8553414344787598  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8561301231384277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8561301231384277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8562350273132324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8680891990661621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8688702583312988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8688702583312988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8689675331115723  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8806405067443848  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8814573287963867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8814573287963867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8815526962280273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8936643600463867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8941464424133301  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8941464424133301  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.8942017555236816  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.901613712310791  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9019899368286133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9019899368286133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9020299911499023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9076776504516602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.908444881439209  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.908444881439209  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9085192680358887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9195284843444824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9199991226196289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9199991226196289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9200448989868164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9271402359008789  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9277586936950684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9277586936950684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9278140068054199  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.936774730682373  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9372315406799316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9372315406799316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9372715950012207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9440407752990723  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([244, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9498839378356934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9498839378356934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.9503493309020996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0322585105895996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 244, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.00368070602417  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0045223236083984  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.005363941192627  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0044798851013184  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5647, 40])
input nodes number: 10189
output nodes number: 5647
edges number: 35241
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.0045957565307617  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.00459623336792  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.023398399353027344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 8 input nodes size: 63259
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.021339893341064453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.021339893341064453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05150413513183594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.05154561996459961  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.042151451110839844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.04385948181152344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.04385948181152344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.04385948181152344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([63259, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.04385948181152344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1576, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13599014282226562  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13599014282226562  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1576, 128]), torch.Size([1, 1576, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.13749313354492188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.14951705932617188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1576, 128])
m.shape torch.Size([1667, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.15075159072875977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.15075159072875977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1667, 128]), torch.Size([1, 1667, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.15234136581420898  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17618799209594727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1667, 128])
m.shape torch.Size([1471, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17757320404052734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17757320404052734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1471, 128]), torch.Size([1, 1471, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.17897605895996094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21033477783203125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1471, 128])
m.shape torch.Size([1244, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21216058731079102  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.21216058731079102  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2133469581604004  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.24830007553100586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1133, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2506289482116699  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2506289482116699  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.2517094612121582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29068994522094727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1005, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29302501678466797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29302501678466797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.29398345947265625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3355588912963867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([945, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.33823394775390625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.33823394775390625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.33913516998291016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.38419628143310547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([937, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.38732004165649414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.38732004165649414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.3882136344909668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4391484260559082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([769, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4420018196105957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4420018196105957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4427351951599121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.4909062385559082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([13974, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5571727752685547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5571727752685547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 13974, 128]), torch.Size([1, 13974, 128])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.5704994201660156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5166912078857422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 13974, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4322905540466309  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4558663368225098  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4794421195983887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4556818008422852  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([24721, 256])
first layer input nodes number: 63259
first layer output nodes number: 24721
edges number: 186766
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.4799156188964844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5034914016723633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5096960067749023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5096960067749023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([971, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5514588356018066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5514588356018066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 971, 256]), torch.Size([1, 971, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5533108711242676  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5683932304382324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 971, 256])
m.shape torch.Size([837, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5690765380859375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5690765380859375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5706729888916016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.5983800888061523  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([598, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6002392768859863  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6002392768859863  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6013798713684082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6297345161437988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([453, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.631821632385254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.631821632385254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.632685661315918  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.666020393371582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([344, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6672415733337402  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6672415733337402  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6678977012634277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6950125694274902  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([252, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6961379051208496  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6961379051208496  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.6966185569763184  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7172865867614746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([205, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7184257507324219  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7184257507324219  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7188167572021484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7383670806884766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7397632598876953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7397632598876953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7401580810546875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7626628875732422  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([149, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7642903327941895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7642903327941895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7645745277404785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7827630043029785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([131, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7838802337646484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7838802337646484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.7841300964355469  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.801870346069336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([98, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8028006553649902  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8028006553649902  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8029875755310059  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8175673484802246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8186736106872559  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8186736106872559  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8188719749450684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8357329368591309  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8368334770202637  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8368334770202637  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8370165824890137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8538622856140137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8548870086669922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8548870086669922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8550357818603516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8697643280029297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8705697059631348  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8705697059631348  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8706860542297363  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.883018970489502  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8839893341064453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8839893341064453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8841133117675781  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.898122787475586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8988127708435059  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8988127708435059  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.8989005088806152  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9094290733337402  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9102158546447754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9102158546447754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9103074073791504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9219346046447754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9228019714355469  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9228019714355469  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9228973388671875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9356765747070312  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9365134239196777  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9365134239196777  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.936601161956787  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.948972225189209  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9497361183166504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9497361183166504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.949812412261963  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.961103916168213  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9615521430969238  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9615521430969238  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9615960121154785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.968395709991455  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9691476821899414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9691476821899414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9692144393920898  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9800291061401367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9804344177246094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9804344177246094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9804706573486328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 1.9865951538085938  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([571, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.0002975463867188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.0002975463867188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.0013866424560547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.195408344268799  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 571, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.1597251892089844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.1605491638183594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.1613731384277344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.1605076789855957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5527, 40])
input nodes number: 24721
output nodes number: 5527
edges number: 42244
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.1607160568237305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 2.1607165336608887  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.046953678131103516  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 9 input nodes size: 66961
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.04213380813598633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.04213380813598633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07406330108642578  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.07410573959350586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.0439000129699707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.046216487884521484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.046216487884521484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.046216487884521484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([66961, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9451904296875 GB
    Memory Allocated: 0.046216487884521484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1242, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.16975736618041992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.16975736618041992  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1242, 128]), torch.Size([1, 1242, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.17094182968139648  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.18085956573486328  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1242, 128])
m.shape torch.Size([1356, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.18156051635742188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.18156051635742188  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1356, 128]), torch.Size([1, 1356, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.18285369873046875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.20254898071289062  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1356, 128])
m.shape torch.Size([1298, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.20375919342041016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.20375919342041016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1298, 128]), torch.Size([1, 1298, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.20499706268310547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.23223018646240234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1298, 128])
m.shape torch.Size([1233, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.2339630126953125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.2339630126953125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1233, 128]), torch.Size([1, 1233, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.2351388931274414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.2698326110839844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1233, 128])
m.shape torch.Size([1226, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.2721676826477051  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.2721676826477051  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.27333688735961914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.31641149520874023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1112, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.31900835037231445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.31900835037231445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.3200688362121582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.36631059646606445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1074, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.36936521530151367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.36936521530151367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.370389461517334  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.42217111587524414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1030, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.42558813095092773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.42558813095092773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.42657041549682617  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.4825606346130371  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([1022, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.48645544052124023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.48645544052124023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.4874300956726074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.5498843193054199  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([20096, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.6452221870422363  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.6452221870422363  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 20096, 128]), torch.Size([1, 20096, 128])
----------------------------------------3
 Nvidia-smi: 5.0662841796875 GB
    Memory Allocated: 0.6643872261047363  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0367016792297363  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 20096, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.920884132385254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.950181007385254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.979477882385254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9499521255493164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([30689, 256])
first layer input nodes number: 66961
first layer output nodes number: 30689
edges number: 251498
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9799790382385254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0092759132385254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0167832374572754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0167832374572754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([678, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0746889114379883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0746889114379883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 678, 256]), torch.Size([1, 678, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.075982093811035  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.087174415588379  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 678, 256])
m.shape torch.Size([630, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0880069732666016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0880069732666016  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0892086029052734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1077895164489746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([487, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.108798027038574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.108798027038574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.109726905822754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1312952041625977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([374, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.132449150085449  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.132449150085449  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.133162498474121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.156641960144043  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([342, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.157928943634033  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.157928943634033  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.158581256866455  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.182760715484619  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([237, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1838016510009766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1838016510009766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.184253692626953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2036914825439453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([192, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2047572135925293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2047572135925293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2051234245300293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2234339714050293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([189, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2247042655944824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2247042655944824  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.225064754486084  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.245612621307373  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([147, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2467041015625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2467041015625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2469844818115234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2649288177490234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([152, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.266249656677246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.266249656677246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2665395736694336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.287123680114746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2883849143981934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2883849143981934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2886385917663574  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3084254264831543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.309809684753418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.309809684753418  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3100595474243164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3312978744506836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.332364082336426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.332364082336426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3325414657592773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.348860740661621  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3499293327331543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3499293327331543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.350093364715576  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.366332530975342  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.367577075958252  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.367577075958252  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3677525520324707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.386353015899658  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3884377479553223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3884377479553223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.3885884284973145  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4056153297424316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.406651496887207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.406651496887207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4067811965942383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4223451614379883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4236817359924316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4236817359924316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4238362312316895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4434571266174316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([71, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4446768760681152  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4446768760681152  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.444812297821045  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.462958812713623  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.463994026184082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.463994026184082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.464097023010254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4786195755004883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4797792434692383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4797792434692383  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.479893684387207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.496830940246582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.497767925262451  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.497767925262451  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.4978575706481934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.5117526054382324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.512636661529541  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.512636661529541  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.512716770172119  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.5256943702697754  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.5265769958496094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.5265769958496094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.526653289794922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.5395469665527344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([1130, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.5666608810424805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.5666608810424805  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1130, 256]), torch.Size([1, 1130, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.569016456604004  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.9515857696533203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1130, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.8989768028259277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.8998165130615234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.900656223297119  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.8997740745544434  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5635, 40])
input nodes number: 30689
output nodes number: 5635
edges number: 59331
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.9000611305236816  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.90006160736084  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.05024099349975586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 10 input nodes size: 54009
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.043915748596191406  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.043915748596191406  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.06966924667358398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.06971073150634766  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.037738800048828125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.039811134338378906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.039811134338378906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.039811134338378906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([54009, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.039811134338378906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([1044, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.1462841033935547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.1462841033935547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.1472797393798828  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.1552448272705078  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1064, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.15629911422729492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.15629911422729492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.15731382369995117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.17253446578979492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1036, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.1736750602722168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.1736750602722168  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.17466306686401367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.19639921188354492  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([931, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.19774389266967773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.19774389266967773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.19863176345825195  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.22504377365112305  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([945, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2268528938293457  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2268528938293457  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2277541160583496  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.26019811630249023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([857, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.26219940185546875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.26219940185546875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2630167007446289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2982044219970703  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([841, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.30060291290283203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.30060291290283203  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.3014049530029297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.34231996536254883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([755, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.3447990417480469  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.3447990417480469  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.3455190658569336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.3876361846923828  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([786, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.39064931869506836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.39064931869506836  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.39139890670776367  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.43941450119018555  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([17793, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.5238833427429199  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.5238833427429199  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 17793, 128]), torch.Size([1, 17793, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.5414047241210938  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.7478251457214355  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 17793, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.6473431587219238  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.6721882820129395  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.697033405303955  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.6719937324523926  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([26052, 256])
first layer input nodes number: 54009
first layer output nodes number: 26052
edges number: 216802
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.6974377632141113  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.722282886505127  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.729236125946045  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.729236125946045  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([670, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.789156436920166  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.789156436920166  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.7904343605041504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.80067777633667  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([536, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.801072120666504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.801072120666504  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8020944595336914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8205366134643555  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([450, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8213796615600586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8213796615600586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8222379684448242  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.841120719909668  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([358, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8421578407287598  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8421578407287598  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8428406715393066  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.864241123199463  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([306, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.865370273590088  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.865370273590088  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8659539222717285  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.891894817352295  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([228, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8929181098937988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.8929181098937988  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.89335298538208  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9120526313781738  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([215, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9138264656066895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9138264656066895  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9142365455627441  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9347405433654785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9356536865234375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9356536865234375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9359169006347656  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9509201049804688  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([167, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9522333145141602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9522333145141602  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9525518417358398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9729375839233398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([136, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.974085807800293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.974085807800293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9743452072143555  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.992762565612793  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9943652153015137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9943652153015137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 1.9946188926696777  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0144057273864746  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0157322883605957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0157322883605957  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.01597261428833  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.036400318145752  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.037567138671875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.037567138671875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0377635955810547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.055837631225586  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.056910514831543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.056910514831543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0570764541625977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0735044479370117  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.074676036834717  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.074676036834717  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0748419761657715  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.0924315452575684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([85, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.093656063079834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.093656063079834  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.093818187713623  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.112138271331787  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.113168716430664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.113168716430664  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1132984161376953  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1288623809814453  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1298184394836426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1298184394836426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1299309730529785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1442227363586426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1458873748779297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1458873748779297  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1459922790527344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1600494384765625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1611313819885254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1611313819885254  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1612439155578613  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1771111488342285  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1783671379089355  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1783671379089355  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1784911155700684  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1968398094177246  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1978139877319336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1978139877319336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.1979074478149414  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2123937606811523  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2132315635681152  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2132315635681152  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2133078575134277  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2256674766540527  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2273073196411133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2273073196411133  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.227389335632324  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2412500381469727  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([1254, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2713403701782227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2713403701782227  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1254, 256]), torch.Size([1, 1254, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.2737321853637695  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.7047696113586426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1254, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.6497230529785156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.650545597076416  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.6513681411743164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.6505041122436523  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([5517, 40])
input nodes number: 26052
output nodes number: 5517
edges number: 61279
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.6507229804992676  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 2.650723457336426  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.04337167739868164  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

pseudo mini batch 11 input nodes size: 56985
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.03772163391113281  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.03772163391113281  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.06489419937133789  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.06493663787841797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.03914165496826172  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.041556358337402344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.041556358337402344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.041556358337402344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([56985, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.041556358337402344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([976, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.16482210159301758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.16482210159301758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.16575288772583008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.1734619140625  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([1022, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.17397117614746094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.17397117614746094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.17494583129882812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.18976402282714844  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([949, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.19063425064086914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.19063425064086914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.19153928756713867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.21230840682983398  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([950, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2136678695678711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2136678695678711  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.21457386016845703  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.24169445037841797  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([972, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2435588836669922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2435588836669922  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.24448585510253906  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.27867889404296875  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([923, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2808561325073242  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2808561325073242  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.2817363739013672  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.32051849365234375  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([893, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.32305908203125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.32305908203125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.3239107131958008  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.36728763580322266  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([852, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.37011194229125977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.37011194229125977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 852, 128]), torch.Size([1, 852, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.3709244728088379  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.417269229888916  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 852, 128])
m.shape torch.Size([885, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.42066097259521484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.42066097259521484  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.4215049743652344  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.4783034324645996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([21019, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.5781078338623047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.5781078338623047  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 21019, 128]), torch.Size([1, 21019, 128])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.5981531143188477  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.0314407348632812  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 21019, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 1.915079116821289  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 1.9431562423706055  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 1.9712333679199219  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 1.9429364204406738  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

torch.Size([29441, 256])
first layer input nodes number: 56985
first layer output nodes number: 29441
edges number: 251287
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 1.9716601371765137  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 1.99973726272583  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.0071897506713867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.0071897506713867  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

m.shape torch.Size([607, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.0777840614318848  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.0777840614318848  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.078941822052002  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.0898919105529785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 607, 256])
m.shape torch.Size([468, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.090212821960449  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.090212821960449  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.0911054611206055  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1046319007873535  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([344, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1051855087280273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1051855087280273  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.105841636657715  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1218199729919434  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([286, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.122664451599121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.122664451599121  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1232099533081055  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.139599323272705  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([263, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1405906677246094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1405906677246094  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.141092300415039  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1599197387695312  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([217, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1609206199645996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1609206199645996  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.16133451461792  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1791319847106934  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([171, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1800756454467773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1800756454467773  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1804018020629883  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.196709632873535  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([151, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1977076530456543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.1977076530456543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.197995662689209  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.214412212371826  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.215643882751465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.215643882751465  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.215947151184082  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.235356330871582  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.236694812774658  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.236694812774658  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.236990451812744  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.2579808235168457  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.259199619293213  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.259199619293213  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.259443759918213  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.278486728668213  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([125, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.279806613922119  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.279806613922119  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.2800450325012207  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3003106117248535  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3015785217285156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3015785217285156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.301790237426758  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.321268081665039  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3226022720336914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3226022720336914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3228063583374023  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.343010902404785  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.344264507293701  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.344264507293701  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3444437980651855  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3634486198425293  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([94, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.364804744720459  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.364804744720459  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3649840354919434  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3852438926696777  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3865108489990234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.3865108489990234  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.386669158935547  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4056663513183594  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([102, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4073519706726074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4073519706726074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4075465202331543  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4322543144226074  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([91, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.43381929397583  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.43381929397583  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.433992862701416  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4572510719299316  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4589524269104004  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4589524269104004  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.459129810333252  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.4841408729553223  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([86, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.485788345336914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.485788345336914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.485952377319336  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5102291107177734  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5113039016723633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5113039016723633  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5113935470581055  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5252885818481445  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.526791572570801  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.526791572570801  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5269250869750977  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5485544204711914  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.550079345703125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.550079345703125  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.550210952758789  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.5724525451660156  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([1567, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.610039234161377  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.610039234161377  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

 h.shape torch.Size([1, 1567, 256]), torch.Size([1, 1567, 256])
----------------------------------------3
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 2.6132359504699707  GigaBytes
Max Memory Allocated: 3.022031784057617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 3.147947311401367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1567, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 3.0823068618774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 3.0831546783447266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 3.0840024948120117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 3.0831122398376465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5688, 40])
input nodes number: 29441
output nodes number: 5688
edges number: 72602
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 3.083399772644043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.9842529296875 GB
    Memory Allocated: 3.083400249481201  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04568672180175781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 12 input nodes size: 33337
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.039166927337646484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.039166927337646484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05506324768066406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.055106163024902344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027891159057617188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028795242309570312  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028795242309570312  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028795242309570312  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([33337, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028795242309570312  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1545, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07173299789428711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07173299789428711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1545, 128]), torch.Size([1, 1545, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07320642471313477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08568191528320312  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1545, 128])
m.shape torch.Size([1607, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08647775650024414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08647775650024414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1607, 128]), torch.Size([1, 1607, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08801031112670898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11099863052368164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1607, 128])
m.shape torch.Size([1477, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11275577545166016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11275577545166016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1477, 128]), torch.Size([1, 1477, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11416435241699219  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14560317993164062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1477, 128])
m.shape torch.Size([1235, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14767026901245117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14767026901245117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1488480567932129  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18369054794311523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1134, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1858053207397461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1858053207397461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18688678741455078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22588443756103516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([906, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.227935791015625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.227935791015625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22879981994628906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26595306396484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([740, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2679910659790039  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2679910659790039  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26869678497314453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30416297912597656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([662, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30633544921875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30633544921875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30696678161621094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34462928771972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([535, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34660959243774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34660959243774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3471198081970215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38074207305908203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([4524, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.40205907821655273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.40205907821655273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 4524, 128]), torch.Size([1, 4524, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4063735008239746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7151408195495605  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 4524, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6785407066345215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6922402381896973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.705939769744873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6921329498291016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([14365, 256])
first layer input nodes number: 33337
first layer output nodes number: 14365
edges number: 85767
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7061901092529297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7198896408081055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7233147621154785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7233147621154785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1066, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7588181495666504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7588181495666504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1066, 256]), torch.Size([1, 1066, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7612452507019043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7786331176757812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1066, 256])
m.shape torch.Size([863, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7793946266174316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7793946266174316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 863, 256]), torch.Size([1, 863, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7810406684875488  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8057312965393066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 863, 256])
m.shape torch.Size([693, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8077292442321777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8077292442321777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 693, 256]), torch.Size([1, 693, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8090510368347168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8387765884399414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 693, 256])
m.shape torch.Size([504, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8405036926269531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8405036926269531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8414649963378906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8693428039550781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([481, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8711738586425781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8711738586425781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8720912933349609  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9051408767700195  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([346, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9066777229309082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9066777229309082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9073376655578613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9366879463195801  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([262, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9381208419799805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9381208419799805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9386205673217773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9643392562866211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([227, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9658350944519043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9658350944519043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9662680625915527  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9909472465515137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([194, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9924092292785645  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9924092292785645  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9927792549133301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.01646089553833  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0177464485168457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0177464485168457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.018038272857666  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0387578010559082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.039806842803955  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.039806842803955  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.040022373199463  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0568337440490723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.057877540588379  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.057877540588379  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0580663681030273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0741167068481445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0753092765808105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0753092765808105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0755057334899902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0935797691345215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.094477653503418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.094477653503418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.094618797302246  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1085920333862305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1092281341552734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1092281341552734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1093215942382812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1192283630371094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1200275421142578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1200275421142578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1201324462890625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1319866180419922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.13275146484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.13275146484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1328468322753906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1442909240722656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1449356079101562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1449356079101562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1450119018554688  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1547012329101562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1553936004638672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1553936004638672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1554698944091797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1656932830810547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.166308879852295  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.166308879852295  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1663737297058105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1755175590515137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.175828456878662  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.175828456878662  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.17586088180542  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1806597709655762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1809821128845215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1809821128845215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1810126304626465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1857428550720215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1860814094543457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1860814094543457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1861119270324707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1910557746887207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1914329528808594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1914329528808594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1914653778076172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1969451904296875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.202864170074463  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.202864170074463  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2033352851867676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2862515449523926  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2576375007629395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.258495807647705  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2593541145324707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2584528923034668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5759, 40])
input nodes number: 14365
output nodes number: 5759
edges number: 35385
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2586135864257812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2586140632629395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.030609130859375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 13 input nodes size: 42529
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027901649475097656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027901649475097656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04818105697631836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.048223018646240234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.032283782958984375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03340625762939453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03340625762939453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03340625762939453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([42529, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03340625762939453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1433, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08930110931396484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08930110931396484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.090667724609375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10160064697265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1584, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10304689407348633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10304689407348633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1584, 128]), torch.Size([1, 1584, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10455751419067383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12774658203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1584, 128])
m.shape torch.Size([1431, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12964630126953125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12964630126953125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1431, 128]), torch.Size([1, 1431, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1310110092163086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16205310821533203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1431, 128])
m.shape torch.Size([1245, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16374540328979492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16374540328979492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1245, 128]), torch.Size([1, 1245, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1649327278137207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19989919662475586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1245, 128])
m.shape torch.Size([1136, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20201396942138672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20201396942138672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20309734344482422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24295330047607422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([926, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24506092071533203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24506092071533203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24594402313232422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28402042388916016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([874, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2864961624145508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2864961624145508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28732967376708984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.32900524139404297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([788, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33159446716308594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33159446716308594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33234596252441406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3752288818359375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([690, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37781429290771484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37781429290771484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37847232818603516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.42089176177978516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([6894, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.45343589782714844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.45343589782714844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 6894, 128]), torch.Size([1, 6894, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4600105285644531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9277582168579102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 6894, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8784761428833008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8946895599365234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9109029769897461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8945627212524414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([17001, 256])
first layer input nodes number: 42529
first layer output nodes number: 17001
edges number: 112682
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.911221981048584  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9274353981018066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9314889907836914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9314889907836914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([957, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.969027042388916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.969027042388916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 957, 256]), torch.Size([1, 957, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9708523750305176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9854550361633301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 957, 256])
m.shape torch.Size([812, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9868378639221191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9868378639221191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9883866310119629  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0122122764587402  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([619, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0137805938720703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0137805938720703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0149612426757812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0464458465576172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([489, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0477356910705566  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0477356910705566  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.048668384552002  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.075716495513916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([438, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0773553848266602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0773553848266602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.078190803527832  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1082658767700195  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([308, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1096243858337402  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1096243858337402  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1102118492126465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1370306015014648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1385669708251953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1385669708251953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1390857696533203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1663599014282227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.167783260345459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.167783260345459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1681857109069824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1911253929138184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1925249099731445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1925249099731445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1928777694702148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2154607772827148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2166204452514648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2166204452514648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2168855667114258  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2357091903686523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2370357513427734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2370357513427734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2372989654541016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2578296661376953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.259047508239746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.259047508239746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2592706680297852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2782392501831055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2793774604797363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2793774604797363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2795681953430176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2971158027648926  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.298083782196045  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.298083782196045  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.298234462738037  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3131518363952637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3140850067138672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3140850067138672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3142166137695312  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3281669616699219  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3291468620300293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3291468620300293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3292765617370605  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3439326286315918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3446850776672363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3446850776672363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.344780445098877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.356224536895752  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3570075035095215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3570075035095215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3570990562438965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3687262535095215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3692831993103027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3692831993103027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3693461418151855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3777804374694824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.378345012664795  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.378345012664795  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.378404140472412  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3867411613464355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.387619972229004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.387619972229004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3877058029174805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4004087448120117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4009156227111816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4009156227111816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4009652137756348  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4086518287658691  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4091577529907227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4091577529907227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4092035293579102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4166193008422852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4171042442321777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4171042442321777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4171462059020996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4242377281188965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([311, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.431689739227295  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.431689739227295  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4322829246520996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.539350986480713  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.508155345916748  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.508988857269287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5098223686218262  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5089468955993652  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5591, 40])
input nodes number: 17001
output nodes number: 5591
edges number: 37863
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5090909004211426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5090913772583008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03554677963256836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 14 input nodes size: 38485
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03225898742675781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03225898742675781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05061006546020508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05065202713012695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.030330657958984375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.031517982482910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.031517982482910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.031517982482910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([38485, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.031517982482910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1434, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09085559844970703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09085559844970703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1434, 128]), torch.Size([1, 1434, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0922231674194336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1031637191772461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1434, 128])
m.shape torch.Size([1457, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10396337509155273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10396337509155273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1457, 128]), torch.Size([1, 1457, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10535287857055664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1275324821472168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1457, 128])
m.shape torch.Size([1220, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12858295440673828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12858295440673828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1220, 128]), torch.Size([1, 1220, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1297464370727539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1556406021118164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1220, 128])
m.shape torch.Size([1133, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15721988677978516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15721988677978516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15830039978027344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1896352767944336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1005, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19149112701416016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19149112701416016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19244956970214844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22781133651733398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([862, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2297983169555664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2297983169555664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2306203842163086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26604747772216797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([810, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2687263488769531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2687263488769531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2694988250732422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3081226348876953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([752, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3106050491333008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3106050491333008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3113222122192383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3530855178833008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([644, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.35549068450927734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.35549068450927734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.35610485076904297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3955068588256836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([7955, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4331321716308594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4331321716308594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 7955, 128]), torch.Size([1, 7955, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4407186508178711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9923548698425293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 7955, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9382281303405762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9546999931335449  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9711718559265137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9545712471008301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([17272, 256])
first layer input nodes number: 38485
first layer output nodes number: 17272
edges number: 119769
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9714608192443848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9879326820373535  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9922909736633301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9922909736633301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([985, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0314340591430664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0314340591430664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 985, 256]), torch.Size([1, 985, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0333127975463867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.050145149230957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 985, 256])
m.shape torch.Size([826, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0507936477661133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0507936477661133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0523691177368164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0760011672973633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([595, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.07710599899292  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.07710599899292  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0782408714294434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.103208065032959  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 595, 256])
m.shape torch.Size([476, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1048712730407715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1048712730407715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1057791709899902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1322226524353027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1337008476257324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1337008476257324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.134467601776123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1620707511901855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([325, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1635618209838867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1635618209838867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1641817092895508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.191615104675293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1931285858154297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1931285858154297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1936454772949219  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.22090482711792  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2223153114318848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2223153114318848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.222729206085205  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.246321201324463  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([161, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.247507095336914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.247507095336914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2478141784667969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2674674987792969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2688617706298828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2688617706298828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2691688537597656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2909717559814453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2922563552856445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2922563552856445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.292515754699707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.312748908996582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([92, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.313680648803711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.313680648803711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3138561248779297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3287715911865234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3295960426330566  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3295960426330566  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.329735279083252  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3425450325012207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.343430995941162  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.343430995941162  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3435664176940918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3569731712341309  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.357813835144043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.357813835144043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3579339981079102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.370671272277832  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.371488094329834  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.371488094329834  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3715968132019043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3838820457458496  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3846940994262695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3846940994262695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3847951889038086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.396925926208496  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3976712226867676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3976712226867676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.397758960723877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4089016914367676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4096980094909668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4096980094909668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4097857475280762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4215426445007324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.42234468460083  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.42234468460083  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4224286079406738  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4342617988586426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4348459243774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4348459243774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4349050521850586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4436559677124023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.444303035736084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.444303035736084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.444364070892334  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.453824520111084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4541702270507812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4541702270507812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.454202651977539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4594554901123047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4601316452026367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4601316452026367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.460188865661621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4698591232299805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([407, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4796099662780762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4796099662780762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4803862571716309  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.617663860321045  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 407, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5848360061645508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5856733322143555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5865106582641602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5856313705444336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5617, 40])
input nodes number: 17272
output nodes number: 5617
edges number: 39502
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.585805892944336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5858063697814941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03374004364013672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 15 input nodes size: 56936
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03033447265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03033447265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.057483673095703125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0575251579284668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.039132118225097656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04097270965576172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04097270965576172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04097270965576172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([56936, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04097270965576172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1282, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1364140510559082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1364140510559082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13763666152954102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14741754531860352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1453, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14895391464233398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14895391464233398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15033960342407227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17175817489624023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([1222, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17281341552734375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17281341552734375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1222, 128]), torch.Size([1, 1222, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1739788055419922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1998891830444336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1222, 128])
m.shape torch.Size([1149, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20149803161621094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20149803161621094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20259380340576172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23437118530273438  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1044, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2363123893737793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2363123893737793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23730802536010742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2731509208679199  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([968, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2754225730895996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2754225730895996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27634572982788086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31611013412475586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([906, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31867265701293945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31867265701293945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3195366859436035  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3638606071472168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([866, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.366732120513916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.366732120513916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.36755800247192383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.41463327407836914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([862, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4179196357727051  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4179196357727051  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.41874170303344727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.47232770919799805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([14939, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5431513786315918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5431513786315918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 14939, 128]), torch.Size([1, 14939, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5573983192443848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5841879844665527  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 14939, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.495913028717041  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5194602012634277  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5430073738098145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5192761421203613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([24691, 256])
first layer input nodes number: 56936
first layer output nodes number: 24691
edges number: 193896
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.543433666229248  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5669808387756348  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5736432075500488  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5736432075500488  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([818, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6258301734924316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6258301734924316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6273903846740723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6398720741271973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([695, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6404643058776855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6404643058776855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 695, 256]), torch.Size([1, 695, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6417899131774902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6622028350830078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 695, 256])
m.shape torch.Size([532, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6631617546081543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6631617546081543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6641764640808105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6893181800842285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([375, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6902680397033691  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6902680397033691  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6909832954406738  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7131905555725098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([305, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7142987251281738  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7142987251281738  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7148804664611816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7366161346435547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([259, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7378191947937012  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7378191947937012  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7383131980895996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.761094570159912  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([197, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7621731758117676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7621731758117676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7625489234924316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7813363075256348  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([155, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7823405265808105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7823405265808105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7826361656188965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.799487590789795  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([169, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8008017539978027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8008017539978027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.801124095916748  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.821753978729248  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([122, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.822765827178955  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.822765827178955  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8229985237121582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.83951997756958  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8407254219055176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8407254219055176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8409638404846191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.859560489654541  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([92, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8605027198791504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8605027198791504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8606781959533691  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.875593662261963  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([84, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8766608238220215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8766608238220215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8768210411071777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8915610313415527  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.892463207244873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.892463207244873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8926024436950684  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9063868522644043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9073410034179688  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9073410034179688  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9074764251708984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9218311309814453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.922563076019287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.922563076019287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9226622581481934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9338698387145996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.934800624847412  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.934800624847412  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9349150657653809  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9486479759216309  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.949732780456543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.949732780456543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9498586654663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.965846061706543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([64, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.966951847076416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.966951847076416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.967073917388916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.983431339263916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.984273910522461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.984273910522461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9843635559082031  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9970035552978516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.997786521911621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.997786521911621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9978647232055664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0094385147094727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0102033615112305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0102033615112305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0102758407592773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.021510124206543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.022225856781006  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.022225856781006  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0222907066345215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0327963829040527  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.033825397491455  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.033825397491455  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0339131355285645  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes
[05:25:24] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27803442 edges into 16 parts and get 6416800 edge cuts

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.048740863800049  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([997, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.072653293609619  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.072653293609619  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 997, 256]), torch.Size([1, 997, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.074554920196533  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.41593599319458  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 997, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3693456649780273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3701682090759277  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.370990753173828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.370126724243164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5517, 40])
input nodes number: 24691
output nodes number: 5517
edges number: 53105
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.37033748626709  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.370337963104248  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04423332214355469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04423332214355469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04423332214355469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011041790246963501 |0.0015293210744857788 |0.11639939248561859 |9.247660636901855e-05 |0.07535970211029053 |0.004857301712036133 |
----------------------------------------------------------pseudo_mini_loss sum 4.795449256896973
Total (block generation + training)time/epoch 26.231505393981934
Training time/epoch 3.362898588180542
Training time without block to device /epoch 3.3384294509887695
Training time without total dataloading part /epoch 3.0744824409484863
load block tensor time/epoch 0.17666864395141602
block to device time/epoch 0.02446913719177246
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  881110
Number of first layer input nodes during this epoch:  601116
Number of first layer output nodes during this epoch:  279994
----------------------------------------before generate dataloader block 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.044232845306396484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018983125686645508
global_2_local spend time (sec) 0.04747319221496582
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004147768020629883
A = g.adjacency_matrix() spent  0.012336015701293945
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0845334529876709
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.2994065284729004
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1728382110595703

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18726793, 2.0: 3227048, 3.0: 807585, 4.0: 243406, 5.0: 88339, 6.0: 38420, 7.0: 17657, 8.0: 9197, 9.0: 4921, 10.0: 2773, 11.0: 1643, 12.0: 917, 13.0: 542, 14.0: 332, 15.0: 191, 16.0: 175, 17.0: 133, 18.0: 67, 19.0: 35, 20.0: 12, 21.0: 6})
Convert a graph into a bidirected graph: 1.101 seconds
Metis partitioning: 5.491 seconds
Split the graph: 0.861 seconds
Construct subgraphs: 0.067 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.532991170883179
5854
5742
5854
5854
5854
5624
5524
5662
5534
5517
5533
5765
5735
5518
5854
5517
total k batches seeds list generation spend  19.451752424240112
after graph partition
graph partition algorithm spend time 19.573301553726196
5854
5742
5854
5854
5854
5624
5524
5662
5534
5517
5533
5765
5735
5518
5854
5517
partition_len_list
[14094, 13337, 13421, 11084, 12338, 11990, 10707, 10379, 17402, 19796, 12415, 12880, 29387, 28063, 28346, 26218]
shared_neighbor_graph_partition_s0 selection method  spend 19.682925701141357
time for parepare:  0.019461393356323242
local_output_nid generation:  0.0018222332000732422
local_in_edges_tensor generation:  0.0017914772033691406
mini_batch_src_global generation:  0.0022966861724853516
r_  generation:  0.018574237823486328
local_output_nid generation:  0.002057313919067383
local_in_edges_tensor generation:  0.001560211181640625
mini_batch_src_global generation:  0.002009153366088867
r_  generation:  0.016160249710083008
local_output_nid generation:  0.002203226089477539
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.0019407272338867188
r_  generation:  0.01781630516052246
local_output_nid generation:  0.002226591110229492
local_in_edges_tensor generation:  0.001445770263671875
mini_batch_src_global generation:  0.0015480518341064453
r_  generation:  0.015703201293945312
local_output_nid generation:  0.0023741722106933594
local_in_edges_tensor generation:  0.0014519691467285156
mini_batch_src_global generation:  0.0019979476928710938
r_  generation:  0.02258896827697754
local_output_nid generation:  0.003679037094116211
local_in_edges_tensor generation:  0.0014514923095703125
mini_batch_src_global generation:  0.0019030570983886719
r_  generation:  0.01454782485961914
local_output_nid generation:  0.0021224021911621094
local_in_edges_tensor generation:  0.0013637542724609375
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.011798858642578125
local_output_nid generation:  0.002057313919067383
local_in_edges_tensor generation:  0.001451730728149414
mini_batch_src_global generation:  0.0013170242309570312
r_  generation:  0.015688180923461914
local_output_nid generation:  0.0020775794982910156
local_in_edges_tensor generation:  0.0013048648834228516
mini_batch_src_global generation:  0.0012311935424804688
r_  generation:  0.012030601501464844
local_output_nid generation:  0.0020325183868408203
local_in_edges_tensor generation:  0.0013265609741210938
mini_batch_src_global generation:  0.0012714862823486328
r_  generation:  0.017090559005737305
local_output_nid generation:  0.0026595592498779297
local_in_edges_tensor generation:  0.001444101333618164
mini_batch_src_global generation:  0.0014252662658691406
r_  generation:  0.011063337326049805
local_output_nid generation:  0.002169370651245117
local_in_edges_tensor generation:  0.001392364501953125
mini_batch_src_global generation:  0.0011463165283203125
r_  generation:  0.012413740158081055
local_output_nid generation:  0.0020360946655273438
local_in_edges_tensor generation:  0.0019202232360839844
mini_batch_src_global generation:  0.0020020008087158203
r_  generation:  0.022683382034301758
local_output_nid generation:  0.0022704601287841797
local_in_edges_tensor generation:  0.002080202102661133
mini_batch_src_global generation:  0.0021181106567382812
r_  generation:  0.019327163696289062
local_output_nid generation:  0.0023550987243652344
local_in_edges_tensor generation:  0.0019881725311279297
mini_batch_src_global generation:  0.016017675399780273
r_  generation:  0.025352001190185547
local_output_nid generation:  0.0024077892303466797
local_in_edges_tensor generation:  0.0016651153564453125
mini_batch_src_global generation:  0.001981496810913086
r_  generation:  0.019235849380493164
----------------------check_connections_block total spend ----------------------------- 0.47619056701660156
generate_one_block  0.02820873260498047
generate_one_block  0.019904375076293945
generate_one_block  0.02374577522277832
generate_one_block  0.02944803237915039
generate_one_block  0.02418684959411621
generate_one_block  0.021912097930908203
generate_one_block  0.01625680923461914
generate_one_block  0.020522117614746094
generate_one_block  0.01801919937133789
generate_one_block  0.02039027214050293
generate_one_block  0.015743732452392578
generate_one_block  0.015142679214477539
generate_one_block  0.03952670097351074
generate_one_block  0.03578472137451172
generate_one_block  0.039597272872924805
generate_one_block  0.02941608428955078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0501103401184082
gen group dst list time:  0.009945154190063477
time for parepare:  0.024670839309692383
local_output_nid generation:  0.0031168460845947266
local_in_edges_tensor generation:  0.015964508056640625
mini_batch_src_global generation:  0.004957675933837891
r_  generation:  0.03580474853515625
local_output_nid generation:  0.0041196346282958984
local_in_edges_tensor generation:  0.004203319549560547
mini_batch_src_global generation:  0.0033063888549804688
r_  generation:  0.030676841735839844
local_output_nid generation:  0.004079341888427734
local_in_edges_tensor generation:  0.003362894058227539
mini_batch_src_global generation:  0.002767801284790039
r_  generation:  0.03110027313232422
local_output_nid generation:  0.0032896995544433594
local_in_edges_tensor generation:  0.0026073455810546875
mini_batch_src_global generation:  0.0021619796752929688
r_  generation:  0.023226261138916016
local_output_nid generation:  0.0036704540252685547
local_in_edges_tensor generation:  0.0028693675994873047
mini_batch_src_global generation:  0.0022840499877929688
r_  generation:  0.028569936752319336
local_output_nid generation:  0.003468036651611328
local_in_edges_tensor generation:  0.0025331974029541016
mini_batch_src_global generation:  0.0022907257080078125
r_  generation:  0.026341676712036133
local_output_nid generation:  0.0030205249786376953
local_in_edges_tensor generation:  0.0023713111877441406
mini_batch_src_global generation:  0.001924753189086914
r_  generation:  0.023992300033569336
local_output_nid generation:  0.003083467483520508
local_in_edges_tensor generation:  0.002374887466430664
mini_batch_src_global generation:  0.0019991397857666016
r_  generation:  0.024051904678344727
local_output_nid generation:  0.0047855377197265625
local_in_edges_tensor generation:  0.004573822021484375
mini_batch_src_global generation:  0.003756999969482422
r_  generation:  0.04239988327026367
local_output_nid generation:  0.005500316619873047
local_in_edges_tensor generation:  0.006459951400756836
mini_batch_src_global generation:  0.0054209232330322266
r_  generation:  0.05379962921142578
local_output_nid generation:  0.003699064254760742
local_in_edges_tensor generation:  0.0030531883239746094
mini_batch_src_global generation:  0.0032567977905273438
r_  generation:  0.02814769744873047
local_output_nid generation:  0.003687620162963867
local_in_edges_tensor generation:  0.0030078887939453125
mini_batch_src_global generation:  0.0025920867919921875
r_  generation:  0.027749300003051758
local_output_nid generation:  0.0068285465240478516
local_in_edges_tensor generation:  0.008242368698120117
mini_batch_src_global generation:  0.00840139389038086
r_  generation:  0.08844208717346191
local_output_nid generation:  0.00795435905456543
local_in_edges_tensor generation:  0.007868051528930664
mini_batch_src_global generation:  0.009682893753051758
r_  generation:  0.08105611801147461
local_output_nid generation:  0.00737452507019043
local_in_edges_tensor generation:  0.0066335201263427734
mini_batch_src_global generation:  0.01024770736694336
r_  generation:  0.08695292472839355
local_output_nid generation:  0.007139444351196289
local_in_edges_tensor generation:  0.006345510482788086
mini_batch_src_global generation:  0.009231328964233398
r_  generation:  0.07657694816589355
----------------------check_connections_block total spend ----------------------------- 1.1383740901947021
generate_one_block  0.06399393081665039
generate_one_block  0.041564226150512695
generate_one_block  0.03999614715576172
generate_one_block  0.029445886611938477
generate_one_block  0.03654909133911133
generate_one_block  0.033284902572631836
generate_one_block  0.02791619300842285
generate_one_block  0.030713319778442383
generate_one_block  0.05538344383239746
generate_one_block  0.06844830513000488
generate_one_block  0.033872365951538086
generate_one_block  0.03539609909057617
generate_one_block  0.11777067184448242
generate_one_block  0.10726356506347656
generate_one_block  0.10957479476928711
generate_one_block  0.09884285926818848
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.044232845306396484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

connection checking time:  1.1383740901947021
block generation total time  0.9300158023834229
average batch blocks generation time:  0.05812598764896393
block dataloader generation time/epoch 22.848251223564148
pseudo mini batch 0 input nodes size: 34267
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03911638259887695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03911638259887695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05545616149902344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.055500030517578125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028309345245361328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02941751480102539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02941751480102539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02941751480102539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([34267, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02941751480102539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1019, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07775688171386719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07775688171386719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07872867584228516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08679628372192383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([1115, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08755826950073242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08755826950073242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08862161636352539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10457181930541992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1073, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1055750846862793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1055750846862793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1065983772277832  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12911081314086914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([968, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1304454803466797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1304454803466797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13136863708496094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15838050842285156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([924, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16083335876464844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16083335876464844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1617145538330078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19365739822387695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([798, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19549989700317383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19549989700317383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19626092910766602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22898530960083008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([712, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23139333724975586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23139333724975586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2320723533630371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26666975021362305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([658, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26884031295776367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26884031295776367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.269467830657959  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3060946464538574  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([557, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30817127227783203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30817127227783203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3087024688720703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34284162521362305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([6270, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37247371673583984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37247371673583984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 6270, 128]), torch.Size([1, 6270, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37845325469970703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8030004501342773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 6270, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.761573314666748  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7750144004821777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7884554862976074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7749090194702148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([14094, 256])
first layer input nodes number: 34267
first layer output nodes number: 14094
edges number: 97709
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7887129783630371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8021540641784668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8055143356323242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8055143356323242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([707, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8556389808654785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8556389808654785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 707, 256]), torch.Size([1, 707, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.856987476348877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.868471622467041  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 707, 256])
m.shape torch.Size([661, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8694000244140625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8694000244140625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8706607818603516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8904514312744141  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([554, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8914260864257812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8914260864257812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8924827575683594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9163007736206055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([486, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9176526069641113  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9176526069641113  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9185795783996582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9457745552062988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([400, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9472336769104004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9472336769104004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9479966163635254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.976585865020752  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9781017303466797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9781017303466797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.978729248046875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0061378479003906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([287, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0077552795410156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0077552795410156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0083026885986328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0368714332580566  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([264, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0387115478515625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0387115478515625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.039215087890625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0689620971679688  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([194, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0703887939453125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0703887939453125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0707588195800781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0944404602050781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([193, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0961108207702637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0961108207702637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0964789390563965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1226153373718262  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1247234344482422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1247234344482422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1250228881835938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1483802795410156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([157, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1500415802001953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1500415802001953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1503410339355469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1757946014404297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([126, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1772193908691406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1772193908691406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.177459716796875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1995697021484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([123, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2011046409606934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2011046409606934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2013392448425293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.224565029144287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([111, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.226048469543457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.226048469543457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2262601852416992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.248702049255371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.249795913696289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.249795913696289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2499446868896484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2667560577392578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([77, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2679400444030762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2679400444030762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2680869102478027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2857108116149902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2866487503051758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2866487503051758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.286759376525879  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3008089065551758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3017945289611816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3017945289611816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.301903247833252  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3164715766906738  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3174748420715332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3174748420715332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.317579746246338  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3323712348937988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3332476615905762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3332476615905762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3333353996276855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.346320629119873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.347397804260254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.347397804260254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.347498893737793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3631677627563477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3637804985046387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3637804985046387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.363837718963623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3731074333190918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3740248680114746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3740248680114746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.37410306930542  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3873190879821777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([610, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.401937484741211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.401937484741211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4031009674072266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.608994483947754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 610, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.565040111541748  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5659127235412598  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5667853355407715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.565868854522705  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5854, 40])
input nodes number: 14094
output nodes number: 5854
edges number: 50882
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.566068172454834  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5660691261291504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.031594276428222656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 1 input nodes size: 30785
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028360366821289062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028360366821289062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.043039798736572266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04308271408081055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026699066162109375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027616500854492188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027616500854492188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027616500854492188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([30785, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027616500854492188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1235, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0690774917602539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0690774917602539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07025527954101562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0798182487487793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1361, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08052730560302734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08052730560302734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1361, 128]), torch.Size([1, 1361, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08182525634765625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10157203674316406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1361, 128])
m.shape torch.Size([1304, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10278844833374023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10278844833374023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1304, 128]), torch.Size([1, 1304, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10403203964233398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13139104843139648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1304, 128])
m.shape torch.Size([1141, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13294553756713867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13294553756713867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1340336799621582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1655898094177246  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([967, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16735124588012695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16735124588012695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1682734489440918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20217323303222656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([791, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20397520065307617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20397520065307617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20472955703735352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2379918098449707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([715, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24000120162963867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24000120162963867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24068307876586914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27521562576293945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([660, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2773923873901367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2773923873901367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27802181243896484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31436586380004883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([581, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3165445327758789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3165445327758789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31709861755371094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.35422658920288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([4582, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37579822540283203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.37579822540283203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 4582, 128]), torch.Size([1, 4582, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38016796112060547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6913127899169922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 4582, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6559391021728516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6686582565307617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6813774108886719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6685585975646973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([13337, 256])
first layer input nodes number: 30785
first layer output nodes number: 13337
edges number: 83348
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6816091537475586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6943283081054688  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6975083351135254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6975083351135254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([882, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7366867065429688  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7366867065429688  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7383689880371094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7519102096557617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([790, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7530074119567871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7530074119567871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.754514217376709  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7786860466003418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([656, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7799997329711914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7799997329711914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 656, 256]), torch.Size([1, 656, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7812509536743164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8092703819274902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 656, 256])
m.shape torch.Size([568, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.810828685760498  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.810828685760498  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8119120597839355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.843329906463623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([430, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8448567390441895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8448567390441895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8456768989562988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8815274238586426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8829226493835449  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8829226493835449  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8835196495056152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9092564582824707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9107880592346191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9107880592346191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9113068580627441  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9381132125854492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([243, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9397225379943848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9397225379943848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9401860237121582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9666047096252441  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([202, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9681205749511719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9681205749511719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.968505859375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9931640625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9944519996643066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9944519996643066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9947457313537598  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0156006813049316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([150, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0170397758483887  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0170397758483887  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0173258781433105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0396418571472168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0410561561584473  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0410561561584473  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.041313648223877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0632004737854004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0645089149475098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0645089149475098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0647282600402832  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0849080085754395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.085996150970459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.085996150970459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0861659049987793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1029715538024902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1040401458740234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1040401458740234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1041927337646484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1203670501708984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1211366653442383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1211366653442383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.121241569519043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1330957412719727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1339750289916992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1339750289916992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1340837478637695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.147130012512207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.147923469543457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.147923469543457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1480169296264648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.159886360168457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1607165336608887  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1607165336608887  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1608080863952637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1730761528015137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1737804412841797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1737804412841797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1738548278808594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1843433380126953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1850128173828125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1850128173828125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.185079574584961  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1949596405029297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1955394744873047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1955394744873047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1955947875976562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2041683197021484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2047600746154785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2047600746154785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2048134803771973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2134652137756348  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2139692306518555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2139692306518555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2140130996704102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2214269638061523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([300, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2286138534545898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2286138534545898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2291860580444336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3311786651611328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 300, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2987632751464844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.299619197845459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3004751205444336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2995762825012207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5742, 40])
input nodes number: 13337
output nodes number: 5742
edges number: 39639
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2997021675109863  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2997026443481445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02940654754638672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 2 input nodes size: 27652
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026682376861572266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026682376861572266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03986787796020508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.039911746978759766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02518939971923828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026182174682617188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026182174682617188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026182174682617188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([27652, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026182174682617188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1204, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06894874572753906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06894874572753906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07009696960449219  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07928276062011719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1290, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08046150207519531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08046150207519531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08169174194335938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10014533996582031  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1175, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1014556884765625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1014556884765625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10257625579833984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12774181365966797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1175, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12927770614624023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12927770614624023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13030099868774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16087865829467773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([958, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16265106201171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16265106201171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16356468200683594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1972513198852539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([840, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19919776916503906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19919776916503906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1999988555908203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23475074768066406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([730, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2367868423461914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2367868423461914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23748302459716797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2722921371459961  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([702, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27462196350097656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27462196350097656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27529144287109375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3143482208251953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([573, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31647253036499023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31647253036499023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.317018985748291  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3534231185913086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([4876, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3764004707336426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3764004707336426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 4876, 128]), torch.Size([1, 4876, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38105058670043945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7271485328674316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 4876, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6893243789672852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7021236419677734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7149229049682617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7020235061645508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([13421, 256])
first layer input nodes number: 27652
first layer output nodes number: 13421
edges number: 86074
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7151312828063965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7279305458068848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7311305999755859  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7311305999755859  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7773647308349609  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7773647308349609  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7789440155029297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7924809455871582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([692, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.793097972869873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.793097972869873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 692, 256]), torch.Size([1, 692, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7944178581237793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.814216136932373  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 692, 256])
m.shape torch.Size([561, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8159499168395996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8159499168395996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8170199394226074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8408312797546387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([462, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8420724868774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8420724868774414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8429536819458008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8686532974243164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([425, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8702554702758789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8702554702758789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8710660934448242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9002485275268555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9017868041992188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9017868041992188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9024295806884766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9305696487426758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9320716857910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9320716857910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9325885772705078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9589910507202148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([278, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9608702659606934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9608702659606934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9614005088806152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9929633140563965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([208, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9944977760314941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9944977760314941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9948945045471191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0202851295471191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([216, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.022162914276123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.022162914276123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0225749015808105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.051826000213623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([176, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.053481101989746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.053481101989746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.053816795349121  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.080000877380371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([139, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0814366340637207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0814366340637207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0817017555236816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1042370796203613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1054668426513672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1054668426513672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1056747436523438  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1248016357421875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1259088516235352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1259088516235352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1260805130004883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1430749893188477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1452727317810059  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1452727317810059  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1454520225524902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.164456844329834  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1656436920166016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1656436920166016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.165802001953125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1836910247802734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.184755802154541  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.184755802154541  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.184889316558838  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.200911045074463  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.202038288116455  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.202038288116455  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2021698951721191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.218883991241455  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2200417518615723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2200417518615723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2201695442199707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2372937202453613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2383642196655273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2383642196655273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2384767532348633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2543439865112305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2551560401916504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2551560401916504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2552380561828613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.26737642288208  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.268287181854248  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.268287181854248  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2683730125427246  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2816767692565918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.282496452331543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.282496452331543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2825708389282227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.294621467590332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2953686714172363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2953686714172363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.295433521270752  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3063931465148926  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([459, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.317389965057373  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.317389965057373  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.318265438079834  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.473802089691162  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 459, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.433969497680664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4348421096801758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4357147216796875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.434798240661621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5854, 40])
input nodes number: 13421
output nodes number: 5854
edges number: 47028
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4349589347839355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4349594116210938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028115272521972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 3 input nodes size: 19247
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02520608901977539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02520608901977539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03438377380371094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.034427642822265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021198272705078125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021944046020507812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021944046020507812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021944046020507812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([19247, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021944046020507812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1269, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.053040504455566406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.053040504455566406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1269, 128]), torch.Size([1, 1269, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05425071716308594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06476163864135742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1269, 128])
m.shape torch.Size([1375, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06546783447265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06546783447265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06677913665771484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08644866943359375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1205, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0883326530456543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0883326530456543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1205, 128]), torch.Size([1, 1205, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08948183059692383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1149907112121582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1205, 128])
m.shape torch.Size([1083, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11648178100585938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11648178100585938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11751461029052734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14770889282226562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([924, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14939546585083008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14939546585083008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15027666091918945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1821446418762207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([788, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1839585304260254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1839585304260254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18471002578735352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21707391738891602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([660, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2189011573791504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2189011573791504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21953058242797852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2518601417541504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([582, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2537655830383301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2537655830383301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2543206214904785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2860226631164551  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([480, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28780508041381836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28780508041381836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28826284408569336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31755971908569336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([2718, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3302912712097168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3302912712097168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 2718, 128]), torch.Size([1, 2718, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3333315849304199  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.518094539642334  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 2718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4921727180480957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5027432441711426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5133137702941895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5026602745056152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([11084, 256])
first layer input nodes number: 19247
first layer output nodes number: 11084
edges number: 62090
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5134592056274414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5240297317504883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5267124176025391  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5267124176025391  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([834, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5641074180603027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5641074180603027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5656981468200684  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5807147026062012  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([825, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.581505298614502  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.581505298614502  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 825, 256]), torch.Size([1, 825, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5830788612365723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6072468757629395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 825, 256])
m.shape torch.Size([666, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6091418266296387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6091418266296387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6104121208190918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6392168998718262  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([564, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6407504081726074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6407504081726074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6418261528015137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6730227470397949  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([465, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6748218536376953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6748218536376953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6757087707519531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7076568603515625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([386, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.709439754486084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.709439754486084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7101759910583496  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7418341636657715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([335, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7437200546264648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7437200546264648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.744359016418457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7777481079101562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([273, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7795281410217285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7795281410217285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7800488471984863  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.810549259185791  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([241, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8123736381530762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8123736381530762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.812833309173584  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.842252254486084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8436756134033203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8436756134033203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8440036773681641  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8672962188720703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([156, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.868781566619873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.868781566619873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8690791130065918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8922877311706543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8938403129577637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8938403129577637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8940997123718262  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9161486625671387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([122, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9175434112548828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9175434112548828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9177761077880859  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9391841888427734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.940373420715332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.940373420715332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9405584335327148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9588747024536133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9600653648376465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9600653648376465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9602351188659668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9782290458679199  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9791898727416992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9791898727416992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9793195724487305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9939756393432617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9947118759155273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9947118759155273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9948053359985352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0060205459594727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0067181587219238  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0067181587219238  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0068001747131348  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0172162055969238  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.017777919769287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.017777919769287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.01784086227417  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0262751579284668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0268783569335938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0268783569335938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0269412994384766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0358161926269531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0363097190856934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0363097190856934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0363593101501465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.043698787689209  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0442872047424316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0442872047424316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0443425178527832  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0529160499572754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0534191131591797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0534191131591797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0534648895263672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0608806610107422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0612730979919434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0612730979919434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.061307430267334  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0671095848083496  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([170, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0711774826049805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0711774826049805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0715017318725586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1285696029663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 170, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0977892875671387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0986618995666504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.099534511566162  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0986180305480957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5854, 40])
input nodes number: 11084
output nodes number: 5854
edges number: 37824
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0987448692321777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.098745346069336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023430347442626953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 4 input nodes size: 20915
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021198272705078125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021198272705078125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.031171321868896484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.031215190887451172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021993637084960938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023001670837402344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023001670837402344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023001670837402344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([20915, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023001670837402344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([939, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06417655944824219  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06417655944824219  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06507205963134766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0722360610961914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([1020, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07276105880737305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07276105880737305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07373380661010742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08883428573608398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([1016, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09009361267089844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09009361267089844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09106254577636719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11253929138183594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([913, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11379623413085938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11379623413085938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11466693878173828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14029312133789062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([870, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14193201065063477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14193201065063477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1427617073059082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17332983016967773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([744, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17504358291625977  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17504358291625977  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17575311660766602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2063736915588379  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([670, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20825529098510742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20825529098510742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2088942527770996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24148035049438477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([596, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24343442916870117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24343442916870117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2440028190612793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27682065963745117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([519, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2787637710571289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2787637710571289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27925872802734375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3113579750061035  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([5051, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33519554138183594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33519554138183594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 5051, 128]), torch.Size([1, 5051, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3404073715209961  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6872844696044922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 5051, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6504874229431152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6622538566589355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6740202903747559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6621618270874023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([12338, 256])
first layer input nodes number: 20915
first layer output nodes number: 12338
edges number: 83132
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6741781234741211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6859445571899414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6888861656188965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6888861656188965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([644, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7397513389587402  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7397513389587402  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7409796714782715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7508063316345215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([597, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7513628005981445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7513628005981445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7525014877319336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7713069915771484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([554, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7726316452026367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7726316452026367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7736883163452148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7976078987121582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7988519668579102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7988519668579102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7997312545776367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8254175186157227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([422, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8270058631896973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8270058631896973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8278107643127441  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8567872047424316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([331, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8582940101623535  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8582940101623535  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8589253425598145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8867764472961426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([317, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8885936737060547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8885936737060547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8891983032226562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9196128845214844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([268, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9213714599609375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9213714599609375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9218826293945312  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9519128799438477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([230, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9536471366882324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9536471366882324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9540858268737793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9821619987487793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([202, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.983884334564209  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.983884334564209  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9842696189880371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.011624813079834  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([180, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0133352279663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0133352279663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0136785507202148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0404577255249023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0419702529907227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0419702529907227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0422487258911133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0659189224243164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([126, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0673542022705078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0673542022705078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0675945281982422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0897045135498047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([132, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0913605690002441  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0913605690002441  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0916123390197754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1165375709533691  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([109, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.117983341217041  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.117983341217041  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1181912422180176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1402287483215332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([82, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1414432525634766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1414432525634766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1415996551513672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1592731475830078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.160698413848877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.160698413848877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1608738899230957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1819310188293457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1829681396484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1829681396484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1830921173095703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1988372802734375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1997251510620117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1997251510620117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.199824333190918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2131147384643555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([73, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2144684791564941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2144684791564941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2146077156066895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2342400550842285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2353816032409668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2353816032409668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2354960441589355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2524333000183105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2532010078430176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2532010078430176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2532753944396973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2648053169250488  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2657408714294434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2657408714294434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.265824794769287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2794203758239746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2803010940551758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2803010940551758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2803773880004883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2932710647583008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([588, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3073616027832031  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3073616027832031  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3084831237792969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5062828063964844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 588, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4615569114685059  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4624295234680176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4633021354675293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.462385654449463  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5854, 40])
input nodes number: 12338
output nodes number: 5854
edges number: 52030
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4625215530395508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.462522029876709  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02489614486694336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 5 input nodes size: 23808
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021993637084960938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021993637084960938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03371238708496094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03375434875488281  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023737430572509766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.024574756622314453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.024574756622314453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.024574756622314453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([23808, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.024574756622314453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1351, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.059746742248535156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.059746742248535156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1351, 128]), torch.Size([1, 1351, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06103515625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07134246826171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1351, 128])
m.shape torch.Size([1465, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07230520248413086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07230520248413086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1465, 128]), torch.Size([1, 1465, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07370233535766602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09520101547241211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1465, 128])
m.shape torch.Size([1269, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09631776809692383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09631776809692383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1269, 128]), torch.Size([1, 1269, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09752798080444336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12415266036987305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1269, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12581586837768555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12581586837768555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12685632705688477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1583399772644043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([823, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15978193283081055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15978193283081055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1605668067932129  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18967151641845703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([704, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19129323959350586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19129323959350586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19196462631225586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22156667709350586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([593, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22321033477783203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22321033477783203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22377586364746094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2527279853820801  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([531, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2544708251953125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2544708251953125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2549772262573242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2846698760986328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([462, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28639936447143555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28639936447143555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28683996200561523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.31503820419311523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([3701, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33246564865112305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33246564865112305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 3701, 128]), torch.Size([1, 3701, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33611392974853516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5876436233520508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 3701, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5576982498168945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5691328048706055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5805673599243164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5690431594848633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([11990, 256])
first layer input nodes number: 23808
first layer output nodes number: 11990
edges number: 70358
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5807466506958008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5921812057495117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5950398445129395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5950398445129395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([903, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6364040374755859  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6364040374755859  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 903, 256]), torch.Size([1, 903, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6381263732910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6519050598144531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 903, 256])
m.shape torch.Size([805, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6530246734619141  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6530246734619141  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6545600891113281  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6775913238525391  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([631, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6788063049316406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6788063049316406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6800098419189453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.708625316619873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([494, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7100067138671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7100067138671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7109489440917969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.741093635559082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([359, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7423481941223145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7423481941223145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7430329322814941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7676835060119629  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([309, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7691230773925781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7691230773925781  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7697124481201172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7950868606567383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7964205741882324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7964205741882324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.796882152557373  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8199610710144043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([196, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8212375640869141  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8212375640869141  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8216114044189453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8429203033447266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([193, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8444032669067383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8444032669067383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8447713851928711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8683309555053711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8699560165405273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8699560165405273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8702421188354492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8905553817749023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([97, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8914790153503418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8914790153503418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8916640281677246  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.906095027923584  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.907433032989502  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.907433032989502  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9076695442199707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9277729988098145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9288668632507324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9288668632507324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9290518760681152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.946073055267334  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.946962833404541  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.946962833404541  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9471020698547363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9608864784240723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9619297981262207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9619297981262207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.962069034576416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9768280982971191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9777274131774902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9777274131774902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9778475761413574  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9914259910583496  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9925098419189453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9925098419189453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9926433563232422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0086650848388672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0096712112426758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0096712112426758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0097894668579102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0248079299926758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0258631706237793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0258631706237793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0259795188903809  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0415701866149902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.042262077331543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.042262077331543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0423364639282227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0528249740600586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0537567138671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0537567138671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0538482666015625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0673980712890625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0679445266723633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0679445266723633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.067997932434082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0762758255004883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0772442817687988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0772442817687988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0773301124572754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0912346839904785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0918149948120117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0918149948120117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0918664932250977  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.100569725036621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([435, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1109962463378906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1109962463378906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.111825942993164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2584400177001953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 435, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.224203109741211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.225041389465332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2258796691894531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2249994277954102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5624, 40])
input nodes number: 11990
output nodes number: 5624
edges number: 41898
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2250967025756836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2250971794128418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026199817657470703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 6 input nodes size: 22480
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02370309829711914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02370309829711914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03442239761352539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03446388244628906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.022703170776367188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023392677307128906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023392677307128906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023392677307128906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([22480, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.023392677307128906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1436, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05312061309814453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05312061309814453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1436, 128]), torch.Size([1, 1436, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.054490089416503906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0654458999633789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1436, 128])
m.shape torch.Size([1415, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06611061096191406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06611061096191406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1415, 128]), torch.Size([1, 1415, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0674600601196289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08862495422363281  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1415, 128])
m.shape torch.Size([1220, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0901026725769043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0901026725769043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1220, 128]), torch.Size([1, 1220, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09126615524291992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11686277389526367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1220, 128])
m.shape torch.Size([947, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1180872917175293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1180872917175293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11899042129516602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14518117904663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([804, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14664649963378906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14664649963378906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1474132537841797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17535018920898438  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([648, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1768207550048828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1768207550048828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17743873596191406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20456695556640625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([525, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2060103416442871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2060103416442871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2065110206604004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2325277328491211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([457, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23402070999145508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23402070999145508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23445653915405273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.25929880142211914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([375, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26069021224975586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.26069021224975586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2610478401184082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2839360237121582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([2880, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.29749011993408203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.29749011993408203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 2880, 128]), torch.Size([1, 2880, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30065107345581055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.49871015548706055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 2880, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.47404003143310547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4842510223388672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4944620132446289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.48417091369628906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([10707, 256])
first layer input nodes number: 22480
first layer output nodes number: 10707
edges number: 59128
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4946317672729492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5048427581787109  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5073957443237305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5073957443237305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1052, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5413689613342285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5413689613342285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1052, 256]), torch.Size([1, 1052, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5433754920959473  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5598363876342773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1052, 256])
m.shape torch.Size([865, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5606317520141602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5606317520141602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 865, 256]), torch.Size([1, 865, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.562281608581543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5870304107666016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 865, 256])
m.shape torch.Size([724, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5889425277709961  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5889425277709961  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 724, 256]), torch.Size([1, 724, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5903234481811523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6207036972045898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 724, 256])
m.shape torch.Size([517, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6224513053894043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6224513053894043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6234374046325684  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6533780097961426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([420, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6549034118652344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6549034118652344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6557044982910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6853675842285156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6867375373840332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6867375373840332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6873230934143066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7134499549865723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([223, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7146577835083008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7146577835083008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.715083122253418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7363500595092773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([190, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7375984191894531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7375984191894531  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7379608154296875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7586174011230469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([155, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7597770690917969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7597770690917969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7600727081298828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7789936065673828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7802877426147461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7802877426147461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.780573844909668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8008871078491211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([109, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8018965721130371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8018965721130371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8021044731140137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8183207511901855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8191628456115723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8191628456115723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8193192481994629  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.832613468170166  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8333477973937988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8333477973937988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8334717750549316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8448777198791504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8457040786743164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8457040786743164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.845829963684082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8582925796508789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8593544960021973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8593544960021973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8595032691955566  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8752732276916504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8759527206420898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8759527206420898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8760461807250977  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8866071701049805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8873124122619629  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8873124122619629  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8874001502990723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8979287147521973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8987674713134766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8987674713134766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.89886474609375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9112186431884766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9117546081542969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9117546081542969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9118156433105469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9199943542480469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.920464038848877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.920464038848877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9205136299133301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9275059700012207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9281072616577148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9281072616577148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.928166389465332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9369173049926758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9372262954711914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9372262954711914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9372568130493164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9419870376586914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9423480033874512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9423480033874512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.942380428314209  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9476332664489746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9480786323547363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9480786323547363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9481167793273926  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9545636177062988  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([233, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9603056907653809  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9603056907653809  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9607501029968262  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0389666557312012  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 233, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0120620727539062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.012885570526123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0137090682983398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0128440856933594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5524, 40])
input nodes number: 10707
output nodes number: 5524
edges number: 33373
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0129508972167969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.012951374053955  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.024786949157714844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 7 input nodes size: 19769
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02268838882446289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02268838882446289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03211498260498047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03215742111206055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.021396636962890625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.022255897521972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.022255897521972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.022255897521972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([19769, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.022255897521972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05625200271606445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05625200271606445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05704069137573242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06494903564453125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([911, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06542348861694336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06542348861694336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06629228591918945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07932424545288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([876, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08034324645996094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08034324645996094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08117866516113281  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09955787658691406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([821, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10076713562011719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10076713562011719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10155010223388672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12459373474121094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([714, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12590456008911133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12590456008911133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 714, 128]), torch.Size([1, 714, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1265854835510254  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15109872817993164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 714, 128])
m.shape torch.Size([667, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15266656875610352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15266656875610352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15330266952514648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18121004104614258  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([573, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18280458450317383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18280458450317383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1833510398864746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.211181640625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([531, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21293401718139648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21293401718139648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2134404182434082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24287652969360352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([416, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24493694305419922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24493694305419922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24533367156982422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2707242965698242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([4043, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2900571823120117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2900571823120117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 4043, 128]), torch.Size([1, 4043, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2939128875732422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5707006454467773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 4043, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5405731201171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.550471305847168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5603694915771484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5503935813903809  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([10379, 256])
first layer input nodes number: 19769
first layer output nodes number: 10379
edges number: 68566
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.560518741607666  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5704169273376465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5728917121887207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5728917121887207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([637, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.618588924407959  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.618588924407959  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 637, 256]), torch.Size([1, 637, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6198039054870605  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.629523754119873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 637, 256])
m.shape torch.Size([619, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6305594444274902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6305594444274902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6317400932312012  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6496763229370117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([547, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6507768630981445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6507768630981445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.651820182800293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6757464408874512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([465, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6771988868713379  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6771988868713379  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6780858039855957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7039446830749512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([411, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7054767608642578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7054767608642578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7062606811523438  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7354593276977539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([376, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7372360229492188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7372360229492188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7379531860351562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7689590454101562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([307, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7706661224365234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7706661224365234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7712516784667969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8013229370117188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([257, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.803006649017334  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.803006649017334  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8034968376159668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8327584266662598  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([206, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8342952728271484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8342952728271484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8346881866455078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8598346710205078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([222, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8617720603942871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8617720603942871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8621954917907715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8922591209411621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([204, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8942046165466309  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8942046165466309  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8945937156677246  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9249434471130371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([132, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9262714385986328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9262714385986328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9265232086181641  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9479236602783203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([135, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9494848251342773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9494848251342773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.949742317199707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9734315872192383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([127, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9750118255615234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9750118255615234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9752540588378906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9992351531982422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0002965927124023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0002965927124023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.000452995300293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0170316696166992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([99, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0184760093688965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0184760093688965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.018664836883545  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0400023460388184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0414276123046875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0414276123046875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.041604995727539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0628910064697266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0639963150024414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0639963150024414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0641279220581055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0808420181274414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.081634521484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.081634521484375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0817241668701172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0937366485595703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([79, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0952105522155762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0952105522155762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0953612327575684  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1166071891784668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.117830753326416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.117830753326416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1179413795471191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1343140602111816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1351680755615234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1351680755615234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1352500915527344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1479625701904297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1486735343933105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1486735343933105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1487383842468262  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1592440605163574  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.160111427307129  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.160111427307129  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1601858139038086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1727571487426758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([374, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1817069053649902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1817069053649902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.182420253753662  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3085169792175293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 374, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2689294815063477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2697734832763672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2706174850463867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.269731044769287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5662, 40])
input nodes number: 10379
output nodes number: 5662
edges number: 46669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.269871711730957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2698721885681152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02392864227294922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 8 input nodes size: 46250
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02141714096069336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02141714096069336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04347085952758789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04351234436035156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.034043312072753906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.035137176513671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.035137176513671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.035137176513671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([46250, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.035137176513671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1629, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09134483337402344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09134483337402344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1629, 128]), torch.Size([1, 1629, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09289836883544922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10532665252685547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1629, 128])
m.shape torch.Size([1714, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10618448257446289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10618448257446289  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1714, 128]), torch.Size([1, 1714, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1078190803527832  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1326146125793457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1714, 128])
m.shape torch.Size([1485, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13392162322998047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13392162322998047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1485, 128]), torch.Size([1, 1485, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13533782958984375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1668834686279297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1485, 128])
m.shape torch.Size([1296, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16864728927612305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16864728927612305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16988325119018555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20572614669799805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1296, 128])
m.shape torch.Size([1171, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2079000473022461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2079000473022461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1171, 128]), torch.Size([1, 1171, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2090167999267578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.25008630752563477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1171, 128])
m.shape torch.Size([950, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2522459030151367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2522459030151367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.25315189361572266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2927083969116211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([839, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2950558662414551  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2950558662414551  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2958559989929199  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33688831329345703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([780, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3394637107849121  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3394637107849121  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.340207576751709  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3837752342224121  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([640, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38614988327026367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38614988327026367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38676023483276367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.42635679244995117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([6898, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.45894384384155273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.45894384384155273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 6898, 128]), torch.Size([1, 6898, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.46552228927612305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9335198402404785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 6898, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8833370208740234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.899932861328125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9165287017822266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8998031616210938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([17402, 256])
first layer input nodes number: 46250
first layer output nodes number: 17402
edges number: 113104
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9168753623962402  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9334712028503418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9378743171691895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9378743171691895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1059, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9714574813842773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9714574813842773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1059, 256]), torch.Size([1, 1059, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.973564624786377  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9902825355529785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1059, 256])
m.shape torch.Size([913, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.99102783203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.99102783203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 913, 256]), torch.Size([1, 913, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9927692413330078  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.018890380859375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 913, 256])
m.shape torch.Size([658, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0199170112609863  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0199170112609863  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 658, 256]), torch.Size([1, 658, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.021172046661377  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.052990436553955  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 658, 256])
m.shape torch.Size([507, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0543122291564941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0543122291564941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.05527925491333  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0833230018615723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([430, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0849061012268066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0849061012268066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.085726261138916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1155400276184082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([292, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.116814136505127  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.116814136505127  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1173710823059082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1432538032531738  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1446442604064941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1446442604064941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1451172828674316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1687684059143066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.170069694519043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.170069694519043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1704511642456055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.192194938659668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1934318542480469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1934318542480469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.193746566772461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.213888168334961  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([138, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2150869369506836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2150869369506836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2153501510620117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2340383529663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.23502779006958  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.23502779006958  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2352299690246582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.250999927520752  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([95, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2519946098327637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2519946098327637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2521758079528809  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2675776481628418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2683868408203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2683868408203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.268524169921875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.281158447265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2820048332214355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2820048332214355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2821345329284668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2949748039245605  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2956023216247559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2956023216247559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2956938743591309  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3053984642028809  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.306121826171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.306121826171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3062171936035156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3169937133789062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3177142143249512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3177142143249512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3178038597106934  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3285613059997559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3291568756103516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3291568756103516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3292274475097656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3381900787353516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3388490676879883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3388490676879883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3389215469360352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3486337661743164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3491358757019043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3491358757019043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.349189281463623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3567194938659668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.35711669921875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.35711669921875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.357156753540039  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3630847930908203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.363509178161621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.363509178161621  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3635492324829102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3697576522827148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.37013578414917  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.37013578414917  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3701701164245605  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3757319450378418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3761301040649414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3761301040649414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.376164436340332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3819665908813477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([257, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.388124942779541  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.388124942779541  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3886151313781738  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4781432151794434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 257, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.450669765472412  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4514946937561035  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.452319622039795  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4514532089233398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5534, 40])
input nodes number: 17402
output nodes number: 5534
edges number: 33625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4516053199768066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4516057968139648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03725910186767578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 9 input nodes size: 45661
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03402423858642578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03402423858642578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.05579710006713867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.055838584899902344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03374338150024414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03511190414428711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03511190414428711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03511190414428711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([45661, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03511190414428711  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1498, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10582780838012695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10582780838012695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1498, 128]), torch.Size([1, 1498, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10725641250610352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.11868524551391602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1498, 128])
m.shape torch.Size([1498, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1197805404663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1197805404663086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1498, 128]), torch.Size([1, 1498, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.12120914459228516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1429281234741211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1498, 128])
m.shape torch.Size([1246, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14433813095092773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14433813095092773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1246, 128]), torch.Size([1, 1246, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14552640914916992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1724390983581543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1246, 128])
m.shape torch.Size([1158, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1740574836730957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1740574836730957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17516183853149414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20719194412231445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([1063, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20917415618896484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20917415618896484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2101879119873047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2469162940979004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([905, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24899864196777344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24899864196777344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2498617172241211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.287109375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([842, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2894883155822754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2894883155822754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.29029130935668945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3307003974914551  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([826, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3334498405456543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3334498405456543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33423757553100586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3801150321960449  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([710, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3827681541442871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3827681541442871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38344526290893555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4284329414367676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([10050, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.47692251205444336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.47692251205444336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 10050, 128]), torch.Size([1, 10050, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.48650693893432617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.179685115814209  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 10050, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1159114837646484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1347904205322266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1536693572998047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1346426010131836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([19796, 256])
first layer input nodes number: 45661
first layer output nodes number: 19796
edges number: 143001
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1540117263793945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1728906631469727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1776103973388672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1776103973388672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1021, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.218179702758789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.218179702758789  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1021, 256]), torch.Size([1, 1021, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2201271057128906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2365312576293945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1021, 256])
m.shape torch.Size([814, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2379083633422852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2379083633422852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 814, 256]), torch.Size([1, 814, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2394609451293945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2627496719360352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 814, 256])
m.shape torch.Size([552, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2635650634765625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2635650634765625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.264617919921875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2881965637207031  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([435, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2896785736083984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2896785736083984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.2905082702636719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3145694732666016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([366, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3159136772155762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3159136772155762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3166117668151855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.341742992401123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([286, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.343043327331543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.343043327331543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3435888290405273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3676233291625977  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3689522743225098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3689522743225098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3694062232971191  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.392103672027588  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3935070037841797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.3935070037841797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.393911361694336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4169597625732422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([162, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.418159008026123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.418159008026123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4184679985046387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4382433891296387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4396076202392578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4396076202392578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4399089813232422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4613056182861328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4625930786132812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4625930786132812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4628524780273438  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4830856323242188  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4841327667236328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4841327667236328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.4843273162841797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.500864028930664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5016040802001953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5016040802001953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5017318725585938  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.51348876953125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.514218807220459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.514218807220459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.514331340789795  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5254721641540527  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5262956619262695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5262956619262695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.526412010192871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5387449264526367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5395479202270508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5395479202270508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5396547317504883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5517244338989258  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5524392127990723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5524392127990723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5525288581848145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.563286304473877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.564176082611084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.564176082611084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5642790794372559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.577359676361084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5781121253967285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5781121253967285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5781960487365723  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5894417762756348  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5902457237243652  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.5902457237243652  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.590329647064209  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6021628379821777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6028680801391602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6028680801391602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6029386520385742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6133832931518555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6140036582946777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6140036582946777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.614062786102295  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.623227596282959  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6236844062805176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6236844062805176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6237263679504395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6305241584777832  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6312413215637207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6312413215637207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6313023567199707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6416172981262207  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([481, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.653144359588623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.653144359588623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.6540617942810059  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8158841133117676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 481, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7815051078796387  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.782327651977539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7831501960754395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7822861671447754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5517, 40])
input nodes number: 19796
output nodes number: 5517
edges number: 40464
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.782473087310791  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7824735641479492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03762674331665039  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 10 input nodes size: 27206
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.033740997314453125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.033740997314453125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.046713829040527344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.046755313873291016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.024940967559814453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.025702953338623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.025702953338623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.025702953338623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([27206, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.025702953338623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1565, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06075334548950195  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06075334548950195  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1565, 128]), torch.Size([1, 1565, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.062245845794677734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07477426528930664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1565, 128])
m.shape torch.Size([1572, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07587146759033203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07587146759033203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1572, 128]), torch.Size([1, 1572, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07737064361572266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.09985828399658203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1572, 128])
m.shape torch.Size([1354, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10183238983154297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10183238983154297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1354, 128]), torch.Size([1, 1354, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10312366485595703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1326589584350586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1354, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1341075897216797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1341075897216797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13515472412109375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16571617126464844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([989, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16755056381225586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16755056381225586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16849374771118164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20311594009399414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([792, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2049102783203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2049102783203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20566558837890625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2381439208984375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([633, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23987913131713867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.23987913131713867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24048280715942383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.27126169204711914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([549, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2730541229248047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2730541229248047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2735776901245117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30384111404418945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([451, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3055148124694824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3055148124694824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30594491958618164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33347177505493164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([3412, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34952640533447266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34952640533447266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 3412, 128]), torch.Size([1, 3412, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.35278797149658203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5839381217956543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 3412, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5546712875366211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5665111541748047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5783510208129883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5664186477661133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([12415, 256])
first layer input nodes number: 27206
first layer output nodes number: 12415
edges number: 69862
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5785560607910156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5903959274291992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5933561325073242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5933561325073242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1101, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6262331008911133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6262331008911133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1101, 256]), torch.Size([1, 1101, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6290545463562012  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6466412544250488  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1101, 256])
m.shape torch.Size([899, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.647705078125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.647705078125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6494197845458984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6758542060852051  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([680, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6774535179138184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6774535179138184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 680, 256]), torch.Size([1, 680, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6787505149841309  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.707822322845459  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 680, 256])
m.shape torch.Size([503, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7091078758239746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7091078758239746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7100672721862793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.738126277923584  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([440, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7397613525390625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7397613525390625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7406005859375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7714576721191406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7728662490844727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7728662490844727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7734708786010742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7998743057250977  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([239, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.801180362701416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.801180362701416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8016362190246582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8244290351867676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([187, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8256392478942871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8256392478942871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.825995922088623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8463263511657715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([169, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8476099967956543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8476099967956543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8479323387145996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8685622215270996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8695545196533203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8695545196533203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8697834014892578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8860340118408203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([88, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8868503570556641  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8868503570556641  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8870182037353516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9001102447509766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([95, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9011220932006836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9011220932006836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9013032913208008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9167051315307617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9178142547607422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9178142547607422  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9179973602294922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9348430633544922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9358186721801758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9358186721801758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.935969352722168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9508867263793945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9516043663024902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9516043663024902  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9517092704772949  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9628291130065918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9635920524597168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9635920524597168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9636931419372559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9751162528991699  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9757685661315918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9757685661315918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9758505821228027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9856925010681152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9862227439880371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9862227439880371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9862856864929199  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9942793846130371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9948873519897461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9948873519897461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9949541091918945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0038995742797852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0044622421264648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0044622421264648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.004521369934082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0128583908081055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0131316184997559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0131316184997559  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.013160228729248  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0173945426940918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.017824649810791  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.017824649810791  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.01786470413208  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0240731239318848  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0244512557983398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0244512557983398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0244855880737305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0300474166870117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0304226875305176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0304226875305176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0304551124572754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0359349250793457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([199, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0407004356384277  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0407004356384277  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0410799980163574  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1078829765319824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 199, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0820813179016113  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0829062461853027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0837311744689941  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.082864761352539  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5533, 40])
input nodes number: 12415
output nodes number: 5533
edges number: 32262
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0830011367797852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0830016136169434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.027251720428466797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 11 input nodes size: 29842
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02494335174560547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02494335174560547  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.039173126220703125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03921651840209961  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02620220184326172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02699565887451172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02699565887451172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02699565887451172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([29842, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.02699565887451172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1541, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0639195442199707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.0639195442199707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06538915634155273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07714605331420898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([1662, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07877349853515625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07877349853515625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.08035850524902344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10413360595703125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([1419, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10554981231689453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.10554981231689453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1419, 128]), torch.Size([1, 1419, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.106903076171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13756752014160156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1419, 128])
m.shape torch.Size([1160, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13956117630004883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.13956117630004883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.14066743850708008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17320871353149414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([978, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1749873161315918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1749873161315918  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1759200096130371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21011018753051758  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([812, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21196699142456055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21196699142456055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21274137496948242  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2474055290222168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([676, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24927473068237305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24927473068237305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24991941452026367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2826666831970215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([614, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2846865653991699  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2846865653991699  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28527212142944336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3194422721862793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3213510513305664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3213510513305664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3218402862548828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.35330915451049805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([3505, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3697776794433594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3697776794433594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 3505, 128]), torch.Size([1, 3505, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3731203079223633  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6104469299316406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 3505, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5795507431030273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5918340682983398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6041173934936523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5917377471923828  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([12880, 256])
first layer input nodes number: 29842
first layer output nodes number: 12880
edges number: 72835
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.604341983795166  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6166253089904785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6196961402893066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6196961402893066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1063, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6532540321350098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6532540321350098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1063, 256]), torch.Size([1, 1063, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6555476188659668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6721668243408203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1063, 256])
m.shape torch.Size([931, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6731400489807129  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6731400489807129  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 931, 256]), torch.Size([1, 931, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6749157905578613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7016968727111816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 931, 256])
m.shape torch.Size([728, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7029314041137695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7029314041137695  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.704319953918457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7365617752075195  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([521, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.738492488861084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.738492488861084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7394862174987793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7695479393005371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([430, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7711176872253418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7711176872253418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.7719378471374512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8015170097351074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([326, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8029870986938477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8029870986938477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8036088943481445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8312616348266602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([265, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8327336311340332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8327336311340332  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8332390785217285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8592085838317871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.860755443572998  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.860755443572998  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8612017631530762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8866419792175293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8882961273193359  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8882961273193359  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.8887100219726562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9151992797851562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9165205955505371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9165205955505371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9168238639831543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9383559226989746  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9394941329956055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9394941329956055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9397268295288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9578771591186523  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9589605331420898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9589605331420898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9591588973999023  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9760198593139648  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9770827293395996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9770827293395996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9772601127624512  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9935793876647949  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9945135116577148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9945135116577148  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.9946584701538086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0090093612670898  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0098743438720703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0098743438720703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0099983215332031  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0231399536132812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0239238739013672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0239238739013672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0240287780761719  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0358829498291016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0366148948669434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0366148948669434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0367064476013184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0476927757263184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.048304557800293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.048304557800293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0483770370483398  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.057581901550293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0581669807434082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0581669807434082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0582318305969238  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0669217109680176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0673699378967285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0673699378967285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0674176216125488  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.074141025543213  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0747027397155762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0747027397155762  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0747580528259277  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.082944393157959  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0831918716430664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0831918716430664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.083216667175293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0870599746704102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.087313175201416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.087313175201416  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0873360633850098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0910439491271973  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0914478302001953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0914478302001953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.091482162475586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.0972843170166016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([159, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.101088047027588  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.101088047027588  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.101391315460205  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.15476655960083  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 159, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.128026008605957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.128885269165039  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.129744529724121  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1288418769836426  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5765, 40])
input nodes number: 12880
output nodes number: 5765
edges number: 33511
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.1290159225463867  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.129016399383545  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.028650283813476562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 12 input nodes size: 59750
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026236534118652344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.026236534118652344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.055533409118652344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.055576324462890625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.041303157806396484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04367876052856445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04367876052856445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04367876052856445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([59750, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04367876052856445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([968, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16520357131958008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16520357131958008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16612672805786133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17351198196411133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17418336868286133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17418336868286133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17522192001342773  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19080018997192383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1062, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1920757293701172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1920757293701172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19308853149414062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21537017822265625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1014, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2167978286743164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2167978286743164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.21776485443115234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24599933624267578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([1052, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24802398681640625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24802398681640625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.24902725219726562  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2861156463623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1002, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2884807586669922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2884807586669922  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1002, 128]), torch.Size([1, 1002, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.28943634033203125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3316535949707031  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1002, 128])
m.shape torch.Size([1004, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33452701568603516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33452701568603516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.33548450469970703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3850088119506836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([956, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38817691802978516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38817691802978516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.38908863067626953  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4410982131958008  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([1032, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4450712203979492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4450712203979492  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.44605541229248047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5091238021850586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([20208, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6049909591674805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6049909591674805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 20208, 128]), torch.Size([1, 20208, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6245222091674805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0013837814331055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 20208, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8868327140808105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.914858341217041  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9428839683532715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9146389961242676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([29387, 256])
first layer input nodes number: 59750
first layer output nodes number: 29387
edges number: 247704
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.943331241607666  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9713568687438965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9790778160095215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9790778160095215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([564, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0480308532714844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0480308532714844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0491065979003906  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.058673858642578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([502, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.059101104736328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.059101104736328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.06005859375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.077892303466797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([380, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.078693389892578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.078693389892578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.079418182373047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0962371826171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([300, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0970358848571777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0970358848571777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0976080894470215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1156678199768066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([297, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1175293922424316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1175293922424316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.118095874786377  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.138489246368408  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([234, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1395554542541504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1395554542541504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1400017738342285  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.159193515777588  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([198, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1603026390075684  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1603026390075684  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1606802940368652  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.179563045501709  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([177, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1807355880737305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1807355880737305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1810731887817383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2003164291381836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.201627254486084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.201627254486084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.201953411102295  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.222827434539795  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([146, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2240676879882812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2240676879882812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.224346160888672  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2441177368164062  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.245448112487793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.245448112487793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.245713233947754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.266392707824707  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2677135467529297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2677135467529297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.267953872680664  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.288381576538086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2897610664367676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2897610664367676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.289989948272705  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.311047077178955  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([101, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3122920989990234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3122920989990234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3124847412109375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3315563201904297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([99, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3338632583618164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3338632583618164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.334052085876465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.354067802429199  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([99, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3554959297180176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3554959297180176  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.355684757232666  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3770222663879395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.378267765045166  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.378267765045166  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3784241676330566  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3971924781799316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.398740768432617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.398740768432617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3989200592041016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.421689987182617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4231162071228027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4231162071228027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.423274517059326  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.444488048553467  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4456586837768555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4456586837768555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4457826614379883  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.463263511657715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([80, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4648165702819824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4648165702819824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4649691581726074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4875521659851074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([61, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4887657165527344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4887657165527344  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.488882064819336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.506916046142578  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.50789213180542  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.50789213180542  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5079779624938965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5218825340270996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([63, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5232930183410645  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5232930183410645  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5234131813049316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5437207221984863  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([1509, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5799193382263184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5799193382263184  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1509, 256]), torch.Size([1, 1509, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5827975273132324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.10746431350708  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1509, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.043720245361328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.0445752143859863  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.0454301834106445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.044532299041748  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5735, 40])
input nodes number: 29387
output nodes number: 5735
edges number: 70939
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.044790267944336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.044790744781494  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.047747135162353516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 13 input nodes size: 66656
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.041298866271972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.041298866271972656  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07308292388916016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.07312440872192383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04378461837768555  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04583120346069336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04583120346069336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04583120346069336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([66656, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04583120346069336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([1384, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15647268295288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15647268295288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1384, 128]), torch.Size([1, 1384, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1577925682067871  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1690840721130371  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1384, 128])
m.shape torch.Size([1461, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16981744766235352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16981744766235352  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1461, 128]), torch.Size([1, 1461, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.17121076583862305  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19268274307250977  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1461, 128])
m.shape torch.Size([1303, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19385004043579102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19385004043579102  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1303, 128]), torch.Size([1, 1303, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.19509267807006836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22243070602416992  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1303, 128])
m.shape torch.Size([1168, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22403717041015625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22403717041015625  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22515106201171875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.25745391845703125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1101, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2595219612121582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2595219612121582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2605719566345215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.29900312423706055  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1032, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30143070220947266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.30143070220947266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3024148941040039  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34504032135009766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([974, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34779930114746094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34779930114746094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3487281799316406  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3969907760620117  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([1008, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4011955261230469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4011955261230469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4021568298339844  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4575614929199219  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([865, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.46079301834106445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.46079301834106445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.46161794662475586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.515040397644043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([17767, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5993475914001465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5993475914001465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 17767, 128]), torch.Size([1, 17767, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.6162915229797363  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8193106651306152  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 17767, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7164387702941895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.743201732635498  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7699646949768066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7429924011230469  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([28063, 256])
first layer input nodes number: 66656
first layer output nodes number: 28063
edges number: 224921
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.770463466644287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.7972264289855957  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8043036460876465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8043036460876465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([870, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8530964851379395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8530964851379395  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 870, 256]), torch.Size([1, 870, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8547558784484863  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8680310249328613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 870, 256])
m.shape torch.Size([726, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8686771392822266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8686771392822266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8700618743896484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.893545150756836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 726, 256])
m.shape torch.Size([533, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8943939208984375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8943939208984375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8954105377197266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.922602653503418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([405, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9236741065979004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9236741065979004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9244465827941895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9480443000793457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([346, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9493212699890137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9493212699890137  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9499812126159668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9775443077087402  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([266, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9791278839111328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9791278839111328  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.979635238647461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0020880699157715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([212, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.003261089324951  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.003261089324951  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0036654472351074  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.02388334274292  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([187, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0254225730895996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0254225730895996  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0257792472839355  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.046109676361084  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([124, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.047004222869873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.047004222869873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.047240734100342  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.062377452850342  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.063412666320801  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.063412666320801  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0636415481567383  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.079892158508301  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0809407234191895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0809407234191895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.081150531768799  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.09751558303833  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0992321968078613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0992321968078613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.099426746368408  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1159634590148926  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1170411109924316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1170411109924316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.117220401763916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1337151527404785  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1345272064208984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1345272064208984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.134654998779297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.147306442260742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1483240127563477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1483240127563477  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1484670639038086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.163630485534668  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.164435863494873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.164435863494873  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1645445823669434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1768298149108887  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1775107383728027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1775107383728027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1775965690612793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.187896251678467  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1889262199401855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1889262199401855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.18904447555542  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2040629386901855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2048258781433105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2048258781433105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.204911708831787  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2164130210876465  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.218250274658203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.218250274658203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.218351364135742  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.23260498046875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.233523368835449  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.233523368835449  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.233614921569824  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.247164726257324  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.247795581817627  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.247795581817627  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.247856616973877  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.257317066192627  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2582154273986816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2582154273986816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2582955360412598  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.271273136138916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.271902084350586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.271902084350586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2719573974609375  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2813053131103516  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([868, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3021345138549805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3021345138549805  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 868, 256]), torch.Size([1, 868, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3037900924682617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.597193717956543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 868, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5541458129882812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5549683570861816  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.555790901184082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.554926872253418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([5518, 40])
input nodes number: 28063
output nodes number: 5518
edges number: 49664
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.555145263671875  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.555145740509033  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.04940319061279297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

pseudo mini batch 14 input nodes size: 52134
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.043752193450927734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.043752193450927734  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06861162185668945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.06865549087524414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03682994842529297  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03925609588623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03925609588623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03925609588623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([52134, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.03925609588623047  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([783, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15961360931396484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.15961360931396484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16036033630371094  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.1663341522216797  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([866, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16678667068481445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16678667068481445  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.16761255264282227  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18000078201293945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([852, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18088006973266602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18088006973266602  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 852, 128]), torch.Size([1, 852, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.18169260025024414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20012140274047852  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 852, 128])
m.shape torch.Size([886, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20140504837036133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20140504837036133  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.20225000381469727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22675371170043945  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([837, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22832679748535156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.22832679748535156  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2291250228881836  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2578611373901367  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([883, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.25998830795288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.25998830795288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2608304023742676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.2977299690246582  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([820, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3000459671020508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3000459671020508  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3008279800415039  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34151554107666016  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([808, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3442068099975586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3442068099975586  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.34497737884521484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3888998031616211  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([856, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.39218807220458984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.39218807220458984  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.3930044174194336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.4452505111694336  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([20755, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5438098907470703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.5438098907470703  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 20755, 128]), torch.Size([1, 20755, 128])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 0.563603401184082  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.968942642211914  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 20755, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8549365997314453  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.8819694519042969  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9090023040771484  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.881758213043213  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

torch.Size([28346, 256])
first layer input nodes number: 52134
first layer output nodes number: 28346
edges number: 245556
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9093928337097168  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9364256858825684  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9431838989257812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 1.9431838989257812  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

m.shape torch.Size([479, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.020747184753418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.020747184753418  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.021660804748535  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.030280113220215  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([407, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0306057929992676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0306057929992676  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0313820838928223  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.043844699859619  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([353, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0444812774658203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0444812774658203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.045154571533203  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0606231689453125  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([281, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0614686012268066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0614686012268066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.062004566192627  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.0798802375793457  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([260, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.080862045288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.080862045288086  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.081357955932617  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1009459495544434  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([225, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1019959449768066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1019959449768066  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1024250984191895  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1208786964416504  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([181, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1224255561828613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1224255561828613  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1227707862854004  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1400322914123535  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([152, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.14102840423584  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.14102840423584  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.1413183212280273  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.157843589782715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.159212589263916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.159212589263916  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.159546375274658  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.180908679962158  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.182231903076172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.182231903076172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.182527542114258  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2035179138183594  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([142, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.205256938934326  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.205256938934326  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2055277824401855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.226653575897217  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2282252311706543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2282252311706543  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2285075187683105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.252501964569092  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([117, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2538228034973145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2538228034973145  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2540459632873535  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2745766639709473  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.275905132293701  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.275905132293701  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.276109218597412  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.296313762664795  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.297466278076172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.297466278076172  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.2976322174072266  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3152217864990234  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([96, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.316615104675293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.316615104675293  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.316798210144043  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.337489128112793  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3393683433532715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3393683433532715  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.339545726776123  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3608317375183105  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([92, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.362334728240967  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.362334728240967  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3625102043151855  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.384795665740967  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3865160942077637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.3865160942077637  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.386704921722412  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4120078086853027  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([92, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.413681983947754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.413681983947754  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4138574600219727  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4385995864868164  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.440328598022461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.440328598022461  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.440500259399414  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4659061431884766  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.468142032623291  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.468142032623291  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.468266010284424  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.4874825477600098  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.488725185394287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.488725185394287  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.488837718963623  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.507068157196045  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5085806846618652  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5085806846618652  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5087103843688965  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5306296348571777  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([1831, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5745606422424316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5745606422424316  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

 h.shape torch.Size([1, 1831, 256]), torch.Size([1, 1831, 256])
----------------------------------------3
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 2.5780529975891113  GigaBytes
Max Memory Allocated: 3.185307502746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.208785057067871  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 1831, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.1362247467041016  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.1370973587036133  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.137969970703125  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.1370534896850586  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

torch.Size([5854, 40])
input nodes number: 28346
output nodes number: 5854
edges number: 79974
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.1373586654663086  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0545654296875 GB
    Memory Allocated: 3.137359142303467  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04341697692871094  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

pseudo mini batch 15 input nodes size: 56637
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0368800163269043  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0368800163269043  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06388664245605469  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06392812728881836  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03902482986450195  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04101133346557617  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04101133346557617  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04101133346557617  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

torch.Size([56637, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04101133346557617  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

m.shape torch.Size([1213, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14571666717529297  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14571666717529297  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 1213, 128]), torch.Size([1, 1213, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14687347412109375  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1561279296875  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 1213, 128])
m.shape torch.Size([1281, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15677118301391602  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15677118301391602  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 1281, 128]), torch.Size([1, 1281, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15799283981323242  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17631769180297852  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 1281, 128])
m.shape torch.Size([1244, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17765235900878906  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17765235900878906  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17883872985839844  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2049388885498047  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1017, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20650291442871094  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20650291442871094  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2074728012084961  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2362823486328125  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([1032, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23825788497924805  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23825788497924805  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2392420768737793  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2746729850769043  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([932, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27684736251831055  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27684736251831055  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27773618698120117  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3166689872741699  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([932, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31975698471069336  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31975698471069336  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.320645809173584  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.36508703231811523  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([807, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3677210807800293  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3677210807800293  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.36849069595336914  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.41361188888549805  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([825, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.41676759719848633  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.41676759719848633  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4175543785095215  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.46884632110595703  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([16935, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5492053031921387  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5492053031921387  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 16935, 128]), torch.Size([1, 16935, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5653557777404785  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7139577865600586  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 16935, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6156868934631348  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6406903266906738  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.665693759918213  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6404948234558105  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

torch.Size([26218, 256])
first layer input nodes number: 56637
first layer output nodes number: 26218
edges number: 212082
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6661176681518555  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6911211013793945  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6978826522827148  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6978826522827148  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

m.shape torch.Size([784, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7512149810791016  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7512149810791016  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 784, 256]), torch.Size([1, 784, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7527103424072266  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.765843391418457  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 784, 256])
m.shape torch.Size([660, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7665152549743652  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7665152549743652  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7677741050720215  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.790898323059082  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 660, 256])
m.shape torch.Size([500, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.792294979095459  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.792294979095459  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7932486534118652  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8156657218933105  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([351, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8166728019714355  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8166728019714355  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8173422813415527  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.839489459991455  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([321, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8406977653503418  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8406977653503418  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8413100242614746  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.864180088043213  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([234, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8652234077453613  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8652234077453613  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8656697273254395  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8848614692687988  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([210, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8868942260742188  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8868942260742188  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8872947692871094  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9073219299316406  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([154, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9083385467529297  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9083385467529297  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9086322784423828  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.925374984741211  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9266471862792969  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9266471862792969  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9269599914550781  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9469795227050781  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9482073783874512  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9482073783874512  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9484820365905762  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9679827690124512  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([131, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.969883918762207  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.969883918762207  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9701337814331055  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9896230697631836  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9908132553100586  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9908132553100586  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9910306930541992  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0095129013061523  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.010678768157959  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.010678768157959  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.010873317718506  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0287718772888184  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.029751777648926  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.029751777648926  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.029904365539551  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.045010566711426  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.046131134033203  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.046131134033203  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0462894439697266  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.063070297241211  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0640511512756348  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0640511512756348  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.064180850982666  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0788369178771973  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.07993221282959  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.07993221282959  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0800676345825195  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.096318244934082  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([72, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.097496509552002  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.097496509552002  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0976338386535645  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.115074634552002  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.11614990234375  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.11614990234375  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1162662506103516  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.131856918334961  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([66, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1330676078796387  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1330676078796387  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1331934928894043  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1509432792663574  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.151948928833008  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.151948928833008  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1520442962646484  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.166158676147461  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.166745662689209  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.166745662689209  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1668028831481934  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1756720542907715  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.176572322845459  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.176572322845459  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.176652431488037  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1896300315856934  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 24, 256])Using backend: pytorch

----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.19046688079834  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.19046688079834  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1905393600463867  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2027883529663086  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([987, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.226468086242676  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.226468086242676  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2283506393432617  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5674428939819336  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

rst.shape  torch.Size([1, 987, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5196948051452637  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.520517349243164  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5213398933410645  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5204758644104004  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

torch.Size([5517, 40])
input nodes number: 26218
output nodes number: 5517
edges number: 54468
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.520662784576416  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.520663261413574  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.044425010681152344  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.044425010681152344  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.044425010681152344  GigaBytes
Max Memory Allocated: 3.252439498901367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011873602867126465 |0.0019666701555252075 |0.11812329292297363 |9.551644325256348e-05 |0.0778990238904953 |0.004764080047607422 |
----------------------------------------------------------pseudo_mini_loss sum 3.7090039253234863
Total (block generation + training)time/epoch 26.26035213470459
Training time/epoch 3.4604194164276123
Training time without block to device /epoch 3.428952693939209
Training time without total dataloading part /epoch 3.1426494121551514
load block tensor time/epoch 0.18997764587402344
block to device time/epoch 0.03146672248840332
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  854916
Number of first layer input nodes during this epoch:  583059
Number of first layer output nodes during this epoch:  271857
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
