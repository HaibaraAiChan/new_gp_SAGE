[04:27:08] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510562 edges into 4 parts and get 1607 edge cuts
main start at this time 1651552013.567529
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034636497497558594
global_2_local spend time (sec) 0.03657341003417969
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004919767379760742
A = g.adjacency_matrix() spent  0.007968425750732422
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09012961387634277
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2906525135040283
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1781480312347412

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 0.020 seconds
Metis partitioning: 0.071 seconds
Split the graph: 0.070 seconds
Construct subgraphs: 0.080 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.24091506004333496
22813
22815
22815
22498
total k batches seeds list generation spend  10.438539266586304
after graph partition
graph partition algorithm spend time 10.515774965286255
22813
22815
22815
22498
partition_len_list
[84746, 75073, 71334, 75069]
shared_neighbor_graph_partition_s0 selection method  spend 10.597611665725708
time for parepare:  0.01646590232849121
local_output_nid generation:  0.0027456283569335938
local_in_edges_tensor generation:  0.0037415027618408203
mini_batch_src_global generation:  0.008196115493774414
r_  generation:  0.08087277412414551
local_output_nid generation:  0.004019260406494141
local_in_edges_tensor generation:  0.003533601760864258
mini_batch_src_global generation:  0.007226705551147461
r_  generation:  0.05648064613342285
local_output_nid generation:  0.004091739654541016
local_in_edges_tensor generation:  0.0036287307739257812
mini_batch_src_global generation:  0.006360530853271484
r_  generation:  0.06614136695861816
local_output_nid generation:  0.003983497619628906
local_in_edges_tensor generation:  0.0033876895904541016
mini_batch_src_global generation:  0.005113840103149414
r_  generation:  0.0521550178527832
----------------------check_connections_block total spend ----------------------------- 0.3944065570831299
generate_one_block  0.12171673774719238
generate_one_block  0.0787804126739502
generate_one_block  0.09048032760620117
generate_one_block  0.0721592903137207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02098822593688965
gen group dst list time:  0.00852513313293457
time for parepare:  0.018935441970825195
local_output_nid generation:  0.013083457946777344
local_in_edges_tensor generation:  0.020533084869384766
mini_batch_src_global generation:  0.018908262252807617
r_  generation:  0.21706509590148926
local_output_nid generation:  0.016408681869506836
local_in_edges_tensor generation:  0.017549753189086914
mini_batch_src_global generation:  0.019582509994506836
r_  generation:  0.18748021125793457
local_output_nid generation:  0.0157015323638916
local_in_edges_tensor generation:  0.014653205871582031
mini_batch_src_global generation:  0.01751565933227539
r_  generation:  0.17859983444213867
local_output_nid generation:  0.016245603561401367
local_in_edges_tensor generation:  0.015653371810913086
mini_batch_src_global generation:  0.018961191177368164
r_  generation:  0.18657732009887695
----------------------check_connections_block total spend ----------------------------- 1.1714377403259277
generate_one_block  0.2861466407775879
generate_one_block  0.22536563873291016
generate_one_block  0.22214102745056152
generate_one_block  0.24171853065490723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.1714377403259277
block generation total time  0.9753718376159668
average batch blocks generation time:  0.2438429594039917
pseudo mini batch 0 input nodes size: 134507
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.0672307014465332  GigaBytes
Max Memory Allocated: 0.0672307014465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06740093231201172  GigaBytes
Max Memory Allocated: 0.06740093231201172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06740093231201172  GigaBytes
Max Memory Allocated: 0.06740093231201172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.07397651672363281  GigaBytes
Max Memory Allocated: 0.07397651672363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.07397651672363281  GigaBytes
Max Memory Allocated: 0.07397651672363281  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.07397651672363281  GigaBytes
Max Memory Allocated: 0.07397651672363281  GigaBytes

torch.Size([134507, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.07397651672363281  GigaBytes
Max Memory Allocated: 0.07397651672363281  GigaBytes

m.shape torch.Size([4846, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3838353157043457  GigaBytes
Max Memory Allocated: 0.3900604248046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3838353157043457  GigaBytes
Max Memory Allocated: 0.3900604248046875  GigaBytes

 h.shape torch.Size([1, 4846, 128]), torch.Size([1, 4846, 128])
----------------------------------------3
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3884568214416504  GigaBytes
Max Memory Allocated: 0.3900604248046875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.4255046844482422  GigaBytes
Max Memory Allocated: 0.42781543731689453  GigaBytes

rst.shape  torch.Size([1, 4846, 128])
m.shape torch.Size([5775, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.42870140075683594  GigaBytes
Max Memory Allocated: 0.4288311004638672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.42870140075683594  GigaBytes
Max Memory Allocated: 0.4288311004638672  GigaBytes

 h.shape torch.Size([1, 5775, 128]), torch.Size([1, 5775, 128])
----------------------------------------3
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.43420886993408203  GigaBytes
Max Memory Allocated: 0.43420886993408203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.520146369934082  GigaBytes
Max Memory Allocated: 0.5256538391113281  GigaBytes

rst.shape  torch.Size([1, 5775, 128])
m.shape torch.Size([5682, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5256538391113281  GigaBytes
Max Memory Allocated: 0.5258450508117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5256538391113281  GigaBytes
Max Memory Allocated: 0.5258450508117676  GigaBytes

 h.shape torch.Size([1, 5682, 128]), torch.Size([1, 5682, 128])
----------------------------------------3
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5314164161682129  GigaBytes
Max Memory Allocated: 0.5314164161682129  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.6579289436340332  GigaBytes
Max Memory Allocated: 0.6660571098327637  GigaBytes

rst.shape  torch.Size([1, 5682, 128])
m.shape torch.Size([5190, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.6660571098327637  GigaBytes
Max Memory Allocated: 0.6662898063659668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.6660571098327637  GigaBytes
Max Memory Allocated: 0.6662898063659668  GigaBytes

 h.shape torch.Size([1, 5190, 128]), torch.Size([1, 5190, 128])
----------------------------------------3
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.6710066795349121  GigaBytes
Max Memory Allocated: 0.6710066795349121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.8145442008972168  GigaBytes
Max Memory Allocated: 0.8244433403015137  GigaBytes

rst.shape  torch.Size([1, 5190, 128])
m.shape torch.Size([4775, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.8234539031982422  GigaBytes
Max Memory Allocated: 0.8244433403015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.8234539031982422  GigaBytes
Max Memory Allocated: 0.8244433403015137  GigaBytes

 h.shape torch.Size([1, 4775, 128]), torch.Size([1, 4775, 128])
----------------------------------------3
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.8289279937744141  GigaBytes
Max Memory Allocated: 0.8289279937744141  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.9928646087646484  GigaBytes
Max Memory Allocated: 1.0045833587646484  GigaBytes

rst.shape  torch.Size([1, 4775, 128])
m.shape torch.Size([4094, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 1.0023064613342285  GigaBytes
Max Memory Allocated: 1.0045833587646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 1.0023064613342285  GigaBytes
Max Memory Allocated: 1.0045833587646484  GigaBytes

 h.shape torch.Size([1, 4094, 128]), torch.Size([1, 4094, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 1.0067219734191895  GigaBytes
Max Memory Allocated: 1.0067219734191895  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4256591796875 GB
    Memory Allocated: 1.1749906539916992  GigaBytes
Max Memory Allocated: 1.1867132186889648  GigaBytes

rst.shape  torch.Size([1, 4094, 128])
m.shape torch.Size([3727, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.185469150543213  GigaBytes
Max Memory Allocated: 1.1867132186889648  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.185469150543213  GigaBytes
Max Memory Allocated: 1.1867132186889648  GigaBytes

 h.shape torch.Size([1, 3727, 128]), torch.Size([1, 3727, 128])
----------------------------------------3
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.1891083717346191  GigaBytes
Max Memory Allocated: 1.1891083717346191  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.368044376373291  GigaBytes
Max Memory Allocated: 1.3804845809936523  GigaBytes

rst.shape  torch.Size([1, 3727, 128])
m.shape torch.Size([3465, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.379939079284668  GigaBytes
Max Memory Allocated: 1.3804845809936523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.379939079284668  GigaBytes
Max Memory Allocated: 1.3804845809936523  GigaBytes

 h.shape torch.Size([1, 3465, 128]), torch.Size([1, 3465, 128])
----------------------------------------3
 Nvidia-smi: 2.6483154296875 GB
    Memory Allocated: 1.3832435607910156  GigaBytes
Max Memory Allocated: 1.3832435607910156  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.5736169815063477  GigaBytes
Max Memory Allocated: 1.5872888565063477  GigaBytes

rst.shape  torch.Size([1, 3465, 128])
m.shape torch.Size([3088, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.5856366157531738  GigaBytes
Max Memory Allocated: 1.5872888565063477  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.5856366157531738  GigaBytes
Max Memory Allocated: 1.5872888565063477  GigaBytes

 h.shape torch.Size([1, 3088, 128]), torch.Size([1, 3088, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.5892982482910156  GigaBytes
Max Memory Allocated: 1.5892982482910156  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0272216796875 GB
    Memory Allocated: 1.7861709594726562  GigaBytes
Max Memory Allocated: 1.7998428344726562  GigaBytes

rst.shape  torch.Size([1, 3088, 128])
m.shape torch.Size([44104, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2381591796875 GB
    Memory Allocated: 1.995635986328125  GigaBytes
Max Memory Allocated: 2.000565528869629  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2381591796875 GB
    Memory Allocated: 1.995635986328125  GigaBytes
Max Memory Allocated: 2.000565528869629  GigaBytes

 h.shape torch.Size([1, 44104, 128]), torch.Size([1, 44104, 128])
----------------------------------------3
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 2.038604736328125  GigaBytes
Max Memory Allocated: 2.038604736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 5.034912109375  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

rst.shape  torch.Size([1, 44104, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 4.7529683113098145  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 4.8337883949279785  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 4.914608478546143  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 4.833156585693359  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

torch.Size([84746, 256])
first layer input nodes number: 134507
first layer output nodes number: 84746
edges number: 625282
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 4.915645122528076  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 4.99646520614624  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 5.016670227050781  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 5.016670227050781  GigaBytes
Max Memory Allocated: 5.245849609375  GigaBytes

m.shape torch.Size([2556, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.268040180206299  GigaBytes
Max Memory Allocated: 5.270122528076172  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.268040180206299  GigaBytes
Max Memory Allocated: 5.270122528076172  GigaBytes

 h.shape torch.Size([1, 2556, 256]), torch.Size([1, 2556, 256])
----------------------------------------3
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.273503303527832  GigaBytes
Max Memory Allocated: 5.273503303527832  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.313453674316406  GigaBytes
Max Memory Allocated: 5.315891265869141  GigaBytes

rst.shape  torch.Size([1, 2556, 256])
m.shape torch.Size([2190, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.315924167633057  GigaBytes
Max Memory Allocated: 5.315940856933594  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.315924167633057  GigaBytes
Max Memory Allocated: 5.315940856933594  GigaBytes

 h.shape torch.Size([1, 2190, 256]), torch.Size([1, 2190, 256])
----------------------------------------3
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.320289611816406  GigaBytes
Max Memory Allocated: 5.320289611816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.383673667907715  GigaBytes
Max Memory Allocated: 5.387850761413574  GigaBytes

rst.shape  torch.Size([1, 2190, 256])
m.shape torch.Size([1727, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.3865647315979  GigaBytes
Max Memory Allocated: 5.387850761413574  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.3865647315979  GigaBytes
Max Memory Allocated: 5.387850761413574  GigaBytes

 h.shape torch.Size([1, 1727, 256]), torch.Size([1, 1727, 256])
----------------------------------------3
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.389994144439697  GigaBytes
Max Memory Allocated: 5.389994144439697  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.463943958282471  GigaBytes
Max Memory Allocated: 5.4688849449157715  GigaBytes

rst.shape  torch.Size([1, 1727, 256])
m.shape torch.Size([1393, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.467483997344971  GigaBytes
Max Memory Allocated: 5.4688849449157715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.467483997344971  GigaBytes
Max Memory Allocated: 5.4688849449157715  GigaBytes

 h.shape torch.Size([1, 1393, 256]), torch.Size([1, 1393, 256])
----------------------------------------3
 Nvidia-smi: 6.7908935546875 GB
    Memory Allocated: 5.470364093780518  GigaBytes
Max Memory Allocated: 5.470364093780518  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8104248046875 GB
    Memory Allocated: 5.552976131439209  GigaBytes
Max Memory Allocated: 5.558290004730225  GigaBytes

rst.shape  torch.Size([1, 1393, 256])
m.shape torch.Size([1210, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.8104248046875 GB
    Memory Allocated: 5.556975364685059  GigaBytes
Max Memory Allocated: 5.558290004730225  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8104248046875 GB
    Memory Allocated: 5.556975364685059  GigaBytes
Max Memory Allocated: 5.558290004730225  GigaBytes

 h.shape torch.Size([1, 1210, 256]), torch.Size([1, 1210, 256])
----------------------------------------3
 Nvidia-smi: 6.8104248046875 GB
    Memory Allocated: 5.559391498565674  GigaBytes
Max Memory Allocated: 5.559391498565674  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8885498046875 GB
    Memory Allocated: 5.645392417907715  GigaBytes
Max Memory Allocated: 5.651162147521973  GigaBytes

rst.shape  torch.Size([1, 1210, 256])
m.shape torch.Size([965, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.8885498046875 GB
    Memory Allocated: 5.649141788482666  GigaBytes
Max Memory Allocated: 5.651162147521973  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8885498046875 GB
    Memory Allocated: 5.649141788482666  GigaBytes
Max Memory Allocated: 5.651162147521973  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 6.8905029296875 GB
    Memory Allocated: 5.65098237991333  GigaBytes
Max Memory Allocated: 5.651162147521973  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9822998046875 GB
    Memory Allocated: 5.730976581573486  GigaBytes
Max Memory Allocated: 5.7364983558654785  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([819, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9822998046875 GB
    Memory Allocated: 5.73556661605835  GigaBytes
Max Memory Allocated: 5.7364983558654785  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9822998046875 GB
    Memory Allocated: 5.73556661605835  GigaBytes
Max Memory Allocated: 5.7364983558654785  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 6.9822998046875 GB
    Memory Allocated: 5.737128734588623  GigaBytes
Max Memory Allocated: 5.737128734588623  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 5.816806316375732  GigaBytes
Max Memory Allocated: 5.8222737312316895  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([731, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 5.821646213531494  GigaBytes
Max Memory Allocated: 5.8222737312316895  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 5.821646213531494  GigaBytes
Max Memory Allocated: 5.8222737312316895  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 5.82304048538208  GigaBytes
Max Memory Allocated: 5.82304048538208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1522216796875 GB
    Memory Allocated: 5.902548313140869  GigaBytes
Max Memory Allocated: 5.908125400543213  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([695, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.1522216796875 GB
    Memory Allocated: 5.907863140106201  GigaBytes
Max Memory Allocated: 5.908125400543213  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1522216796875 GB
    Memory Allocated: 5.907863140106201  GigaBytes
Max Memory Allocated: 5.908125400543213  GigaBytes

 h.shape torch.Size([1, 695, 256]), torch.Size([1, 695, 256])
----------------------------------------3
 Nvidia-smi: 7.1541748046875 GB
    Memory Allocated: 5.909188747406006  GigaBytes
Max Memory Allocated: 5.909188747406006  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 5.996945858001709  GigaBytes
Max Memory Allocated: 6.00291109085083  GigaBytes

rst.shape  torch.Size([1, 695, 256])
m.shape torch.Size([626, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 6.002299785614014  GigaBytes
Max Memory Allocated: 6.00291109085083  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 6.002299785614014  GigaBytes
Max Memory Allocated: 6.00291109085083  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 6.003493785858154  GigaBytes
Max Memory Allocated: 6.003493785858154  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.089146137237549  GigaBytes
Max Memory Allocated: 6.095116138458252  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([586, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.094744682312012  GigaBytes
Max Memory Allocated: 6.095116138458252  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.094744682312012  GigaBytes
Max Memory Allocated: 6.095116138458252  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.09586238861084  GigaBytes
Max Memory Allocated: 6.09586238861084  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4451904296875 GB
    Memory Allocated: 6.183623313903809  GigaBytes
Max Memory Allocated: 6.189770698547363  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([534, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.4451904296875 GB
    Memory Allocated: 6.189223766326904  GigaBytes
Max Memory Allocated: 6.189770698547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4451904296875 GB
    Memory Allocated: 6.189223766326904  GigaBytes
Max Memory Allocated: 6.189770698547363  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 6.190242290496826  GigaBytes
Max Memory Allocated: 6.190242290496826  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5408935546875 GB
    Memory Allocated: 6.277589321136475  GigaBytes
Max Memory Allocated: 6.283700466156006  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([498, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5408935546875 GB
    Memory Allocated: 6.2833027839660645  GigaBytes
Max Memory Allocated: 6.283700466156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5408935546875 GB
    Memory Allocated: 6.2833027839660645  GigaBytes
Max Memory Allocated: 6.283700466156006  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 7.5408935546875 GB
    Memory Allocated: 6.284252643585205  GigaBytes
Max Memory Allocated: 6.284252643585205  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6326904296875 GB
    Memory Allocated: 6.3734259605407715  GigaBytes
Max Memory Allocated: 6.3796000480651855  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([413, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6326904296875 GB
    Memory Allocated: 6.378508567810059  GigaBytes
Max Memory Allocated: 6.3796000480651855  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6326904296875 GB
    Memory Allocated: 6.378508567810059  GigaBytes
Max Memory Allocated: 6.3796000480651855  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 7.6326904296875 GB
    Memory Allocated: 6.37929630279541  GigaBytes
Max Memory Allocated: 6.3796000480651855  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7010498046875 GB
    Memory Allocated: 6.461535453796387  GigaBytes
Max Memory Allocated: 6.467049598693848  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([387, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7010498046875 GB
    Memory Allocated: 6.466721057891846  GigaBytes
Max Memory Allocated: 6.467049598693848  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7010498046875 GB
    Memory Allocated: 6.466721057891846  GigaBytes
Max Memory Allocated: 6.467049598693848  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 7.7010498046875 GB
    Memory Allocated: 6.467459201812744  GigaBytes
Max Memory Allocated: 6.467459201812744  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.547905445098877  GigaBytes
Max Memory Allocated: 6.553441524505615  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([366, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.553164958953857  GigaBytes
Max Memory Allocated: 6.553441524505615  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.553164958953857  GigaBytes
Max Memory Allocated: 6.553441524505615  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.553863048553467  GigaBytes
Max Memory Allocated: 6.553863048553467  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8612060546875 GB
    Memory Allocated: 6.633487224578857  GigaBytes
Max Memory Allocated: 6.639071941375732  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([348, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8612060546875 GB
    Memory Allocated: 6.638824462890625  GigaBytes
Max Memory Allocated: 6.639071941375732  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8612060546875 GB
    Memory Allocated: 6.638824462890625  GigaBytes
Max Memory Allocated: 6.639071941375732  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 7.8612060546875 GB
    Memory Allocated: 6.639488220214844  GigaBytes
Max Memory Allocated: 6.639488220214844  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9530029296875 GB
    Memory Allocated: 6.722202301025391  GigaBytes
Max Memory Allocated: 6.72784423828125  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([353, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9530029296875 GB
    Memory Allocated: 6.727977752685547  GigaBytes
Max Memory Allocated: 6.728001594543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9530029296875 GB
    Memory Allocated: 6.727977752685547  GigaBytes
Max Memory Allocated: 6.728001594543457  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 7.9549560546875 GB
    Memory Allocated: 6.72865104675293  GigaBytes
Max Memory Allocated: 6.72865104675293  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.816278457641602  GigaBytes
Max Memory Allocated: 6.822338104248047  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([312, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.821639537811279  GigaBytes
Max Memory Allocated: 6.822338104248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.821639537811279  GigaBytes
Max Memory Allocated: 6.822338104248047  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.822234630584717  GigaBytes
Max Memory Allocated: 6.822338104248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 6.903592586517334  GigaBytes
Max Memory Allocated: 6.90924596786499  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([302, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 6.909100532531738  GigaBytes
Max Memory Allocated: 6.90924596786499  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 6.909100532531738  GigaBytes
Max Memory Allocated: 6.90924596786499  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 6.909676551818848  GigaBytes
Max Memory Allocated: 6.909676551818848  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2283935546875 GB
    Memory Allocated: 6.9908952713012695  GigaBytes
Max Memory Allocated: 6.996655464172363  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([292, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.2283935546875 GB
    Memory Allocated: 6.9965009689331055  GigaBytes
Max Memory Allocated: 6.996655464172363  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2283935546875 GB
    Memory Allocated: 6.9965009689331055  GigaBytes
Max Memory Allocated: 6.996655464172363  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 8.2283935546875 GB
    Memory Allocated: 6.997057914733887  GigaBytes
Max Memory Allocated: 6.997057914733887  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2987060546875 GB
    Memory Allocated: 7.081029415130615  GigaBytes
Max Memory Allocated: 7.087193965911865  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([235, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.2987060546875 GB
    Memory Allocated: 7.085720062255859  GigaBytes
Max Memory Allocated: 7.087193965911865  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2987060546875 GB
    Memory Allocated: 7.085720062255859  GigaBytes
Max Memory Allocated: 7.087193965911865  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 8.2987060546875 GB
    Memory Allocated: 7.08616828918457  GigaBytes
Max Memory Allocated: 7.087193965911865  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3905029296875 GB
    Memory Allocated: 7.155643463134766  GigaBytes
Max Memory Allocated: 7.160573959350586  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([207, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3905029296875 GB
    Memory Allocated: 7.1599955558776855  GigaBytes
Max Memory Allocated: 7.160573959350586  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3905029296875 GB
    Memory Allocated: 7.1599955558776855  GigaBytes
Max Memory Allocated: 7.160573959350586  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 8.3905029296875 GB
    Memory Allocated: 7.160390377044678  GigaBytes
Max Memory Allocated: 7.160573959350586  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 7.224351406097412  GigaBytes
Max Memory Allocated: 7.228891849517822  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([245, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 7.2298054695129395  GigaBytes
Max Memory Allocated: 7.229827404022217  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 7.2298054695129395  GigaBytes
Max Memory Allocated: 7.229827404022217  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 7.2302727699279785  GigaBytes
Max Memory Allocated: 7.2302727699279785  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5408935546875 GB
    Memory Allocated: 7.30924654006958  GigaBytes
Max Memory Allocated: 7.314854145050049  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([4823, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.6580810546875 GB
    Memory Allocated: 7.425145626068115  GigaBytes
Max Memory Allocated: 7.425594806671143  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6580810546875 GB
    Memory Allocated: 7.425145626068115  GigaBytes
Max Memory Allocated: 7.425594806671143  GigaBytes

 h.shape torch.Size([1, 4823, 256]), torch.Size([1, 4823, 256])
----------------------------------------3
 Nvidia-smi: 8.6580810546875 GB
    Memory Allocated: 7.434528827667236  GigaBytes
Max Memory Allocated: 7.434528827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4920654296875 GB
    Memory Allocated: 9.053577899932861  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4823, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4920654296875 GB
    Memory Allocated: 8.822882175445557  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4920654296875 GB
    Memory Allocated: 8.826282024383545  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4920654296875 GB
    Memory Allocated: 8.829814434051514  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4920654296875 GB
    Memory Allocated: 8.826244354248047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22813, 40])
input nodes number: 84746
output nodes number: 22813
edges number: 257152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4940185546875 GB
    Memory Allocated: 8.830446243286133  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4940185546875 GB
    Memory Allocated: 8.83044719696045  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.09272336959838867  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 1 input nodes size: 131912
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.0735769271850586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.0735769271850586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.13647747039794922  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.13664770126342773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07202434539794922  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07674694061279297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07674694061279297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07674694061279297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([131912, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07674694061279297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([6688, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.313967227935791  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.313967227935791  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6688, 128]), torch.Size([1, 6688, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.3210735321044922  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.3748455047607422  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6688, 128])
m.shape torch.Size([7591, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.37889575958251953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.37889575958251953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7591, 128]), torch.Size([1, 7591, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.3869948387145996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.4970836639404297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7591, 128])
m.shape torch.Size([7186, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.5028839111328125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.5028839111328125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7186, 128]), torch.Size([1, 7186, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.5097370147705078  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6605052947998047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7186, 128])
m.shape torch.Size([6244, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6689882278442383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6689882278442383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6244, 128]), torch.Size([1, 6244, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6749429702758789  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.847630500793457  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6244, 128])
m.shape torch.Size([5462, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.8576755523681641  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.8576755523681641  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5462, 128]), torch.Size([1, 5462, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.8632817268371582  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.0514206886291504  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5462, 128])
m.shape torch.Size([4394, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.061387538909912  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.061387538909912  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4394, 128]), torch.Size([1, 4394, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.065690517425537  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.2516522407531738  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4394, 128])
m.shape torch.Size([3692, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.2612061500549316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.2612061500549316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3692, 128]), torch.Size([1, 3692, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.2647290229797363  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.4437603950500488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3692, 128])
m.shape torch.Size([3246, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.4544892311096191  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.4544892311096191  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3246, 128]), torch.Size([1, 3246, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.457643985748291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.6451077461242676  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3246, 128])
m.shape torch.Size([2789, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.6547250747680664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.6547250747680664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2789, 128]), torch.Size([1, 2789, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.6575908660888672  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.8354344367980957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2789, 128])
m.shape torch.Size([27781, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.9656620025634766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.9656620025634766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 27781, 128]), torch.Size([1, 27781, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.9921560287475586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.873231887817383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 27781, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.66618013381958  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.7377753257751465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.809370517730713  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.737215518951416  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([75073, 256])
first layer input nodes number: 131912
first layer output nodes number: 75073
edges number: 476801
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.8103814125061035  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.88197660446167  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.8998756408691406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.8998756408691406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([3733, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.055157661437988  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.055157661437988  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3733, 256]), torch.Size([1, 3733, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.062337398529053  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.119298458099365  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3733, 256])
m.shape torch.Size([3192, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.1220703125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.1220703125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3192, 256]), torch.Size([1, 3192, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.12868595123291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.220401763916016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3192, 256])
m.shape torch.Size([2606, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.225257873535156  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.225257873535156  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2606, 256]), torch.Size([1, 2606, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.2307515144348145  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.3411545753479  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2606, 256])
m.shape torch.Size([2078, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.347623348236084  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.347623348236084  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2078, 256]), torch.Size([1, 2078, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.352112770080566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.468656539916992  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2078, 256])
m.shape torch.Size([1743, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.475051403045654  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.475051403045654  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1743, 256]), torch.Size([1, 1743, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.478377819061279  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.603087902069092  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1743, 256])
m.shape torch.Size([1299, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.608652591705322  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.608652591705322  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1299, 256]), torch.Size([1, 1299, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.611202716827393  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.718517780303955  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1299, 256])
m.shape torch.Size([1088, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.724536895751953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.724536895751953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1088, 256]), torch.Size([1, 1088, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.727138519287109  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.835822105407715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1088, 256])
m.shape torch.Size([900, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.841413497924805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.841413497924805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 900, 256]), torch.Size([1, 900, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.843130111694336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.941511154174805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 900, 256])
m.shape torch.Size([773, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.9473395347595215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.9473395347595215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.9488139152526855  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.043835163116455  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([693, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.0497589111328125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.0497589111328125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 693, 256]), torch.Size([1, 693, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.051080703735352  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.1460723876953125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 693, 256])
m.shape torch.Size([526, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.150972843170166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.150972843170166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.151976108551025  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.232143878936768  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([478, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.237155437469482  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.237155437469482  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.238067150115967  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.316609859466553  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([358, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.320627212524414  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.320627212524414  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.321310043334961  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.387112140655518  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([288, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.390645980834961  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.390645980834961  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.391195297241211  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.4483160972595215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([293, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.452265739440918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.452265739440918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.452824592590332  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.513123512268066  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([271, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.517011642456055  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.517011642456055  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.517528533935547  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.578119277954102  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([201, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.581145286560059  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.581145286560059  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.581528663635254  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.627533912658691  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([186, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.630560398101807  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.630560398101807  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.63091516494751  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.675970554351807  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([180, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.679080486297607  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.679080486297607  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.679423809051514  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.725429058074951  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([159, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.72831392288208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.72831392288208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.728617191314697  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.771378040313721  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([137, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.773991584777832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.773991584777832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.774252891540527  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.812926292419434  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([102, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.814952850341797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.814952850341797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.815147399902344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.845302581787109  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([82, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.847018241882324  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.847018241882324  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.847174644470215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.872511863708496  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([85, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.874394416809082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.874394416809082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.874556541442871  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.901955604553223  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([1364, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.935078144073486  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.935078144073486  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1364, 256]), torch.Size([1, 1364, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.937995433807373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 6.396683216094971  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1364, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 6.265827178955078  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 6.269387245178223  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 6.273308753967285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 6.269578456878662  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22815, 40])
input nodes number: 75073
output nodes number: 22815
edges number: 156910
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 6.270468711853027  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 6.2704691886901855  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.0860590934753418  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 2 input nodes size: 127404
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07218456268310547  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07218456268310547  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.1329355239868164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.13310575485229492  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07003498077392578  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07491493225097656  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07491493225097656  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07491493225097656  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([127404, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.07491493225097656  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([5788, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.30556249618530273  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.30556249618530273  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5788, 128]), torch.Size([1, 5788, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.3110823631286621  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.3579573631286621  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5788, 128])
m.shape torch.Size([6845, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.36104631423950195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.36104631423950195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6845, 128]), torch.Size([1, 6845, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.36757421493530273  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.46814823150634766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6845, 128])
m.shape torch.Size([6558, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.47426557540893555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.47426557540893555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6558, 128]), torch.Size([1, 6558, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.480741024017334  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6206393241882324  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6558, 128])
m.shape torch.Size([5648, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6284623146057129  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6284623146057129  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5648, 128]), torch.Size([1, 5648, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.6340904235839844  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.8007011413574219  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5648, 128])
m.shape torch.Size([5079, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.810117244720459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.810117244720459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5079, 128]), torch.Size([1, 5079, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.8149700164794922  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 0.9905948638916016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5079, 128])
m.shape torch.Size([4196, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.0001778602600098  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.0001778602600098  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4196, 128]), torch.Size([1, 4196, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.0045790672302246  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.1777515411376953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4196, 128])
m.shape torch.Size([3611, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.1878037452697754  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.1878037452697754  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3611, 128]), torch.Size([1, 3611, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.1915521621704102  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.3668522834777832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3611, 128])
m.shape torch.Size([3197, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.3773260116577148  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.3773260116577148  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3197, 128]), torch.Size([1, 3197, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.380599021911621  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.5556674003601074  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3197, 128])
m.shape torch.Size([2727, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.5658459663391113  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.5658459663391113  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2727, 128]), torch.Size([1, 2727, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.5688629150390625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.7386698722839355  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2727, 128])
m.shape torch.Size([27685, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.8693556785583496  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.8693556785583496  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 27685, 128]), torch.Size([1, 27685, 128])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 1.8957581520080566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.770333766937256  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 27685, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.568291187286377  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.6363205909729004  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.704349994659424  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.635788917541504  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([71334, 256])
first layer input nodes number: 127404
first layer output nodes number: 71334
edges number: 464561
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.705301284790039  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.7733306884765625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.7903380393981934  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.7903380393981934  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([3197, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.977283477783203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.977283477783203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3197, 256]), torch.Size([1, 3197, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 3.9844746589660645  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.036770343780518  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3197, 256])
m.shape torch.Size([2760, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.038148880004883  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.038148880004883  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2760, 256]), torch.Size([1, 2760, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.043601989746094  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.122566223144531  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2760, 256])
m.shape torch.Size([2181, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.126313209533691  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.126313209533691  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2181, 256]), torch.Size([1, 2181, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.131258964538574  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.228418350219727  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2181, 256])
m.shape torch.Size([1721, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.233725547790527  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.233725547790527  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1721, 256]), torch.Size([1, 1721, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.237448215484619  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.333851337432861  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1721, 256])
m.shape torch.Size([1502, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.339428424835205  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.339428424835205  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1502, 256]), torch.Size([1, 1502, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.342385292053223  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.456583499908447  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1502, 256])
m.shape torch.Size([1258, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.462405681610107  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.462405681610107  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1258, 256]), torch.Size([1, 1258, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.464810848236084  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.570927619934082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1258, 256])
m.shape torch.Size([1088, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.576841354370117  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.576841354370117  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1088, 256]), torch.Size([1, 1088, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.578972816467285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.687845230102539  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1088, 256])
m.shape torch.Size([940, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.694035530090332  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.694035530090332  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 940, 256]), torch.Size([1, 940, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.695828437805176  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.798405647277832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 940, 256])
m.shape torch.Size([823, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.804628372192383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.804628372192383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 823, 256]), torch.Size([1, 823, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.8061981201171875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.909099578857422  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 823, 256])
m.shape torch.Size([720, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.915341854095459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.915341854095459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 720, 256]), torch.Size([1, 720, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 4.916715145111084  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.01574182510376  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 720, 256])
m.shape torch.Size([651, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.021937847137451  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.021937847137451  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.023179531097412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.120052814483643  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([540, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.125660419464111  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.125660419464111  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.12669038772583  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.2151570320129395  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([508, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.22098970413208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.22098970413208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.221958637237549  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.311668872833252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([451, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.317253112792969  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.317253112792969  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.318113327026367  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.405094146728516  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([364, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.409912109375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.409912109375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.410606384277344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.485954284667969  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([317, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.490482330322266  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.490482330322266  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.491086959838867  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.559913635253906  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([312, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.564709186553955  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.564709186553955  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.565304279327393  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.638142108917236  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([274, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.642585277557373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.642585277557373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.643107891082764  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.711719036102295  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([208, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.715256214141846  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.715256214141846  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.715652942657471  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.768814563751221  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([248, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.773383617401123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.773383617401123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.7738566398620605  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.840552806854248  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([193, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.844212055206299  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.844212055206299  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.844580173492432  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.899061679840088  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([152, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.902091979980469  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.902091979980469  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.902381896972656  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.947319030761719  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([147, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.950423717498779  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.950423717498779  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.950704097747803  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.9961256980896  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([138, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.999168872833252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.999168872833252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 10.9920654296875 GB
    Memory Allocated: 5.99943208694458  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.043915271759033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([2122, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.094771385192871  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.094771385192871  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2122, 256]), torch.Size([1, 2122, 256])
----------------------------------------3
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.099465370178223  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.811829566955566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2122, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.646886348724365  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.6504225730896  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.654784679412842  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.651078224182129  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22815, 40])
input nodes number: 71334
output nodes number: 22815
edges number: 190324
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.651756286621094  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0252685546875 GB
    Memory Allocated: 6.651756763458252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08422994613647461  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 3 input nodes size: 132639
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07001113891601562  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07001113891601562  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13325834274291992  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13342618942260742  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07250499725341797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.077056884765625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.077056884765625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.077056884765625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([132639, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.077056884765625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([6908, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3112196922302246  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3112196922302246  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6908, 128]), torch.Size([1, 6908, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.317807674407959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37199926376342773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6908, 128])
m.shape torch.Size([7997, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37713003158569336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37713003158569336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7997, 128]), torch.Size([1, 7997, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.38555479049682617  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.503298282623291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7997, 128])
m.shape torch.Size([7271, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5096073150634766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5096073150634766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7271, 128]), torch.Size([1, 7271, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5165414810180664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.669093132019043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7271, 128])
m.shape torch.Size([6344, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6777262687683105  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6777262687683105  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6344, 128]), torch.Size([1, 6344, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6837763786315918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.859229564666748  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6344, 128])
m.shape torch.Size([5341, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8689384460449219  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8689384460449219  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5341, 128]), torch.Size([1, 5341, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8742141723632812  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0576739311218262  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5341, 128])
m.shape torch.Size([4399, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0678610801696777  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0678610801696777  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4399, 128]), torch.Size([1, 4399, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0722527503967285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.258741855621338  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4399, 128])
m.shape torch.Size([3720, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2684082984924316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2684082984924316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3720, 128]), torch.Size([1, 3720, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.272104263305664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4531502723693848  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3720, 128])
m.shape torch.Size([3207, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4637932777404785  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4637932777404785  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3207, 128]), torch.Size([1, 3207, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4668564796447754  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6417241096496582  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3207, 128])
m.shape torch.Size([2780, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6518616676330566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6518616676330566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2780, 128]), torch.Size([1, 2780, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6545791625976562  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8335614204406738  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2780, 128])
m.shape torch.Size([27102, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9604954719543457  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9604954719543457  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 27102, 128]), torch.Size([1, 27102, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.986341953277588  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.821442127227783  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 27102, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6172361373901367  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6888275146484375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7604188919067383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6882681846618652  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([75069, 256])
first layer input nodes number: 132639
first layer output nodes number: 75069
edges number: 470926
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.761601448059082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.833192825317383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.851090908050537  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.851090908050537  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([3942, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9906835556030273  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9906835556030273  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3942, 256]), torch.Size([1, 3942, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.998202323913574  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.059821128845215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3942, 256])
m.shape torch.Size([3564, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.062912940979004  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.062912940979004  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3564, 256]), torch.Size([1, 3564, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.070003986358643  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.171970844268799  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3564, 256])
m.shape torch.Size([2763, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.176538944244385  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.176538944244385  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2763, 256]), torch.Size([1, 2763, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.182137966156006  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.3008880615234375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2763, 256])
m.shape torch.Size([2128, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.307307720184326  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.307307720184326  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2128, 256]), torch.Size([1, 2128, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.3120646476745605  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.439404487609863  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2128, 256])
m.shape torch.Size([1767, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.44586706161499  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.44586706161499  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1767, 256]), torch.Size([1, 1767, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.44977331161499  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.571103572845459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1767, 256])
m.shape torch.Size([1346, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.577180862426758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.577180862426758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1346, 256]), torch.Size([1, 1346, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.579803943634033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.6965203285217285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1346, 256])
m.shape torch.Size([1050, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.70211124420166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.70211124420166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1050, 256]), torch.Size([1, 1050, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.7042555809021  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.8098978996276855  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1050, 256])
m.shape torch.Size([901, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.815824508666992  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.815824508666992  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 901, 256]), torch.Size([1, 901, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.817543029785156  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.915788650512695  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 901, 256])
m.shape torch.Size([685, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.9208550453186035  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.9208550453186035  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.92216157913208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.0065741539001465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 685, 256])
m.shape torch.Size([560, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.011303424835205  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.011303424835205  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.01237154006958  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.0903801918029785  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([440, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.094498157501221  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.094498157501221  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.095337390899658  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.161316394805908  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([385, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.165356636047363  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.165356636047363  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.166090965270996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.229519844055176  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([292, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.23280143737793  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.23280143737793  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.233358383178711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.286630630493164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([282, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.290146827697754  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.290146827697754  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.290684700012207  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3448076248168945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([245, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.348071098327637  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.348071098327637  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.348538398742676  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.398072242736816  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([157, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4002532958984375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4002532958984375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.400552749633789  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.434391021728516  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([169, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.437136173248291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.437136173248291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.437458515167236  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.476139545440674  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([135, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.47831392288208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.47831392288208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.47857141494751  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.51127290725708  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([136, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.513628005981445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.513628005981445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.513887405395508  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.548646926879883  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([98, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.550401210784912  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.550401210784912  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.550588130950928  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.576943874359131  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([95, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.578768253326416  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.578768253326416  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.578949451446533  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.605766773223877  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.607093334197998  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.607093334197998  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.6072211265563965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.627028942108154  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([83, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.628799915313721  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.628799915313721  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.628958225250244  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.654604434967041  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.6558403968811035  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.6558403968811035  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.655949115753174  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.674322605133057  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([1151, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.701924800872803  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.701924800872803  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1151, 256]), torch.Size([1, 1151, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.704494953155518  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.109250545501709  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1151, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.994387626647949  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.997786521911621  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.001139163970947  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.997572422027588  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22498, 40])
input nodes number: 75069
output nodes number: 22498
edges number: 139864
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.998162269592285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.998162746429443  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08562469482421875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09117507934570312  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09117507934570312  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06037545204162598 |0.08680969476699829 |0.27364760637283325 |0.0001246333122253418 |0.08949536085128784 |0.00561213493347168 |
----------------------------------------------------------pseudo_mini_loss sum 5.302299976348877
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  832684
Number of first layer input nodes during this epoch:  526462
Number of first layer output nodes during this epoch:  306222
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09117460250854492  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0162355899810791
global_2_local spend time (sec) 0.04146218299865723
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004408359527587891
A = g.adjacency_matrix() spent  0.007772922515869141
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07808876037597656
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.2981257438659668
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1804659366607666

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------[04:27:24] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 512748 edges into 4 parts and get 719 edge cuts


before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 0.142 seconds
Metis partitioning: 0.070 seconds
Split the graph: 0.071 seconds
Construct subgraphs: 0.043 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.32690954208374023
23327
22969
22337
22308
total k batches seeds list generation spend  10.54627251625061
after graph partition
graph partition algorithm spend time 10.64181661605835
23327
22969
22337
22308
partition_len_list
[70462, 85149, 74273, 74290]
shared_neighbor_graph_partition_s0 selection method  spend 10.731210470199585
time for parepare:  0.017127037048339844
local_output_nid generation:  0.003200054168701172
local_in_edges_tensor generation:  0.0037071704864501953
mini_batch_src_global generation:  0.0074388980865478516
r_  generation:  0.07411932945251465
local_output_nid generation:  0.004292488098144531
local_in_edges_tensor generation:  0.004458904266357422
mini_batch_src_global generation:  0.010641813278198242
r_  generation:  0.08630871772766113
local_output_nid generation:  0.004250764846801758
local_in_edges_tensor generation:  0.004274606704711914
mini_batch_src_global generation:  0.005392789840698242
r_  generation:  0.052047014236450195
local_output_nid generation:  0.0041501522064208984
local_in_edges_tensor generation:  0.003309488296508789
mini_batch_src_global generation:  0.004426240921020508
r_  generation:  0.05051779747009277
----------------------check_connections_block total spend ----------------------------- 0.4150869846343994
generate_one_block  0.11217355728149414
generate_one_block  0.12238335609436035
generate_one_block  0.0723271369934082
generate_one_block  0.06955504417419434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04337120056152344
gen group dst list time:  0.00847768783569336
time for parepare:  0.020758628845214844
local_output_nid generation:  0.012279510498046875
local_in_edges_tensor generation:  0.031347036361694336
mini_batch_src_global generation:  0.01421809196472168
r_  generation:  0.1723792552947998
local_output_nid generation:  0.017087459564208984
local_in_edges_tensor generation:  0.01925802230834961
mini_batch_src_global generation:  0.02405261993408203
r_  generation:  0.22521471977233887
local_output_nid generation:  0.016379594802856445
local_in_edges_tensor generation:  0.013624191284179688
mini_batch_src_global generation:  0.018032550811767578
r_  generation:  0.18169784545898438
local_output_nid generation:  0.01668834686279297
local_in_edges_tensor generation:  0.013826131820678711
mini_batch_src_global generation:  0.01859736442565918
r_  generation:  0.19119501113891602
----------------------check_connections_block total spend ----------------------------- 1.1828694343566895
generate_one_block  0.22292518615722656
generate_one_block  0.29167962074279785
generate_one_block  0.22115492820739746
generate_one_block  0.22167372703552246
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09117460250854492  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

connection checking time:  1.1828694343566895
block generation total time  0.9574334621429443
average batch blocks generation time:  0.23935836553573608
block dataloader generation time/epoch 13.83948016166687
pseudo mini batch 0 input nodes size: 123538
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07791709899902344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07791709899902344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.1368246078491211  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13699865341186523  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07358360290527344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959461212158203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959461212158203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959461212158203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([123538, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959461212158203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([5074, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3135061264038086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3135061264038086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5074, 128]), torch.Size([1, 5074, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3183450698852539  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3570566177368164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5074, 128])
m.shape torch.Size([6169, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3605203628540039  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3605203628540039  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6169, 128]), torch.Size([1, 6169, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.36640357971191406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4546518325805664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6169, 128])
m.shape torch.Size([6079, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4604063034057617  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4604063034057617  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6079, 128]), torch.Size([1, 6079, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4663276672363281  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5953197479248047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6079, 128])
m.shape torch.Size([5544, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6028714179992676  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6028714179992676  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5544, 128]), torch.Size([1, 5544, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6086592674255371  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7631268501281738  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5544, 128])
m.shape torch.Size([4932, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7722420692443848  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7722420692443848  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4932, 128]), torch.Size([1, 4932, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7772374153137207  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9523015022277832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4932, 128])
m.shape torch.Size([4169, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9618773460388184  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9618773460388184  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4169, 128]), torch.Size([1, 4169, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9659590721130371  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1375422477722168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4169, 128])
m.shape torch.Size([3677, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1478276252746582  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1478276252746582  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3677, 128]), torch.Size([1, 3677, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1514759063720703  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3295879364013672  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3677, 128])
m.shape torch.Size([3273, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3401079177856445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3401079177856445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3273, 128]), torch.Size([1, 3273, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3433876037597656  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5323247909545898  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3273, 128])
m.shape torch.Size([2864, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5430550575256348  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5430550575256348  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2864, 128]), torch.Size([1, 2864, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.546060562133789  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.7246570587158203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2864, 128])
m.shape torch.Size([28681, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8600530624389648  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8600530624389648  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 28681, 128]), torch.Size([1, 28681, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8874053955078125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.829421043395996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 28681, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.622128963470459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.689326763153076  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7565245628356934  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6888017654418945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([70462, 256])
first layer input nodes number: 123538
first layer output nodes number: 70462
edges number: 472008
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7574472427368164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.8246450424194336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.841444492340088  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.841444492340088  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([2581, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.06650972366333  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.06650972366333  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2581, 256]), torch.Size([1, 2581, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.07191276550293  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.112227916717529  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2581, 256])
m.shape torch.Size([2279, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.114147663116455  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.114147663116455  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2279, 256]), torch.Size([1, 2279, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.118882656097412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.184619426727295  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2279, 256])
m.shape torch.Size([1788, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.18834114074707  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.18834114074707  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1788, 256]), torch.Size([1, 1788, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.192082405090332  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.268955230712891  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1788, 256])
m.shape torch.Size([1511, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.272879123687744  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.272879123687744  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1511, 256]), torch.Size([1, 1511, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.276363849639893  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.361217021942139  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1511, 256])
m.shape torch.Size([1357, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.366297721862793  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.366297721862793  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1357, 256]), torch.Size([1, 1357, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.369104862213135  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.465493679046631  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1357, 256])
m.shape torch.Size([1190, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.472017765045166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.472017765045166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1190, 256]), torch.Size([1, 1190, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.474306583404541  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.5739264488220215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1190, 256])
m.shape torch.Size([1099, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.580793380737305  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.580793380737305  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1099, 256]), torch.Size([1, 1099, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.582904815673828  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.691620826721191  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1099, 256])
m.shape torch.Size([1017, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.697727203369141  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.697727203369141  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1017, 256]), torch.Size([1, 1017, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.699666976928711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.810768127441406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1017, 256])
m.shape torch.Size([939, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.817921161651611  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.817921161651611  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 939, 256]), torch.Size([1, 939, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.819712162017822  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.935061931610107  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 939, 256])
m.shape torch.Size([888, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.94270133972168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.94270133972168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 888, 256]), torch.Size([1, 888, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.944395065307617  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.065549850463867  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 888, 256])
m.shape torch.Size([755, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.072685241699219  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.072685241699219  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.074125289916992  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1865339279174805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([670, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.193541526794434  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.193541526794434  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.194819450378418  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.303633689880371  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([597, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.310454368591309  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.310454368591309  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.311593055725098  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.417281150817871  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([541, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.423991680145264  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.423991680145264  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.425023555755615  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.530986309051514  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([483, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.537434101104736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.537434101104736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.538355350494385  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.636691570281982  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([408, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.642505168914795  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.642505168914795  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.643283367156982  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.734065532684326  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([412, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.740408420562744  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.740408420562744  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.741194248199463  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.838594913482666  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([338, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.84404993057251  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.84404993057251  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.8446946144104  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.92704439163208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([302, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.932237148284912  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.932237148284912  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.9328131675720215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.010562419891357  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([325, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.01652193069458  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.01652193069458  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.017141819000244  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.109032154083252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([275, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1142730712890625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1142730712890625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.114797592163086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.194247245788574  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([223, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.198700428009033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.198700428009033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.19912576675415  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.2650532722473145  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([206, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.27028751373291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.27028751373291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.2706804275512695  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.334332466125488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([198, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.338703632354736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.338703632354736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.339081287384033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.402904987335205  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([2945, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.473479270935059  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.473479270935059  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2945, 256]), torch.Size([1, 2945, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.479806900024414  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.4693803787231445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2945, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.267679691314697  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.271155834197998  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.274631977081299  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.270981788635254  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([23327, 40])
input nodes number: 70462
output nodes number: 23327
edges number: 230207
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.271758079528809  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.271759033203125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08964872360229492  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 1 input nodes size: 135036
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07366180419921875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07366180419921875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13805198669433594  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13822317123413086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07914161682128906  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08570480346679688  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08570480346679688  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08570480346679688  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([135036, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08570480346679688  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([4941, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.39477062225341797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.39477062225341797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4941, 128]), torch.Size([1, 4941, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.39948272705078125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4371795654296875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4941, 128])
m.shape torch.Size([5984, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.44053030014038086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.44053030014038086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5984, 128]), torch.Size([1, 5984, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.44623708724975586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5339751243591309  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5984, 128])
m.shape torch.Size([5756, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5393557548522949  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5393557548522949  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5756, 128]), torch.Size([1, 5756, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5456938743591309  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6719450950622559  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5756, 128])
m.shape torch.Size([5283, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6801791191101074  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6801791191101074  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5283, 128]), torch.Size([1, 5283, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6855654716491699  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8324742317199707  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5283, 128])
m.shape torch.Size([4857, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8415350914001465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8415350914001465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4857, 128]), torch.Size([1, 4857, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8463702201843262  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0150294303894043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4857, 128])
m.shape torch.Size([4131, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0245323181152344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0245323181152344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4131, 128]), torch.Size([1, 4131, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0289039611816406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1997003555297852  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4131, 128])
m.shape torch.Size([3625, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2098302841186523  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2098302841186523  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3625, 128]), torch.Size([1, 3625, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.213430404663086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.388031005859375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3625, 128])
m.shape torch.Size([3405, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3992915153503418  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3992915153503418  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3405, 128]), torch.Size([1, 3405, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.402538776397705  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5929017066955566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3405, 128])
m.shape torch.Size([3159, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.604835033416748  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.604835033416748  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3159, 128]), torch.Size([1, 3159, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.608011245727539  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8022875785827637  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3159, 128])
m.shape torch.Size([44008, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 2.0106277465820312  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 2.0106277465820312  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 44008, 128]), torch.Size([1, 44008, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 2.0535964965820312  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.044410705566406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 44008, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.762608051300049  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.843812465667725  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.9250168800354  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.843177795410156  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([85149, 256])
first layer input nodes number: 135036
first layer output nodes number: 85149
edges number: 625506
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.926109790802002  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.007314205169678  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.027615547180176  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.027615547180176  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([2625, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.276463031768799  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.276463031768799  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2625, 256]), torch.Size([1, 2625, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.281881809234619  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.322437286376953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2625, 256])
m.shape torch.Size([2313, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.323879241943359  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.323879241943359  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2313, 256]), torch.Size([1, 2313, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.328551292419434  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.395817756652832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2313, 256])
m.shape torch.Size([1815, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.398845672607422  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.398845672607422  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1815, 256]), torch.Size([1, 1815, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.402614593505859  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.480889797210693  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1815, 256])
m.shape torch.Size([1444, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.484618186950684  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.484618186950684  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1444, 256]), torch.Size([1, 1444, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4875288009643555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.568837642669678  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1444, 256])
m.shape torch.Size([1226, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.57313871383667  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.57313871383667  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1226, 256]), torch.Size([1, 1226, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.57550573348999  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.667055606842041  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1226, 256])
m.shape torch.Size([969, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.670644760131836  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.670644760131836  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.672492980957031  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.75196647644043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([751, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.7560954093933105  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.7560954093933105  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.757527828216553  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.830714702606201  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([724, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.835565567016602  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.835565567016602  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 724, 256]), torch.Size([1, 724, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.836946487426758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.916254043579102  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 724, 256])
m.shape torch.Size([674, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.921393871307373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.921393871307373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 674, 256]), torch.Size([1, 674, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.922679424285889  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.005370616912842  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 674, 256])
m.shape torch.Size([645, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.010927200317383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.010927200317383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.012157440185547  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.100337982177734  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([568, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1057281494140625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1057281494140625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1068115234375  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.192981719970703  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([527, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1985182762146  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1985182762146  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.199523448944092  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.2859320640563965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([449, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.291039943695068  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.291039943695068  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.291896343231201  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.377546787261963  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([402, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.382527828216553  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.382527828216553  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.383294582366943  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.459203243255615  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([406, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.4646735191345215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.4646735191345215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.465447902679443  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.550370693206787  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([375, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.555750370025635  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.555750370025635  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.5564656257629395  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.639997959136963  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([333, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.645081520080566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.645081520080566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.645716667175293  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.723110198974609  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([366, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.729124546051025  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.729124546051025  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.729822635650635  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.818647861480713  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([326, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.824252128601074  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.824252128601074  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.824873924255371  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.910662651062012  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([297, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.916247844696045  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.916247844696045  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.91681432723999  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.997556209564209  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([292, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.003166675567627  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.003166675567627  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.003723621368408  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.088146686553955  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([224, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.092604637145996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.092604637145996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.093031883239746  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.159255027770996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([207, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.1636176109313965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.1636176109313965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.164012432098389  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.227973461151123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([229, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.233058452606201  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.233058452606201  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.233495235443115  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.307311534881592  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([4782, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.421995639801025  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.421995639801025  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4782, 256]), torch.Size([1, 4782, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.431277751922607  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 9.037171840667725  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4782, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.809194564819336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.813127517700195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.816550254821777  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.812446117401123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22969, 40])
input nodes number: 85149
output nodes number: 22969
edges number: 255358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.813708782196045  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.813709259033203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09787988662719727  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 2 input nodes size: 132594
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959842681884766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959842681884766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.1428241729736328  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.1429910659790039  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.0784296989440918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08284139633178711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08284139633178711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08284139633178711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([132594, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08284139633178711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([7030, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3121786117553711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3121786117553711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7030, 128]), torch.Size([1, 7030, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.31888294219970703  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3733072280883789  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7030, 128])
m.shape torch.Size([8074, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37832164764404297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37832164764404297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 8074, 128]), torch.Size([1, 8074, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.386688232421875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5037631988525391  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 8074, 128])
m.shape torch.Size([7386, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.510310173034668  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.510310173034668  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7386, 128]), torch.Size([1, 7386, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5179634094238281  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6729278564453125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7386, 128])
m.shape torch.Size([6242, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6813116073608398  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6813116073608398  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6242, 128]), torch.Size([1, 6242, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6872644424438477  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8598966598510742  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6242, 128])
m.shape torch.Size([5477, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8699784278869629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8699784278869629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5477, 128]), torch.Size([1, 5477, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8755664825439453  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0636043548583984  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5477, 128])
m.shape torch.Size([4397, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0740509033203125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0740509033203125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4397, 128]), torch.Size([1, 4397, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0788555145263672  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2658109664916992  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4397, 128])
m.shape torch.Size([3649, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2758941650390625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2758941650390625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3649, 128]), torch.Size([1, 3649, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2794251441955566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4575138092041016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3649, 128])
m.shape torch.Size([3155, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4674177169799805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4674177169799805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3155, 128]), torch.Size([1, 3155, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4705438613891602  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6445369720458984  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3155, 128])
m.shape torch.Size([2582, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6541132926940918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6541132926940918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2582, 128]), torch.Size([1, 2582, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.656599998474121  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8181028366088867  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2582, 128])
m.shape torch.Size([26281, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9419422149658203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9419422149658203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 26281, 128]), torch.Size([1, 26281, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.967005729675293  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7465152740478516  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 26281, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.548175811767578  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6190080642700195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.689840316772461  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6184544563293457  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([74273, 256])
first layer input nodes number: 132594
first layer output nodes number: 74273
edges number: 460902
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6909403800964355  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.761772632598877  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7794809341430664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7794809341430664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([4082, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9104952812194824  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9104952812194824  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4082, 256]), torch.Size([1, 4082, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.919334888458252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.983482837677002  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4082, 256])
m.shape torch.Size([3550, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.985778331756592  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.985778331756592  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3550, 256]), torch.Size([1, 3550, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.992825984954834  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.094966411590576  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3550, 256])
m.shape torch.Size([2820, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.099712371826172  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.099712371826172  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2820, 256]), torch.Size([1, 2820, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.106040954589844  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.226909637451172  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2820, 256])
m.shape torch.Size([2133, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.233057975769043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.233057975769043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2133, 256]), torch.Size([1, 2133, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.2371931076049805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.360867977142334  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2133, 256])
m.shape torch.Size([1839, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.367671489715576  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.367671489715576  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1839, 256]), torch.Size([1, 1839, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.371415138244629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.499279022216797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1839, 256])
m.shape torch.Size([1351, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.505076885223389  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.505076885223389  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1351, 256]), torch.Size([1, 1351, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.507819652557373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.623962879180908  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1351, 256])
m.shape torch.Size([1071, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.6293230056762695  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.6293230056762695  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1071, 256]), torch.Size([1, 1071, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.631459712982178  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.743690013885498  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1071, 256])
m.shape torch.Size([899, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.7487568855285645  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.7487568855285645  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.750471591949463  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.848209857940674  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([667, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.853122234344482  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.853122234344482  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.854394435882568  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.939597129821777  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([541, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.9441609382629395  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.9441609382629395  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.945192813873291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.022200107574463  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([436, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.026293754577637  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.026293754577637  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.027125358581543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.093390464782715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([367, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.097207546234131  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.097207546234131  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.097907543182373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.157407283782959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([311, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.160943508148193  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.160943508148193  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.161536693572998  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.217213153839111  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([267, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.2205095291137695  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.2205095291137695  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.2210187911987305  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.272364616394043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([213, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.275180816650391  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.275180816650391  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.27558708190918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.31865119934082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([172, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3210930824279785  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3210930824279785  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.321421146392822  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.358492374420166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([152, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.360812187194824  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.360812187194824  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.361102104187012  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.395892143249512  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([131, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.398013591766357  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.398013591766357  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.398263454437256  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.429996013641357  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([101, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.43211030960083  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.43211030960083  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.432302951812744  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4581170082092285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([92, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.459789276123047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.459789276123047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.459964752197266  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.484706878662109  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([71, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.486052513122559  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.486052513122559  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.486187934875488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.506230354309082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([61, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.507452487945557  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.507452487945557  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.507568836212158  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5256028175354  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5268049240112305  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5268049240112305  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.526913642883301  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.544526100158691  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.545717716217041  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.545717716217041  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.545820713043213  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.56322717666626  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([899, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.584827899932861  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.584827899932861  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.58654260635376  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.888330936431885  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 899, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.780801773071289  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.784187316894531  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.787516117095947  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.783963680267334  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22337, 40])
input nodes number: 74273
output nodes number: 22337
edges number: 131121
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.784136772155762  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.78413724899292  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09069299697875977  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 3 input nodes size: 132344
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07788228988647461  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07788228988647461  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.14098882675170898  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.14115524291992188  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07776260375976562  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08214282989501953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08214282989501953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08214282989501953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([132344, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08214282989501953  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([7248, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3112373352050781  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3112373352050781  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7248, 128]), torch.Size([1, 7248, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3181495666503906  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37439727783203125  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7248, 128])
m.shape torch.Size([7973, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37854480743408203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37854480743408203  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7973, 128]), torch.Size([1, 7973, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3864617347717285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5034403800964355  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7973, 128])
m.shape torch.Size([7405, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.509918212890625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.509918212890625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7405, 128]), torch.Size([1, 7405, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5177731513977051  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6731362342834473  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7405, 128])
m.shape torch.Size([6252, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6815299987792969  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6815299987792969  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6252, 128]), torch.Size([1, 6252, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6879673004150391  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8608760833740234  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6252, 128])
m.shape torch.Size([5385, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8707337379455566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8707337379455566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5385, 128]), torch.Size([1, 5385, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8762826919555664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.061161994934082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5385, 128])
m.shape torch.Size([4356, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0714330673217773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0714330673217773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4356, 128]), torch.Size([1, 4356, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.075859546661377  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2638916969299316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4356, 128])
m.shape torch.Size([3705, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2733440399169922  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2733440399169922  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3705, 128]), torch.Size([1, 3705, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2770967483520508  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4551000595092773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3705, 128])
m.shape torch.Size([3112, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4652047157287598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4652047157287598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3112, 128]), torch.Size([1, 3112, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4682669639587402  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6414923667907715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3112, 128])
m.shape torch.Size([2664, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6511778831481934  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6511778831481934  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2664, 128]), torch.Size([1, 2664, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6538996696472168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8229336738586426  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2664, 128])
m.shape torch.Size([26190, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.946547031402588  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.946547031402588  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 26190, 128]), torch.Size([1, 26190, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9715237617492676  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7448716163635254  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 26190, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.546422004699707  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6172704696655273  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6881189346313477  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6167168617248535  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([74290, 256])
first layer input nodes number: 132344
first layer output nodes number: 74290
edges number: 460185
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6891255378723145  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7599740028381348  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.77768611907959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.77768611907959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([4140, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.905458450317383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.905458450317383  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4140, 256]), torch.Size([1, 4140, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.914033889770508  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.977884292602539  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4140, 256])
m.shape torch.Size([3564, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.981032371520996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.981032371520996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3564, 256]), torch.Size([1, 3564, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9880194664001465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.091724872589111  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3564, 256])
m.shape torch.Size([2854, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.096555233001709  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.096555233001709  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2854, 256]), torch.Size([1, 2854, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.102450847625732  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.224354267120361  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2854, 256])
m.shape torch.Size([2232, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.230343341827393  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.230343341827393  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2232, 256]), torch.Size([1, 2232, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.235447883605957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.362905502319336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2232, 256])
m.shape torch.Size([1800, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.36942720413208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.36942720413208  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1800, 256]), torch.Size([1, 1800, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.373257637023926  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.500913619995117  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1800, 256])
m.shape torch.Size([1358, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.506380081176758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.506380081176758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1358, 256]), torch.Size([1, 1358, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.509668350219727  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.6219482421875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1358, 256])
m.shape torch.Size([1124, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.628110408782959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.628110408782959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1124, 256]), torch.Size([1, 1124, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.6303839683532715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.739770412445068  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1124, 256])
m.shape torch.Size([832, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.745179653167725  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.745179653167725  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.746766567230225  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.839501857757568  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([696, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.844728946685791  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.844728946685791  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.8460564613342285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.933454990386963  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([525, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.937837600708008  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.937837600708008  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 525, 256]), torch.Size([1, 525, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.938838958740234  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.010440826416016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 525, 256])
m.shape torch.Size([444, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.014634609222412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.014634609222412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.015481472015381  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.083425045013428  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([373, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.087303638458252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.087303638458252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.088015079498291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1493916511535645  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([299, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.152771949768066  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.152771949768066  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.153342247009277  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.206844329833984  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([224, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.210145473480225  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.210145473480225  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.210572719573975  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.252870082855225  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([187, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.25535249710083  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.25535249710083  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.255709171295166  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.293516635894775  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([156, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.295737266540527  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.295737266540527  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.296034812927246  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.329657554626465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([133, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.331682205200195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.331682205200195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.331935882568359  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.362377166748047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.364205360412598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.364205360412598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3644208908081055  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.391793251037598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.39363956451416  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.39363956451416  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.393843650817871  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.421191215515137  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.422877311706543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.422877311706543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4230546951293945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.448065757751465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([79, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.44957160949707  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.44957160949707  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4497222900390625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.472023010253906  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.472962856292725  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.472962856292725  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4730544090271  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.487245082855225  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([49, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.488282680511475  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.488282680511475  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.488376140594482  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.503516674041748  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape [04:27:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510472 edges into 4 parts and get 1019 edge cuts
 torch.Size([1, 49, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.504497528076172  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.504497528076172  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.504581451416016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.518764495849609  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([834, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.538762092590332  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.538762092590332  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.540352821350098  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.826459884643555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 834, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.724123001098633  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.727521896362305  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.730846405029297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.727281093597412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22308, 40])
input nodes number: 74290
output nodes number: 22308
edges number: 127564
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.7280144691467285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.728014945983887  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09040307998657227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09040307998657227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09040307998657227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06034499406814575 |0.003579854965209961 |0.14382332563400269 |0.00010514259338378906 |0.09168738126754761 |0.004568576812744141 |
----------------------------------------------------------pseudo_mini_loss sum 4.170615196228027
Total (block generation + training)time/epoch 15.094121217727661
Training time/epoch 1.2541530132293701
Training time without block to device /epoch 1.2398335933685303
Training time without total dataloading part /epoch 0.9470319747924805
load block tensor time/epoch 0.241379976272583
block to device time/epoch 0.014319419860839844
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  827686
Number of first layer input nodes during this epoch:  523512
Number of first layer output nodes during this epoch:  304174
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09040260314941406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016908884048461914
global_2_local spend time (sec) 0.045166730880737305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004784584045410156
A = g.adjacency_matrix() spent  0.01080775260925293
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08247947692871094
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3410484790802002
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2359123229980469

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 0.024 seconds
Metis partitioning: 0.073 seconds
Split the graph: 0.070 seconds
Construct subgraphs: 0.071 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.23876261711120605
22798
22797
22797
22549
total k batches seeds list generation spend  10.740599632263184
after graph partition
graph partition algorithm spend time 10.829293727874756
22798
22797
22797
22549
partition_len_list
[84699, 74856, 70628, 74154]
shared_neighbor_graph_partition_s0 selection method  spend 10.924535036087036
time for parepare:  0.01741337776184082
local_output_nid generation:  0.003142833709716797
local_in_edges_tensor generation:  0.003924369812011719
mini_batch_src_global generation:  0.010025978088378906
r_  generation:  0.08017277717590332
local_output_nid generation:  0.004133462905883789
local_in_edges_tensor generation:  0.004130840301513672
mini_batch_src_global generation:  0.00749969482421875
r_  generation:  0.0631556510925293
local_output_nid generation:  0.004297971725463867
local_in_edges_tensor generation:  0.003835439682006836
mini_batch_src_global generation:  0.006661653518676758
r_  generation:  0.07222485542297363
local_output_nid generation:  0.004293680191040039
local_in_edges_tensor generation:  0.003462553024291992
mini_batch_src_global generation:  0.005276918411254883
r_  generation:  0.0541844367980957
----------------------check_connections_block total spend ----------------------------- 0.4233689308166504
generate_one_block  0.13399434089660645
generate_one_block  0.08553028106689453
generate_one_block  0.09872937202453613
generate_one_block  0.07173919677734375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02480626106262207
gen group dst list time:  0.008624553680419922
time for parepare:  0.019257068634033203
local_output_nid generation:  0.01355600357055664
local_in_edges_tensor generation:  0.0244903564453125
mini_batch_src_global generation:  0.01978898048400879
r_  generation:  0.22236371040344238
local_output_nid generation:  0.01664257049560547
local_in_edges_tensor generation:  0.014594078063964844
mini_batch_src_global generation:  0.020461559295654297
r_  generation:  0.18671894073486328
local_output_nid generation:  0.01568746566772461
local_in_edges_tensor generation:  0.012894153594970703
mini_batch_src_global generation:  0.017927885055541992
r_  generation:  0.17980432510375977
local_output_nid generation:  0.016520023345947266
local_in_edges_tensor generation:  0.013437271118164062
mini_batch_src_global generation:  0.01847100257873535
r_  generation:  0.18694472312927246
----------------------check_connections_block total spend ----------------------------- 1.1757030487060547
generate_one_block  0.28592753410339355
generate_one_block  0.22751665115356445
generate_one_block  0.22052288055419922
generate_one_block  0.22117114067077637
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09040260314941406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

connection checking time:  1.1757030487060547
block generation total time  0.9551382064819336
average batch blocks generation time:  0.2387845516204834
block dataloader generation time/epoch 13.927140235900879
pseudo mini batch 0 input nodes size: 135263
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.0777750015258789  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.0777750015258789  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.1422734260559082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.14244365692138672  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07917070388793945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08584213256835938  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08584213256835938  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08584213256835938  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([135263, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08584213256835938  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([5098, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.39101362228393555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.39101362228393555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5098, 128]), torch.Size([1, 5098, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3958754539489746  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4347701072692871  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5098, 128])
m.shape torch.Size([6072, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.43812990188598633  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.43812990188598633  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6072, 128]), torch.Size([1, 6072, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4439206123352051  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5318799018859863  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6072, 128])
m.shape torch.Size([5841, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5376706123352051  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5376706123352051  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5841, 128]), torch.Size([1, 5841, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.543241024017334  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6703033447265625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5841, 128])
m.shape torch.Size([5322, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6784048080444336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6784048080444336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5322, 128]), torch.Size([1, 5322, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6837277412414551  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8314042091369629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5322, 128])
m.shape torch.Size([4802, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8403153419494629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8403153419494629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4802, 128]), torch.Size([1, 4802, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8452010154724121  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0127863883972168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4802, 128])
m.shape torch.Size([4052, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0220894813537598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0220894813537598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4052, 128]), torch.Size([1, 4052, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0260796546936035  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1944661140441895  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4052, 128])
m.shape torch.Size([3696, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2048707008361816  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2048707008361816  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3696, 128]), torch.Size([1, 3696, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2084050178527832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3869223594665527  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3696, 128])
m.shape torch.Size([3365, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.397996425628662  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.397996425628662  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3365, 128]), torch.Size([1, 3365, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4013633728027344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5902061462402344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3365, 128])
m.shape torch.Size([3084, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6012182235717773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6012182235717773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3084, 128]), torch.Size([1, 3084, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.604304313659668  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.7981820106506348  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3084, 128])
m.shape torch.Size([43367, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 2.0030875205993652  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 2.0030875205993652  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 43367, 128]), torch.Size([1, 43367, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 2.046010971069336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.000146865844727  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 43367, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.721336841583252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.802112102508545  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.882887363433838  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.801480770111084  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([84699, 256])
first layer input nodes number: 135263
first layer output nodes number: 84699
edges number: 618593
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.883955478668213  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.964730739593506  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.984924793243408  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.984924793243408  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([2776, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.224673271179199  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.224673271179199  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2776, 256]), torch.Size([1, 2776, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.230790138244629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.275444984436035  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2776, 256])
m.shape torch.Size([2384, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.276806354522705  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.276806354522705  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2384, 256]), torch.Size([1, 2384, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.281527042388916  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.354737758636475  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2384, 256])
m.shape torch.Size([1914, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.357035160064697  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.357035160064697  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1914, 256]), torch.Size([1, 1914, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3608269691467285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.441458225250244  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1914, 256])
m.shape torch.Size([1425, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4451117515563965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4451117515563965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1425, 256]), torch.Size([1, 1425, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4478888511657715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.528148651123047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1425, 256])
m.shape torch.Size([1316, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.533113956451416  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.533113956451416  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1316, 256]), torch.Size([1, 1316, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.535665035247803  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.628014087677002  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1316, 256])
m.shape torch.Size([961, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.631589889526367  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.631589889526367  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 961, 256]), torch.Size([1, 961, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.6334228515625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.717474937438965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 961, 256])
m.shape torch.Size([804, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.721967697143555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.721967697143555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.723501205444336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.802589416503906  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([694, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.807158946990967  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.807158946990967  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.808482646942139  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.884480953216553  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 694, 256])
m.shape torch.Size([670, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.889615058898926  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.889615058898926  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.89089298248291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.97268009185791  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([602, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.977827548980713  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.977827548980713  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.978975772857666  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.060511112213135  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([523, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.065466403961182  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.065466403961182  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.066463947296143  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.144351482391357  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([480, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.149388790130615  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.149388790130615  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.150304317474365  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.22845983505249  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([454, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.233675003051758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.233675003051758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.234540939331055  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.315725326538086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([359, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.320123195648193  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.320123195648193  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.320807933807373  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.390857219696045  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([360, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.395705223083496  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.395705223083496  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.396391868591309  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.4704389572143555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([355, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.475554943084717  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.475554943084717  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.476232051849365  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.554881572723389  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([314, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.55967378616333  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.55967378616333  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.560272693634033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.634003162384033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([347, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.639707088470459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.639707088470459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.640368938446045  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.724761486053467  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([307, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.730037212371826  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.730037212371826  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.7306227684021  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.812248706817627  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([283, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.81739616394043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.81739616394043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.817935943603516  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.894643783569336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([266, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.89974308013916  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.89974308013916  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.900250434875488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.976466178894043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([206, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.9805684089660645  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.9805684089660645  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.980961322784424  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.041862964630127  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([191, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.045888900756836  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.045888900756836  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.046253204345703  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.1052703857421875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([224, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.110255241394043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.110255241394043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.110682487487793  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.182887077331543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([4583, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.292794704437256  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.292794704437256  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4583, 256]), torch.Size([1, 4583, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 7.3015360832214355  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.84001874923706  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4583, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.620677947998047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.624090194702148  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.627487659454346  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.623905181884766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22798, 40])
input nodes number: 84699
output nodes number: 22798
edges number: 245622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.624720096588135  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 8.624721050262451  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09734153747558594  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 1 input nodes size: 130974
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07918500900268555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07918500900268555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.14163827896118164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.14180850982666016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07713985443115234  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08216333389282227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08216333389282227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08216333389282227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([130974, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08216333389282227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([6486, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3199186325073242  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3199186325073242  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6486, 128]), torch.Size([1, 6486, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.32628583908081055  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.37577009201049805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6486, 128])
m.shape torch.Size([7523, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3798518180847168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3798518180847168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7523, 128]), torch.Size([1, 7523, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3879833221435547  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.49655771255493164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7523, 128])
m.shape torch.Size([7049, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5020971298217773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5020971298217773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7049, 128]), torch.Size([1, 7049, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5089035034179688  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6570243835449219  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7049, 128])
m.shape torch.Size([6196, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6654810905456543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6654810905456543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6196, 128]), torch.Size([1, 6196, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.671567440032959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8429274559020996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6196, 128])
m.shape torch.Size([5304, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8526186943054199  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8526186943054199  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5304, 128]), torch.Size([1, 5304, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8579421043395996  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0417675971984863  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5304, 128])
m.shape torch.Size([4423, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0518927574157715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0518927574157715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4423, 128]), torch.Size([1, 4423, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0567736625671387  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2435202598571777  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4423, 128])
m.shape torch.Size([3688, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2535157203674316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2535157203674316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3688, 128]), torch.Size([1, 3688, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.257124423980713  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4397587776184082  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3688, 128])
m.shape torch.Size([3319, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4504742622375488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4504742622375488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3319, 128]), torch.Size([1, 3319, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4536643028259277  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6387319564819336  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3319, 128])
m.shape torch.Size([2790, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6491031646728516  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6491031646728516  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2790, 128]), torch.Size([1, 2790, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6523404121398926  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8320393562316895  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2790, 128])
m.shape torch.Size([28078, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9636893272399902  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9636893272399902  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 28078, 128]), torch.Size([1, 28078, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.990466594696045  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.8916525840759277  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 28078, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.683206558227539  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7545948028564453  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.8259830474853516  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7540369033813477  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([74856, 256])
first layer input nodes number: 130974
first layer output nodes number: 74856
edges number: 478779
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.826961040496826  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.8983492851257324  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.916196346282959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.916196346282959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([3589, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.080490589141846  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.080490589141846  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3589, 256]), torch.Size([1, 3589, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.08733606338501  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.142618656158447  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3589, 256])
m.shape torch.Size([3162, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.1453857421875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.1453857421875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3162, 256]), torch.Size([1, 3162, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.151839733123779  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.242640018463135  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3162, 256])
m.shape torch.Size([2478, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.247149467468262  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.247149467468262  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2478, 256]), torch.Size([1, 2478, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.251984596252441  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.3610734939575195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2478, 256])
m.shape torch.Size([2053, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.366923809051514  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.366923809051514  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2053, 256]), torch.Size([1, 2053, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.371269226074219  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.48552131652832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2053, 256])
m.shape torch.Size([1628, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.491387367248535  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.491387367248535  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1628, 256]), torch.Size([1, 1628, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.494673728942871  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.6126604080200195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1628, 256])
m.shape torch.Size([1312, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.618673801422119  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.618673801422119  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1312, 256]), torch.Size([1, 1312, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.621191501617432  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.732074737548828  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1312, 256])
m.shape torch.Size([1024, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.737621307373047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.737621307373047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1024, 256]), torch.Size([1, 1024, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.739574432373047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.837230682373047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1024, 256])
m.shape torch.Size([925, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.843366622924805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.843366622924805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 925, 256]), torch.Size([1, 925, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.845130920410156  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.945695877075195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 925, 256])
m.shape torch.Size([736, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.951180458068848  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.951180458068848  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 736, 256]), torch.Size([1, 736, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.952584266662598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.042969703674316  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 736, 256])
m.shape torch.Size([658, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.0485920906066895  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.0485920906066895  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 658, 256]), torch.Size([1, 658, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.04984712600708  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.140064716339111  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 658, 256])
m.shape torch.Size([509, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1448187828063965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1448187828063965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.145789623260498  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.22190523147583  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([488, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.227048397064209  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.227048397064209  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.2279791831970215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.309709072113037  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([376, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.313941955566406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.313941955566406  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.314659118652344  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3824615478515625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([342, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.386704921722412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.386704921722412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.387357234954834  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.452550411224365  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([339, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.457111835479736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.457111835479736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.45775842666626  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.526998043060303  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([278, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.53095006942749  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.53095006942749  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.531480312347412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5935893058776855  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([229, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5970659255981445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5970659255981445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.597502708435059  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.649916648864746  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([178, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.652778148651123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.652778148651123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.653117656707764  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.696235179901123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([187, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.6994805335998535  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.6994805335998535  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.6998372077941895  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.747631549835205  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([165, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.750625133514404  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.750625133514404  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.750939846038818  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.795314311981201  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([133, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.797841548919678  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.797841548919678  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.798095226287842  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.835639476776123  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([120, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.838050365447998  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.838050365447998  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.8382792472839355  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.873755931854248  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([105, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.875962734222412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.875962734222412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.876163005828857  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.908607006072998  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([105, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.910929203033447  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.910929203033447  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.911129474639893  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.94497537612915  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([1678, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.985194683074951  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.985194683074951  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1678, 256]), torch.Size([1, 1678, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.988746166229248  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.56195592880249  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1678, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.422207832336426  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.425630569458008  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.429028034210205  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.4254350662231445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22797, 40])
input nodes number: 74856
output nodes number: 22797
edges number: 166275
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.426148414611816  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.426148891448975  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09110116958618164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 2 input nodes size: 125766
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07712507247924805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07712507247924805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13709497451782227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13726520538330078  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07464170455932617  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959890365600586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959890365600586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959890365600586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([125766, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07959890365600586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([5566, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3095717430114746  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3095717430114746  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5566, 128]), torch.Size([1, 5566, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3148798942565918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3573451042175293  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5566, 128])
m.shape torch.Size([6573, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.360959529876709  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.360959529876709  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6573, 128]), torch.Size([1, 6573, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.36722803115844727  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.46198129653930664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6573, 128])
m.shape torch.Size([6380, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.46724796295166016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.46724796295166016  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6380, 128]), torch.Size([1, 6380, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.4741501808166504  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.608191967010498  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6380, 128])
m.shape torch.Size([5598, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6158270835876465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6158270835876465  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5598, 128]), torch.Size([1, 5598, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6212849617004395  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7761063575744629  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5598, 128])
m.shape torch.Size([5032, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7854342460632324  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7854342460632324  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5032, 128]), torch.Size([1, 5032, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.7904257774353027  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9665427207946777  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5032, 128])
m.shape torch.Size([4176, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9757552146911621  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9757552146911621  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4176, 128]), torch.Size([1, 4176, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.9798026084899902  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.153639316558838  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4176, 128])
m.shape torch.Size([3692, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1639714241027832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1639714241027832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3692, 128]), torch.Size([1, 3692, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.1675724983215332  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3446106910705566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3692, 128])
m.shape torch.Size([3208, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3550877571105957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3550877571105957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3208, 128]), torch.Size([1, 3208, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.3583073616027832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5368390083312988  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3208, 128])
m.shape torch.Size([2761, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5471582412719727  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.5471582412719727  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2761, 128]), torch.Size([1, 2761, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.550004482269287  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.7194147109985352  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2761, 128])
m.shape torch.Size([27642, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8499054908752441  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8499054908752441  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 27642, 128]), torch.Size([1, 27642, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8762669563293457  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7479310035705566  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 27642, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.545193672180176  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6125497817993164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.679905891418457  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.61202335357666  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([70628, 256])
first layer input nodes number: 125766
first layer output nodes number: 70628
edges number: 463237
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.680845260620117  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.748201370239258  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.765040397644043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.765040397644043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([2924, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9630579948425293  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9630579948425293  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2924, 256]), torch.Size([1, 2924, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9699487686157227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.016172409057617  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2924, 256])
m.shape torch.Size([2536, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.017485618591309  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.017485618591309  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2536, 256]), torch.Size([1, 2536, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.0228471755981445  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.095952033996582  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2536, 256])
m.shape torch.Size([1981, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.099928379058838  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.099928379058838  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1981, 256]), torch.Size([1, 1981, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.103846073150635  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.189747333526611  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1981, 256])
m.shape torch.Size([1660, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.194258213043213  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.194258213043213  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1660, 256]), torch.Size([1, 1660, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.197730541229248  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.289785861968994  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1660, 256])
m.shape torch.Size([1450, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.2951531410217285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.2951531410217285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1450, 256]), torch.Size([1, 1450, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.298180103302002  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.39963960647583  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1450, 256])
m.shape torch.Size([1223, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.405309677124023  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.405309677124023  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1223, 256]), torch.Size([1, 1223, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.407659530639648  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.512401103973389  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1223, 256])
m.shape torch.Size([1145, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.518762588500977  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.518762588500977  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1145, 256]), torch.Size([1, 1145, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.520961761474609  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.630475997924805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1145, 256])
m.shape torch.Size([983, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.636899471282959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.636899471282959  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.638774394989014  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.7495551109313965  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([867, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.756117343902588  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.756117343902588  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 867, 256]), torch.Size([1, 867, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.757771015167236  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.863605976104736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 867, 256])
m.shape torch.Size([803, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.870497226715088  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.870497226715088  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 803, 256]), torch.Size([1, 803, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.872028827667236  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.981175899505615  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 803, 256])
m.shape torch.Size([710, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.987916946411133  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.987916946411133  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 710, 256]), torch.Size([1, 710, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.98927116394043  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.097761154174805  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 710, 256])
m.shape torch.Size([607, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1040849685668945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1040849685668945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.105242729187012  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.20438289642334  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 607, 256])
m.shape torch.Size([514, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.210226535797119  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.210226535797119  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.211206912994385  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.302229404449463  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([475, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.308130741119385  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.308130741119385  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.309036731719971  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3994526863098145  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([378, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.404449462890625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.404449462890625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.405170440673828  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.483636856079102  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([321, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.488213062286377  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.488213062286377  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.48882532119751  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.558713912963867  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([346, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.564061164855957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.564061164855957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.56472110748291  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.644637107849121  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([316, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.649774074554443  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.649774074554443  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.650376796722412  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.728272914886475  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([236, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.732281684875488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.732281684875488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.732731819152832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.7930498123168945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([269, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.7979960441589355  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.7979960441589355  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.798509120941162  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.872493267059326  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([226, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.876798629760742  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.876798629760742  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.877229690551758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.94102668762207  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([182, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.94465970993042  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.94465970993042  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.945006847381592  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.998813152313232  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([165, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.0022873878479  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.0022873878479  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.0026021003723145  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.053585529327393  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([154, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.056980609893799  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.056980609893799  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.057274341583252  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.10691499710083  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([2326, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.162657737731934  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.162657737731934  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2326, 256]), torch.Size([1, 2326, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.1670942306518555  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.9479169845581055  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2326, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.773509979248047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.77751350402832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.780910968780518  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.776737213134766  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22797, 40])
input nodes number: 70628
output nodes number: 22797
edges number: 201936
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.778039932250977  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 6.778040409088135  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08977937698364258  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

pseudo mini batch 3 input nodes size: 132737
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07524776458740234  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07524776458740234  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13854169845581055  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.13871002197265625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.07856988906860352  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08297014236450195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08297014236450195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08297014236450195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([132737, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.08297014236450195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([7058, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.31192874908447266  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.31192874908447266  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7058, 128]), torch.Size([1, 7058, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.31865978240966797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3731374740600586  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7058, 128])
m.shape torch.Size([8043, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3781251907348633  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3781251907348633  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 8043, 128]), torch.Size([1, 8043, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.3864784240722656  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5037107467651367  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 8043, 128])
m.shape torch.Size([7362, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5101938247680664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5101938247680664  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 7362, 128]), torch.Size([1, 7362, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.5172147750854492  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6716756820678711  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 7362, 128])
m.shape torch.Size([6281, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.680145263671875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.680145263671875  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 6281, 128]), torch.Size([1, 6281, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.6861352920532227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8598461151123047  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 6281, 128])
m.shape torch.Size([5408, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8697447776794434  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8697447776794434  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 5408, 128]), torch.Size([1, 5408, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.8749022483825684  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0605711936950684  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 5408, 128])
m.shape torch.Size([4408, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.070603847503662  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.070603847503662  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4408, 128]), torch.Size([1, 4408, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.0753912925720215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2635879516601562  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4408, 128])
m.shape torch.Size([3612, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.272928237915039  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.272928237915039  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3612, 128]), torch.Size([1, 3612, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.2768831253051758  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4551877975463867  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3612, 128])
m.shape torch.Size([3123, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.465378761291504  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.465378761291504  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3123, 128]), torch.Size([1, 3123, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.4684362411499023  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.640390396118164  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3123, 128])
m.shape torch.Size([2600, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6500592231750488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6500592231750488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2600, 128]), torch.Size([1, 2600, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.6528668403625488  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.8178191184997559  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2600, 128])
m.shape torch.Size([26259, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9414973258972168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9414973258972168  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 26259, 128]), torch.Size([1, 26259, 128])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 1.9665398597717285  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.7445597648620605  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 26259, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.5456886291503906  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6164073944091797  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6871261596679688  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.6158547401428223  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([74154, 256])
first layer input nodes number: 132737
first layer output nodes number: 74154
edges number: 460100
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.688121795654297  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.758840560913086  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.776520252227783  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.776520252227783  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

m.shape torch.Size([4139, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.906947612762451  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.906947612762451  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 4139, 256]), torch.Size([1, 4139, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.916255474090576  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.982292652130127  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 4139, 256])
m.shape torch.Size([3624, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9847030639648438  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9847030639648438  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 3624, 256]), torch.Size([1, 3624, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 3.9919557571411133  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.095925331115723  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 3624, 256])
m.shape torch.Size([2904, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.1008429527282715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.1008429527282715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2904, 256]), torch.Size([1, 2904, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.107203483581543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.230353355407715  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2904, 256])
m.shape torch.Size([2182, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.235934734344482  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.235934734344482  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 2182, 256]), torch.Size([1, 2182, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.240493297576904  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.366983413696289  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 2182, 256])
m.shape torch.Size([1828, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.372920036315918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.372920036315918  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1828, 256]), torch.Size([1, 1828, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.376755237579346  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.503252983093262  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1828, 256])
m.shape torch.Size([1372, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.50954008102417  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.50954008102417  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1372, 256]), torch.Size([1, 1372, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.5124688148498535  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.627466201782227  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1372, 256])
m.shape torch.Size([1072, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.633370399475098  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.633370399475098  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 1072, 256]), torch.Size([1, 1072, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.635634422302246  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.741433143615723  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 1072, 256])
m.shape torch.Size([870, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.747100353240967  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.747100353240967  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 870, 256]), torch.Size([1, 870, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.748759746551514  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.8433451652526855  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 870, 256])
m.shape torch.Size([703, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.848596572875977  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.848596572875977  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 703, 256]), torch.Size([1, 703, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.849937438964844  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.939277648925781  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 703, 256])
m.shape torch.Size([536, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.943758964538574  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.943758964538574  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 4.944781303405762  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.017489433288574  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([461, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.021852493286133  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.021852493286133  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.022731781005859  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.091744422912598  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([362, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.095479965209961  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.095479965209961  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.096170425415039  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.15537166595459  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([312, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1589250564575195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.1589250564575195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.159520149230957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.2155656814575195  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([258, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.218739986419678  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.218739986419678  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.219232082366943  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.269921779632568  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([212, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.272732257843018  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.272732257843018  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.273136615753174  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.315998554229736  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([157, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.318615436553955  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.318615436553955  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.318914890289307  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.352753162384033  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([141, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.354907512664795  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.354907512664795  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.3551764488220215  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.387448787689209  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([107, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.389165878295898  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.389165878295898  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.389369964599609  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.415288925170898  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.417122840881348  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.417122840881348  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.417325019836426  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.4444169998168945  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([90, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.446046352386475  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.446046352386475  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.446218013763428  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.470422267913818  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([92, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.472193717956543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.472193717956543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.472369194030762  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.498339653015137  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.499267101287842  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.499267101287842  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.499358654022217  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.513549327850342  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5147857666015625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.5147857666015625  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.514896392822266  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.532817840576172  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.533731460571289  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.533731460571289  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.533811569213867  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.54734992980957  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([873, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.568957328796387  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.568957328796387  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

 h.shape torch.Size([1, 873, 256]), torch.Size([1, 873, 256])
----------------------------------------3
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.570622444152832  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.863682746887207  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

rst.shape  torch.Size([1, 873, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.758031845092773  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes
Using backend: pytorch

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.76148796081543  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.764848232269287  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.761223793029785  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

torch.Size([22549, 40])
input nodes number: 74154
output nodes number: 22549
edges number: 130417
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.761397361755371  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 5.761397838592529  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09069967269897461  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09069967269897461  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.0291748046875 GB
    Memory Allocated: 0.09069967269897461  GigaBytes
Max Memory Allocated: 9.168812274932861  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061069607734680176 |0.003518044948577881 |0.14205878973007202 |0.00010269880294799805 |0.08925729990005493 |0.004567146301269531 |
----------------------------------------------------------pseudo_mini_loss sum 3.101686477661133
Total (block generation + training)time/epoch 15.177534580230713
Training time/epoch 1.2459168434143066
Training time without block to device /epoch 1.2318446636199951
Training time without total dataloading part /epoch 0.9302423000335693
load block tensor time/epoch 0.2442784309387207
block to device time/epoch 0.014072179794311523
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  829077
Number of first layer input nodes during this epoch:  524740
Number of first layer output nodes during this epoch:  304337
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
