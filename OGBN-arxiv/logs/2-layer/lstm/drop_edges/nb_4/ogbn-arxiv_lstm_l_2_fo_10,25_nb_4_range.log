main start at this time 1651552094.0471659
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03086233139038086
number of batches is  4
batch size is  22736
range selection method spend 0.014871835708618164
time for parepare:  0.018188953399658203
local_output_nid generation:  0.005456209182739258
local_in_edges_tensor generation:  0.005931377410888672
mini_batch_src_global generation:  0.005799770355224609
r_  generation:  0.07673883438110352
local_output_nid generation:  0.006045341491699219
local_in_edges_tensor generation:  0.0031325817108154297
mini_batch_src_global generation:  0.007757902145385742
r_  generation:  0.0794212818145752
local_output_nid generation:  0.006062984466552734
local_in_edges_tensor generation:  0.0029735565185546875
mini_batch_src_global generation:  0.02055501937866211
r_  generation:  0.07806110382080078
local_output_nid generation:  0.005984783172607422
local_in_edges_tensor generation:  0.0031714439392089844
mini_batch_src_global generation:  0.007176637649536133
r_  generation:  0.08115196228027344
----------------------check_connections_block total spend ----------------------------- 0.4808518886566162
generate_one_block  0.09055566787719727
generate_one_block  0.09499192237854004
generate_one_block  0.10355639457702637
generate_one_block  0.09319734573364258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025065183639526367
gen group dst list time:  0.010540485382080078
time for parepare:  0.018627643585205078
local_output_nid generation:  0.013763189315795898
local_in_edges_tensor generation:  0.030644893646240234
mini_batch_src_global generation:  0.019465923309326172
r_  generation:  0.23743557929992676
local_output_nid generation:  0.01929450035095215
local_in_edges_tensor generation:  0.024526596069335938
mini_batch_src_global generation:  0.026076555252075195
r_  generation:  0.24773240089416504
local_output_nid generation:  0.019981861114501953
local_in_edges_tensor generation:  0.021216154098510742
mini_batch_src_global generation:  0.025547027587890625
r_  generation:  0.2506990432739258
local_output_nid generation:  0.020633697509765625
local_in_edges_tensor generation:  0.022062301635742188
mini_batch_src_global generation:  0.029575347900390625
r_  generation:  0.2517886161804199
----------------------check_connections_block total spend ----------------------------- 1.5015511512756348
generate_one_block  0.30691003799438477
generate_one_block  0.3135089874267578
generate_one_block  0.30946779251098633
generate_one_block  0.3086817264556885
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.5015511512756348
block generation total time  1.2385685443878174
average batch blocks generation time:  0.30964213609695435
pseudo mini batch 0 input nodes size: 143024
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.0711369514465332  GigaBytes
Max Memory Allocated: 0.0711369514465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07130670547485352  GigaBytes
Max Memory Allocated: 0.07130670547485352  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07130670547485352  GigaBytes
Max Memory Allocated: 0.07130670547485352  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0777125358581543  GigaBytes
Max Memory Allocated: 0.0777125358581543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0777125358581543  GigaBytes
Max Memory Allocated: 0.0777125358581543  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0777125358581543  GigaBytes
Max Memory Allocated: 0.0777125358581543  GigaBytes

torch.Size([143024, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0777125358581543  GigaBytes
Max Memory Allocated: 0.0777125358581543  GigaBytes

m.shape torch.Size([6118, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4114861488342285  GigaBytes
Max Memory Allocated: 0.4186382293701172  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4114861488342285  GigaBytes
Max Memory Allocated: 0.4186382293701172  GigaBytes

 h.shape torch.Size([1, 6118, 128]), torch.Size([1, 6118, 128])
----------------------------------------3
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4180464744567871  GigaBytes
Max Memory Allocated: 0.4186382293701172  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.46482229232788086  GigaBytes
Max Memory Allocated: 0.4677395820617676  GigaBytes

rst.shape  torch.Size([1, 6118, 128])
m.shape torch.Size([7260, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4688286781311035  GigaBytes
Max Memory Allocated: 0.4689912796020508  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4688286781311035  GigaBytes
Max Memory Allocated: 0.4689912796020508  GigaBytes

 h.shape torch.Size([1, 7260, 128]), torch.Size([1, 7260, 128])
----------------------------------------3
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.47614622116088867  GigaBytes
Max Memory Allocated: 0.47614622116088867  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.5800013542175293  GigaBytes
Max Memory Allocated: 0.5869250297546387  GigaBytes

rst.shape  torch.Size([1, 7260, 128])
m.shape torch.Size([7120, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.5867247581481934  GigaBytes
Max Memory Allocated: 0.5869636535644531  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.5867247581481934  GigaBytes
Max Memory Allocated: 0.5869636535644531  GigaBytes

 h.shape torch.Size([1, 7120, 128]), torch.Size([1, 7120, 128])
----------------------------------------3
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.5935149192810059  GigaBytes
Max Memory Allocated: 0.5935149192810059  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7437644004821777  GigaBytes
Max Memory Allocated: 0.7539496421813965  GigaBytes

rst.shape  torch.Size([1, 7120, 128])
m.shape torch.Size([6491, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.753110408782959  GigaBytes
Max Memory Allocated: 0.7539496421813965  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.753110408782959  GigaBytes
Max Memory Allocated: 0.7539496421813965  GigaBytes

 h.shape torch.Size([1, 6491, 128]), torch.Size([1, 6491, 128])
----------------------------------------3
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7596006393432617  GigaBytes
Max Memory Allocated: 0.7596006393432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9423608779907227  GigaBytes
Max Memory Allocated: 0.9547414779663086  GigaBytes

rst.shape  torch.Size([1, 6491, 128])
m.shape torch.Size([6031, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9526844024658203  GigaBytes
Max Memory Allocated: 0.9547414779663086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9526844024658203  GigaBytes
Max Memory Allocated: 0.9547414779663086  GigaBytes

 h.shape torch.Size([1, 6031, 128]), torch.Size([1, 6031, 128])
----------------------------------------3
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9584360122680664  GigaBytes
Max Memory Allocated: 0.9584360122680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.1680803298950195  GigaBytes
Max Memory Allocated: 1.1824593544006348  GigaBytes

rst.shape  torch.Size([1, 6031, 128])
m.shape torch.Size([5224, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.1801505088806152  GigaBytes
Max Memory Allocated: 1.1824593544006348  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.1801505088806152  GigaBytes
Max Memory Allocated: 1.1824593544006348  GigaBytes

 h.shape torch.Size([1, 5224, 128]), torch.Size([1, 5224, 128])
----------------------------------------3
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.185582160949707  GigaBytes
Max Memory Allocated: 1.185582160949707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.3998079299926758  GigaBytes
Max Memory Allocated: 1.4154329299926758  GigaBytes

rst.shape  torch.Size([1, 5224, 128])
m.shape torch.Size([4747, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7127685546875 GB
    Memory Allocated: 1.4131617546081543  GigaBytes
Max Memory Allocated: 1.4154329299926758  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7127685546875 GB
    Memory Allocated: 1.4131617546081543  GigaBytes
Max Memory Allocated: 1.4154329299926758  GigaBytes

 h.shape torch.Size([1, 4747, 128]), torch.Size([1, 4747, 128])
----------------------------------------3
 Nvidia-smi: 2.7127685546875 GB
    Memory Allocated: 1.4177145957946777  GigaBytes
Max Memory Allocated: 1.4177145957946777  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.6450490951538086  GigaBytes
Max Memory Allocated: 1.6608939170837402  GigaBytes

rst.shape  torch.Size([1, 4747, 128])
m.shape torch.Size([4319, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.6592612266540527  GigaBytes
Max Memory Allocated: 1.6608939170837402  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.6592612266540527  GigaBytes
Max Memory Allocated: 1.6608939170837402  GigaBytes

 h.shape torch.Size([1, 4319, 128]), torch.Size([1, 4319, 128])
----------------------------------------3
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.663449764251709  GigaBytes
Max Memory Allocated: 1.663449764251709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 1.8982629776000977  GigaBytes
Max Memory Allocated: 1.914738655090332  GigaBytes

rst.shape  torch.Size([1, 4319, 128])
m.shape torch.Size([3821, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 1.9126014709472656  GigaBytes
Max Memory Allocated: 1.914738655090332  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 1.9126014709472656  GigaBytes
Max Memory Allocated: 1.914738655090332  GigaBytes

 h.shape torch.Size([1, 3821, 128]), torch.Size([1, 3821, 128])
----------------------------------------3
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 1.916672706604004  GigaBytes
Max Memory Allocated: 1.916672706604004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4881591796875 GB
    Memory Allocated: 2.150808811187744  GigaBytes
Max Memory Allocated: 2.1672067642211914  GigaBytes

rst.shape  torch.Size([1, 3821, 128])
m.shape torch.Size([44296, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.3602066040039062  GigaBytes
Max Memory Allocated: 2.3652167320251465  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.3602066040039062  GigaBytes
Max Memory Allocated: 2.3652167320251465  GigaBytes

 h.shape torch.Size([1, 44296, 128]), torch.Size([1, 44296, 128])
----------------------------------------3
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.4031753540039062  GigaBytes
Max Memory Allocated: 2.4031753540039062  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0076904296875 GB
    Memory Allocated: 5.410469055175781  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

rst.shape  torch.Size([1, 44296, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0076904296875 GB
    Memory Allocated: 5.110074520111084  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0076904296875 GB
    Memory Allocated: 5.201080799102783  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0076904296875 GB
    Memory Allocated: 5.292087078094482  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0076904296875 GB
    Memory Allocated: 5.200369358062744  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

torch.Size([95427, 256])
first layer input nodes number: 143024
first layer output nodes number: 95427
edges number: 674591
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0076904296875 GB
    Memory Allocated: 5.293162822723389  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0076904296875 GB
    Memory Allocated: 5.384169101715088  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0994873046875 GB
    Memory Allocated: 5.407711505889893  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0994873046875 GB
    Memory Allocated: 5.407711505889893  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

m.shape torch.Size([3397, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.589807033538818  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.589807033538818  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

 h.shape torch.Size([1, 3397, 256]), torch.Size([1, 3397, 256])
----------------------------------------3
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.596508502960205  GigaBytes
Max Memory Allocated: 5.6216888427734375  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.648342609405518  GigaBytes
Max Memory Allocated: 5.65158224105835  GigaBytes

rst.shape  torch.Size([1, 3397, 256])
m.shape torch.Size([2871, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.6506218910217285  GigaBytes
Max Memory Allocated: 5.65158224105835  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.6506218910217285  GigaBytes
Max Memory Allocated: 5.65158224105835  GigaBytes

 h.shape torch.Size([1, 2871, 256]), torch.Size([1, 2871, 256])
----------------------------------------3
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.656414985656738  GigaBytes
Max Memory Allocated: 5.656414985656738  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.74077844619751  GigaBytes
Max Memory Allocated: 5.7462544441223145  GigaBytes

rst.shape  torch.Size([1, 2871, 256])
m.shape torch.Size([2308, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.744383811950684  GigaBytes
Max Memory Allocated: 5.7462544441223145  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.744383811950684  GigaBytes
Max Memory Allocated: 5.7462544441223145  GigaBytes

 h.shape torch.Size([1, 2308, 256]), torch.Size([1, 2308, 256])
----------------------------------------3
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.748818397521973  GigaBytes
Max Memory Allocated: 5.748818397521973  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.846018314361572  GigaBytes
Max Memory Allocated: 5.852621555328369  GigaBytes

rst.shape  torch.Size([1, 2308, 256])
m.shape torch.Size([1817, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.850802898406982  GigaBytes
Max Memory Allocated: 5.852621555328369  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.850802898406982  GigaBytes
Max Memory Allocated: 5.852621555328369  GigaBytes

 h.shape torch.Size([1, 1817, 256]), torch.Size([1, 1817, 256])
----------------------------------------3
 Nvidia-smi: 7.2791748046875 GB
    Memory Allocated: 5.854290962219238  GigaBytes
Max Memory Allocated: 5.854290962219238  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3182373046875 GB
    Memory Allocated: 5.955014228820801  GigaBytes
Max Memory Allocated: 5.961945533752441  GigaBytes

rst.shape  torch.Size([1, 1817, 256])
m.shape torch.Size([1610, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3182373046875 GB
    Memory Allocated: 5.960996627807617  GigaBytes
Max Memory Allocated: 5.961945533752441  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3182373046875 GB
    Memory Allocated: 5.960996627807617  GigaBytes
Max Memory Allocated: 5.961945533752441  GigaBytes

 h.shape torch.Size([1, 1610, 256]), torch.Size([1, 1610, 256])
----------------------------------------3
 Nvidia-smi: 7.3182373046875 GB
    Memory Allocated: 5.96429443359375  GigaBytes
Max Memory Allocated: 5.96429443359375  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.077867031097412  GigaBytes
Max Memory Allocated: 6.085544109344482  GigaBytes

rst.shape  torch.Size([1, 1610, 256])
m.shape torch.Size([1249, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.083292484283447  GigaBytes
Max Memory Allocated: 6.085544109344482  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.083292484283447  GigaBytes
Max Memory Allocated: 6.085544109344482  GigaBytes

 h.shape torch.Size([1, 1249, 256]), torch.Size([1, 1249, 256])
----------------------------------------3
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.085875034332275  GigaBytes
Max Memory Allocated: 6.085875034332275  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 6.192962169647217  GigaBytes
Max Memory Allocated: 6.200109004974365  GigaBytes

rst.shape  torch.Size([1, 1249, 256])
m.shape torch.Size([1060, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 6.198782444000244  GigaBytes
Max Memory Allocated: 6.200109004974365  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 6.198782444000244  GigaBytes
Max Memory Allocated: 6.200109004974365  GigaBytes

 h.shape torch.Size([1, 1060, 256]), torch.Size([1, 1060, 256])
----------------------------------------3
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 6.200991153717041  GigaBytes
Max Memory Allocated: 6.200991153717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 6.306892395019531  GigaBytes
Max Memory Allocated: 6.313968658447266  GigaBytes

rst.shape  torch.Size([1, 1060, 256])
m.shape torch.Size([833, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 6.311874866485596  GigaBytes
Max Memory Allocated: 6.313968658447266  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 6.311874866485596  GigaBytes
Max Memory Allocated: 6.313968658447266  GigaBytes

 h.shape torch.Size([1, 833, 256]), torch.Size([1, 833, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 6.3134636878967285  GigaBytes
Max Memory Allocated: 6.313968658447266  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.406421661376953  GigaBytes
Max Memory Allocated: 6.413242340087891  GigaBytes

rst.shape  torch.Size([1, 833, 256])
m.shape torch.Size([759, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.412498950958252  GigaBytes
Max Memory Allocated: 6.413242340087891  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.412498950958252  GigaBytes
Max Memory Allocated: 6.413242340087891  GigaBytes

 h.shape torch.Size([1, 759, 256]), torch.Size([1, 759, 256])
----------------------------------------3
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.413946628570557  GigaBytes
Max Memory Allocated: 6.413946628570557  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.506628513336182  GigaBytes
Max Memory Allocated: 6.513143062591553  GigaBytes

rst.shape  torch.Size([1, 759, 256])
m.shape torch.Size([646, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.512113571166992  GigaBytes
Max Memory Allocated: 6.513143062591553  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.512113571166992  GigaBytes
Max Memory Allocated: 6.513143062591553  GigaBytes

 h.shape torch.Size([1, 646, 256]), torch.Size([1, 646, 256])
----------------------------------------3
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.513345718383789  GigaBytes
Max Memory Allocated: 6.513345718383789  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 6.601327896118164  GigaBytes
Max Memory Allocated: 6.607488632202148  GigaBytes

rst.shape  torch.Size([1, 646, 256])
m.shape torch.Size([580, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 6.606843948364258  GigaBytes
Max Memory Allocated: 6.607488632202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 6.606843948364258  GigaBytes
Max Memory Allocated: 6.607488632202148  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 6.607950210571289  GigaBytes
Max Memory Allocated: 6.607950210571289  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.69444465637207  GigaBytes
Max Memory Allocated: 6.700700759887695  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([476, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.700190544128418  GigaBytes
Max Memory Allocated: 6.700700759887695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.700190544128418  GigaBytes
Max Memory Allocated: 6.700700759887695  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.701098442077637  GigaBytes
Max Memory Allocated: 6.701098442077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0604248046875 GB
    Memory Allocated: 6.780039310455322  GigaBytes
Max Memory Allocated: 6.785486698150635  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([400, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0604248046875 GB
    Memory Allocated: 6.784583568572998  GigaBytes
Max Memory Allocated: 6.785486698150635  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0604248046875 GB
    Memory Allocated: 6.784583568572998  GigaBytes
Max Memory Allocated: 6.785486698150635  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 8.0604248046875 GB
    Memory Allocated: 6.785346508026123  GigaBytes
Max Memory Allocated: 6.785486698150635  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1483154296875 GB
    Memory Allocated: 6.856635570526123  GigaBytes
Max Memory Allocated: 6.8615946769714355  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([348, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.1483154296875 GB
    Memory Allocated: 6.860937118530273  GigaBytes
Max Memory Allocated: 6.8615946769714355  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1483154296875 GB
    Memory Allocated: 6.860937118530273  GigaBytes
Max Memory Allocated: 6.8615946769714355  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 8.1483154296875 GB
    Memory Allocated: 6.861600875854492  GigaBytes
Max Memory Allocated: 6.861600875854492  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1561279296875 GB
    Memory Allocated: 6.931888580322266  GigaBytes
Max Memory Allocated: 6.936534881591797  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([319, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.1561279296875 GB
    Memory Allocated: 6.936155796051025  GigaBytes
Max Memory Allocated: 6.936534881591797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1561279296875 GB
    Memory Allocated: 6.936155796051025  GigaBytes
Max Memory Allocated: 6.936534881591797  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 8.1580810546875 GB
    Memory Allocated: 6.936764240264893  GigaBytes
Max Memory Allocated: 6.936764240264893  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2264404296875 GB
    Memory Allocated: 7.001754283905029  GigaBytes
Max Memory Allocated: 7.006317615509033  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([275, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.2264404296875 GB
    Memory Allocated: 7.005679130554199  GigaBytes
Max Memory Allocated: 7.006317615509033  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2264404296875 GB
    Memory Allocated: 7.005679130554199  GigaBytes
Max Memory Allocated: 7.006317615509033  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 8.2264404296875 GB
    Memory Allocated: 7.006203651428223  GigaBytes
Max Memory Allocated: 7.006317615509033  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2908935546875 GB
    Memory Allocated: 7.067706108093262  GigaBytes
Max Memory Allocated: 7.071902275085449  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([241, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.2908935546875 GB
    Memory Allocated: 7.07138204574585  GigaBytes
Max Memory Allocated: 7.071902275085449  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2908935546875 GB
    Memory Allocated: 7.07138204574585  GigaBytes
Max Memory Allocated: 7.071902275085449  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 8.2908935546875 GB
    Memory Allocated: 7.071841716766357  GigaBytes
Max Memory Allocated: 7.071902275085449  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3494873046875 GB
    Memory Allocated: 7.127002239227295  GigaBytes
Max Memory Allocated: 7.130909442901611  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([243, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3494873046875 GB
    Memory Allocated: 7.130976676940918  GigaBytes
Max Memory Allocated: 7.130993366241455  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3494873046875 GB
    Memory Allocated: 7.130976676940918  GigaBytes
Max Memory Allocated: 7.130993366241455  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 7.131440162658691  GigaBytes
Max Memory Allocated: 7.131440162658691  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4119873046875 GB
    Memory Allocated: 7.190302848815918  GigaBytes
Max Memory Allocated: 7.194474220275879  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([211, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4119873046875 GB
    Memory Allocated: 7.193924427032471  GigaBytes
Max Memory Allocated: 7.194474220275879  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4119873046875 GB
    Memory Allocated: 7.193924427032471  GigaBytes
Max Memory Allocated: 7.194474220275879  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 8.4119873046875 GB
    Memory Allocated: 7.194326877593994  GigaBytes
Max Memory Allocated: 7.194474220275879  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4705810546875 GB
    Memory Allocated: 7.248255252838135  GigaBytes
Max Memory Allocated: 7.252737522125244  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([194, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4705810546875 GB
    Memory Allocated: 7.252565383911133  GigaBytes
Max Memory Allocated: 7.252737522125244  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4705810546875 GB
    Memory Allocated: 7.252565383911133  GigaBytes
Max Memory Allocated: 7.252737522125244  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 8.4705810546875 GB
    Memory Allocated: 7.252935409545898  GigaBytes
Max Memory Allocated: 7.252935409545898  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5487060546875 GB
    Memory Allocated: 7.305109024047852  GigaBytes
Max Memory Allocated: 7.308809280395508  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([172, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5487060546875 GB
    Memory Allocated: 7.308395862579346  GigaBytes
Max Memory Allocated: 7.308809280395508  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5487060546875 GB
    Memory Allocated: 7.308395862579346  GigaBytes
Max Memory Allocated: 7.308809280395508  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 8.5487060546875 GB
    Memory Allocated: 7.3087239265441895  GigaBytes
Max Memory Allocated: 7.308809280395508  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 7.3572773933410645  GigaBytes
Max Memory Allocated: 7.360722064971924  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([126, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 7.359777927398682  GigaBytes
Max Memory Allocated: 7.360722064971924  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 7.359777927398682  GigaBytes
Max Memory Allocated: 7.360722064971924  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 7.360018253326416  GigaBytes
Max Memory Allocated: 7.360722064971924  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6307373046875 GB
    Memory Allocated: 7.397268772125244  GigaBytes
Max Memory Allocated: 7.399912357330322  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([119, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.6307373046875 GB
    Memory Allocated: 7.399779319763184  GigaBytes
Max Memory Allocated: 7.399912357330322  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6307373046875 GB
    Memory Allocated: 7.399779319763184  GigaBytes
Max Memory Allocated: 7.399912357330322  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 8.6307373046875 GB
    Memory Allocated: 7.400006294250488  GigaBytes
Max Memory Allocated: 7.400006294250488  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6658935546875 GB
    Memory Allocated: 7.436776161193848  GigaBytes
Max Memory Allocated: 7.439386367797852  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([131, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.6658935546875 GB
    Memory Allocated: 7.439684867858887  GigaBytes
Max Memory Allocated: 7.439696788787842  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6658935546875 GB
    Memory Allocated: 7.439684867858887  GigaBytes
Max Memory Allocated: 7.439696788787842  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.6658935546875 GB
    Memory Allocated: 7.439934730529785  GigaBytes
Max Memory Allocated: 7.439934730529785  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7108154296875 GB
    Memory Allocated: 7.482161521911621  GigaBytes
Max Memory Allocated: 7.485159873962402  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([2351, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 7.5391154289245605  GigaBytes
Max Memory Allocated: 7.539334774017334  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 7.5391154289245605  GigaBytes
Max Memory Allocated: 7.539334774017334  GigaBytes

 h.shape torch.Size([1, 2351, 256]), torch.Size([1, 2351, 256])
----------------------------------------3
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 7.543599605560303  GigaBytes
Max Memory Allocated: 7.543599605560303  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6834716796875 GB
    Memory Allocated: 8.332814693450928  GigaBytes
Max Memory Allocated: 8.389455318450928  GigaBytes

rst.shape  torch.Size([1, 2351, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.7069091796875 GB
    Memory Allocated: 8.174587726593018  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.7069091796875 GB
    Memory Allocated: 8.17797565460205  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.7069091796875 GB
    Memory Allocated: 8.181363582611084  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.7069091796875 GB
    Memory Allocated: 8.17780590057373  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

torch.Size([22736, 40])
input nodes number: 95427
output nodes number: 22736
edges number: 184999
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7069091796875 GB
    Memory Allocated: 8.182075023651123  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.7069091796875 GB
    Memory Allocated: 8.18207597732544  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.0951242446899414  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

pseudo mini batch 1 input nodes size: 143278
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.14579105377197266  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.14596080780029297  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.07743167877197266  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.08387565612792969  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.08387565612792969  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.08387565612792969  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

torch.Size([143278, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.0701904296875 GB
    Memory Allocated: 0.08387565612792969  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

m.shape torch.Size([6018, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4191875457763672  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4191875457763672  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 6018, 128]), torch.Size([1, 6018, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4249267578125  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4718017578125  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 6018, 128])
m.shape torch.Size([7360, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4759511947631836  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4759511947631836  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 7360, 128]), torch.Size([1, 7360, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4829702377319336  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5882558822631836  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 7360, 128])
m.shape torch.Size([7123, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5949358940124512  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5949358940124512  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 7123, 128]), torch.Size([1, 7123, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.601841926574707  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7520608901977539  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 7123, 128])
m.shape torch.Size([6581, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7612166404724121  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7612166404724121  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 6581, 128]), torch.Size([1, 6581, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7677512168884277  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9497590065002441  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 6581, 128])
m.shape torch.Size([5973, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9608616828918457  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9608616828918457  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 5973, 128]), torch.Size([1, 5973, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9670443534851074  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.1772418022155762  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 5973, 128])
m.shape torch.Size([5236, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.1893739700317383  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.1893739700317383  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 5236, 128]), torch.Size([1, 5236, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.1943674087524414  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.4093823432922363  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 5236, 128])
m.shape torch.Size([4755, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.4227571487426758  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.4227571487426758  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 4755, 128]), torch.Size([1, 4755, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.4273662567138672  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.660609245300293  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 4755, 128])
m.shape torch.Size([4300, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.6756057739257812  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.6756057739257812  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 4300, 128]), torch.Size([1, 4300, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.6797142028808594  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9139909744262695  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 4300, 128])
m.shape torch.Size([3799, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9282441139221191  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9282441139221191  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 3799, 128]), torch.Size([1, 3799, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9320197105407715  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.164429187774658  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 3799, 128])
m.shape torch.Size([44590, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.3755083084106445  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.3755083084106445  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 44590, 128]), torch.Size([1, 44590, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.4184770584106445  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.468369483947754  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 44590, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.167470932006836  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.258770942687988  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.350070953369141  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.258057594299316  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

torch.Size([95735, 256])
first layer input nodes number: 143278
first layer output nodes number: 95735
edges number: 677488
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.3511505126953125  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.442450523376465  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.465888023376465  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.465888023376465  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

m.shape torch.Size([3299, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.6503095626831055  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.6503095626831055  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 3299, 256]), torch.Size([1, 3299, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.656601905822754  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.706940650939941  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 3299, 256])
m.shape torch.Size([2914, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.7093963623046875  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.7093963623046875  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 2914, 256]), torch.Size([1, 2914, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.715044975280762  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.798415184020996  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 2914, 256])
m.shape torch.Size([2346, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.802635192871094  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.802635192871094  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 2346, 256]), torch.Size([1, 2346, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.807155609130859  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.906497478485107  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 2346, 256])
m.shape torch.Size([1880, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.911488056182861  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.911488056182861  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 1880, 256]), torch.Size([1, 1880, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 5.915274143218994  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.020567893981934  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 1880, 256])
m.shape torch.Size([1538, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.0261664390563965  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.0261664390563965  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 1538, 256]), torch.Size([1, 1538, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.029224872589111  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.13712739944458  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 1538, 256])
m.shape torch.Size([1135, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.142040252685547  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.142040252685547  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 1135, 256]), torch.Size([1, 1135, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.144279479980469  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.239287853240967  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 1135, 256])
m.shape torch.Size([990, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.2447052001953125  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.2447052001953125  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 990, 256]), torch.Size([1, 990, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.246593475341797  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.344087600708008  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 990, 256])
m.shape torch.Size([882, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.349925518035889  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.349925518035889  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.351607799530029  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.447558879852295  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([765, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.453335285186768  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.453335285186768  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.454794406890869  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.548414707183838  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([682, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.5542402267456055  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.5542402267456055  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 682, 256]), torch.Size([1, 682, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.555541038513184  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.6483259201049805  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 682, 256])
m.shape torch.Size([546, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.653448104858398  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.653448104858398  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.654489517211914  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.738466262817383  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 546, 256])
m.shape torch.Size([489, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.743585586547852  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.743585586547852  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.744518280029297  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.826723098754883  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([415, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.831442356109619  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.831442356109619  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.832233905792236  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.906854152679443  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([333, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.911776542663574  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.911776542663574  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.912411689758301  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.978222370147705  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([320, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.982518196105957  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.982518196105957  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 6.983128547668457  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.047974586486816  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([287, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.0520830154418945  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.0520830154418945  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.052630424499512  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.1169939041137695  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([261, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.12098503112793  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.12098503112793  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.121482849121094  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.182806968688965  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([245, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.18679666519165  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.18679666519165  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.1872639656066895  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.24661111831665  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([211, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.25023078918457  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.25023078918457  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.250633239746094  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.304561614990234  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([209, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.308378219604492  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.308378219604492  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.30877685546875  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.364984512329102  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([205, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.368923187255859  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.368923187255859  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.369314193725586  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.427183151245117  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([149, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.43013858795166  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.43013858795166  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.430422782897949  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.474472999572754  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([131, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.477227210998535  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.477227210998535  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.477477073669434  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.5179548263549805  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([130, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.520828723907471  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.520828723907471  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 7.521076679229736  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 7.562981128692627  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([2374, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 7.619940280914307  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 7.619940280914307  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

 h.shape torch.Size([1, 2374, 256]), torch.Size([1, 2374, 256])
----------------------------------------3
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 7.624946117401123  GigaBytes
Max Memory Allocated: 8.395717144012451  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 8.422754287719727  GigaBytes
Max Memory Allocated: 8.479354858398438  GigaBytes

rst.shape  torch.Size([1, 2374, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 8.262632369995117  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 8.26602029800415  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 8.269408226013184  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 8.26585054397583  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95735
output nodes number: 22736
edges number: 187301
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 8.266733646392822  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4002685546875 GB
    Memory Allocated: 8.26673412322998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.09518814086914062  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 2 input nodes size: 143087
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.07743167877197266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.07743167877197266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.14579105377197266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.14596080780029297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.08388042449951172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.08388042449951172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.08388042449951172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143087, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.08388042449951172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6021, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.417600154876709  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.417600154876709  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6021, 128]), torch.Size([1, 6021, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.423342227935791  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.47045183181762695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6021, 128])
m.shape torch.Size([7356, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.4745960235595703  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.4745960235595703  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7356, 128]), torch.Size([1, 7356, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.4816112518310547  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.5868396759033203  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7356, 128])
m.shape torch.Size([7020, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.5933742523193359  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.5933742523193359  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7020, 128]), torch.Size([1, 7020, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.6002292633056641  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.7500553131103516  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7020, 128])
m.shape torch.Size([6609, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.7593135833740234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.7593135833740234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6609, 128]), torch.Size([1, 6609, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.7658123970031738  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.9485945701599121  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6609, 128])
m.shape torch.Size([6000, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.9597482681274414  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.9597482681274414  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6000, 128]), torch.Size([1, 6000, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 0.9656286239624023  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.1751928329467773  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6000, 128])
m.shape torch.Size([5206, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.1872262954711914  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.1872262954711914  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5206, 128]), torch.Size([1, 5206, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.192553997039795  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.4069428443908691  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5206, 128])
m.shape torch.Size([4664, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.4200282096862793  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.4200282096862793  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4664, 128]), torch.Size([1, 4664, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.4245271682739258  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.6588702201843262  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4664, 128])
m.shape torch.Size([4198, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.6726603507995605  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.6726603507995605  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4198, 128]), torch.Size([1, 4198, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.6769261360168457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.905836582183838  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4198, 128])
m.shape torch.Size([3801, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.9201469421386719  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.9201469421386719  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3801, 128]), torch.Size([1, 3801, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 1.9237890243530273  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 2.155792236328125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3801, 128])
m.shape torch.Size([44441, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 2.3658909797668457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 2.3658909797668457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44441, 128]), torch.Size([1, 44441, 128])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 2.4088597297668457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.424450397491455  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44441, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.123840808868408  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.215637683868408  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.306538105010986  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.214030742645264  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95316, 256])
first layer input nodes number: 143087
first layer output nodes number: 95316
edges number: 674316
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.307606220245361  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.3985066413879395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.4219441413879395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.4219441413879395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3369, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.6054606437683105  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.6054606437683105  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3369, 256]), torch.Size([1, 3369, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.611886501312256  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.663293361663818  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3369, 256])
m.shape torch.Size([2990, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.666804790496826  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.666804790496826  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2990, 256]), torch.Size([1, 2990, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.672771453857422  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.760106563568115  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2990, 256])
m.shape torch.Size([2287, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.763986110687256  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.763986110687256  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2287, 256]), torch.Size([1, 2287, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.768692493438721  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.865614414215088  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2287, 256])
m.shape torch.Size([1876, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.871614933013916  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.871614933013916  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1876, 256]), torch.Size([1, 1876, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.875243663787842  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.983386516571045  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1876, 256])
m.shape torch.Size([1509, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.988458156585693  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.988458156585693  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1509, 256]), torch.Size([1, 1509, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 5.991488933563232  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.096909999847412  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1509, 256])
m.shape torch.Size([1237, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.102527141571045  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.102527141571045  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1237, 256]), torch.Size([1, 1237, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.104918956756592  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.21429443359375  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1237, 256])
m.shape torch.Size([1003, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.219460487365723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.219460487365723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1003, 256]), torch.Size([1, 1003, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.221373558044434  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.318228721618652  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1003, 256])
m.shape torch.Size([861, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.323892593383789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.323892593383789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.325534820556641  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.41914176940918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([704, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.4247612953186035  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.4247612953186035  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.4261040687561035  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.515932559967041  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([637, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.521383762359619  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.521383762359619  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 637, 256]), torch.Size([1, 637, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.522598743438721  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.6099324226379395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 637, 256])
m.shape torch.Size([536, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.614992141723633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.614992141723633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.61601448059082  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.697246551513672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([491, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.702398777008057  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.702398777008057  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.703335285186768  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.785446643829346  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([433, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.790388584136963  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.790388584136963  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.791214466094971  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.867613315582275  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([371, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.872192859649658  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.872192859649658  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.872900485992432  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.9449896812438965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([318, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.949220657348633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.949220657348633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 6.949827194213867  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.014886856079102  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([264, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.018643379211426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.018643379211426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.019146919250488  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.0818681716918945  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([236, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.085472583770752  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.085472583770752  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.085922718048096  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.139938831329346  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([240, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.143866062164307  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.143866062164307  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.144323825836182  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.202459812164307  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([197, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.205828666687012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.205828666687012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.206204414367676  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.25655460357666  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([218, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.260557651519775  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.260557651519775  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.2609734535217285  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.319601535797119  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([179, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.32327938079834  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.32327938079834  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.323620796203613  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.374150276184082  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([129, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.376707553863525  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.376707553863525  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.376953601837158  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.415091037750244  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([129, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.417819976806641  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.417819976806641  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.418066024780273  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.457925796508789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([138, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.460986137390137  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.460986137390137  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 7.461249351501465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 7.505732536315918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([2384, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 7.562884330749512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 7.562884330749512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2384, 256]), torch.Size([1, 2384, 256])
----------------------------------------3
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 7.567431449890137  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 8.36860179901123  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2384, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 8.208447933197021  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 8.212810039520264  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 8.216197967529297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 8.211666107177734  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95316
output nodes number: 22736
edges number: 185812
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 8.212546348571777  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6072998046875 GB
    Memory Allocated: 8.212546825408936  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.09512710571289062  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 3 input nodes size: 143197
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.1457524299621582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.14592218399047852  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.0773930549621582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.08384370803833008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.08384370803833008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.08384370803833008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143197, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.08384370803833008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6038, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.41958189010620117  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.41958189010620117  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6038, 128]), torch.Size([1, 6038, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.4253401756286621  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.47241735458374023  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6038, 128])
m.shape torch.Size([7169, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.47637510299682617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.47637510299682617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7169, 128]), torch.Size([1, 7169, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.4832119941711426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.5857653617858887  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7169, 128])
m.shape torch.Size([7097, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.5924992561340332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.5924992561340332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7097, 128]), torch.Size([1, 7097, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.599301815032959  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.7494215965270996  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7097, 128])
m.shape torch.Size([6508, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.7584505081176758  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.7584505081176758  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6508, 128]), torch.Size([1, 6508, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.7649378776550293  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.945035457611084  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6508, 128])
m.shape torch.Size([6074, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.956413745880127  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.956413745880127  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6074, 128]), torch.Size([1, 6074, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 0.9624843597412109  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.173715591430664  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6074, 128])
m.shape torch.Size([5287, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.1859455108642578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.1859455108642578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5287, 128]), torch.Size([1, 5287, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.1909875869750977  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.4078044891357422  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5287, 128])
m.shape torch.Size([4687, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.4209280014038086  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.4209280014038086  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4687, 128]), torch.Size([1, 4687, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.4255366325378418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.6564812660217285  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4687, 128])
m.shape torch.Size([4315, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.6715426445007324  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.6715426445007324  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4315, 128]), torch.Size([1, 4315, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.675666332244873  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.9104399681091309  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4315, 128])
m.shape torch.Size([3862, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.925856113433838  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.925856113433838  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3862, 128]), torch.Size([1, 3862, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 1.929624080657959  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 2.167026996612549  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3862, 128])
m.shape torch.Size([44758, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 2.378608226776123  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 2.378608226776123  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44758, 128]), torch.Size([1, 44758, 128])
----------------------------------------3
 Nvidia-smi: 10.6112060546875 GB
    Memory Allocated: 2.421576976776123  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.471789836883545  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44758, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.169628620147705  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.260985851287842  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.3523430824279785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.260272026062012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95795, 256])
first layer input nodes number: 143197
first layer output nodes number: 95795
edges number: 679458
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.353460788726807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.444818019866943  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.468255519866943  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.468255519866943  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3363, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.651684761047363  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.651684761047363  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3363, 256]), torch.Size([1, 3363, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.658099174499512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.709414482116699  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3363, 256])
m.shape torch.Size([2931, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.712678909301758  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.712678909301758  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2931, 256]), torch.Size([1, 2931, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.718656539916992  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.802821159362793  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2931, 256])
m.shape torch.Size([2336, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.806780815124512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.806780815124512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2336, 256]), torch.Size([1, 2336, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.811243534088135  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.910123348236084  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2336, 256])
m.shape torch.Size([1747, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.914612293243408  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.914612293243408  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1747, 256]), torch.Size([1, 1747, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.9180073738098145  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.016178607940674  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1747, 256])
m.shape torch.Size([1565, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.021696090698242  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.021696090698242  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1565, 256]), torch.Size([1, 1565, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.024725914001465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.134526252746582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1565, 256])
m.shape torch.Size([1247, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.14052152633667  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.14052152633667  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1247, 256]), torch.Size([1, 1247, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.143039226531982  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.2514729499816895  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1247, 256])
m.shape torch.Size([992, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.256495475769043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.256495475769043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 992, 256]), torch.Size([1, 992, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.258387565612793  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.355517387390137  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 992, 256])
m.shape torch.Size([896, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.3614606857299805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.3614606857299805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.3631696701049805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.4605817794799805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([748, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.466197967529297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.466197967529297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.467624664306641  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.559085845947266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([634, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.56446647644043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.56446647644043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.565675735473633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.652261734008789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([541, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.657376766204834  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.657376766204834  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.6584086418151855  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.742015361785889  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([481, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.747047424316406  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.747047424316406  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.747964859008789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.826423645019531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([408, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.8310627937316895  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.8310627937316895  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.831840991973877  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.905380725860596  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([382, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.910131931304932  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.910131931304932  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.910860538482666  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.984813213348389  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([332, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.9892354011535645  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.9892354011535645  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.989868640899658  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.059765338897705  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([285, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.063831806182861  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.063831806182861  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.064375400543213  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.126863956451416  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([292, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.131363391876221  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.131363391876221  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.131920337677002  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.201229572296143  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([220, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.204757213592529  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.204757213592529  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.205176830291748  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.258468151092529  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([217, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.262221336364746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.262221336364746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.262635231018066  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.318097114562988  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([186, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.321465969085693  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.321465969085693  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.3218207359313965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.371842861175537  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([161, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.37491512298584  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.37491512298584  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.375222206115723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.420670509338379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([152, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.424479007720947  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.424479007720947  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.424768924713135  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.469706058502197  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([140, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.47265625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.47265625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.472923278808594  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.516181945800781  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([126, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.518955230712891  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.518955230712891  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.519195556640625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.559810638427734  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([2351, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.616769313812256  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.616769313812256  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2351, 256]), torch.Size([1, 2351, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.621253490447998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.410852432250977  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2351, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.250805377960205  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.254193305969238  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.257581233978271  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.254023551940918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22733, 40])
input nodes number: 95795
output nodes number: 22733
edges number: 186138
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.254907131195068  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.254907608032227  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.09519433975219727  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10074472427368164  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10074472427368164  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05513519048690796 |0.08381837606430054 |0.2934303879737854 |0.0001291036605834961 |0.10307347774505615 |0.005741596221923828 |
----------------------------------------------------------pseudo_mini_loss sum 5.3323469161987305
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  954859
Number of first layer input nodes during this epoch:  572586
Number of first layer output nodes during this epoch:  382273
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10074424743652344  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01688861846923828
number of batches is  4
batch size is  22736
range selection method spend 0.012848615646362305
time for parepare:  0.017114877700805664
local_output_nid generation:  0.005411863327026367
local_in_edges_tensor generation:  0.00589752197265625
mini_batch_src_global generation:  0.0057408809661865234
r_  generation:  0.07418465614318848
local_output_nid generation:  0.006216287612915039
local_in_edges_tensor generation:  0.003011941909790039
mini_batch_src_global generation:  0.007540225982666016
r_  generation:  0.07669329643249512
local_output_nid generation:  0.00618743896484375
local_in_edges_tensor generation:  0.0029668807983398438
mini_batch_src_global generation:  0.005579948425292969
r_  generation:  0.0807957649230957
local_output_nid generation:  0.006716012954711914
local_in_edges_tensor generation:  0.0035638809204101562
mini_batch_src_global generation:  0.006536245346069336
r_  generation:  0.08292603492736816
----------------------check_connections_block total spend ----------------------------- 0.4625735282897949
generate_one_block  0.0999746322631836
generate_one_block  0.09896969795227051
generate_one_block  0.1121523380279541
generate_one_block  0.09921526908874512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05004286766052246
gen group dst list time:  0.010917186737060547
time for parepare:  0.021282434463500977
local_output_nid generation:  0.01450657844543457
local_in_edges_tensor generation:  0.031122446060180664
mini_batch_src_global generation:  0.023708105087280273
r_  generation:  0.24020981788635254
local_output_nid generation:  0.020516633987426758
local_in_edges_tensor generation:  0.0251309871673584
mini_batch_src_global generation:  0.0250244140625
r_  generation:  0.24703741073608398
local_output_nid generation:  0.020903587341308594
local_in_edges_tensor generation:  0.021918296813964844
mini_batch_src_global generation:  0.025969743728637695
r_  generation:  0.25359129905700684
local_output_nid generation:  0.021174907684326172
local_in_edges_tensor generation:  0.021160125732421875
mini_batch_src_global generation:  0.026819705963134766
r_  generation:  0.26017308235168457
----------------------check_connections_block total spend ----------------------------- 1.5271060466766357
generate_one_block  0.31218528747558594
generate_one_block  0.3160250186920166
generate_one_block  0.3212769031524658
generate_one_block  0.3213801383972168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10074424743652344  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

connection checking time:  1.5271060466766357
block generation total time  1.2708673477172852
average batch blocks generation time:  0.3177168369293213
block dataloader generation time/epoch 3.885556221008301
pseudo mini batch 0 input nodes size: 143008
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08294248580932617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08294248580932617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15130186080932617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15147161483764648  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302021026611328  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946037292480469  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946037292480469  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946037292480469  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143008, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946037292480469  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([5952, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4238553047180176  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4238553047180176  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5952, 128]), torch.Size([1, 5952, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4295315742492676  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4767727851867676  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5952, 128])
m.shape torch.Size([7256, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48085451126098633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48085451126098633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7256, 128]), torch.Size([1, 7256, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4877743721008301  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5915722846984863  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7256, 128])
m.shape torch.Size([7123, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.598301887512207  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.598301887512207  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7123, 128]), torch.Size([1, 7123, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6051583290100098  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7553772926330566  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7123, 128])
m.shape torch.Size([6505, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7643880844116211  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7643880844116211  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6505, 128]), torch.Size([1, 6505, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7708864212036133  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9509081840515137  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6505, 128])
m.shape torch.Size([6000, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9621114730834961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9621114730834961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6000, 128]), torch.Size([1, 6000, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9678335189819336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.178635597229004  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6000, 128])
m.shape torch.Size([5194, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1906347274780273  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1906347274780273  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5194, 128]), torch.Size([1, 5194, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1955881118774414  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4088563919067383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5194, 128])
m.shape torch.Size([4704, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4220809936523438  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4220809936523438  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4704, 128]), torch.Size([1, 4704, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4267559051513672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6608400344848633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4704, 128])
m.shape torch.Size([4281, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6749277114868164  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6749277114868164  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4281, 128]), torch.Size([1, 4281, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6790657043457031  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9127464294433594  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4281, 128])
m.shape torch.Size([3810, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.927055835723877  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.927055835723877  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3810, 128]), torch.Size([1, 3810, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9306893348693848  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.1634297370910645  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3810, 128])
m.shape torch.Size([44678, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.3746542930603027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.3746542930603027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44678, 128]), torch.Size([1, 44678, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.4176230430603027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.468404293060303  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44678, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.167182922363281  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.258979797363281  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.350058555603027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.25754976272583  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95503, 256])
first layer input nodes number: 143008
first layer output nodes number: 95503
edges number: 677263
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.351219654083252  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.442298412322998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.465735912322998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.465735912322998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3293, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.64951229095459  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.64951229095459  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3293, 256]), torch.Size([1, 3293, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.656176567077637  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.707161903381348  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3293, 256])
m.shape torch.Size([2971, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.709732532501221  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.709732532501221  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2971, 256]), torch.Size([1, 2971, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.715695381164551  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.801627159118652  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2971, 256])
m.shape torch.Size([2359, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.805816173553467  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.805816173553467  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2359, 256]), torch.Size([1, 2359, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.8103156089782715  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.909801006317139  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2359, 256])
m.shape torch.Size([1807, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.914498329162598  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.914498329162598  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1807, 256]), torch.Size([1, 1807, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.918068885803223  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.019525051116943  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1807, 256])
m.shape torch.Size([1509, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.024674415588379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.024674415588379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1509, 256]), torch.Size([1, 1509, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.027588844299316  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.13339376449585  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1509, 256])
m.shape torch.Size([1179, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.138567924499512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.138567924499512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1179, 256]), torch.Size([1, 1179, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.140886306762695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.239772796630859  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1179, 256])
m.shape torch.Size([1084, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.2458014488220215  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.2458014488220215  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1084, 256]), torch.Size([1, 1084, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.248330593109131  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.35617208480835  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1084, 256])
m.shape torch.Size([857, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.361985683441162  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.361985683441162  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.363620281219482  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.457976818084717  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([723, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.463413715362549  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.463413715362549  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 723, 256]), torch.Size([1, 723, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.464792728424072  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.5561394691467285  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 723, 256])
m.shape torch.Size([633, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.5615339279174805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.5615339279174805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 633, 256]), torch.Size([1, 633, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.562741279602051  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.6494951248168945  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 633, 256])
m.shape torch.Size([580, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.655023574829102  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.655023574829102  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.656129837036133  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.742647171020508  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([460, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.747399806976318  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.747399806976318  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.748277187347412  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.825378894805908  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([429, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.830300807952881  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.830300807952881  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.831119060516357  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.907045841217041  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([369, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.911602020263672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.911602020263672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.91230583190918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.983205795288086  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([306, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.987265586853027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.987265586853027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.987849235534668  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.052704334259033  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([273, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.056611061096191  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.056611061096191  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.057131767272949  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.117804527282715  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([270, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.121955871582031  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.121955871582031  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.122470855712891  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.184980392456055  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([242, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.188910007476807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.188910007476807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.189371585845947  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.247992038726807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([208, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.251559734344482  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.251559734344482  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.251956462860107  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.305118083953857  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([215, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.30905294418335  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.30905294418335  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.309463024139404  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.367284297943115  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([174, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.371524333953857  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.371524333953857  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.371856212615967  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.420974254608154  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.423747539520264  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.423747539520264  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.424012660980225  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.46510648727417  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([135, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.467958450317383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.467958450317383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.4682159423828125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.509929656982422  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([130, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.5127997398376465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.5127997398376465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.513047695159912  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.554952144622803  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([2391, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.612279415130615  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.612279415130615  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2391, 256]), torch.Size([1, 2391, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.61683988571167  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.422235012054443  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2391, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.261330127716064  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.264718055725098  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.26810598373413  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.264548301696777  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95503
output nodes number: 22736
edges number: 186951
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.265429973602295  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.265430927276611  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.1008448600769043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 1 input nodes size: 143256
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15133094787597656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15150070190429688  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08297157287597656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08939266204833984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08939266204833984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08939266204833984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143256, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08939266204833984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6193, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42369604110717773  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42369604110717773  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6193, 128]), torch.Size([1, 6193, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42960214614868164  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4768509864807129  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6193, 128])
m.shape torch.Size([7235, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48079776763916016  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48079776763916016  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7235, 128]), torch.Size([1, 7235, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4876976013183594  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5911951065063477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7235, 128])
m.shape torch.Size([7118, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5979275703430176  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5979275703430176  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7118, 128]), torch.Size([1, 7118, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6047158241271973  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.754915714263916  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7118, 128])
m.shape torch.Size([6604, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7641177177429199  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7641177177429199  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6604, 128]), torch.Size([1, 6604, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7706608772277832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9533047676086426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6604, 128])
m.shape torch.Size([6025, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9645204544067383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9645204544067383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6025, 128]), torch.Size([1, 6025, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9705023765563965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.181899070739746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6025, 128])
m.shape torch.Size([5236, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1940064430236816  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1940064430236816  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5236, 128]), torch.Size([1, 5236, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1996898651123047  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4147839546203613  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5236, 128])
m.shape torch.Size([4664, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4278550148010254  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4278550148010254  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4664, 128]), torch.Size([1, 4664, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.432420253753662  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.663628101348877  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4664, 128])
m.shape torch.Size([4300, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6787114143371582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6787114143371582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4300, 128]), torch.Size([1, 4300, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6828198432922363  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.917581558227539  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4300, 128])
m.shape torch.Size([3840, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9312801361083984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9312801361083984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3840, 128]), torch.Size([1, 3840, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.934946060180664  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.170703887939453  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3840, 128])
m.shape torch.Size([44524, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.381763458251953  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.381763458251953  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44524, 128]), torch.Size([1, 44524, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.424732208251953  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.445072174072266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44524, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.1444621086120605  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.2357659339904785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.3270697593688965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.235052585601807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95739, 256])
first layer input nodes number: 143256
first layer output nodes number: 95739
edges number: 676822
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.3281474113464355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.4194512367248535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.4428887367248535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.4428887367248535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3379, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.624855041503906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.624855041503906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3379, 256]), torch.Size([1, 3379, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.631527423858643  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.68308687210083  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3379, 256])
m.shape torch.Size([2926, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.685489177703857  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.685489177703857  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2926, 256]), torch.Size([1, 2926, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.691315174102783  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.775648593902588  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2926, 256])
m.shape torch.Size([2305, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.7795515060424805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.7795515060424805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2305, 256]), torch.Size([1, 2305, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.784272193908691  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.881806373596191  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2305, 256])
m.shape torch.Size([1894, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.886889934539795  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.886889934539795  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1894, 256]), torch.Size([1, 1894, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.890540599822998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.996509075164795  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1894, 256])
m.shape torch.Size([1557, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.001899242401123  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.001899242401123  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1557, 256]), torch.Size([1, 1557, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.004971981048584  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.114116668701172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1557, 256])
m.shape torch.Size([1237, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.119537353515625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.119537353515625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1237, 256]), torch.Size([1, 1237, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.121978759765625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.231163501739502  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1237, 256])
m.shape torch.Size([1027, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.236333847045898  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.236333847045898  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1027, 256]), torch.Size([1, 1027, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.238363265991211  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.33779239654541  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1027, 256])
m.shape torch.Size([846, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.343282699584961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.343282699584961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.34489631652832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.439908981323242  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([735, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.445460319519043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.445460319519043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.44686222076416  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.536795616149902  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([673, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.542563438415527  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.542563438415527  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.54384708404541  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.636063575744629  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 673, 256])
m.shape torch.Size([527, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.640993595123291  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.640993595123291  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.641998767852783  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.721050262451172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([508, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.726407051086426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.726407051086426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.7273759841918945  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.810203552246094  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([387, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.814554691314697  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.814554691314697  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.815292835235596  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.88464879989624  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([340, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.88885498046875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.88885498046875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.889503479003906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.955636024475098  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([326, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.960612773895264  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.960612773895264  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.9612345695495605  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0297770500183105  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([266, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.033556938171387  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.033556938171387  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.034064292907715  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.093216896057129  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([262, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0972442626953125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0972442626953125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.097743988037109  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.15882682800293  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([222, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.163146495819092  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.163146495819092  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.163569927215576  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.217345714569092  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([195, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2206950187683105  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2206950187683105  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.221066951751709  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2709059715271  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([193, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.274430274963379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.274430274963379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.274798393249512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.326703071594238  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([168, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.3299102783203125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.3299102783203125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.330230712890625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.377655029296875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([148, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.380624294281006  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.380624294281006  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.380906581878662  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.424661159515381  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([114, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.427040100097656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.427040100097656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.427257537841797  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.462482452392578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([144, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.46574592590332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.46574592590332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.466020584106445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.51243782043457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([2357, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.569380283355713  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.569380283355713  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2357, 256]), torch.Size([1, 2357, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.573875904083252  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.365334510803223  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2357, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.206636428833008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.210024356842041  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.213412284851074  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.20985460281372  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95739
output nodes number: 22736
edges number: 184863
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.210737705230713  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.210738182067871  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.1006622314453125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 2 input nodes size: 143148
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08297157287597656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08297157287597656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15133094787597656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15150070190429688  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08947181701660156  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08947181701660156  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08947181701660156  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143148, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08947181701660156  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6036, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42520856857299805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42520856857299805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6036, 128]), torch.Size([1, 6036, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.43096494674682617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4780459403991699  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6036, 128])
m.shape torch.Size([7324, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48215246200561523  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48215246200561523  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7324, 128]), torch.Size([1, 7324, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4891371726989746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5939078330993652  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7324, 128])
m.shape torch.Size([7060, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6005148887634277  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6005148887634277  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7060, 128]), torch.Size([1, 7060, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6073737144470215  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.757352352142334  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7060, 128])
m.shape torch.Size([6480, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7663455009460449  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7663455009460449  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6480, 128]), torch.Size([1, 6480, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7728018760681152  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9521918296813965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6480, 128])
m.shape torch.Size([6018, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9634499549865723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9634499549865723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6018, 128]), torch.Size([1, 6018, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9691891670227051  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.180046558380127  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6018, 128])
m.shape torch.Size([5227, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.192131519317627  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.192131519317627  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5227, 128]), torch.Size([1, 5227, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1971163749694824  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.41166353225708  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5227, 128])
m.shape torch.Size([4701, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4248623847961426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4248623847961426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4701, 128]), torch.Size([1, 4701, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4294400215148926  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6626200675964355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4701, 128])
m.shape torch.Size([4208, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6764307022094727  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6764307022094727  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4208, 128]), torch.Size([1, 4208, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6805992126464844  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9099431037902832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4208, 128])
m.shape torch.Size([3831, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.92437744140625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.92437744140625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3831, 128]), torch.Size([1, 3831, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9280309677124023  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.1618566513061523  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3831, 128])
m.shape torch.Size([44922, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.374873638153076  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.374873638153076  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44922, 128]), torch.Size([1, 44922, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.417842388153076  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.468623638153076  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44922, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.166543006896973  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.258339881896973  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.349708557128906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.257197856903076  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95807, 256])
first layer input nodes number: 143148
first layer output nodes number: 95807
edges number: 679506
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.3509521484375  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.442320823669434  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.465758323669434  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.465758323669434  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3359, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.649251937866211  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.649251937866211  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3359, 256]), torch.Size([1, 3359, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.656741619110107  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.707995891571045  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3359, 256])
m.shape torch.Size([2951, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.711226463317871  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.711226463317871  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2951, 256]), torch.Size([1, 2951, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.717180252075195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.803127765655518  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2951, 256])
m.shape torch.Size([2342, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.807083606719971  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.807083606719971  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2342, 256]), torch.Size([1, 2342, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.812131404876709  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.9104228019714355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2342, 256])
m.shape torch.Size([1844, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.915278911590576  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.915278911590576  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1844, 256]), torch.Size([1, 1844, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.919083595275879  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.022618293762207  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1844, 256])
m.shape torch.Size([1573, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.028232097625732  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.028232097625732  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1573, 256]), torch.Size([1, 1573, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.031379222869873  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.140260219573975  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1573, 256])
m.shape torch.Size([1210, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.145618915557861  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.145618915557861  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1210, 256]), torch.Size([1, 1210, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.148098468780518  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.250177383422852  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1210, 256])
m.shape torch.Size([941, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.2551960945129395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.2551960945129395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 941, 256]), torch.Size([1, 941, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.256990909576416  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.347274303436279  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 941, 256])
m.shape torch.Size([880, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.353143215179443  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.353143215179443  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 880, 256]), torch.Size([1, 880, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.354821681976318  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.4505133628845215  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 880, 256])
m.shape torch.Size([740, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.456075668334961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.456075668334961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.457487106323242  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.548276901245117  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 740, 256])
m.shape torch.Size([646, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.5537800788879395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.5537800788879395  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 646, 256]), torch.Size([1, 646, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.555012226104736  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.644012928009033  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 646, 256])
m.shape torch.Size([552, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.649232864379883  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.649232864379883  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.650285720825195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.735174179077148  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([498, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.740391731262207  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.740391731262207  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.741341590881348  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.823727607727051  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([385, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.828063488006592  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.828063488006592  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.828797817230225  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.901290416717529  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([348, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.905606269836426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.905606269836426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.9062700271606445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.974818229675293  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([329, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.979229927062988  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.979229927062988  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.979857444763184  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.048683166503906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([263, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0524139404296875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0524139404296875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.052915573120117  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.11100959777832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([258, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.114974498748779  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.114974498748779  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.115466594696045  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.176499843597412  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([222, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.1800947189331055  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.1800947189331055  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.18051815032959  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2342939376831055  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([201, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.238020896911621  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.238020896911621  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.238404273986816  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.289776802062988  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([195, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.293333530426025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.293333530426025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.293705463409424  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.3461480140686035  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([198, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.349958419799805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.349958419799805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.350336074829102  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.406229019165039  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([132, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.408831596374512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.408831596374512  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.409083366394043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.448107719421387  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([122, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.450678825378418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.450678825378418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.450911521911621  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.488608360290527  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([119, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.491237163543701  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.491237163543701  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.491464138031006  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.529822826385498  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([2428, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.58804988861084  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.58804988861084  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2428, 256]), torch.Size([1, 2428, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.592680931091309  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.410416603088379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2428, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.251328945159912  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.254716873168945  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.258104801177979  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.254547119140625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95807
output nodes number: 22736
edges number: 186128
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.255430698394775  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.255431175231934  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10094833374023438  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 3 input nodes size: 142965
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15119218826293945  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15136194229125977  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08283281326293945  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08925867080688477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08925867080688477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08925867080688477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([142965, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08925867080688477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6025, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4230666160583496  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4230666160583496  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6025, 128]), torch.Size([1, 6025, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42881250381469727  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.47591447830200195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6025, 128])
m.shape torch.Size([7232, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4799385070800781  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4799385070800781  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7232, 128]), torch.Size([1, 7232, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4868354797363281  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5902900695800781  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7232, 128])
m.shape torch.Size([7071, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.596956729888916  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.596956729888916  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7071, 128]), torch.Size([1, 7071, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6037769317626953  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7537975311279297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7071, 128])
m.shape torch.Size([6555, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7629284858703613  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7629284858703613  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6555, 128]), torch.Size([1, 6555, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7694258689880371  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9507145881652832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6555, 128])
m.shape torch.Size([6067, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9620537757873535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9620537757873535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6067, 128]), torch.Size([1, 6067, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.968477725982666  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1786808967590332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6067, 128])
m.shape torch.Size([5244, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.190791130065918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.190791130065918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5244, 128]), torch.Size([1, 5244, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.196098804473877  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.411667823791504  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5244, 128])
m.shape torch.Size([4773, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4250988960266113  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4250988960266113  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4773, 128]), torch.Size([1, 4773, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4297380447387695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6642842292785645  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4773, 128])
m.shape torch.Size([4292, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6783809661865234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6783809661865234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4292, 128]), torch.Size([1, 4292, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.682736873626709  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9162530899047852  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4292, 128])
m.shape torch.Size([3818, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9305915832519531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9305915832519531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3818, 128]), torch.Size([1, 3818, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9342536926269531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.168823719024658  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3818, 128])
m.shape torch.Size([44415, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.3787903785705566  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.3787903785705566  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44415, 128]), torch.Size([1, 44415, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.4217591285705566  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.435862064361572  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44415, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.135261535644531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.226329803466797  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.3173980712890625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.2256178855896  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95492, 256])
first layer input nodes number: 142965
first layer output nodes number: 95492
edges number: 675980
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.318503379821777  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.409571647644043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.433009147644043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.433009147644043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3397, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.616473197937012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.616473197937012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3397, 256]), torch.Size([1, 3397, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.622952461242676  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.674786567687988  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3397, 256])
m.shape torch.Size([2858, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.6772356033325195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.6772356033325195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2858, 256]), torch.Size([1, 2858, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.683228492736816  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.765600681304932  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2858, 256])
m.shape torch.Size([2271, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.769498825073242  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.769498825073242  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2271, 256]), torch.Size([1, 2271, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.773981094360352  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.869917869567871  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2271, 256])
m.shape torch.Size([1775, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.874552249908447  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.874552249908447  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1775, 256]), torch.Size([1, 1775, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.878006458282471  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.978403568267822  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1775, 256])
m.shape torch.Size([1583, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.983510494232178  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.983510494232178  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1583, 256]), torch.Size([1, 1583, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.986590385437012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.097026824951172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1583, 256])
m.shape torch.Size([1242, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.103026866912842  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.103026866912842  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1242, 256]), torch.Size([1, 1242, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.105472087860107  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.210083484649658  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1242, 256])
m.shape torch.Size([993, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.215541839599609  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.215541839599609  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 993, 256]), torch.Size([1, 993, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.217435836791992  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.313909530639648  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 993, 256])
m.shape torch.Size([889, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.319798469543457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.319798469543457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 889, 256]), torch.Size([1, 889, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.321494102478027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.418145179748535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 889, 256])
m.shape torch.Size([778, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.424027442932129  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.424027442932129  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 778, 256]), torch.Size([1, 778, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.425511360168457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.520482063293457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 778, 256])
m.shape torch.Size([647, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.525959014892578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.525959014892578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.527193069458008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.615449905395508  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([544, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.620584487915039  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.620584487915039  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.621622085571289  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.705850601196289  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([471, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.710764408111572  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.710764408111572  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.711662769317627  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.7882161140441895  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([455, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.793452262878418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.793452262878418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.794320106506348  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.875089645385742  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([377, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.8797287940979  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.8797287940979  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.880447864532471  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.955351829528809  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([328, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.959721088409424  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.959721088409424  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.960346698760986  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.029539585113525  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([309, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0339789390563965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0339789390563965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0345683097839355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.102717876434326  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([240, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.106344699859619  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.106344699859619  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.106802463531494  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.161734104156494  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([262, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.1660380363464355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.1660380363464355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.166537761688232  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.233785152435303  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([232, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.237771987915039  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.237771987915039  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.238214492797852  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.297510147094727  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([204, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.301210403442383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.301210403442383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.301599502563477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.356462478637695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([177, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.3598408699035645  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.3598408699035645  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.360178470611572  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.4101433753967285  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([137, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.412871837615967  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.412871837615967  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.413133144378662  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.4536356925964355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([148, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.456777095794678  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.456777095794678  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.457059383392334  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.5027899742126465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([132, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.5056939125061035  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.5056939125061035  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.505945682525635  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.548494815826416  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([2284, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.603249549865723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.603249549865723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2284, 256]), torch.Size([1, 2284, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.608388900756836  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.375947952270508  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.216788291931152  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.220646858215332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.224034786224365  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.220006465911865  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22733, 40])
input nodes number: 95492
output nodes number: 22733
edges number: 186308
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.220888137817383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.220888614654541  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10056734085083008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10056734085083008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10056734085083008  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060663044452667236 |0.0038772225379943848 |0.1519639492034912 |0.00010311603546142578 |0.09658610820770264 |0.004610538482666016 |
----------------------------------------------------------pseudo_mini_loss sum 4.128801345825195
Total (block generation + training)time/epoch 5.213923692703247
Training time/epoch 1.3279664516448975
Training time without block to device /epoch 1.31245756149292
Training time without total dataloading part /epoch 0.9992232322692871
load block tensor time/epoch 0.24265217781066895
block to device time/epoch 0.015508890151977539
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  954918
Number of first layer input nodes during this epoch:  572377
Number of first layer output nodes during this epoch:  382541
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10056686401367188  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01858234405517578
number of batches is  4
batch size is  22736
range selection method spend 0.013146638870239258
time for parepare:  0.018237829208374023
local_output_nid generation:  0.00580143928527832
local_in_edges_tensor generation:  0.006724119186401367
mini_batch_src_global generation:  0.006070375442504883
r_  generation:  0.07353615760803223
local_output_nid generation:  0.00630640983581543
local_in_edges_tensor generation:  0.0034034252166748047
mini_batch_src_global generation:  0.0072824954986572266
r_  generation:  0.07549691200256348
local_output_nid generation:  0.0064389705657958984
local_in_edges_tensor generation:  0.003056049346923828
mini_batch_src_global generation:  0.005504608154296875
r_  generation:  0.0787205696105957
local_output_nid generation:  0.006377696990966797
local_in_edges_tensor generation:  0.0030803680419921875
mini_batch_src_global generation:  0.008658885955810547
r_  generation:  0.08031272888183594
----------------------check_connections_block total spend ----------------------------- 0.46204662322998047
generate_one_block  0.09698963165283203
generate_one_block  0.09910798072814941
generate_one_block  0.0986170768737793
generate_one_block  0.09994769096374512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02425241470336914
gen group dst list time:  0.010777711868286133
time for parepare:  0.020830392837524414
local_output_nid generation:  0.015081167221069336
local_in_edges_tensor generation:  0.03186821937561035
mini_batch_src_global generation:  0.021344423294067383
r_  generation:  0.25355005264282227
local_output_nid generation:  0.02279496192932129
local_in_edges_tensor generation:  0.023134231567382812
mini_batch_src_global generation:  0.02605581283569336
r_  generation:  0.2568986415863037
local_output_nid generation:  0.021558046340942383
local_in_edges_tensor generation:  0.019245147705078125
mini_batch_src_global generation:  0.02605438232421875
r_  generation:  0.2617497444152832
local_output_nid generation:  0.02201080322265625
local_in_edges_tensor generation:  0.020632505416870117
mini_batch_src_global generation:  0.02687859535217285
r_  generation:  0.2641313076019287
----------------------check_connections_block total spend ----------------------------- 1.573267936706543
generate_one_block  0.33191394805908203
generate_one_block  0.3125782012939453
generate_one_block  0.3110799789428711
generate_one_block  0.31384706497192383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10056686401367188  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

connection checking time:  1.573267936706543
block generation total time  1.2694191932678223
average batch blocks generation time:  0.31735479831695557
block dataloader generation time/epoch 3.873865008354187
pseudo mini batch 0 input nodes size: 143221
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08283185958862305  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08283185958862305  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15119123458862305  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15136098861694336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302021026611328  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946514129638672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946514129638672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946514129638672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143221, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08946514129638672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6112, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42523765563964844  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42523765563964844  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6112, 128]), torch.Size([1, 6112, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.43106651306152344  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.47800254821777344  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6112, 128])
m.shape torch.Size([7270, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4820213317871094  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4820213317871094  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7270, 128]), torch.Size([1, 7270, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4889545440673828  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5929527282714844  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7270, 128])
m.shape torch.Size([7167, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.599738597869873  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.599738597869873  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7167, 128]), torch.Size([1, 7167, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6066226959228516  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7570095062255859  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7167, 128])
m.shape torch.Size([6467, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7659268379211426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7659268379211426  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6467, 128]), torch.Size([1, 6467, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.772428035736084  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9514894485473633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6467, 128])
m.shape torch.Size([6025, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9627704620361328  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9627704620361328  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6025, 128]), torch.Size([1, 6025, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9685163497924805  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1793889999389648  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6025, 128])
m.shape torch.Size([5228, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1914734840393066  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1914734840393066  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5228, 128]), torch.Size([1, 5228, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1964592933654785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4110298156738281  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5228, 128])
m.shape torch.Size([4747, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4243817329406738  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4243817329406738  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4747, 128]), torch.Size([1, 4747, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.428968906402588  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.663060188293457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4747, 128])
m.shape torch.Size([4274, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.677100658416748  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.677100658416748  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4274, 128]), torch.Size([1, 4274, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.681262493133545  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.914088249206543  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4274, 128])
m.shape torch.Size([3816, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.928426742553711  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.928426742553711  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3816, 128]), torch.Size([1, 3816, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9320659637451172  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.164976119995117  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3816, 128])
m.shape torch.Size([44768, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.376626968383789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.376626968383789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44768, 128]), torch.Size([1, 44768, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.419595718383789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.470376968383789  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44768, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.168398857116699  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.259831428527832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.351263999938965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.2591166496276855  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95874, 256])
first layer input nodes number: 143221
first layer output nodes number: 95874
edges number: 678959
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.352455139160156  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.443887710571289  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.467325210571289  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.467325210571289  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3375, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.650562286376953  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.650562286376953  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3375, 256]), torch.Size([1, 3375, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.65789794921875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.7093963623046875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3375, 256])
m.shape torch.Size([2912, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.711775302886963  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.711775302886963  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2912, 256]), torch.Size([1, 2912, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.717623710632324  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.801620960235596  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2912, 256])
m.shape torch.Size([2410, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.805792808532715  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.805792808532715  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2410, 256]), torch.Size([1, 2410, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.810868263244629  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.911995887756348  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2410, 256])
m.shape torch.Size([1804, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.916633129119873  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.916633129119873  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1804, 256]), torch.Size([1, 1804, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.920119762420654  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.0214619636535645  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1804, 256])
m.shape torch.Size([1531, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.026622295379639  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.026622295379639  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1531, 256]), torch.Size([1, 1531, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.029554843902588  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.139383792877197  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1531, 256])
m.shape torch.Size([1229, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.145829677581787  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.145829677581787  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1229, 256]), torch.Size([1, 1229, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.148208141326904  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.253213882446289  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1229, 256])
m.shape torch.Size([975, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.258438587188721  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.258438587188721  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.260298252105713  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.356085300445557  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([878, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.3619065284729  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.3619065284729  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.36358118057251  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.459036350250244  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 878, 256])
m.shape torch.Size([748, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.464669704437256  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.464669704437256  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.4660964012146  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.55783224105835  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([607, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.562952995300293  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.562952995300293  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.56411075592041  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.649025917053223  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 607, 256])
m.shape torch.Size([556, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.654325485229492  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.654325485229492  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.655385971069336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.739431381225586  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([487, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.744518280029297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.744518280029297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.745447158813477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.827269554138184  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([397, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.831765651702881  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.831765651702881  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.832522869110107  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.902530193328857  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([361, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.907009124755859  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.907009124755859  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.907697677612305  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.976853370666504  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([311, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.980992794036865  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.980992794036865  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.98158597946167  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.0479736328125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([279, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.051967620849609  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.051967620849609  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.052499771118164  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.114597320556641  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([257, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.118530750274658  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.118530750274658  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.119020938873291  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.179860591888428  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([255, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.184027194976807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.184027194976807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.184513568878174  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.246283054351807  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([214, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.249948024749756  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.249948024749756  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.250356197357178  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.305051326751709  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([199, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.308672904968262  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.308672904968262  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.309052467346191  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.362570762634277  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([187, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.366155624389648  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.366155624389648  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.366512298583984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.419300079345703  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([126, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.421786308288574  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.421786308288574  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.422026634216309  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.459277153015137  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([135, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.462141513824463  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.462141513824463  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.462399005889893  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.504112720489502  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([137, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.507144451141357  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.507144451141357  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.507405757904053  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.5515666007995605  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([2366, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.608517646789551  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.608517646789551  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2366, 256]), torch.Size([1, 2366, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.613030433654785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.408792495727539  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2366, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.248498439788818  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.251886367797852  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.255274295806885  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.251716613769531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95874
output nodes number: 22736
edges number: 185876
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.252601146697998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.252602100372314  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10088539123535156  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 1 input nodes size: 142904
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15116310119628906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15133285522460938  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08280372619628906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08922481536865234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08922481536865234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08922481536865234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([142904, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08922481536865234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6001, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4229464530944824  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4229464530944824  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6001, 128]), torch.Size([1, 6001, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42866945266723633  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4758172035217285  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6001, 128])
m.shape torch.Size([7330, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4799461364746094  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4799461364746094  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7330, 128]), torch.Size([1, 7330, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4869365692138672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5917930603027344  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7330, 128])
m.shape torch.Size([6951, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5982413291931152  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5982413291931152  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6951, 128]), torch.Size([1, 6951, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6050510406494141  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7546138763427734  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6951, 128])
m.shape torch.Size([6484, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7636666297912598  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7636666297912598  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6484, 128]), torch.Size([1, 6484, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7700729370117188  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9495639801025391  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6484, 128])
m.shape torch.Size([6036, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9608631134033203  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9608631134033203  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6036, 128]), torch.Size([1, 6036, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9671459197998047  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1783199310302734  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6036, 128])
m.shape torch.Size([5263, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1904993057250977  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1904993057250977  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5263, 128]), torch.Size([1, 5263, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1955184936523438  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4113435745239258  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5263, 128])
m.shape torch.Size([4664, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4244017601013184  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4244017601013184  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4664, 128]), torch.Size([1, 4664, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.428891658782959  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6596226692199707  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4664, 128])
m.shape torch.Size([4243, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6735844612121582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6735844612121582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4243, 128]), torch.Size([1, 4243, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6778225898742676  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.909285545349121  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4243, 128])
m.shape torch.Size([3804, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9235873222351074  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9235873222351074  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3804, 128]), torch.Size([1, 3804, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9275155067443848  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.160280227661133  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3804, 128])
m.shape torch.Size([44560, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.371356964111328  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.371356964111328  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44560, 128]), torch.Size([1, 44560, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.414325714111328  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.464160919189453  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44560, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.163577556610107  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.254497051239014  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.34541654586792  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.253786563873291  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95336, 256])
first layer input nodes number: 142904
first layer output nodes number: 95336
edges number: 675636
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.346636772155762  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.437556266784668  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.460455894470215  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.460455894470215  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3398, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.643965244293213  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.643965244293213  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3398, 256]), torch.Size([1, 3398, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.65044641494751  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.702295780181885  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3398, 256])
m.shape torch.Size([2937, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.705667972564697  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.705667972564697  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2937, 256]), torch.Size([1, 2937, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.7116379737854  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.796966552734375  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2937, 256])
m.shape torch.Size([2243, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.800785064697266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.800785064697266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2243, 256]), torch.Size([1, 2243, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.80522346496582  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.901843070983887  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2243, 256])
m.shape torch.Size([1832, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.906261920928955  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.906261920928955  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1832, 256]), torch.Size([1, 1832, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.9098124504089355  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.012742042541504  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1832, 256])
m.shape torch.Size([1545, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.018106937408447  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.018106937408447  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1545, 256]), torch.Size([1, 1545, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.021296977996826  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.131026744842529  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1545, 256])
m.shape torch.Size([1251, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.137087345123291  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.137087345123291  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1251, 256]), torch.Size([1, 1251, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.139553546905518  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.246761322021484  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1251, 256])
m.shape torch.Size([1004, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.252193927764893  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.252193927764893  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1004, 256]), torch.Size([1, 1004, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.254108905792236  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.351002216339111  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1004, 256])
m.shape torch.Size([838, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.356488227844238  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.356488227844238  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 838, 256]), torch.Size([1, 838, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.358086585998535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.4508562088012695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 838, 256])
m.shape torch.Size([742, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.456475734710693  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.456475734710693  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 742, 256]), torch.Size([1, 742, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.45789098739624  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.549184322357178  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 742, 256])
m.shape torch.Size([667, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.554887771606445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.554887771606445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.556159973144531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.64649772644043  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([547, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.651645183563232  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.651645183563232  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.652688503265381  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.73566198348999  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([486, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.740746021270752  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.740746021270752  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.741672992706299  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.820671558380127  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([448, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.8258056640625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.8258056640625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.82666015625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.907497406005859  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([372, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.912075996398926  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.912075996398926  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.912785530090332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.983258247375488  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([310, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.987372875213623  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.987372875213623  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.987964153289795  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.055556297302246  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([290, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.059720516204834  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.059720516204834  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.06027364730835  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.12445592880249  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([266, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.128525733947754  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.128525733947754  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.129033088684082  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.190997123718262  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([218, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.194515228271484  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.194515228271484  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.1949310302734375  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.247737884521484  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([201, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2512006759643555  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2512006759643555  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.251584053039551  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.302956581115723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([211, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.306820869445801  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.306820869445801  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.307223320007324  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.363968849182129  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([174, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.367280006408691  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.367280006408691  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.367611885070801  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.416729927062988  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([145, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.41963005065918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.41963005065918  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.4199066162109375  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.462774276733398  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([135, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.465620517730713  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.465620517730713  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.465878009796143  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.507591724395752  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([132, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.510508060455322  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.510508060455322  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.5107598304748535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.553308963775635  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([2344, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.610260486602783  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.610260486602783  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2344, 256]), torch.Size([1, 2344, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.614731311798096  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.401920795440674  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2344, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.241055965423584  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.244443893432617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.24783182144165  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.244274139404297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95336
output nodes number: 22736
edges number: 186013
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.24515438079834  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.245154857635498  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10063695907592773  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 2 input nodes size: 143205
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08280372619628906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08280372619628906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15116310119628906  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15133285522460938  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08944225311279297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08944225311279297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08944225311279297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143205, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08944225311279297  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6059, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42360734939575195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42360734939575195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6059, 128]), torch.Size([1, 6059, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4293856620788574  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4764227867126465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6059, 128])
m.shape torch.Size([7247, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48044490814208984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48044490814208984  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7247, 128]), torch.Size([1, 7247, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.48735618591308594  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5910253524780273  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7247, 128])
m.shape torch.Size([7113, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5977449417114258  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5977449417114258  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7113, 128]), torch.Size([1, 7113, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6045923233032227  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7547731399536133  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7113, 128])
m.shape torch.Size([6561, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7638955116271973  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7638955116271973  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6561, 128]), torch.Size([1, 6561, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7704157829284668  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9518704414367676  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6561, 128])
m.shape torch.Size([6055, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9631781578063965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9631781578063965  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6055, 128]), torch.Size([1, 6055, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9691762924194336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.179265022277832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6055, 128])
m.shape torch.Size([5200, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1912550926208496  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1912550926208496  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5200, 128]), torch.Size([1, 5200, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1965503692626953  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4104714393615723  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5200, 128])
m.shape torch.Size([4666, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4235663414001465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4235663414001465  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4666, 128]), torch.Size([1, 4666, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4282221794128418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6624541282653809  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4666, 128])
m.shape torch.Size([4289, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6765904426574707  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6765904426574707  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4289, 128]), torch.Size([1, 4289, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6809391975402832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9146728515625  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4289, 128])
m.shape torch.Size([3788, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9289889335632324  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9289889335632324  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3788, 128]), torch.Size([1, 3788, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9328598976135254  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.164534568786621  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3788, 128])
m.shape torch.Size([44600, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.3756189346313477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.3756189346313477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44600, 128]), torch.Size([1, 44600, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.4185876846313477  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.469368934631348  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44600, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.1686272621154785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.259777545928955  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.350927829742432  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.2590651512146  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95578, 256])
first layer input nodes number: 143205
first layer output nodes number: 95578
edges number: 676677
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.352054595947266  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.443204879760742  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.466642379760742  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.466642379760742  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3363, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.6488423347473145  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.6488423347473145  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3363, 256]), torch.Size([1, 3363, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.655256748199463  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.70657205581665  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3363, 256])
m.shape torch.Size([2922, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.708981990814209  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.708981990814209  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2922, 256]), torch.Size([1, 2922, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.714920520782471  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.7992448806762695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2922, 256])
m.shape torch.Size([2315, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.803212642669678  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.803212642669678  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2315, 256]), torch.Size([1, 2315, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.807732105255127  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.905837535858154  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2315, 256])
m.shape torch.Size([1849, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.910738468170166  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.910738468170166  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1849, 256]), torch.Size([1, 1849, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.914343357086182  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.017418384552002  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1849, 256])
m.shape torch.Size([1595, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.023209571838379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.023209571838379  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1595, 256]), torch.Size([1, 1595, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.026296615600586  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.1390581130981445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1595, 256])
m.shape torch.Size([1141, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.143189907073975  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.143189907073975  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1141, 256]), torch.Size([1, 1141, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.145439624786377  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.239641189575195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1141, 256])
m.shape torch.Size([1039, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.245473861694336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.245473861694336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1039, 256]), torch.Size([1, 1039, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.247617721557617  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.350666046142578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1039, 256])
m.shape torch.Size([857, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.355978012084961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.355978012084961  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.357612609863281  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.453051567077637  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([756, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.458774089813232  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.458774089813232  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 756, 256]), torch.Size([1, 756, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.460216045379639  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.553756237030029  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 756, 256])
m.shape torch.Size([656, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.559340476989746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.559340476989746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 656, 256]), torch.Size([1, 656, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.560591697692871  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.650361061096191  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 656, 256])
m.shape torch.Size([564, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.655698299407959  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.655698299407959  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.656774044036865  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.741898059844971  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([500, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.748027324676514  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.748027324676514  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.74898099899292  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.832377910614014  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([418, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.837123870849609  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.837123870849609  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.837921142578125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.912265777587891  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([377, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.916940212249756  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.916940212249756  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.917659282684326  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.991594314575195  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([349, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.9962663650512695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.9962663650512695  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.996932029724121  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.070340633392334  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([266, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.074098587036133  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.074098587036133  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.074605941772461  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.132452011108398  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([261, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.136463165283203  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.136463165283203  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.136960983276367  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.197949409484863  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([242, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.201887607574463  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.201887607574463  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2023491859436035  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.260969638824463  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([213, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.264628887176514  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.264628887176514  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.265035152435303  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.319474697113037  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([179, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.322899341583252  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.322899341583252  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.323240756988525  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.37138032913208  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([177, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.374782562255859  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.374782562255859  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.375120162963867  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.425085067749023  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([131, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.42768669128418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.42768669128418  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.427936553955078  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.466665267944336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([133, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.469480514526367  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.469480514526367  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.469734191894531  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.510829925537109  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([125, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.513586521148682  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.513586521148682  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.513824939727783  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.554117679595947  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([2308, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.610083103179932  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.610083103179932  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2308, 256]), torch.Size([1, 2308, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.614591121673584  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.390113353729248  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.232158660888672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.235546588897705  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.238934516906738  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.235376834869385  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([22736, 40])
input nodes number: 95578
output nodes number: 22736
edges number: 185047
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.23625898361206  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.236259460449219  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10075902938842773  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

pseudo mini batch 3 input nodes size: 143013
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.1512150764465332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.15138483047485352  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.0828557014465332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.0893092155456543  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.0893092155456543  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.0893092155456543  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([143013, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.0893092155456543  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([6082, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42505741119384766  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.42505741119384766  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6082, 128]), torch.Size([1, 6082, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.43085765838623047  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.47785091400146484  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6082, 128])
m.shape torch.Size([7198, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4818153381347656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4818153381347656  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7198, 128]), torch.Size([1, 7198, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.4886798858642578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5916481018066406  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7198, 128])
m.shape torch.Size([7048, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5982980728149414  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5982980728149414  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 7048, 128]), torch.Size([1, 7048, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.6050910949707031  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7550239562988281  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 7048, 128])
m.shape torch.Size([6503, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7640666961669922  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7640666961669922  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 6503, 128]), torch.Size([1, 6503, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7705283164978027  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9504995346069336  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 6503, 128])
m.shape torch.Size([5987, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9616727828979492  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9616727828979492  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5987, 128]), torch.Size([1, 5987, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.9679970741271973  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.177736759185791  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5987, 128])
m.shape torch.Size([5244, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.189885139465332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.189885139465332  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 5244, 128]), torch.Size([1, 5244, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.1948862075805664  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4101881980895996  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 5244, 128])
m.shape torch.Size([4665, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4232587814331055  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4232587814331055  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4665, 128]), torch.Size([1, 4665, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.4279465675354004  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6598701477050781  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4665, 128])
m.shape torch.Size([4313, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6740984916687012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.6740984916687012  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 4313, 128]), torch.Size([1, 4313, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.678246021270752  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9127154350280762  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 4313, 128])
m.shape torch.Size([3806, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.926992416381836  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.926992416381836  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3806, 128]), torch.Size([1, 3806, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 1.9307842254638672  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.165701389312744  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3806, 128])
m.shape torch.Size([44829, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.377647876739502  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.377647876739502  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 44829, 128]), torch.Size([1, 44829, 128])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 2.420616626739502  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.4709649085998535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 44829, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.168867111206055  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.260109901428223  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.351352691650391  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.259397029876709  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

torch.Size([95675, 256])
first layer input nodes number: 143013
first layer output nodes number: 95675
edges number: 678736
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.3524370193481445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.4436798095703125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.4671173095703125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.4671173095703125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

m.shape torch.Size([3292, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.651241302490234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.651241302490234  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 3292, 256]), torch.Size([1, 3292, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.658758640289307  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.708990573883057  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 3292, 256])
m.shape torch.Size([2935, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.71218729019165  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.71218729019165  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2935, 256]), torch.Size([1, 2935, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.718060493469238  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.802031517028809  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2935, 256])
m.shape torch.Size([2309, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.806257724761963  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.806257724761963  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2309, 256]), torch.Size([1, 2309, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.810684680938721  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.908623695373535  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 2309, 256])
m.shape torch.Size([1835, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.912868022918701  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.912868022918701  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1835, 256]), torch.Size([1, 1835, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 5.916598796844482  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.019123077392578  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1835, 256])
m.shape torch.Size([1551, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.024827003479004  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.024827003479004  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1551, 256]), torch.Size([1, 1551, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.027885437011719  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.137330055236816  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1551, 256])
m.shape torch.Size([1247, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.142739772796631  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.142739772796631  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1247, 256]), torch.Size([1, 1247, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.1452765464782715  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.252659320831299  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1247, 256])
m.shape torch.Size([1027, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.258186340332031  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.258186340332031  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 1027, 256]), torch.Size([1, 1027, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.260225772857666  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.358994007110596  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 1027, 256])
m.shape torch.Size([899, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.364846229553223  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.364846229553223  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.366560935974121  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.46645450592041  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([730, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.471911907196045  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.471911907196045  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.473304271697998  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.563744068145752  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([669, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.5694780349731445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.5694780349731445  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.570754051208496  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.661351203918457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([536, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.666380405426025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.666380405426025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.667402744293213  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.748363971710205  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([464, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.753204345703125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.753204345703125  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.75408935546875  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.830018997192383  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([393, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.834486961364746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.834486961364746  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.835236549377441  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.9054670333862305  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([324, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.909451961517334  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.909451961517334  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.910069942474365  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.97285795211792  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([319, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.977148056030273  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.977148056030273  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 6.977756500244141  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.042567253112793  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([276, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.046507358551025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.046507358551025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.047033786773682  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.108144760131836  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([246, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.11190128326416  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.11190128326416  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.112370491027832  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.168675422668457  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([233, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.17247200012207  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.17247200012207  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.172916412353516  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.22935676574707  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([208, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.232933044433594  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.232933044433594  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.233329772949219  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.286491394042969  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([218, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2909417152404785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.2909417152404785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.291357517242432  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.349985599517822  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([179, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.353390693664551  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.353390693664551  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.353732109069824  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.404261589050293  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([154, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.407347202301025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.407347202301025  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.4076409339904785  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.453169345855713  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([116, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.455586910247803  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.455586910247803  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.455808162689209  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.4916510581970215  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([131, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.49456262588501  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.49456262588501  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.494812488555908  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.537039279937744  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([2442, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.595591068267822  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.595591068267822  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

 h.shape torch.Size([1, 2442, 256]), torch.Size([1, 2442, 256])
----------------------------------------3
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 7.60024881362915  GigaBytes
Max Memory Allocated: 8.48563528060913  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.45094919204712  GigaBytes
Max Memory Allocated: 8.50917100906372  GigaBytes

rst.shape  torch.Size([1, 2442, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.290642261505127  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.29403018951416  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.297418117523193  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.29386043548584  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

torch.Size([22733, 40])
input nodes number: 95675
output nodes number: 22733
edges number: 187314
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.294743061065674  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 8.294743537902832  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10063505172729492  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10063505172729492  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.10063505172729492  GigaBytes
Max Memory Allocated: 8.51375675201416  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06274598836898804 |0.0039490461349487305 |0.15246933698654175 |9.930133819580078e-05 |0.09943675994873047 |0.004632711410522461 |
----------------------------------------------------------pseudo_mini_loss sum 3.0626440048217773
Total (block generation + training)time/epoch 5.212180733680725
Training time/epoch 1.348029613494873
Training time without block to device /epoch 1.3322334289550781
Training time without total dataloading part /epoch 1.0126543045043945
load block tensor time/epoch 0.25098395347595215
block to device time/epoch 0.015796184539794922
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  954806
Number of first layer input nodes during this epoch:  572343
Number of first layer output nodes during this epoch:  382463
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
