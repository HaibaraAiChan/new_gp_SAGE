main start at this time 1651552068.3935626
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02890777587890625
number of batches is  4
batch size is  22736
random selection method spend 0.006751298904418945
time for parepare:  0.0182497501373291
local_output_nid generation:  0.00833439826965332
local_in_edges_tensor generation:  0.008928060531616211
mini_batch_src_global generation:  0.005478382110595703
r_  generation:  0.06999874114990234
local_output_nid generation:  0.01107335090637207
local_in_edges_tensor generation:  0.005726337432861328
mini_batch_src_global generation:  0.007258892059326172
r_  generation:  0.0737147331237793
local_output_nid generation:  0.011640548706054688
local_in_edges_tensor generation:  0.0061261653900146484
mini_batch_src_global generation:  0.005303144454956055
r_  generation:  0.07766127586364746
local_output_nid generation:  0.011790990829467773
local_in_edges_tensor generation:  0.005661964416503906
mini_batch_src_global generation:  0.006124973297119141
r_  generation:  0.07867550849914551
----------------------check_connections_block total spend ----------------------------- 0.4853641986846924
generate_one_block  0.0912928581237793
generate_one_block  0.0912318229675293
generate_one_block  0.09597468376159668
generate_one_block  0.09294962882995605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025136709213256836
gen group dst list time:  0.010466575622558594
time for parepare:  0.018508434295654297
local_output_nid generation:  0.0181884765625
local_in_edges_tensor generation:  0.03715062141418457
mini_batch_src_global generation:  0.01999187469482422
r_  generation:  0.24062442779541016
local_output_nid generation:  0.023619890213012695
local_in_edges_tensor generation:  0.02706289291381836
mini_batch_src_global generation:  0.025022506713867188
r_  generation:  0.2489168643951416
local_output_nid generation:  0.02390599250793457
local_in_edges_tensor generation:  0.025505542755126953
mini_batch_src_global generation:  0.025590896606445312
r_  generation:  0.2533411979675293
local_output_nid generation:  0.02379631996154785
local_in_edges_tensor generation:  0.01968550682067871
mini_batch_src_global generation:  0.026846647262573242
r_  generation:  0.2522728443145752
----------------------check_connections_block total spend ----------------------------- 1.5542430877685547
generate_one_block  0.3075287342071533
generate_one_block  0.311981201171875
generate_one_block  0.32059574127197266
generate_one_block  0.30358052253723145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.5542430877685547
block generation total time  1.2436861991882324
average batch blocks generation time:  0.3109215497970581
pseudo mini batch 0 input nodes size: 142653
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.0711369514465332  GigaBytes
Max Memory Allocated: 0.0711369514465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07130670547485352  GigaBytes
Max Memory Allocated: 0.07130670547485352  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07130670547485352  GigaBytes
Max Memory Allocated: 0.07130670547485352  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07769060134887695  GigaBytes
Max Memory Allocated: 0.07769060134887695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07769060134887695  GigaBytes
Max Memory Allocated: 0.07769060134887695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07769060134887695  GigaBytes
Max Memory Allocated: 0.07769060134887695  GigaBytes

torch.Size([142653, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07769060134887695  GigaBytes
Max Memory Allocated: 0.07769060134887695  GigaBytes

m.shape torch.Size([6112, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.40966033935546875  GigaBytes
Max Memory Allocated: 0.416780948638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.40966033935546875  GigaBytes
Max Memory Allocated: 0.416780948638916  GigaBytes

 h.shape torch.Size([1, 6112, 128]), torch.Size([1, 6112, 128])
----------------------------------------3
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.416259765625  GigaBytes
Max Memory Allocated: 0.416780948638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4630126953125  GigaBytes
Max Memory Allocated: 0.4659271240234375  GigaBytes

rst.shape  torch.Size([1, 6112, 128])
m.shape torch.Size([7215, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4669790267944336  GigaBytes
Max Memory Allocated: 0.46714067459106445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4669790267944336  GigaBytes
Max Memory Allocated: 0.46714067459106445  GigaBytes

 h.shape torch.Size([1, 7215, 128]), torch.Size([1, 7215, 128])
----------------------------------------3
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.47432661056518555  GigaBytes
Max Memory Allocated: 0.47432661056518555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.577538013458252  GigaBytes
Max Memory Allocated: 0.584418773651123  GigaBytes

rst.shape  torch.Size([1, 7215, 128])
m.shape torch.Size([7070, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.5842113494873047  GigaBytes
Max Memory Allocated: 0.5844488143920898  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.5842113494873047  GigaBytes
Max Memory Allocated: 0.5844488143920898  GigaBytes

 h.shape torch.Size([1, 7070, 128]), torch.Size([1, 7070, 128])
----------------------------------------3
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.5909538269042969  GigaBytes
Max Memory Allocated: 0.5909538269042969  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7409219741821289  GigaBytes
Max Memory Allocated: 0.7510356903076172  GigaBytes

rst.shape  torch.Size([1, 7070, 128])
m.shape torch.Size([6522, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7503395080566406  GigaBytes
Max Memory Allocated: 0.7510356903076172  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7503395080566406  GigaBytes
Max Memory Allocated: 0.7510356903076172  GigaBytes

 h.shape torch.Size([1, 6522, 128]), torch.Size([1, 6522, 128])
----------------------------------------3
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7568206787109375  GigaBytes
Max Memory Allocated: 0.7568206787109375  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9401607513427734  GigaBytes
Max Memory Allocated: 0.9526004791259766  GigaBytes

rst.shape  torch.Size([1, 6522, 128])
m.shape torch.Size([5999, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9504818916320801  GigaBytes
Max Memory Allocated: 0.9526004791259766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9504818916320801  GigaBytes
Max Memory Allocated: 0.9526004791259766  GigaBytes

 h.shape torch.Size([1, 5999, 128]), torch.Size([1, 5999, 128])
----------------------------------------3
 Nvidia-smi: 2.1990966796875 GB
    Memory Allocated: 0.9562029838562012  GigaBytes
Max Memory Allocated: 0.9562029838562012  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.1654810905456543  GigaBytes
Max Memory Allocated: 1.179783821105957  GigaBytes

rst.shape  torch.Size([1, 5999, 128])
m.shape torch.Size([5255, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.1776552200317383  GigaBytes
Max Memory Allocated: 1.179783821105957  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.1776552200317383  GigaBytes
Max Memory Allocated: 1.179783821105957  GigaBytes

 h.shape torch.Size([1, 5255, 128]), torch.Size([1, 5255, 128])
----------------------------------------3
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.1831908226013184  GigaBytes
Max Memory Allocated: 1.1831908226013184  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.3986878395080566  GigaBytes
Max Memory Allocated: 1.4143128395080566  GigaBytes

rst.shape  torch.Size([1, 5255, 128])
m.shape torch.Size([4602, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.4118070602416992  GigaBytes
Max Memory Allocated: 1.4143128395080566  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.4118070602416992  GigaBytes
Max Memory Allocated: 1.4143128395080566  GigaBytes

 h.shape torch.Size([1, 4602, 128]), torch.Size([1, 4602, 128])
----------------------------------------3
 Nvidia-smi: 2.6951904296875 GB
    Memory Allocated: 1.4165430068969727  GigaBytes
Max Memory Allocated: 1.4165430068969727  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 1.6378703117370605  GigaBytes
Max Memory Allocated: 1.653231143951416  GigaBytes

rst.shape  torch.Size([1, 4602, 128])
m.shape torch.Size([4244, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 1.6518654823303223  GigaBytes
Max Memory Allocated: 1.653231143951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 1.6518654823303223  GigaBytes
Max Memory Allocated: 1.653231143951416  GigaBytes

 h.shape torch.Size([1, 4244, 128]), torch.Size([1, 4244, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 1.6560287475585938  GigaBytes
Max Memory Allocated: 1.6560287475585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 1.887972354888916  GigaBytes
Max Memory Allocated: 1.9041619300842285  GigaBytes

rst.shape  torch.Size([1, 4244, 128])
m.shape torch.Size([3798, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 1.9022479057312012  GigaBytes
Max Memory Allocated: 1.9041619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 1.9022479057312012  GigaBytes
Max Memory Allocated: 1.9041619300842285  GigaBytes

 h.shape torch.Size([1, 3798, 128]), torch.Size([1, 3798, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 1.9059748649597168  GigaBytes
Max Memory Allocated: 1.9059748649597168  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4725341796875 GB
    Memory Allocated: 2.1407079696655273  GigaBytes
Max Memory Allocated: 2.1570072174072266  GigaBytes

rst.shape  torch.Size([1, 3798, 128])
m.shape torch.Size([44242, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.34964656829834  GigaBytes
Max Memory Allocated: 2.3546385765075684  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6854248046875 GB
    Memory Allocated: 2.34964656829834  GigaBytes
Max Memory Allocated: 2.3546385765075684  GigaBytes

 h.shape torch.Size([1, 44242, 128]), torch.Size([1, 44242, 128])
----------------------------------------3
 Nvidia-smi: 3.7283935546875 GB
    Memory Allocated: 2.39261531829834  GigaBytes
Max Memory Allocated: 2.39261531829834  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9920654296875 GB
    Memory Allocated: 5.396819114685059  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

rst.shape  torch.Size([1, 44242, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9920654296875 GB
    Memory Allocated: 5.097999095916748  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9920654296875 GB
    Memory Allocated: 5.18865442276001  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9920654296875 GB
    Memory Allocated: 5.2793097496032715  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9920654296875 GB
    Memory Allocated: 5.18794584274292  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

torch.Size([95059, 256])
first layer input nodes number: 142653
first layer output nodes number: 95059
edges number: 672133
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9920654296875 GB
    Memory Allocated: 5.280458927154541  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9920654296875 GB
    Memory Allocated: 5.371114253997803  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0838623046875 GB
    Memory Allocated: 5.393778324127197  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0838623046875 GB
    Memory Allocated: 5.393778324127197  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

m.shape torch.Size([3412, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.575325965881348  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.575325965881348  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

 h.shape torch.Size([1, 3412, 256]), torch.Size([1, 3412, 256])
----------------------------------------3
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.582813739776611  GigaBytes
Max Memory Allocated: 5.607781410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.634876728057861  GigaBytes
Max Memory Allocated: 5.6381306648254395  GigaBytes

rst.shape  torch.Size([1, 3412, 256])
m.shape torch.Size([2940, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.637274265289307  GigaBytes
Max Memory Allocated: 5.6381306648254395  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.637274265289307  GigaBytes
Max Memory Allocated: 5.6381306648254395  GigaBytes

 h.shape torch.Size([1, 2940, 256]), torch.Size([1, 2940, 256])
----------------------------------------3
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.642995834350586  GigaBytes
Max Memory Allocated: 5.642995834350586  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.727817058563232  GigaBytes
Max Memory Allocated: 5.733424663543701  GigaBytes

rst.shape  torch.Size([1, 2940, 256])
m.shape torch.Size([2330, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.731674671173096  GigaBytes
Max Memory Allocated: 5.733424663543701  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.731674671173096  GigaBytes
Max Memory Allocated: 5.733424663543701  GigaBytes

 h.shape torch.Size([1, 2330, 256]), torch.Size([1, 2330, 256])
----------------------------------------3
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.7361531257629395  GigaBytes
Max Memory Allocated: 5.7361531257629395  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.836021423339844  GigaBytes
Max Memory Allocated: 5.842687606811523  GigaBytes

rst.shape  torch.Size([1, 2330, 256])
m.shape torch.Size([1819, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.840792655944824  GigaBytes
Max Memory Allocated: 5.842687606811523  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.840792655944824  GigaBytes
Max Memory Allocated: 5.842687606811523  GigaBytes

 h.shape torch.Size([1, 1819, 256]), torch.Size([1, 1819, 256])
----------------------------------------3
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 5.8443708419799805  GigaBytes
Max Memory Allocated: 5.8443708419799805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3026123046875 GB
    Memory Allocated: 5.946286201477051  GigaBytes
Max Memory Allocated: 5.953225135803223  GigaBytes

rst.shape  torch.Size([1, 1819, 256])
m.shape torch.Size([1501, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3026123046875 GB
    Memory Allocated: 5.951765060424805  GigaBytes
Max Memory Allocated: 5.953225135803223  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3026123046875 GB
    Memory Allocated: 5.951765060424805  GigaBytes
Max Memory Allocated: 5.953225135803223  GigaBytes

 h.shape torch.Size([1, 1501, 256]), torch.Size([1, 1501, 256])
----------------------------------------3
 Nvidia-smi: 7.3026123046875 GB
    Memory Allocated: 5.954870223999023  GigaBytes
Max Memory Allocated: 5.954870223999023  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 6.060387134552002  GigaBytes
Max Memory Allocated: 6.067544460296631  GigaBytes

rst.shape  torch.Size([1, 1501, 256])
m.shape torch.Size([1252, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 6.066054821014404  GigaBytes
Max Memory Allocated: 6.067544460296631  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 6.066054821014404  GigaBytes
Max Memory Allocated: 6.067544460296631  GigaBytes

 h.shape torch.Size([1, 1252, 256]), torch.Size([1, 1252, 256])
----------------------------------------3
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 6.068519115447998  GigaBytes
Max Memory Allocated: 6.068519115447998  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4783935546875 GB
    Memory Allocated: 6.175758361816406  GigaBytes
Max Memory Allocated: 6.18292236328125  GigaBytes

rst.shape  torch.Size([1, 1252, 256])
m.shape torch.Size([1015, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.4783935546875 GB
    Memory Allocated: 6.181269645690918  GigaBytes
Max Memory Allocated: 6.18292236328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4783935546875 GB
    Memory Allocated: 6.181269645690918  GigaBytes
Max Memory Allocated: 6.18292236328125  GigaBytes

 h.shape torch.Size([1, 1015, 256]), torch.Size([1, 1015, 256])
----------------------------------------3
 Nvidia-smi: 7.4783935546875 GB
    Memory Allocated: 6.183205604553223  GigaBytes
Max Memory Allocated: 6.183205604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 6.280518531799316  GigaBytes
Max Memory Allocated: 6.287294387817383  GigaBytes

rst.shape  torch.Size([1, 1015, 256])
m.shape torch.Size([901, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 6.286478519439697  GigaBytes
Max Memory Allocated: 6.287294387817383  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 6.286478519439697  GigaBytes
Max Memory Allocated: 6.287294387817383  GigaBytes

 h.shape torch.Size([1, 901, 256]), torch.Size([1, 901, 256])
----------------------------------------3
 Nvidia-smi: 7.5740966796875 GB
    Memory Allocated: 6.288197040557861  GigaBytes
Max Memory Allocated: 6.288197040557861  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.386152744293213  GigaBytes
Max Memory Allocated: 6.393026828765869  GigaBytes

rst.shape  torch.Size([1, 901, 256])
m.shape torch.Size([774, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.391988754272461  GigaBytes
Max Memory Allocated: 6.393026828765869  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.391988754272461  GigaBytes
Max Memory Allocated: 6.393026828765869  GigaBytes

 h.shape torch.Size([1, 774, 256]), torch.Size([1, 774, 256])
----------------------------------------3
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.393465042114258  GigaBytes
Max Memory Allocated: 6.393465042114258  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.488658905029297  GigaBytes
Max Memory Allocated: 6.495302200317383  GigaBytes

rst.shape  torch.Size([1, 774, 256])
m.shape torch.Size([664, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.494302749633789  GigaBytes
Max Memory Allocated: 6.495302200317383  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.494302749633789  GigaBytes
Max Memory Allocated: 6.495302200317383  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 6.495569229125977  GigaBytes
Max Memory Allocated: 6.495569229125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.585929870605469  GigaBytes
Max Memory Allocated: 6.592262268066406  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([543, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.591037750244141  GigaBytes
Max Memory Allocated: 6.592262268066406  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.591037750244141  GigaBytes
Max Memory Allocated: 6.592262268066406  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.592073440551758  GigaBytes
Max Memory Allocated: 6.592262268066406  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9744873046875 GB
    Memory Allocated: 6.676884651184082  GigaBytes
Max Memory Allocated: 6.682580947875977  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([471, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9744873046875 GB
    Memory Allocated: 6.681799411773682  GigaBytes
Max Memory Allocated: 6.682580947875977  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9744873046875 GB
    Memory Allocated: 6.681799411773682  GigaBytes
Max Memory Allocated: 6.682580947875977  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 7.9744873046875 GB
    Memory Allocated: 6.682697772979736  GigaBytes
Max Memory Allocated: 6.682697772979736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 6.7596116065979  GigaBytes
Max Memory Allocated: 6.7650017738342285  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([370, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 6.7637858390808105  GigaBytes
Max Memory Allocated: 6.7650017738342285  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 6.7637858390808105  GigaBytes
Max Memory Allocated: 6.7650017738342285  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 6.764491558074951  GigaBytes
Max Memory Allocated: 6.7650017738342285  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0682373046875 GB
    Memory Allocated: 6.8367462158203125  GigaBytes
Max Memory Allocated: 6.841333389282227  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([343, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0682373046875 GB
    Memory Allocated: 6.841009140014648  GigaBytes
Max Memory Allocated: 6.841333389282227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0682373046875 GB
    Memory Allocated: 6.841009140014648  GigaBytes
Max Memory Allocated: 6.841333389282227  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 8.0682373046875 GB
    Memory Allocated: 6.841663360595703  GigaBytes
Max Memory Allocated: 6.841663360595703  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1190185546875 GB
    Memory Allocated: 6.907131195068359  GigaBytes
Max Memory Allocated: 6.911710739135742  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([341, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.1190185546875 GB
    Memory Allocated: 6.911720275878906  GigaBytes
Max Memory Allocated: 6.911739349365234  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1190185546875 GB
    Memory Allocated: 6.911720275878906  GigaBytes
Max Memory Allocated: 6.911739349365234  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 8.1209716796875 GB
    Memory Allocated: 6.912370681762695  GigaBytes
Max Memory Allocated: 6.912370681762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1893310546875 GB
    Memory Allocated: 6.981650352478027  GigaBytes
Max Memory Allocated: 6.986528396606445  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([279, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.1893310546875 GB
    Memory Allocated: 6.9856157302856445  GigaBytes
Max Memory Allocated: 6.986528396606445  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1893310546875 GB
    Memory Allocated: 6.9856157302856445  GigaBytes
Max Memory Allocated: 6.986528396606445  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 8.1893310546875 GB
    Memory Allocated: 6.986147880554199  GigaBytes
Max Memory Allocated: 6.986528396606445  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2557373046875 GB
    Memory Allocated: 7.047467231750488  GigaBytes
Max Memory Allocated: 7.051724433898926  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([255, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.2557373046875 GB
    Memory Allocated: 7.05136775970459  GigaBytes
Max Memory Allocated: 7.051724433898926  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2557373046875 GB
    Memory Allocated: 7.05136775970459  GigaBytes
Max Memory Allocated: 7.051724433898926  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 8.2557373046875 GB
    Memory Allocated: 7.051854133605957  GigaBytes
Max Memory Allocated: 7.051854133605957  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3143310546875 GB
    Memory Allocated: 7.1102190017700195  GigaBytes
Max Memory Allocated: 7.114353179931641  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([224, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3143310546875 GB
    Memory Allocated: 7.113851070404053  GigaBytes
Max Memory Allocated: 7.114353179931641  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3143310546875 GB
    Memory Allocated: 7.113851070404053  GigaBytes
Max Memory Allocated: 7.114353179931641  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.3143310546875 GB
    Memory Allocated: 7.114278316497803  GigaBytes
Max Memory Allocated: 7.114353179931641  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 7.168538570404053  GigaBytes
Max Memory Allocated: 7.172640323638916  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([209, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 7.172456741333008  GigaBytes
Max Memory Allocated: 7.172640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 7.172456741333008  GigaBytes
Max Memory Allocated: 7.172640323638916  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 7.172855377197266  GigaBytes
Max Memory Allocated: 7.172855377197266  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4451904296875 GB
    Memory Allocated: 7.2262725830078125  GigaBytes
Max Memory Allocated: 7.230059623718262  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([202, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4451904296875 GB
    Memory Allocated: 7.22995662689209  GigaBytes
Max Memory Allocated: 7.230059623718262  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4451904296875 GB
    Memory Allocated: 7.22995662689209  GigaBytes
Max Memory Allocated: 7.230059623718262  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 8.4451904296875 GB
    Memory Allocated: 7.230341911315918  GigaBytes
Max Memory Allocated: 7.230341911315918  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5037841796875 GB
    Memory Allocated: 7.284667015075684  GigaBytes
Max Memory Allocated: 7.288519859313965  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([175, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5037841796875 GB
    Memory Allocated: 7.288006782531738  GigaBytes
Max Memory Allocated: 7.288519859313965  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5037841796875 GB
    Memory Allocated: 7.288006782531738  GigaBytes
Max Memory Allocated: 7.288519859313965  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 8.5037841796875 GB
    Memory Allocated: 7.2883405685424805  GigaBytes
Max Memory Allocated: 7.288519859313965  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5662841796875 GB
    Memory Allocated: 7.337740898132324  GigaBytes
Max Memory Allocated: 7.341245651245117  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([135, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5662841796875 GB
    Memory Allocated: 7.340428829193115  GigaBytes
Max Memory Allocated: 7.341245651245117  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5662841796875 GB
    Memory Allocated: 7.340428829193115  GigaBytes
Max Memory Allocated: 7.341245651245117  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.5662841796875 GB
    Memory Allocated: 7.340686321258545  GigaBytes
Max Memory Allocated: 7.341245651245117  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5936279296875 GB
    Memory Allocated: 7.3805975914001465  GigaBytes
Max Memory Allocated: 7.383430004119873  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([132, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5936279296875 GB
    Memory Allocated: 7.383387088775635  GigaBytes
Max Memory Allocated: 7.383430004119873  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5936279296875 GB
    Memory Allocated: 7.383387088775635  GigaBytes
Max Memory Allocated: 7.383430004119873  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.5936279296875 GB
    Memory Allocated: 7.383638858795166  GigaBytes
Max Memory Allocated: 7.383638858795166  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 7.4244256019592285  GigaBytes
Max Memory Allocated: 7.427320957183838  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([142, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 7.427575588226318  GigaBytes
Max Memory Allocated: 7.42758846282959  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 7.427575588226318  GigaBytes
Max Memory Allocated: 7.42758846282959  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 7.427846431732178  GigaBytes
Max Memory Allocated: 7.427846431732178  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7049560546875 GB
    Memory Allocated: 7.473618984222412  GigaBytes
Max Memory Allocated: 7.476869106292725  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([2307, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 7.528916835784912  GigaBytes
Max Memory Allocated: 7.529131889343262  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 7.528916835784912  GigaBytes
Max Memory Allocated: 7.529131889343262  GigaBytes

 h.shape torch.Size([1, 2307, 256]), torch.Size([1, 2307, 256])
----------------------------------------3
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 7.5333170890808105  GigaBytes
Max Memory Allocated: 7.5333170890808105  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6776123046875 GB
    Memory Allocated: 8.307761669158936  GigaBytes
Max Memory Allocated: 8.362764835357666  GigaBytes

rst.shape  torch.Size([1, 2307, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.7010498046875 GB
    Memory Allocated: 8.150049209594727  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.7010498046875 GB
    Memory Allocated: 8.154179573059082  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.7010498046875 GB
    Memory Allocated: 8.157567501068115  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.7010498046875 GB
    Memory Allocated: 8.15326738357544  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

torch.Size([22736, 40])
input nodes number: 95059
output nodes number: 22736
edges number: 184452
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7010498046875 GB
    Memory Allocated: 8.157533645629883  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.7010498046875 GB
    Memory Allocated: 8.1575345993042  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.09514141082763672  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

pseudo mini batch 1 input nodes size: 143468
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.14588165283203125  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.14605140686035156  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.07752227783203125  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.08399295806884766  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.08399295806884766  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.08399295806884766  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

torch.Size([143468, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 0.08399295806884766  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

m.shape torch.Size([6192, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.42061567306518555  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.42061567306518555  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 6192, 128]), torch.Size([1, 6192, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.42652082443237305  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.47376203536987305  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 6192, 128])
m.shape torch.Size([7249, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.4777226448059082  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.4777226448059082  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 7249, 128]), torch.Size([1, 7249, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.4846358299255371  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.5883336067199707  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 7249, 128])
m.shape torch.Size([7181, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.5951495170593262  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.5951495170593262  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 7181, 128]), torch.Size([1, 7181, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.6019978523254395  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.7539815902709961  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 7181, 128])
m.shape torch.Size([6591, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.7631287574768066  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.7631287574768066  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 6591, 128]), torch.Size([1, 6591, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.7694144248962402  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.9516987800598145  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 6591, 128])
m.shape torch.Size([6038, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.96295166015625  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.96295166015625  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 6038, 128]), torch.Size([1, 6038, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 0.9690470695495605  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.1797823905944824  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 6038, 128])
m.shape torch.Size([5255, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.1919379234313965  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.1919379234313965  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 5255, 128]), torch.Size([1, 5255, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.1974906921386719  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.413383960723877  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 5255, 128])
m.shape torch.Size([4720, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.4266328811645508  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.4266328811645508  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 4720, 128]), torch.Size([1, 4720, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.4311795234680176  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.664289951324463  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 4720, 128])
m.shape torch.Size([4318, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.6793198585510254  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.6793198585510254  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 4318, 128]), torch.Size([1, 4318, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.6836247444152832  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.918348789215088  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 4318, 128])
m.shape torch.Size([3774, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.9324860572814941  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.9324860572814941  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 3774, 128]), torch.Size([1, 3774, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 1.9362092018127441  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 2.167529582977295  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 3774, 128])
m.shape torch.Size([44970, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 2.3801636695861816  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 2.3801636695861816  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 44970, 128]), torch.Size([1, 44970, 128])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 2.4231324195861816  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.47374963760376  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 44970, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.171340465545654  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.263167858123779  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.354995250701904  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.262450218200684  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

torch.Size([96288, 256])
first layer input nodes number: 143468
first layer output nodes number: 96288
edges number: 681567
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.35609769821167  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.447925090789795  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.471362590789795  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.471362590789795  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

m.shape torch.Size([3428, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.655136585235596  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.655136585235596  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 3428, 256]), torch.Size([1, 3428, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.662017345428467  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.714324474334717  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 3428, 256])
m.shape torch.Size([2838, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.717121124267578  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.717121124267578  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 2838, 256]), torch.Size([1, 2838, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.722928047180176  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.804806232452393  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 2838, 256])
m.shape torch.Size([2295, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.808717250823975  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.808717250823975  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 2295, 256]), torch.Size([1, 2295, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.813395977020264  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.9117326736450195  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 2295, 256])
m.shape torch.Size([1828, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.916572093963623  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.916572093963623  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 1828, 256]), torch.Size([1, 1828, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.920169353485107  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.022655010223389  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 1828, 256])
m.shape torch.Size([1548, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.028072357177734  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.028072357177734  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 1548, 256]), torch.Size([1, 1548, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.031105041503906  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.138631820678711  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 1548, 256])
m.shape torch.Size([1211, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.1440534591674805  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.1440534591674805  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 1211, 256]), torch.Size([1, 1211, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.146751403808594  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.25792121887207  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 1211, 256])
m.shape torch.Size([1029, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.262767314910889  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.262767314910889  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 1029, 256]), torch.Size([1, 1029, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.26475191116333  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.364420413970947  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 1029, 256])
m.shape torch.Size([839, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.3697710037231445  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.3697710037231445  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 839, 256]), torch.Size([1, 839, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.371371269226074  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.466362953186035  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 839, 256])
m.shape torch.Size([718, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.471773624420166  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.471773624420166  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.473143100738525  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.562719821929932  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([666, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.568436622619629  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.568436622619629  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.569706916809082  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.660374641418457  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([604, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.666125297546387  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.666125297546387  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.6672773361206055  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.757973670959473  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([487, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.763014793395996  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.763014793395996  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.763943672180176  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.845978736877441  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([429, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.850874900817871  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.850874900817871  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.851693153381348  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.927304267883301  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([345, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.931537628173828  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.931537628173828  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.932195663452148  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.999013900756836  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([322, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.003327369689941  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.003327369689941  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.003941535949707  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.069043159484863  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([279, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.073026657104492  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.073026657104492  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.073558807373047  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.13533353805542  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([265, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.139397621154785  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.139397621154785  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.1399030685424805  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.202127456665039  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([236, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.205957889556885  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.205957889556885  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.2064080238342285  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.263575077056885  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([207, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.267130374908447  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.267130374908447  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.2675251960754395  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.320431232452393  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([185, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.323790073394775  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.323790073394775  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.324142932891846  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.37389612197876  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([174, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.377232074737549  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.377232074737549  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.377563953399658  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.426681995391846  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([157, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.429835796356201  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.429835796356201  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.430135250091553  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.476550579071045  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([121, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.479115962982178  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.479115962982178  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.479346752166748  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.516734600067139  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([126, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.51952600479126  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.51952600479126  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.519766330718994  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.5603814125061035  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([2399, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.617905139923096  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.617905139923096  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

 h.shape torch.Size([1, 2399, 256]), torch.Size([1, 2399, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.622480869293213  GigaBytes
Max Memory Allocated: 8.370705604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 8.43001413345337  GigaBytes
Max Memory Allocated: 8.487210750579834  GigaBytes

rst.shape  torch.Size([1, 2399, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 8.270159244537354  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 8.273547172546387  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 8.27693510055542  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 8.273377418518066  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

torch.Size([22736, 40])
input nodes number: 96288
output nodes number: 22736
edges number: 186809
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 8.274264812469482  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 8.27426528930664  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.09536457061767578  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

pseudo mini batch 2 input nodes size: 143187
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.07752227783203125  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.07752227783203125  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.14588165283203125  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.14605140686035156  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.08394432067871094  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.08394432067871094  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.08394432067871094  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

torch.Size([143187, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.08394432067871094  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

m.shape torch.Size([5967, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.42064332962036133  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.42064332962036133  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 5967, 128]), torch.Size([1, 5967, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.4263339042663574  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.47354650497436523  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 5967, 128])
m.shape torch.Size([7266, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.477630615234375  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.477630615234375  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 7266, 128]), torch.Size([1, 7266, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.4845600128173828  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.5885009765625  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 7266, 128])
m.shape torch.Size([7029, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.5950913429260254  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.5950913429260254  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 7029, 128]), torch.Size([1, 7029, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.6019077301025391  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.7517681121826172  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 7029, 128])
m.shape torch.Size([6533, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.7608771324157715  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.7608771324157715  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 6533, 128]), torch.Size([1, 6533, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.7673439979553223  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.94891357421875  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 6533, 128])
m.shape torch.Size([6133, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.9604206085205078  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.9604206085205078  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 6133, 128]), torch.Size([1, 6133, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 0.9664602279663086  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.1773138046264648  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 6133, 128])
m.shape torch.Size([5230, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.1893525123596191  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.1893525123596191  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 5230, 128]), torch.Size([1, 5230, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.1943402290344238  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.4091639518737793  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 5230, 128])
m.shape torch.Size([4778, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.4226183891296387  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.4226183891296387  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 4778, 128]), torch.Size([1, 4778, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.4273648262023926  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.6617565155029297  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 4778, 128])
m.shape torch.Size([4330, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.6759958267211914  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.6759958267211914  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 4330, 128]), torch.Size([1, 4330, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.6801443099975586  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.928985595703125  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 4330, 128])
m.shape torch.Size([3924, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.9428119659423828  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.9428119659423828  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 3924, 128]), torch.Size([1, 3924, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 1.9467811584472656  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 2.193981170654297  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 3924, 128])
m.shape torch.Size([44880, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 2.4061336517333984  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 2.4061336517333984  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 44880, 128]), torch.Size([1, 44880, 128])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 2.4491024017333984  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.499883651733398  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 44880, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.195145130157471  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.286942005157471  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.378561496734619  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.286048412322998  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

torch.Size([96070, 256])
first layer input nodes number: 143187
first layer output nodes number: 96070
edges number: 681965
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.379774570465088  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.471394062042236  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.494831562042236  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.494831562042236  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

m.shape torch.Size([3253, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.678454399108887  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.678454399108887  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 3253, 256]), torch.Size([1, 3253, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.6858744621276855  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.735511302947998  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 3253, 256])
m.shape torch.Size([2928, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.738037586212158  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.738037586212158  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 2928, 256]), torch.Size([1, 2928, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.7437543869018555  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.829192638397217  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 2928, 256])
m.shape torch.Size([2284, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.833573818206787  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.833573818206787  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 2284, 256]), torch.Size([1, 2284, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.838290691375732  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.935258388519287  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 2284, 256])
m.shape torch.Size([1876, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.940292835235596  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.940292835235596  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 1876, 256]), torch.Size([1, 1876, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 5.9439473152160645  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.049699306488037  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 1876, 256])
m.shape torch.Size([1621, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.055700302124023  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.055700302124023  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 1621, 256]), torch.Size([1, 1621, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.058807373046875  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.172307014465332  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 1621, 256])
m.shape torch.Size([1207, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.177497863769531  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.177497863769531  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 1207, 256]), torch.Size([1, 1207, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.179908752441406  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.282123565673828  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 1207, 256])
m.shape torch.Size([980, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.287412643432617  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.287412643432617  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 980, 256]), torch.Size([1, 980, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.289281845092773  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.385259628295898  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 980, 256])
m.shape torch.Size([901, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.3912529945373535  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.3912529945373535  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 901, 256]), torch.Size([1, 901, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.392971515655518  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.490927219390869  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 901, 256])
m.shape torch.Size([766, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.496694087982178  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.496694087982178  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 766, 256]), torch.Size([1, 766, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.498155117034912  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.5921549797058105  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 766, 256])
m.shape torch.Size([628, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.597460746765137  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.597460746765137  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.598658561706543  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.685267448425293  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([548, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.690462589263916  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.690462589263916  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.691507816314697  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.775801181793213  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([493, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.7809648513793945  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.7809648513793945  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.781905174255371  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.865288734436035  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([443, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.870353698730469  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.870353698730469  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.871198654174805  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.951242446899414  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([378, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.955906391143799  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.955906391143799  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 6.956627368927002  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.029867649078369  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([314, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.034034252166748  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.034034252166748  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.034633159637451  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.099878311157227  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([262, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.103608131408691  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.103608131408691  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.104107856750488  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.162552833557129  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([256, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.166485786437988  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.166485786437988  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.166974067687988  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.225567817687988  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([229, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.229285717010498  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.229285717010498  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.229722499847412  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.285193920135498  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([210, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.288810729980469  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.288810729980469  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.289211273193359  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.342884063720703  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([212, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.34675931930542  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.34675931930542  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.347163677215576  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.404178142547607  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([179, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.407650947570801  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.407650947570801  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.407992362976074  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.458521842956543  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([136, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.461226940155029  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.461226940155029  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.461486339569092  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.501693248748779  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([131, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.504459857940674  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.504459857940674  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.504709720611572  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.545187473297119  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([131, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.548084735870361  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.548084735870361  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.6053466796875 GB
    Memory Allocated: 7.54833459854126  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 7.590561389923096  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([2370, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 7.647518634796143  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 7.647518634796143  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

 h.shape torch.Size([1, 2370, 256]), torch.Size([1, 2370, 256])
----------------------------------------3
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 7.652039051055908  GigaBytes
Max Memory Allocated: 8.492871761322021  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 8.448915004730225  GigaBytes
Max Memory Allocated: 8.505420207977295  GigaBytes

rst.shape  torch.Size([1, 2370, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 8.289361000061035  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 8.292748928070068  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 8.296136856079102  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 8.292579174041748  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([22736, 40])
input nodes number: 96070
output nodes number: 22736
edges number: 186813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 8.29346513748169  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6131591796875 GB
    Memory Allocated: 8.293465614318848  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.09542465209960938  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

pseudo mini batch 3 input nodes size: 143140
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.14572525024414062  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.14589500427246094  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.07736587524414062  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08405542373657227  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08405542373657227  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08405542373657227  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([143140, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08405542373657227  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([6044, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.41779279708862305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.41779279708862305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6044, 128]), torch.Size([1, 6044, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.4235568046569824  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.47080087661743164  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6044, 128])
m.shape torch.Size([7329, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.47490835189819336  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.47490835189819336  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7329, 128]), torch.Size([1, 7329, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.48189783096313477  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5867400169372559  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7329, 128])
m.shape torch.Size([7123, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5934348106384277  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5934348106384277  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7123, 128]), torch.Size([1, 7123, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.6003260612487793  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7505450248718262  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7123, 128])
m.shape torch.Size([6535, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.759613037109375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.759613037109375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6535, 128]), torch.Size([1, 6535, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7661256790161133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9477400779724121  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6535, 128])
m.shape torch.Size([5964, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9588432312011719  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9588432312011719  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5964, 128]), torch.Size([1, 5964, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9650321006774902  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1745963096618652  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5964, 128])
m.shape torch.Size([5229, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1867127418518066  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1867127418518066  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5229, 128]), torch.Size([1, 5229, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.191699504852295  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4078068733215332  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5229, 128])
m.shape torch.Size([4752, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4211750030517578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4211750030517578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4752, 128]), torch.Size([1, 4752, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4258146286010742  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6603655815124512  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4752, 128])
m.shape torch.Size([4230, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6742358207702637  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6742358207702637  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4230, 128]), torch.Size([1, 4230, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6783909797668457  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.9083313941955566  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4230, 128])
m.shape torch.Size([3795, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.9226007461547852  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.9226007461547852  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3795, 128]), torch.Size([1, 3795, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.926595687866211  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.1586222648620605  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3795, 128])
m.shape torch.Size([44380, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.3684329986572266  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.3684329986572266  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 44380, 128]), torch.Size([1, 44380, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.4114017486572266  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.423501968383789  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 44380, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.122290134429932  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.214087009429932  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.305049419403076  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.212541580200195  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([95381, 256])
first layer input nodes number: 143140
first layer output nodes number: 95381
edges number: 674464
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.306180477142334  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.3971428871154785  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.420021057128906  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.420021057128906  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([3335, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.603343963623047  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.603343963623047  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3335, 256]), torch.Size([1, 3335, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.610475063323975  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.661363124847412  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3335, 256])
m.shape torch.Size([3000, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.663949489593506  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.663949489593506  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3000, 256]), torch.Size([1, 3000, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.669692516326904  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.755523204803467  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3000, 256])
m.shape torch.Size([2368, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.759524345397949  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.759524345397949  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2368, 256]), torch.Size([1, 2368, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.764155387878418  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.864358425140381  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2368, 256])
m.shape torch.Size([1797, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.869009017944336  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.869009017944336  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1797, 256]), torch.Size([1, 1797, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.872528553009033  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.974946022033691  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1797, 256])
m.shape torch.Size([1552, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.980690956115723  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.980690956115723  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1552, 256]), torch.Size([1, 1552, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.9837493896484375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.0931830406188965  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1552, 256])
m.shape torch.Size([1198, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.098321914672852  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.098321914672852  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1198, 256]), torch.Size([1, 1198, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.100736618041992  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.200116157531738  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1198, 256])
m.shape torch.Size([1021, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.2057342529296875  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.2057342529296875  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1021, 256]), torch.Size([1, 1021, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.207681655883789  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.30557918548584  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1021, 256])
m.shape torch.Size([831, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.310995101928711  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.310995101928711  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.312580108642578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.405752182006836  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 831, 256])
m.shape torch.Size([718, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.411170482635498  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.411170482635498  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.412539958953857  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.501262187957764  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([641, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.506738662719727  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.506738662719727  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.507961273193359  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.5950775146484375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([508, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.599837303161621  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.599837303161621  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.60080623626709  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.679827690124512  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([486, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.684948921203613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.684948921203613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.68587589263916  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.764904975891113  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([414, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.7696146965026855  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.7696146965026855  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.77040433883667  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.8445868492126465  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([368, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.849143981933594  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.849143981933594  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.849845886230469  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.92009162902832  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([312, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.924239158630371  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.924239158630371  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.924834251403809  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.992565631866455  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([291, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.996743202209473  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.996743202209473  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.997298240661621  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.063164710998535  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([254, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.067037582397461  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.067037582397461  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.067522048950195  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.12565803527832  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([259, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.129896640777588  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.129896640777588  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.130390644073486  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.195101261138916  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([210, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.1986894607543945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.1986894607543945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.199090003967285  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.252762794494629  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([208, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.256560802459717  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.256560802459717  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.256957530975342  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.312896251678467  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([189, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.3165130615234375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.3165130615234375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.316873550415039  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.37022590637207  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([128, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.372801780700684  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.372801780700684  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.373045921325684  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.410887718200684  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([135, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.413750171661377  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.413750171661377  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.414007663726807  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.455721378326416  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([126, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.458499431610107  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.458499431610107  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.458739757537842  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.499354839324951  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([2384, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.556518077850342  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.556518077850342  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2384, 256]), torch.Size([1, 2384, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.561065196990967  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.362813472747803  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2384, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.203830242156982  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.207218170166016  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.210606098175049  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.207048416137695  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([22733, 40])
input nodes number: 95381
output nodes number: 22733
edges number: 186176
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.207929134368896  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.207929611206055  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.09537363052368164  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.10092401504516602  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.10092401504516602  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06042367219924927 |0.08875530958175659 |0.2954198122024536 |0.00012618303298950195 |0.10324490070343018 |0.005651235580444336 |
----------------------------------------------------------pseudo_mini_loss sum 5.336187362670898
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  955246
Number of first layer input nodes during this epoch:  572448
Number of first layer output nodes during this epoch:  382798
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.10092353820800781  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016664981842041016
number of batches is  4
batch size is  22736
random selection method spend 0.005661725997924805
time for parepare:  0.021228790283203125
local_output_nid generation:  0.008263349533081055
local_in_edges_tensor generation:  0.00896596908569336
mini_batch_src_global generation:  0.005615234375
r_  generation:  0.07296180725097656
local_output_nid generation:  0.011304616928100586
local_in_edges_tensor generation:  0.005884408950805664
mini_batch_src_global generation:  0.007703304290771484
r_  generation:  0.07646656036376953
local_output_nid generation:  0.011548042297363281
local_in_edges_tensor generation:  0.005777835845947266
mini_batch_src_global generation:  0.005630970001220703
r_  generation:  0.08108782768249512
local_output_nid generation:  0.012279272079467773
local_in_edges_tensor generation:  0.00702214241027832
mini_batch_src_global generation:  0.0063898563385009766
r_  generation:  0.08874106407165527
----------------------check_connections_block total spend ----------------------------- 0.5161411762237549
generate_one_block  0.10093808174133301
generate_one_block  0.09950447082519531
generate_one_block  0.10459446907043457
generate_one_block  0.0972137451171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05036568641662598
gen group dst list time:  0.01110529899597168
time for parepare:  0.02041172981262207
local_output_nid generation:  0.01813340187072754
local_in_edges_tensor generation:  0.04252052307128906
mini_batch_src_global generation:  0.02081608772277832
r_  generation:  0.2354435920715332
local_output_nid generation:  0.023793697357177734
local_in_edges_tensor generation:  0.028827190399169922
mini_batch_src_global generation:  0.025043249130249023
r_  generation:  0.24944019317626953
local_output_nid generation:  0.023639678955078125
local_in_edges_tensor generation:  0.023545503616333008
mini_batch_src_global generation:  0.02603435516357422
r_  generation:  0.2526435852050781
local_output_nid generation:  0.023717880249023438
local_in_edges_tensor generation:  0.025220870971679688
mini_batch_src_global generation:  0.02671051025390625
r_  generation:  0.2570030689239502
----------------------check_connections_block total spend ----------------------------- 1.5606679916381836
generate_one_block  0.31087303161621094
generate_one_block  0.3150789737701416
generate_one_block  0.3311002254486084
generate_one_block  0.3254709243774414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.10092353820800781  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

connection checking time:  1.5606679916381836
block generation total time  1.2825231552124023
average batch blocks generation time:  0.3206307888031006
block dataloader generation time/epoch 3.9667937755584717
pseudo mini batch 0 input nodes size: 142823
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.0829153060913086  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.0829153060913086  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.1512746810913086  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.1514444351196289  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08302021026611328  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08941173553466797  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08941173553466797  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08941173553466797  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([142823, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08941173553466797  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([5975, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.4214210510253906  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.4214210510253906  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5975, 128]), torch.Size([1, 5975, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.42711925506591797  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.4743165969848633  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5975, 128])
m.shape torch.Size([7187, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.47832155227661133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.47832155227661133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7187, 128]), torch.Size([1, 7187, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.48517560958862305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5879864692687988  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7187, 128])
m.shape torch.Size([7029, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5946145057678223  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5946145057678223  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7029, 128]), torch.Size([1, 7029, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.6013932228088379  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.751253604888916  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7029, 128])
m.shape torch.Size([6564, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7604217529296875  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7604217529296875  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6564, 128]), torch.Size([1, 6564, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7669034004211426  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9491925239562988  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6564, 128])
m.shape torch.Size([6019, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9604129791259766  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9604129791259766  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6019, 128]), torch.Size([1, 6019, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9666481018066406  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1763935089111328  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6019, 128])
m.shape torch.Size([5173, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1883234977722168  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1883234977722168  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5173, 128]), torch.Size([1, 5173, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.193638801574707  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4066715240478516  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5173, 128])
m.shape torch.Size([4771, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4201297760009766  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4201297760009766  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4771, 128]), torch.Size([1, 4771, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4247512817382812  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6606707572937012  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4771, 128])
m.shape torch.Size([4219, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.674489974975586  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.674489974975586  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4219, 128]), torch.Size([1, 4219, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6787714958190918  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.9092512130737305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4219, 128])
m.shape torch.Size([3814, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.923607349395752  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.923607349395752  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3814, 128]), torch.Size([1, 3814, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.927441120147705  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.161444664001465  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3814, 128])
m.shape torch.Size([44206, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.3704166412353516  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.3704166412353516  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 44206, 128]), torch.Size([1, 44206, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.4133853912353516  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.415529251098633  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 44206, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.1154632568359375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.206021308898926  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.296579360961914  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.205313682556152  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([94957, 256])
first layer input nodes number: 142823
first layer output nodes number: 94957
edges number: 672360
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.297733306884766  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.388291358947754  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.411728858947754  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.411728858947754  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([3355, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.595162391662598  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.595162391662598  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3355, 256]), torch.Size([1, 3355, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.602375030517578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.654250144958496  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3355, 256])
m.shape torch.Size([2892, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.656610012054443  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.656610012054443  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2892, 256]), torch.Size([1, 2892, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.6626434326171875  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.746127128601074  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2892, 256])
m.shape torch.Size([2292, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.750153541564941  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.750153541564941  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2292, 256]), torch.Size([1, 2292, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.75460147857666  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.852388858795166  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2292, 256])
m.shape torch.Size([1826, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.856579780578613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.856579780578613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1826, 256]), torch.Size([1, 1826, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.86014461517334  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.963057518005371  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1826, 256])
m.shape torch.Size([1619, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.969096660614014  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.969096660614014  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1619, 256]), torch.Size([1, 1619, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.972306251525879  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.085095405578613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1619, 256])
m.shape torch.Size([1202, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.0904059410095215  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.0904059410095215  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.092710018157959  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.192269802093506  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([1037, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.197915554046631  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.197915554046631  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1037, 256]), torch.Size([1, 1037, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.19992208480835  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.3031744956970215  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1037, 256])
m.shape torch.Size([888, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.308577060699463  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.308577060699463  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 888, 256]), torch.Size([1, 888, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.3102707862854  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.4081902503967285  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 888, 256])
m.shape torch.Size([730, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.413658142089844  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.413658142089844  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.415050506591797  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.504594802856445  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([690, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.510530471801758  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.510530471801758  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 690, 256]), torch.Size([1, 690, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.511846542358398  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.605630874633789  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 690, 256])
m.shape torch.Size([554, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.610830307006836  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.610830307006836  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.611886978149414  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.697084426879883  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([485, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.702149868011475  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.702149868011475  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.703074932098389  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.782479763031006  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([402, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.7870402336120605  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.7870402336120605  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.787806987762451  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.861500263214111  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([371, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.866109371185303  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.866109371185303  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.866816997528076  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.937592029571533  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([311, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.9417219161987305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.9417219161987305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.942315101623535  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.006291389465332  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([281, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.010316371917725  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.010316371917725  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.010852336883545  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.072720050811768  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([252, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.076569557189941  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.076569557189941  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.07705020904541  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.13472843170166  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([253, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.1388654708862305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.1388654708862305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.139348030090332  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.2006330490112305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([217, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.204354763031006  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.204354763031006  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.204768657684326  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.260230541229248  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([197, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.263810634613037  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.263810634613037  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.264186382293701  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.317166805267334  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([173, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.320470809936523  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.320470809936523  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.32080078125  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.369636535644531  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([141, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.372908115386963  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.372908115386963  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.3731770515441895  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.414862155914307  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([132, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.4176459312438965  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.4176459312438965  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.417897701263428  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.45868444442749  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([134, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.4616498947143555  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.4616498947143555  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.461905479431152  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.505099296569824  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([2302, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.560284614562988  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.560284614562988  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2302, 256]), torch.Size([1, 2302, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.564675331115723  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.338365077972412  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.17897891998291  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.182366847991943  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.185754776000977  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.182197093963623  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([22736, 40])
input nodes number: 94957
output nodes number: 22736
edges number: 185392
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.183074474334717  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 8.183075428009033  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.10071563720703125  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

pseudo mini batch 1 input nodes size: 143235
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.1513209342956543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.1514906883239746  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.0829615592956543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08939313888549805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08939313888549805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08939313888549805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([143235, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.08939313888549805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([6069, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.4245600700378418  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.4245600700378418  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6069, 128]), torch.Size([1, 6069, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.43034791946411133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.47722291946411133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6069, 128])
m.shape torch.Size([7375, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.48136234283447266  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.48136234283447266  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7375, 128]), torch.Size([1, 7375, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.48839569091796875  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5938959121704102  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7375, 128])
m.shape torch.Size([7160, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.6006217002868652  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.6006217002868652  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7160, 128]), torch.Size([1, 7160, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.6075525283813477  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7579126358032227  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7160, 128])
m.shape torch.Size([6484, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7668657302856445  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7668657302856445  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6484, 128]), torch.Size([1, 6484, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.773371696472168  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9528627395629883  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6484, 128])
m.shape torch.Size([5992, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9640569686889648  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9640569686889648  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5992, 128]), torch.Size([1, 5992, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.9699511528015137  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1806674003601074  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5992, 128])
m.shape torch.Size([5283, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.192924976348877  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.192924976348877  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5283, 128]), torch.Size([1, 5283, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.1979632377624512  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.415360450744629  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5283, 128])
m.shape torch.Size([4711, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4285659790039062  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.4285659790039062  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4711, 128]), torch.Size([1, 4711, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.433225154876709  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6654620170593262  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4711, 128])
m.shape torch.Size([4282, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6795501708984375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6795501708984375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4282, 128]), torch.Size([1, 4282, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.6837882995605469  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.917020320892334  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4282, 128])
m.shape torch.Size([3822, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.9313807487487793  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.9313807487487793  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3822, 128]), torch.Size([1, 3822, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 1.9351754188537598  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.1686015129089355  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3822, 128])
m.shape torch.Size([44633, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.379669666290283  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.379669666290283  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 44633, 128]), torch.Size([1, 44633, 128])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 2.422638416290283  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.4726128578186035  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 44633, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.171597003936768  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.262969493865967  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.354341983795166  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.2622551918029785  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([95811, 256])
first layer input nodes number: 143235
first layer output nodes number: 95811
edges number: 677854
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.355498790740967  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.446871280670166  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.469934940338135  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.469934940338135  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([3373, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.6524434089660645  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.6524434089660645  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3373, 256]), torch.Size([1, 3373, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.660293102264404  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.711760997772217  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3373, 256])
m.shape torch.Size([2965, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.7142438888549805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.7142438888549805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2965, 256]), torch.Size([1, 2965, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.719995021820068  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.806019306182861  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2965, 256])
m.shape torch.Size([2365, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.81001091003418  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.81001091003418  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2365, 256]), torch.Size([1, 2365, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.814896583557129  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.914576530456543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2365, 256])
m.shape torch.Size([1841, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.919399261474609  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.919399261474609  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1841, 256]), torch.Size([1, 1841, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 5.923096656799316  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.028013229370117  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1841, 256])
m.shape torch.Size([1513, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.033528804779053  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.033528804779053  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1513, 256]), torch.Size([1, 1513, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.036459445953369  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.142338275909424  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1513, 256])
m.shape torch.Size([1266, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.148080825805664  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.148080825805664  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1266, 256]), torch.Size([1, 1266, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.1505446434021  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.258978366851807  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1266, 256])
m.shape torch.Size([987, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.264312267303467  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.264312267303467  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.266194820404053  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.3624396324157715  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 987, 256])
m.shape torch.Size([829, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.367872714996338  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.367872714996338  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 829, 256]), torch.Size([1, 829, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.3694539070129395  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.4618096351623535  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 829, 256])
m.shape torch.Size([727, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.467308044433594  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.467308044433594  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.468694686889648  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.557794570922852  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([634, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.56319522857666  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.56319522857666  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.564404487609863  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.651703834533691  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([564, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.65706205368042  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.65706205368042  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.658137798309326  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.742859363555908  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([466, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.747696399688721  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.747696399688721  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.748585224151611  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.824465274810791  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([393, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.8289313316345215  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.8289313316345215  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.829680919647217  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.900735378265381  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([364, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.905258655548096  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.905258655548096  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.9059529304504395  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.976028919219971  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([309, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.980136871337891  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.980136871337891  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 6.98072624206543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.045629024505615  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([310, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.0501017570495605  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.0501017570495605  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.050693035125732  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.119369029998779  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([256, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.123256206512451  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.123256206512451  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.123744487762451  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.182338237762451  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([227, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.186021327972412  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.186021327972412  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.1864542961120605  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.241441249847412  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([191, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.244712829589844  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.244712829589844  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.245077133178711  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.293893814086914  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([197, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.29749870300293  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.29749870300293  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.297874450683594  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.350854873657227  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([199, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.354683876037598  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.354683876037598  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.355063438415527  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.411238670349121  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([135, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.413903713226318  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.413903713226318  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.414161205291748  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.45407247543335  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([143, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.4571051597595215  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.4571051597595215  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.457377910614014  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.501563549041748  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([132, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.504472255706787  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.504472255706787  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 7.504724025726318  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 7.5472731590271  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([2350, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 7.6042256355285645  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 7.6042256355285645  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2350, 256]), torch.Size([1, 2350, 256])
----------------------------------------3
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 7.608707904815674  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 8.397849082946777  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2350, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 8.239912986755371  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 8.243300914764404  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 8.246688842773438  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 8.243131160736084  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([22736, 40])
input nodes number: 95811
output nodes number: 22736
edges number: 185306
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 8.244015216827393  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6248779296875 GB
    Memory Allocated: 8.24401569366455  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.10117864608764648  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

pseudo mini batch 2 input nodes size: 143004
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.0829615592956543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.0829615592956543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.1513209342956543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.1514906883239746  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08944416046142578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08944416046142578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08944416046142578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([143004, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08944416046142578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([6054, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4231986999511719  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4231986999511719  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6054, 128]), torch.Size([1, 6054, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4289722442626953  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.47601890563964844  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6054, 128])
m.shape torch.Size([7273, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4800682067871094  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4800682067871094  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7273, 128]), torch.Size([1, 7273, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.48700428009033203  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.5910453796386719  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7273, 128])
m.shape torch.Size([7066, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.5976853370666504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.5976853370666504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7066, 128]), torch.Size([1, 7066, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.604522705078125  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7545242309570312  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7066, 128])
m.shape torch.Size([6564, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7636747360229492  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7636747360229492  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6564, 128]), torch.Size([1, 6564, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7701740264892578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9524631500244141  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6564, 128])
m.shape torch.Size([6010, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9636621475219727  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9636621475219727  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6010, 128]), torch.Size([1, 6010, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9698972702026367  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1795568466186523  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6010, 128])
m.shape torch.Size([5269, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1917657852172852  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1917657852172852  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5269, 128]), torch.Size([1, 5269, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1971354484558105  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.413914680480957  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5269, 128])
m.shape torch.Size([4781, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.4273605346679688  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.4273605346679688  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4781, 128]), torch.Size([1, 4781, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.431994915008545  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.665393352508545  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4781, 128])
m.shape torch.Size([4242, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.679295539855957  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.679295539855957  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4242, 128]), torch.Size([1, 4242, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.6833410263061523  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.9144892692565918  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4242, 128])
m.shape torch.Size([3853, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.929001808166504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.929001808166504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3853, 128]), torch.Size([1, 3853, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.9328584671020508  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.1683473587036133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3853, 128])
m.shape torch.Size([44400, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.378225803375244  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.378225803375244  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 44400, 128]), torch.Size([1, 44400, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.421194553375244  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.434439182281494  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 44400, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.133210182189941  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.224297523498535  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.315384864807129  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.223585605621338  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([95512, 256])
first layer input nodes number: 143004
first layer output nodes number: 95512
edges number: 675798
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.3165388107299805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.407626152038574  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.431063652038574  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.431063652038574  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([3312, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.614544868469238  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.614544868469238  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3312, 256]), torch.Size([1, 3312, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.621584892272949  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.672122001647949  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3312, 256])
m.shape torch.Size([2895, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.6745285987854  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.6745285987854  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2895, 256]), torch.Size([1, 2895, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.6805830001831055  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.763463020324707  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2895, 256])
m.shape torch.Size([2300, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.767650604248047  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.767650604248047  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2300, 256]), torch.Size([1, 2300, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.772149562835693  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.8695478439331055  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2300, 256])
m.shape torch.Size([1837, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.874416828155518  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.874416828155518  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1837, 256]), torch.Size([1, 1837, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.877922534942627  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.980774402618408  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1837, 256])
m.shape torch.Size([1547, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.986225128173828  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.986225128173828  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1547, 256]), torch.Size([1, 1547, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 5.989185333251953  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.098283767700195  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1547, 256])
m.shape torch.Size([1192, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.103330612182617  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.103330612182617  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1192, 256]), torch.Size([1, 1192, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.105621337890625  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.208489418029785  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1192, 256])
m.shape torch.Size([1038, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.2143144607543945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.2143144607543945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1038, 256]), torch.Size([1, 1038, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.216648101806641  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.32054328918457  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1038, 256])
m.shape torch.Size([914, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.326320171356201  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.326320171356201  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 914, 256]), torch.Size([1, 914, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.328063488006592  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.4285197257995605  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 914, 256])
m.shape torch.Size([787, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.434455871582031  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.434455871582031  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.435956954956055  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.532026290893555  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 787, 256])
m.shape torch.Size([659, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.537609577178955  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.537609577178955  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 659, 256]), torch.Size([1, 659, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.5388665199279785  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.628109455108643  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 659, 256])
m.shape torch.Size([563, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.6334333419799805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.6334333419799805  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.634507179260254  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.719372749328613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([497, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.7245683670043945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.7245683670043945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.725516319274902  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.809318542480469  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([444, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.814392566680908  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.814392566680908  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.815239429473877  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.896975040435791  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([354, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.901315212249756  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.901315212249756  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.9019904136657715  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.970639228820801  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([326, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.975001811981201  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.975001811981201  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 6.975623607635498  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.044064044952393  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([266, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.047843933105469  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.047843933105469  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.048351287841797  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.10639762878418  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([260, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.1103925704956055  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.1103925704956055  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.110888481140137  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.172049522399902  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([246, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.176057815551758  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.176057815551758  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.17652702331543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.236116409301758  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([208, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.239680290222168  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.239680290222168  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.240077018737793  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.293238639831543  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([208, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.297038555145264  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.297038555145264  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.297435283660889  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.353374004364014  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([162, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.356445789337158  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.356445789337158  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.356754779815674  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.402485370635986  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([129, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.405058860778809  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.405058860778809  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.405304908752441  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.443442344665527  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([121, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.4459943771362305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.4459943771362305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.446225166320801  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.483613014221191  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([117, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.486196517944336  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.486196517944336  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.486419677734375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.524133682250977  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([2354, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.581101417541504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.581101417541504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2354, 256]), torch.Size([1, 2354, 256])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 7.585959434509277  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 8.376415729522705  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2354, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 8.21681022644043  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 8.220198154449463  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 8.223586082458496  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 8.220028400421143  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([22736, 40])
input nodes number: 95512
output nodes number: 22736
edges number: 186160
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 8.22091007232666  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 8.220910549163818  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.10079765319824219  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

pseudo mini batch 3 input nodes size: 143247
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.15132665634155273  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.15149641036987305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08296728134155273  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08945322036743164  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08945322036743164  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08945322036743164  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([143247, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.08945322036743164  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([6103, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4272165298461914  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4272165298461914  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6103, 128]), torch.Size([1, 6103, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.43303680419921875  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.47999000549316406  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6103, 128])
m.shape torch.Size([7264, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4840073585510254  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4840073585510254  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7264, 128]), torch.Size([1, 7264, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.4909348487854004  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.5948472023010254  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7264, 128])
m.shape torch.Size([7070, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.6014971733093262  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.6014971733093262  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 7070, 128]), torch.Size([1, 7070, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.6083321571350098  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7583489418029785  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 7070, 128])
m.shape torch.Size([6470, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7673182487487793  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7673182487487793  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6470, 128]), torch.Size([1, 6470, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.7737746238708496  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9529118537902832  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6470, 128])
m.shape torch.Size([6021, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9641819000244141  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9641819000244141  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 6021, 128]), torch.Size([1, 6021, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 0.9699239730834961  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1814827919006348  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 6021, 128])
m.shape torch.Size([5248, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1936264038085938  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1936264038085938  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 5248, 128]), torch.Size([1, 5248, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.1986312866210938  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.4140124320983887  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 5248, 128])
m.shape torch.Size([4719, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.4272613525390625  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.4272613525390625  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4719, 128]), torch.Size([1, 4719, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.4318714141845703  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.6643791198730469  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4719, 128])
m.shape torch.Size([4264, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.6783947944641113  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.6783947944641113  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 4264, 128]), torch.Size([1, 4264, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.6826996803283691  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.9144883155822754  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 4264, 128])
m.shape torch.Size([3794, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.9287371635437012  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.9287371635437012  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3794, 128]), torch.Size([1, 3794, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 1.9325942993164062  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.1650962829589844  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3794, 128])
m.shape torch.Size([45244, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.3790273666381836  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.3790273666381836  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 45244, 128]), torch.Size([1, 45244, 128])
----------------------------------------3
 Nvidia-smi: 10.6268310546875 GB
    Memory Allocated: 2.422175407409668  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.485686302185059  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 45244, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.181933879852295  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.273674488067627  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.365415096282959  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.2729573249816895  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

torch.Size([96197, 256])
first layer input nodes number: 143247
first layer output nodes number: 96197
edges number: 683045
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.366649150848389  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.458389759063721  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.481325149536133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3377685546875 GB
    Memory Allocated: 5.481325149536133  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

m.shape torch.Size([3388, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.666550636291504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.666550636291504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 3388, 256]), torch.Size([1, 3388, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.673651695251465  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.726485252380371  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 3388, 256])
m.shape torch.Size([2954, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.728932857513428  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.728932857513428  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2954, 256]), torch.Size([1, 2954, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.734792232513428  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.81957483291626  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2954, 256])
m.shape torch.Size([2320, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.824265480041504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.824265480041504  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2320, 256]), torch.Size([1, 2320, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.828747749328613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.9278459548950195  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 2320, 256])
m.shape torch.Size([1816, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.932426452636719  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.932426452636719  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1816, 256]), torch.Size([1, 1816, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 5.93591833114624  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.036984920501709  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1816, 256])
m.shape torch.Size([1543, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.042569160461426  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.042569160461426  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1543, 256]), torch.Size([1, 1543, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.045611381530762  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.15312385559082  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1543, 256])
m.shape torch.Size([1208, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.158495903015137  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.158495903015137  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.1609601974487305  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.264092445373535  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
m.shape torch.Size([983, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.269374847412109  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.269374847412109  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.271249771118164  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.36812686920166  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([841, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.373656272888184  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.373656272888184  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.375260353088379  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.467822074890137  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([732, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.473351955413818  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.473351955413818  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 732, 256]), torch.Size([1, 732, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.474748134613037  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.564378261566162  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 732, 256])
m.shape torch.Size([616, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.569601058959961  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.569601058959961  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.570775985717773  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.657812118530273  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([522, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.66274356842041  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.66274356842041  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.663739204406738  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.742247581481934  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([489, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.747389793395996  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.747389793395996  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.748322486877441  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.830117702484131  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([417, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.834861755371094  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.834861755371094  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.835657119750977  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.910656929016113  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([345, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.9149017333984375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.9149017333984375  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.915559768676758  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.982541084289551  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([343, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.987157344818115  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.987157344818115  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 6.98781156539917  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.057375431060791  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([254, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.060954570770264  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.060954570770264  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.061439037322998  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.116183757781982  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([262, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.1211628913879395  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.1211628913879395  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.121662616729736  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.1839680671691895  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([222, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.187559127807617  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.187559127807617  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.187982559204102  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.241758346557617  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([220, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.2455644607543945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.2455644607543945  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.245984077453613  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.302212715148926  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([205, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.305943965911865  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.305943965911865  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.306334972381592  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.361466884613037  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([183, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.364965438842773  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.364965438842773  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.365314483642578  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.416973114013672  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([151, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.419991493225098  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.419991493225098  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.420279502868652  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.464920997619629  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([123, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.467496395111084  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.467496395111084  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.46773099899292  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.505736827850342  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([142, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.508895397186279  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.508895397186279  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.509166240692139  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.554938793182373  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([2454, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.613768577575684  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.613768577575684  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

 h.shape torch.Size([1, 2454, 256]), torch.Size([1, 2454, 256])
----------------------------------------3
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 7.6184492111206055  GigaBytes
Max Memory Allocated: 8.511800765991211  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 8.473311424255371  GigaBytes
Max Memory Allocated: 8.531819343566895  GigaBytes

rst.shape  torch.Size([1, 2454, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 8.312119007110596  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 8.315506935119629  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 8.318894863128662  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 8.315337181091309  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([22733, 40])
input nodes number: 96197
output nodes number: 22733
edges number: 187392
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 8.316224098205566  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.5174560546875 GB
    Memory Allocated: 8.316224575042725  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10097360610961914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10097360610961914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10097360610961914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06842631101608276 |0.004445910453796387 |0.1513282060623169 |9.924173355102539e-05 |0.10223591327667236 |0.004597663879394531 |
----------------------------------------------------------pseudo_mini_loss sum 4.1264142990112305
Total (block generation + training)time/epoch 5.326472043991089
Training time/epoch 1.3594176769256592
Training time without block to device /epoch 1.3416340351104736
Training time without total dataloading part /epoch 1.0192511081695557
load block tensor time/epoch 0.27370524406433105
block to device time/epoch 0.017783641815185547
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  954786
Number of first layer input nodes during this epoch:  572309
Number of first layer output nodes during this epoch:  382477
----------------------------------------before generate dataloader block 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10097312927246094  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018398761749267578
number of batches is  4
batch size is  22736
random selection method spend 0.005877971649169922
time for parepare:  0.01897144317626953
local_output_nid generation:  0.008652687072753906
local_in_edges_tensor generation:  0.009503841400146484
mini_batch_src_global generation:  0.006162166595458984
r_  generation:  0.07077193260192871
local_output_nid generation:  0.014803886413574219
local_in_edges_tensor generation:  0.009423255920410156
mini_batch_src_global generation:  0.008466720581054688
r_  generation:  0.07661747932434082
local_output_nid generation:  0.013335466384887695
local_in_edges_tensor generation:  0.0063877105712890625
mini_batch_src_global generation:  0.005578517913818359
r_  generation:  0.08174610137939453
local_output_nid generation:  0.013413190841674805
local_in_edges_tensor generation:  0.006415367126464844
mini_batch_src_global generation:  0.0063359737396240234
r_  generation:  0.0805661678314209
----------------------check_connections_block total spend ----------------------------- 0.5145058631896973
generate_one_block  0.09685659408569336
generate_one_block  0.09941434860229492
generate_one_block  0.10339927673339844
generate_one_block  0.09981107711791992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030124187469482422
gen group dst list time:  0.016382455825805664
time for parepare:  0.02085566520690918
local_output_nid generation:  0.01963949203491211
local_in_edges_tensor generation:  0.04814291000366211
mini_batch_src_global generation:  0.023964643478393555
r_  generation:  0.24412155151367188
local_output_nid generation:  0.02486896514892578
local_in_edges_tensor generation:  0.028414011001586914
mini_batch_src_global generation:  0.03150510787963867
r_  generation:  0.2545151710510254
local_output_nid generation:  0.02472686767578125
local_in_edges_tensor generation:  0.0257723331451416
mini_batch_src_global generation:  0.02644205093383789
r_  generation:  0.2600538730621338
local_output_nid generation:  0.02426290512084961
local_in_edges_tensor generation:  0.025660991668701172
mini_batch_src_global generation:  0.026758193969726562
r_  generation:  0.2649648189544678
----------------------check_connections_block total spend ----------------------------- 1.61637282371521
generate_one_block  0.3338627815246582
generate_one_block  0.31341028213500977
generate_one_block  0.32735323905944824
generate_one_block  0.31994128227233887
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10097312927246094  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

connection checking time:  1.61637282371521
block generation total time  1.294567584991455
average batch blocks generation time:  0.32364189624786377
block dataloader generation time/epoch 3.9778517484664917
pseudo mini batch 0 input nodes size: 142974
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08296632766723633  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08296632766723633  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15132570266723633  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15149545669555664  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08302021026611328  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08943748474121094  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08943748474121094  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08943748474121094  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([142974, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08943748474121094  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([6069, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4234156608581543  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4234156608581543  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6069, 128]), torch.Size([1, 6069, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.42920351028442383  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.47607851028442383  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6069, 128])
m.shape torch.Size([7204, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4800548553466797  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4800548553466797  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 7204, 128]), torch.Size([1, 7204, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4869251251220703  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5899791717529297  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 7204, 128])
m.shape torch.Size([6992, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5965461730957031  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5965461730957031  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6992, 128]), torch.Size([1, 6992, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.6033153533935547  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7530345916748047  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6992, 128])
m.shape torch.Size([6627, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7623405456542969  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7623405456542969  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6627, 128]), torch.Size([1, 6627, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7688345909118652  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9521145820617676  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6627, 128])
m.shape torch.Size([6053, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.963386058807373  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.963386058807373  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6053, 128]), torch.Size([1, 6053, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9694080352783203  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1803226470947266  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6053, 128])
m.shape torch.Size([5181, 6, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1922593116760254  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1922593116760254  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5181, 128]), torch.Size([1, 5181, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1975159645080566  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4107117652893066  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5181, 128])
m.shape torch.Size([4630, 7, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4236955642700195  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4236955642700195  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4630, 128]), torch.Size([1, 4630, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4281225204467773  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6612062454223633  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4630, 128])
m.shape torch.Size([4267, 8, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6752758026123047  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6752758026123047  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4267, 128]), torch.Size([1, 4267, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6795501708984375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9115018844604492  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4267, 128])
m.shape torch.Size([3785, 9, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.925710678100586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.925710678100586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3785, 128]), torch.Size([1, 3785, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9294490814208984  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.1614718437194824  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3785, 128])
m.shape torch.Size([44637, 10, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.3725576400756836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.3725576400756836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 44637, 128]), torch.Size([1, 44637, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.4155263900756836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.465508460998535  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 44637, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.165069580078125  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.256866455078125  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.3478899002075195  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.2553815841674805  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([95445, 256])
first layer input nodes number: 142974
first layer output nodes number: 95445
edges number: 676293
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.349062442779541  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.4400858879089355  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.4635233879089355  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.4635233879089355  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([3400, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.645440578460693  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.645440578460693  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3400, 256]), torch.Size([1, 3400, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.65211820602417  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.70399808883667  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3400, 256])
m.shape torch.Size([2893, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.7071452140808105  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.7071452140808105  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2893, 256]), torch.Size([1, 2893, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.712925434112549  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.795787811279297  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2893, 256])
m.shape torch.Size([2324, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.799729824066162  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.799729824066162  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2324, 256]), torch.Size([1, 2324, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.804397106170654  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.903717994689941  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2324, 256])
m.shape torch.Size([1820, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.907838821411133  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.907838821411133  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1820, 256]), torch.Size([1, 1820, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.911395072937012  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.01350736618042  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1820, 256])
m.shape torch.Size([1600, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.019161701202393  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.019161701202393  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1600, 256]), torch.Size([1, 1600, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.022266864776611  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.1347503662109375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1600, 256])
m.shape torch.Size([1236, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.140352249145508  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.140352249145508  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1236, 256]), torch.Size([1, 1236, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.142790794372559  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.249542236328125  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1236, 256])
m.shape torch.Size([1024, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.255210876464844  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.255210876464844  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1024, 256]), torch.Size([1, 1024, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.257164001464844  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.355796813964844  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1024, 256])
m.shape torch.Size([878, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.361571311950684  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.361571311950684  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.363245964050293  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.458701133728027  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 878, 256])
m.shape torch.Size([716, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.464057445526123  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.464057445526123  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.465423107147217  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.5548319816589355  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([664, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.560531139373779  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.560531139373779  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.561797618865967  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.651916027069092  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([523, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.6568121910095215  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.6568121910095215  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.657809734344482  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.736083507537842  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([480, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.7411208152771  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.7411208152771  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.74203634262085  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.82025671005249  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([416, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.8249969482421875  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.8249969482421875  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.8257904052734375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.9011077880859375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([360, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.905555248260498  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.905555248260498  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.9062418937683105  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.976912975311279  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([344, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.981529235839844  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.981529235839844  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.982185363769531  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.0519866943359375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([277, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.0559186935424805  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.0559186935424805  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.0564470291137695  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.118360996246338  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([246, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.122116565704346  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.122116565704346  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.122585773468018  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.178890705108643  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([211, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.18230676651001  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.18230676651001  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.182709217071533  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.23382043838501  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([216, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.2375640869140625  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.2375640869140625  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.23797607421875  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.293182373046875  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([202, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.2968597412109375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.2968597412109375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.297245025634766  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.351570129394531  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([181, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.3550310134887695  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.3550310134887695  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.355376243591309  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.40647029876709  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([145, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.409363746643066  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.409363746643066  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.409640312194824  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.452507972717285  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([122, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.455253601074219  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.455253601074219  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.455486297607422  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.493183135986328  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([127, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.495996475219727  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.495996475219727  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.496238708496094  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.537176132202148  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([2331, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.593064785003662  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.593064785003662  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2331, 256]), torch.Size([1, 2331, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.597510814666748  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.380038738250732  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.222183227539062  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.225571155548096  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.228959083557129  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.225401401519775  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([22736, 40])
input nodes number: 95445
output nodes number: 22736
edges number: 184927
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.226282596588135  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.226283550262451  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10079336166381836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

pseudo mini batch 1 input nodes size: 142955
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15118741989135742  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15135717391967773  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08282804489135742  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08952617645263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08952617645263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08952617645263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([142955, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08952617645263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([5966, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.42322587966918945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.42322587966918945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5966, 128]), torch.Size([1, 5966, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.42891550064086914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.47579050064086914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5966, 128])
m.shape torch.Size([7260, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.47986936569213867  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.47986936569213867  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 7260, 128]), torch.Size([1, 7260, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.48679304122924805  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5906481742858887  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 7260, 128])
m.shape torch.Size([7186, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.597465991973877  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.597465991973877  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 7186, 128]), torch.Size([1, 7186, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.6043543815612793  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7560133934020996  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 7186, 128])
m.shape torch.Size([6462, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7649121284484863  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7649121284484863  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6462, 128]), torch.Size([1, 6462, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7711777687072754  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9498944282531738  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6462, 128])
m.shape torch.Size([5999, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.961115837097168  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.961115837097168  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5999, 128]), torch.Size([1, 5999, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9670577049255371  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1771655082702637  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5999, 128])
m.shape torch.Size([5263, 6, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1893625259399414  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1893625259399414  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5263, 128]), torch.Size([1, 5263, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1948018074035645  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4110488891601562  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5263, 128])
m.shape torch.Size([4717, 7, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4242839813232422  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4242839813232422  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4717, 128]), torch.Size([1, 4717, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4290504455566406  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6614694595336914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4717, 128])
m.shape torch.Size([4262, 8, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.675478458404541  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.675478458404541  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4262, 128]), torch.Size([1, 4262, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6797971725463867  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9120674133300781  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4262, 128])
m.shape torch.Size([3854, 9, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9275341033935547  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9275341033935547  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3854, 128]), torch.Size([1, 3854, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9314169883728027  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.167858600616455  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3854, 128])
m.shape torch.Size([44374, 10, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.377612590789795  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.377612590789795  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 44374, 128]), torch.Size([1, 44374, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.420581340789795  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.432338237762451  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 44374, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.1319427490234375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.2237396240234375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.314665794372559  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.222158432006836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([95343, 256])
first layer input nodes number: 142955
first layer output nodes number: 95343
edges number: 675006
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.315791606903076  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.406717777252197  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.429614067077637  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.429614067077637  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([3300, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.613049507141113  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.613049507141113  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3300, 256]), torch.Size([1, 3300, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.6205830574035645  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.6709370613098145  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3300, 256])
m.shape torch.Size([2906, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.673376083374023  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.673376083374023  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2906, 256]), torch.Size([1, 2906, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.679081439971924  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.762845039367676  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2906, 256])
m.shape torch.Size([2344, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.767068862915039  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.767068862915039  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2344, 256]), torch.Size([1, 2344, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.7715535163879395  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.870270252227783  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2344, 256])
m.shape torch.Size([1852, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.875154972076416  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.875154972076416  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1852, 256]), torch.Size([1, 1852, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.8787102699279785  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.982665538787842  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1852, 256])
m.shape torch.Size([1540, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.988300323486328  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.988300323486328  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1540, 256]), torch.Size([1, 1540, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.991374969482422  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.099327087402344  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1540, 256])
m.shape torch.Size([1232, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.104673385620117  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.104673385620117  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1232, 256]), torch.Size([1, 1232, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.107089519500732  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.21457052230835  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1232, 256])
m.shape torch.Size([1037, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.220248699188232  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.220248699188232  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1037, 256]), torch.Size([1, 1037, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.222296714782715  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.324592590332031  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1037, 256])
m.shape torch.Size([917, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.330342769622803  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.330342769622803  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 917, 256]), torch.Size([1, 917, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.332091808319092  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.432836055755615  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 917, 256])
m.shape torch.Size([786, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.438760757446289  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.438760757446289  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 786, 256]), torch.Size([1, 786, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.44025993347168  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.536501884460449  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 786, 256])
m.shape torch.Size([640, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.541903495788574  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.541903495788574  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 640, 256]), torch.Size([1, 640, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.543124198913574  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.630143165588379  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 640, 256])
m.shape torch.Size([507, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.634893417358398  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.634893417358398  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.635860443115234  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.712664604187012  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([495, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.71789026260376  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.71789026260376  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.718834400177002  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.800989627838135  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([428, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.805865287780762  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.805865287780762  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.8066816329956055  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.881911277770996  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([349, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.886199474334717  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.886199474334717  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.886865139007568  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.955079555511475  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([291, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.9596662521362305  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.9596662521362305  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.960221290588379  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.024813652038574  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([271, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.028703689575195  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.028703689575195  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.0292205810546875  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.089399337768555  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([259, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.093372821807861  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.093372821807861  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.09386682510376  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.155406475067139  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([251, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.159904479980469  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.159904479980469  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.160383224487305  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.221183776855469  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([202, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.22463321685791  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.22463321685791  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.225018501281738  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.276646614074707  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([206, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.28041410446167  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.28041410446167  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.280807018280029  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.336207866668701  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([188, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.339806079864502  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.339806079864502  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.340164661407471  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.393234729766846  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([138, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.3959736824035645  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.3959736824035645  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.396236896514893  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.437035083770752  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([119, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.4395341873168945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.4395341873168945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.439761161804199  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.476531028747559  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([118, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.479139804840088  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.479139804840088  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.47936487197876  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.517401218414307  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([2360, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.574368953704834  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.574368953704834  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2360, 256]), torch.Size([1, 2360, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.579290866851807  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.37245798110962  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2360, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.212537288665771  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.215925216674805  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.219313144683838  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.215755462646484  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([22736, 40])
input nodes number: 95343
output nodes number: 22736
edges number: 185813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.216635704040527  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.216636180877686  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10083532333374023  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

pseudo mini batch 2 input nodes size: 143690
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08282804489135742  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08282804489135742  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15134477615356445  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15151453018188477  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08317852020263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0906224250793457  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0906224250793457  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0906224250793457  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([143690, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0906224250793457  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([5997, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4283261299133301  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4283261299133301  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5997, 128]), torch.Size([1, 5997, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.43404531478881836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.48092031478881836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5997, 128])
m.shape torch.Size([7290, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4850130081176758  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4850130081176758  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 7290, 128]), torch.Size([1, 7290, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.49196529388427734  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5962495803833008  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 7290, 128])
m.shape torch.Size([7118, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.6029558181762695  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.6029558181762695  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 7118, 128]), torch.Size([1, 7118, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.6098260879516602  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7600259780883789  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 7118, 128])
m.shape torch.Size([6547, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7691192626953125  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7691192626953125  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6547, 128]), torch.Size([1, 6547, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7756533622741699  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9567365646362305  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6547, 128])
m.shape torch.Size([6075, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9680986404418945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9680986404418945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6075, 128]), torch.Size([1, 6075, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9738922119140625  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.185197353363037  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6075, 128])
m.shape torch.Size([5248, 6, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1973152160644531  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1973152160644531  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5248, 128]), torch.Size([1, 5248, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.2023959159851074  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4180850982666016  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5248, 128])
m.shape torch.Size([4708, 7, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4312973022460938  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4312973022460938  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4708, 128]), torch.Size([1, 4708, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4358954429626465  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6682581901550293  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4708, 128])
m.shape torch.Size([4335, 8, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6825499534606934  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6825499534606934  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4335, 128]), torch.Size([1, 4335, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6868510246276855  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9347319602966309  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4335, 128])
m.shape torch.Size([3835, 9, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.948195457458496  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.948195457458496  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3835, 128]), torch.Size([1, 3835, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9521331787109375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.1871933937072754  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3835, 128])
m.shape torch.Size([45013, 10, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.4002084732055664  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.4002084732055664  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 45013, 128]), torch.Size([1, 45013, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.4431772232055664  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.493958473205566  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 45013, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.190340995788574  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.282137870788574  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.373848915100098  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.281335353851318  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([96166, 256])
first layer input nodes number: 143690
first layer output nodes number: 96166
edges number: 682263
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.375035285949707  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.4667463302612305  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.4901838302612305  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.4901838302612305  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([3308, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.67563533782959  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.67563533782959  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3308, 256]), torch.Size([1, 3308, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.681944847106934  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.732420921325684  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3308, 256])
m.shape torch.Size([3002, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.735036849975586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.735036849975586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3002, 256]), torch.Size([1, 3002, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.741006851196289  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.82715368270874  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3002, 256])
m.shape torch.Size([2291, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.831254482269287  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.831254482269287  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2291, 256]), torch.Size([1, 2291, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.836616516113281  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.934002876281738  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2291, 256])
m.shape torch.Size([1828, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.938846111297607  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.938846111297607  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1828, 256]), torch.Size([1, 1828, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.94234037399292  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.045290946960449  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1828, 256])
m.shape torch.Size([1531, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.050596237182617  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.050596237182617  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1531, 256]), torch.Size([1, 1531, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.053668975830078  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.1615190505981445  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1531, 256])
m.shape torch.Size([1189, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.166655540466309  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.166655540466309  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1189, 256]), torch.Size([1, 1189, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.169024467468262  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.26832389831543  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1189, 256])
m.shape torch.Size([974, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.273632526397705  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.273632526397705  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 974, 256]), torch.Size([1, 974, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.2754902839660645  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.371239185333252  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 974, 256])
m.shape torch.Size([830, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.376692295074463  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.376692295074463  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.378275394439697  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.471191883087158  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([765, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.477017879486084  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.477017879486084  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.4784770011901855  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.5718607902526855  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([661, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.577484607696533  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.577484607696533  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.578745365142822  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.66887903213501  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([584, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.6744232177734375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.6744232177734375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.675537109375  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.762611389160156  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([463, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.768260478973389  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.768260478973389  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.769143581390381  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.8471293449401855  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([409, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.8517985343933105  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.8517985343933105  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.852578639984131  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.926578998565674  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([363, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.9310736656188965  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.9310736656188965  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.931766033172607  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.000935077667236  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([334, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.005404472351074  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.005404472351074  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.006041526794434  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.075074195861816  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([290, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.0792155265808105  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.0792155265808105  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.079768657684326  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.143662929534912  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([274, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.147863388061523  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.147863388061523  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.148386001586914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.213214874267578  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([225, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.216846466064453  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.216846466064453  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.217275619506836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.271778106689453  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([212, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.275434970855713  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.275434970855713  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.275839328765869  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.330023288726807  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([208, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.333819389343262  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.333819389343262  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.334216117858887  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.390154838562012  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([179, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.393569469451904  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.393569469451904  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.393910884857178  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.4444403648376465  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([138, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.447187900543213  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.447187900543213  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.447451114654541  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.4882493019104  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([137, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.491146564483643  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.491146564483643  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.491407871246338  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.5337395668029785  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([137, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.536769390106201  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.536769390106201  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.5370306968688965  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.581191539764404  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([2404, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.638824939727783  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.638824939727783  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2404, 256]), torch.Size([1, 2404, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.6440606117248535  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.453539371490479  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2404, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.29183053970337  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.295218467712402  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.298606395721436  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.295048713684082  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([22736, 40])
input nodes number: 96166
output nodes number: 22736
edges number: 187498
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.295935153961182  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.29593563079834  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10209035873413086  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

pseudo mini batch 3 input nodes size: 142899
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08317852020263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08317852020263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15153789520263672  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.15170764923095703  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0894460678100586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0894460678100586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0894460678100586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([142899, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.0894460678100586  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([6157, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4234127998352051  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4234127998352051  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6157, 128]), torch.Size([1, 6157, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.42928457260131836  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4762587547302246  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6157, 128])
m.shape torch.Size([7208, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4801969528198242  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.4801969528198242  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 7208, 128]), torch.Size([1, 7208, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.48707103729248047  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5901823043823242  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 7208, 128])
m.shape torch.Size([7091, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5968890190124512  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.5968890190124512  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 7091, 128]), torch.Size([1, 7091, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.6037073135375977  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7538042068481445  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 7091, 128])
m.shape torch.Size([6489, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7627997398376465  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7627997398376465  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 6489, 128]), torch.Size([1, 6489, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.7692751884460449  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9508247375488281  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 6489, 128])
m.shape torch.Size([5983, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9619951248168945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9619951248168945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5983, 128]), torch.Size([1, 5983, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.9680004119873047  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1780824661254883  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5983, 128])
m.shape torch.Size([5264, 6, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1902899742126465  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1902899742126465  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 5264, 128]), torch.Size([1, 5264, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.1959600448608398  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4118261337280273  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 5264, 128])
m.shape torch.Size([4612, 7, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4247102737426758  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4247102737426758  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4612, 128]), torch.Size([1, 4612, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.4295601844787598  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.6581921577453613  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4612, 128])
m.shape torch.Size([4271, 8, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.672285556793213  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.672285556793213  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 4271, 128]), torch.Size([1, 4271, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.676499843597412  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9087328910827637  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 4271, 128])
m.shape torch.Size([3799, 9, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9229998588562012  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9229998588562012  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3799, 128]), torch.Size([1, 3799, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 1.9267535209655762  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.161902904510498  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3799, 128])
m.shape torch.Size([44623, 10, 128])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.372832775115967  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.372832775115967  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 44623, 128]), torch.Size([1, 44623, 128])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 2.415801525115967  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.466582775115967  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 44623, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.165100574493408  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.256897449493408  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.347970485687256  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.255461692810059  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([95497, 256])
first layer input nodes number: 142899
first layer output nodes number: 95497
edges number: 676174
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.34916353225708  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.440236568450928  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.463674068450928  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.463674068450928  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

m.shape torch.Size([3420, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.647124290466309  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.647124290466309  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 3420, 256]), torch.Size([1, 3420, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.655257701873779  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.707442760467529  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 3420, 256])
m.shape torch.Size([2905, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.710175037384033  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.710175037384033  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2905, 256]), torch.Size([1, 2905, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.715963840484619  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.799098968505859  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2905, 256])
m.shape torch.Size([2318, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.803012371063232  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.803012371063232  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2318, 256]), torch.Size([1, 2318, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.807549953460693  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.906527042388916  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2318, 256])
m.shape torch.Size([1820, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.911313533782959  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.911313533782959  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1820, 256]), torch.Size([1, 1820, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 5.9148688316345215  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.017451763153076  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1820, 256])
m.shape torch.Size([1551, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.022695064544678  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.022695064544678  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1551, 256]), torch.Size([1, 1551, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.0257086753845215  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.137058734893799  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1551, 256])
m.shape torch.Size([1211, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.142032146453857  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.142032146453857  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1211, 256]), torch.Size([1, 1211, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.144436359405518  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.246301174163818  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1211, 256])
m.shape torch.Size([1010, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.251871109008789  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.251871109008789  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 1010, 256]), torch.Size([1, 1010, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.25379753112793  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.350919723510742  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 1010, 256])
m.shape torch.Size([847, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.35646915435791  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.35646915435791  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.358084678649902  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.450736045837402  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([709, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.456061363220215  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.456061363220215  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.457413673400879  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.546429634094238  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([634, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.551847457885742  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.551847457885742  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.553056716918945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.63967227935791  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([589, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.645295143127441  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.645295143127441  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.646418571472168  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.73404598236084  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([499, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.739239692687988  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.739239692687988  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.740191459655762  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.82341194152832  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([403, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.827971458435059  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.827971458435059  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.828740119934082  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.899514198303223  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([362, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.904001235961914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.904001235961914  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.904691696166992  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.973818302154541  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([320, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.978086471557617  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.978086471557617  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 6.978696823120117  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.044259071350098  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([273, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.048152446746826  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.048152446746826  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.048673152923584  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.109306812286377  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([251, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.113147735595703  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.113147735595703  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.113626480102539  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.171075820922852  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([261, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.175919532775879  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.175919532775879  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.176417350769043  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.24099063873291  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([206, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.244503974914551  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.244503974914551  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.24489688873291  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.297547340393066  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([191, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.301230430603027  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.301230430603027  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.3015947341918945  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.352961540222168  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([169, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.3561906814575195  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.3561906814575195  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.356513023376465  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.404219627380371  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([135, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.4069132804870605  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.4069132804870605  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.40717077255249  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.447082042694092  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([141, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.450070381164551  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.450070381164551  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.450339317321777  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.4939069747924805  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([143, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.497071266174316  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.497071266174316  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.497344017028809  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.543438911437988  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([2365, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.600383758544922  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.600383758544922  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

 h.shape torch.Size([1, 2365, 256]), torch.Size([1, 2365, 256])
----------------------------------------3
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 7.604894638061523  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.400900840759277  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

rst.shape  torch.Size([1, 2365, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.240726470947266  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.244114398956299  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.247502326965332  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.243944644927979  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

torch.Size([22733, 40])
input nodes number: 95497
output nodes number: 22733
edges number: 186012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.244826316833496  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 8.244826793670654  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10083961486816406  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10083961486816406  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 0.10083961486816406  GigaBytes
Max Memory Allocated: 8.536108016967773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07537126541137695 |0.004531443119049072 |0.1516767144203186 |9.691715240478516e-05 |0.09709203243255615 |0.004586696624755859 |
----------------------------------------------------------pseudo_mini_loss sum 3.068018913269043
Total (block generation + training)time/epoch 5.352627277374268
Training time/epoch 1.3893380165100098
Training time without block to device /epoch 1.3712122440338135
Training time without total dataloading part /epoch 1.000049352645874
load block tensor time/epoch 0.3014850616455078
block to device time/epoch 0.01812577247619629
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  954969
Number of first layer input nodes during this epoch:  572518
Number of first layer output nodes during this epoch:  382451
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
