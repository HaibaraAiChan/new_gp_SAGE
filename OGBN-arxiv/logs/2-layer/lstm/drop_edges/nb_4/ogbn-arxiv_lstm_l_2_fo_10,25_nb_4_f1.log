[04:19:11] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27741370 edges into 4 parts and get 1724314 edge cuts
main start at this time 1651551528.101831
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09025859832763672
global_2_local spend time (sec) 0.0369570255279541
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0045392513275146484
A = g.adjacency_matrix() spent  0.007956504821777344
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08052802085876465
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2873470783233643
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.3389716148376465

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18687042, 2.0: 3216437, 3.0: 806435, 4.0: 243588, 5.0: 87963, 6.0: 38056, 7.0: 17712, 8.0: 9211, 9.0: 5018, 10.0: 2773, 11.0: 1603, 12.0: 931, 13.0: 552, 14.0: 368, 15.0: 239, 16.0: 157, 17.0: 127, 18.0: 78, 19.0: 42, 20.0: 15, 21.0: 7})
Convert a graph into a bidirected graph: 1.198 seconds
Metis partitioning: 4.977 seconds
Split the graph: 2.551 seconds
Construct subgraphs: 0.148 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.887915134429932
23167
22447
22805
22522
total k batches seeds list generation spend  21.584142208099365
after graph partition
graph partition algorithm spend time 21.697109699249268
23167
22447
22805
22522
partition_len_list
[39071, 35075, 68725, 51408]
shared_neighbor_graph_partition_s0 selection method  spend 21.782337427139282
time for parepare:  0.017121553421020508
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.0035479068756103516
mini_batch_src_global generation:  0.005675315856933594
r_  generation:  0.05307793617248535
local_output_nid generation:  0.003699779510498047
local_in_edges_tensor generation:  0.004514217376708984
mini_batch_src_global generation:  0.006742000579833984
r_  generation:  0.06472396850585938
local_output_nid generation:  0.004128694534301758
local_in_edges_tensor generation:  0.005936622619628906
mini_batch_src_global generation:  0.010857105255126953
r_  generation:  0.08978271484375
local_output_nid generation:  0.004163980484008789
local_in_edges_tensor generation:  0.004044055938720703
mini_batch_src_global generation:  0.007233858108520508
r_  generation:  0.060968637466430664
----------------------check_connections_block total spend ----------------------------- 0.4177682399749756
generate_one_block  0.07321047782897949
generate_one_block  0.07703185081481934
generate_one_block  0.12371969223022461
generate_one_block  0.07278180122375488
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042501211166381836
gen group dst list time:  0.005377292633056641
time for parepare:  0.03393244743347168
local_output_nid generation:  0.0069386959075927734
local_in_edges_tensor generation:  0.01678466796875
mini_batch_src_global generation:  0.006901741027832031
r_  generation:  0.08848190307617188
local_output_nid generation:  0.008667469024658203
local_in_edges_tensor generation:  0.0073511600494384766
mini_batch_src_global generation:  0.008409500122070312
r_  generation:  0.07867288589477539
local_output_nid generation:  0.01354670524597168
local_in_edges_tensor generation:  0.01643824577331543
mini_batch_src_global generation:  0.020973682403564453
r_  generation:  0.18847894668579102
local_output_nid generation:  0.013250589370727539
local_in_edges_tensor generation:  0.010535001754760742
mini_batch_src_global generation:  0.015048742294311523
r_  generation:  0.1303849220275879
----------------------check_connections_block total spend ----------------------------- 0.7829978466033936
generate_one_block  0.09931492805480957
generate_one_block  0.09437036514282227
generate_one_block  0.23510169982910156
generate_one_block  0.16606616973876953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.7829978466033936
block generation total time  0.5948531627655029
average batch blocks generation time:  0.14871329069137573
pseudo mini batch 0 input nodes size: 58926
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.030875682830810547  GigaBytes
Max Memory Allocated: 0.030875682830810547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.031048297882080078  GigaBytes
Max Memory Allocated: 0.031048297882080078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.031048297882080078  GigaBytes
Max Memory Allocated: 0.031048297882080078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03370809555053711  GigaBytes
Max Memory Allocated: 0.03370809555053711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03370809555053711  GigaBytes
Max Memory Allocated: 0.03370809555053711  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03370809555053711  GigaBytes
Max Memory Allocated: 0.03370809555053711  GigaBytes

torch.Size([58926, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03370809555053711  GigaBytes
Max Memory Allocated: 0.03370809555053711  GigaBytes

m.shape torch.Size([5317, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.14084529876708984  GigaBytes
Max Memory Allocated: 0.1412210464477539  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.14084529876708984  GigaBytes
Max Memory Allocated: 0.1412210464477539  GigaBytes

 h.shape torch.Size([1, 5317, 128]), torch.Size([1, 5317, 128])
----------------------------------------3
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.14591598510742188  GigaBytes
Max Memory Allocated: 0.14591598510742188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.18648147583007812  GigaBytes
Max Memory Allocated: 0.18901681900024414  GigaBytes

rst.shape  torch.Size([1, 5317, 128])
m.shape torch.Size([5297, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.18901681900024414  GigaBytes
Max Memory Allocated: 0.18913555145263672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.18901681900024414  GigaBytes
Max Memory Allocated: 0.18913555145263672  GigaBytes

 h.shape torch.Size([1, 5297, 128]), torch.Size([1, 5297, 128])
----------------------------------------3
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.19406843185424805  GigaBytes
Max Memory Allocated: 0.19406843185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.26984262466430664  GigaBytes
Max Memory Allocated: 0.27489423751831055  GigaBytes

rst.shape  torch.Size([1, 5297, 128])
m.shape torch.Size([4467, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.2742190361022949  GigaBytes
Max Memory Allocated: 0.27489423751831055  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.2742190361022949  GigaBytes
Max Memory Allocated: 0.27489423751831055  GigaBytes

 h.shape torch.Size([1, 4467, 128]), torch.Size([1, 4467, 128])
----------------------------------------3
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.27847909927368164  GigaBytes
Max Memory Allocated: 0.27847909927368164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3740053176879883  GigaBytes
Max Memory Allocated: 0.38039541244506836  GigaBytes

rst.shape  torch.Size([1, 4467, 128])
m.shape torch.Size([3665, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.37850475311279297  GigaBytes
Max Memory Allocated: 0.38039541244506836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.37850475311279297  GigaBytes
Max Memory Allocated: 0.38039541244506836  GigaBytes

 h.shape torch.Size([1, 3665, 128]), torch.Size([1, 3665, 128])
----------------------------------------3
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3820915222167969  GigaBytes
Max Memory Allocated: 0.3820915222167969  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.48431396484375  GigaBytes
Max Memory Allocated: 0.4913043975830078  GigaBytes

rst.shape  torch.Size([1, 3665, 128])
m.shape torch.Size([3030, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.4894828796386719  GigaBytes
Max Memory Allocated: 0.4913043975830078  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.4894828796386719  GigaBytes
Max Memory Allocated: 0.4913043975830078  GigaBytes

 h.shape torch.Size([1, 3030, 128]), torch.Size([1, 3030, 128])
----------------------------------------3
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.49263763427734375  GigaBytes
Max Memory Allocated: 0.49263763427734375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.6020994186401367  GigaBytes
Max Memory Allocated: 0.6093235015869141  GigaBytes

rst.shape  torch.Size([1, 3030, 128])
m.shape torch.Size([2404, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.6067838668823242  GigaBytes
Max Memory Allocated: 0.6093235015869141  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.6067838668823242  GigaBytes
Max Memory Allocated: 0.6093235015869141  GigaBytes

 h.shape torch.Size([1, 2404, 128]), torch.Size([1, 2404, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.6091699600219727  GigaBytes
Max Memory Allocated: 0.6093235015869141  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9158935546875 GB
    Memory Allocated: 0.7099242210388184  GigaBytes
Max Memory Allocated: 0.7168021202087402  GigaBytes

rst.shape  torch.Size([1, 2404, 128])
m.shape torch.Size([2022, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9158935546875 GB
    Memory Allocated: 0.7155270576477051  GigaBytes
Max Memory Allocated: 0.7168021202087402  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9158935546875 GB
    Memory Allocated: 0.7155270576477051  GigaBytes
Max Memory Allocated: 0.7168021202087402  GigaBytes

 h.shape torch.Size([1, 2022, 128]), torch.Size([1, 2022, 128])
----------------------------------------3
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.7174553871154785  GigaBytes
Max Memory Allocated: 0.7174553871154785  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8146157264709473  GigaBytes
Max Memory Allocated: 0.8213648796081543  GigaBytes

rst.shape  torch.Size([1, 2022, 128])
m.shape torch.Size([1774, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8204188346862793  GigaBytes
Max Memory Allocated: 0.8213648796081543  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8204188346862793  GigaBytes
Max Memory Allocated: 0.8213648796081543  GigaBytes

 h.shape torch.Size([1, 1774, 128]), torch.Size([1, 1774, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.822110652923584  GigaBytes
Max Memory Allocated: 0.822110652923584  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.9192652702331543  GigaBytes
Max Memory Allocated: 0.926032543182373  GigaBytes

rst.shape  torch.Size([1, 1774, 128])
m.shape torch.Size([1481, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.9247751235961914  GigaBytes
Max Memory Allocated: 0.926032543182373  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.9247751235961914  GigaBytes
Max Memory Allocated: 0.926032543182373  GigaBytes

 h.shape torch.Size([1, 1481, 128]), torch.Size([1, 1481, 128])
----------------------------------------3
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.9261875152587891  GigaBytes
Max Memory Allocated: 0.9261875152587891  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 1.016580581665039  GigaBytes
Max Memory Allocated: 1.0229363441467285  GigaBytes

rst.shape  torch.Size([1, 1481, 128])
m.shape torch.Size([9614, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.0617175102233887  GigaBytes
Max Memory Allocated: 1.0627927780151367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.0617175102233887  GigaBytes
Max Memory Allocated: 1.0627927780151367  GigaBytes

 h.shape torch.Size([1, 9614, 128]), torch.Size([1, 9614, 128])
----------------------------------------3
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.071709156036377  GigaBytes
Max Memory Allocated: 1.071709156036377  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.7226815223693848  GigaBytes
Max Memory Allocated: 1.7685246467590332  GigaBytes

rst.shape  torch.Size([1, 9614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.6353306770324707  GigaBytes
Max Memory Allocated: 1.7751049995422363  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.6725916862487793  GigaBytes
Max Memory Allocated: 1.7751049995422363  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.709852695465088  GigaBytes
Max Memory Allocated: 1.7751049995422363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.6723003387451172  GigaBytes
Max Memory Allocated: 1.7751049995422363  GigaBytes

torch.Size([39071, 256])
first layer input nodes number: 58926
first layer output nodes number: 39071
edges number: 211361
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.7102937698364258  GigaBytes
Max Memory Allocated: 1.7751049995422363  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.7475547790527344  GigaBytes
Max Memory Allocated: 1.7751049995422363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 1.7568702697753906  GigaBytes
Max Memory Allocated: 1.7941312789916992  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 1.7568702697753906  GigaBytes
Max Memory Allocated: 1.7941312789916992  GigaBytes

m.shape torch.Size([3964, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 1.9013962745666504  GigaBytes
Max Memory Allocated: 1.9014110565185547  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 1.9013962745666504  GigaBytes
Max Memory Allocated: 1.9014110565185547  GigaBytes

 h.shape torch.Size([1, 3964, 256]), torch.Size([1, 3964, 256])
----------------------------------------3
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 1.9089570045471191  GigaBytes
Max Memory Allocated: 1.9089570045471191  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 1.9694428443908691  GigaBytes
Max Memory Allocated: 1.9732232093811035  GigaBytes

rst.shape  torch.Size([1, 3964, 256])
m.shape torch.Size([3490, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 1.9732756614685059  GigaBytes
Max Memory Allocated: 1.973301887512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 1.9732756614685059  GigaBytes
Max Memory Allocated: 1.973301887512207  GigaBytes

 h.shape torch.Size([1, 3490, 256]), torch.Size([1, 3490, 256])
----------------------------------------3
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 1.9799323081970215  GigaBytes
Max Memory Allocated: 1.9799323081970215  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.0819334983825684  GigaBytes
Max Memory Allocated: 2.088590145111084  GigaBytes

rst.shape  torch.Size([1, 3490, 256])
m.shape torch.Size([2770, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.086592197418213  GigaBytes
Max Memory Allocated: 2.088590145111084  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.086592197418213  GigaBytes
Max Memory Allocated: 2.088590145111084  GigaBytes

 h.shape torch.Size([1, 2770, 256]), torch.Size([1, 2770, 256])
----------------------------------------3
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.0921292304992676  GigaBytes
Max Memory Allocated: 2.0921292304992676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 2.208913803100586  GigaBytes
Max Memory Allocated: 2.216838836669922  GigaBytes

rst.shape  torch.Size([1, 2770, 256])
m.shape torch.Size([2156, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 2.2145609855651855  GigaBytes
Max Memory Allocated: 2.216838836669922  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 2.2145609855651855  GigaBytes
Max Memory Allocated: 2.216838836669922  GigaBytes

 h.shape torch.Size([1, 2156, 256]), torch.Size([1, 2156, 256])
----------------------------------------3
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 2.2187509536743164  GigaBytes
Max Memory Allocated: 2.2187509536743164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6522216796875 GB
    Memory Allocated: 2.342538833618164  GigaBytes
Max Memory Allocated: 2.3507633209228516  GigaBytes

rst.shape  torch.Size([1, 2156, 256])
m.shape torch.Size([1777, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6522216796875 GB
    Memory Allocated: 2.3484654426574707  GigaBytes
Max Memory Allocated: 2.3507633209228516  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6522216796875 GB
    Memory Allocated: 2.3484654426574707  GigaBytes
Max Memory Allocated: 2.3507633209228516  GigaBytes

 h.shape torch.Size([1, 1777, 256]), torch.Size([1, 1777, 256])
----------------------------------------3
 Nvidia-smi: 3.6522216796875 GB
    Memory Allocated: 2.352048873901367  GigaBytes
Max Memory Allocated: 2.352048873901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.478362560272217  GigaBytes
Max Memory Allocated: 2.4868359565734863  GigaBytes

rst.shape  torch.Size([1, 1777, 256])
m.shape torch.Size([1339, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.4843897819519043  GigaBytes
Max Memory Allocated: 2.4868359565734863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.4843897819519043  GigaBytes
Max Memory Allocated: 2.4868359565734863  GigaBytes

 h.shape torch.Size([1, 1339, 256]), torch.Size([1, 1339, 256])
----------------------------------------3
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.4871649742126465  GigaBytes
Max Memory Allocated: 2.4871649742126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 2.6058716773986816  GigaBytes
Max Memory Allocated: 2.6135334968566895  GigaBytes

rst.shape  torch.Size([1, 1339, 256])
m.shape torch.Size([1126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 2.612170696258545  GigaBytes
Max Memory Allocated: 2.6135334968566895  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 2.612170696258545  GigaBytes
Max Memory Allocated: 2.6135334968566895  GigaBytes

 h.shape torch.Size([1, 1126, 256]), torch.Size([1, 1126, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 2.6144652366638184  GigaBytes
Max Memory Allocated: 2.6144652366638184  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.723477840423584  GigaBytes
Max Memory Allocated: 2.730994701385498  GigaBytes

rst.shape  torch.Size([1, 1126, 256])
m.shape torch.Size([965, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.729703903198242  GigaBytes
Max Memory Allocated: 2.730994701385498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.729703903198242  GigaBytes
Max Memory Allocated: 2.730994701385498  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.7315444946289062  GigaBytes
Max Memory Allocated: 2.7315444946289062  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 2.837582588195801  GigaBytes
Max Memory Allocated: 2.844944953918457  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([796, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 2.843547821044922  GigaBytes
Max Memory Allocated: 2.844944953918457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 2.843547821044922  GigaBytes
Max Memory Allocated: 2.844944953918457  GigaBytes

 h.shape torch.Size([1, 796, 256]), torch.Size([1, 796, 256])
----------------------------------------3
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 2.8450660705566406  GigaBytes
Max Memory Allocated: 2.8450660705566406  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.9426212310791016  GigaBytes
Max Memory Allocated: 2.949453353881836  GigaBytes

rst.shape  torch.Size([1, 796, 256])
m.shape torch.Size([655, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.948157787322998  GigaBytes
Max Memory Allocated: 2.949453353881836  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.948157787322998  GigaBytes
Max Memory Allocated: 2.949453353881836  GigaBytes

 h.shape torch.Size([1, 655, 256]), torch.Size([1, 655, 256])
----------------------------------------3
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.9494071006774902  GigaBytes
Max Memory Allocated: 2.949453353881836  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3299560546875 GB
    Memory Allocated: 3.038573741912842  GigaBytes
Max Memory Allocated: 3.0448203086853027  GigaBytes

rst.shape  torch.Size([1, 655, 256])
m.shape torch.Size([528, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3299560546875 GB
    Memory Allocated: 3.0435314178466797  GigaBytes
Max Memory Allocated: 3.0448203086853027  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3299560546875 GB
    Memory Allocated: 3.0435314178466797  GigaBytes
Max Memory Allocated: 3.0448203086853027  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 4.3299560546875 GB
    Memory Allocated: 3.0445384979248047  GigaBytes
Max Memory Allocated: 3.0448203086853027  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.125225067138672  GigaBytes
Max Memory Allocated: 3.1307640075683594  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([450, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.1299118995666504  GigaBytes
Max Memory Allocated: 3.1307640075683594  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.1299118995666504  GigaBytes
Max Memory Allocated: 3.1307640075683594  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.130770206451416  GigaBytes
Max Memory Allocated: 3.130770206451416  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.205862522125244  GigaBytes
Max Memory Allocated: 3.211012363433838  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([381, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.2101941108703613  GigaBytes
Max Memory Allocated: 3.211012363433838  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.2101941108703613  GigaBytes
Max Memory Allocated: 3.211012363433838  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.210920810699463  GigaBytes
Max Memory Allocated: 3.211012363433838  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5330810546875 GB
    Memory Allocated: 3.2801756858825684  GigaBytes
Max Memory Allocated: 3.2848992347717285  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([320, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5330810546875 GB
    Memory Allocated: 3.284118175506592  GigaBytes
Max Memory Allocated: 3.2848992347717285  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5330810546875 GB
    Memory Allocated: 3.284118175506592  GigaBytes
Max Memory Allocated: 3.2848992347717285  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.5330810546875 GB
    Memory Allocated: 3.284728527069092  GigaBytes
Max Memory Allocated: 3.2848992347717285  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6014404296875 GB
    Memory Allocated: 3.346193790435791  GigaBytes
Max Memory Allocated: 3.350466251373291  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([297, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6014404296875 GB
    Memory Allocated: 3.350170612335205  GigaBytes
Max Memory Allocated: 3.350466251373291  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6014404296875 GB
    Memory Allocated: 3.350170612335205  GigaBytes
Max Memory Allocated: 3.350466251373291  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.6014404296875 GB
    Memory Allocated: 3.3507370948791504  GigaBytes
Max Memory Allocated: 3.3507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.413074016571045  GigaBytes
Max Memory Allocated: 3.4173226356506348  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([230, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.416327953338623  GigaBytes
Max Memory Allocated: 3.4173226356506348  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.416327953338623  GigaBytes
Max Memory Allocated: 3.4173226356506348  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.41676664352417  GigaBytes
Max Memory Allocated: 3.4173226356506348  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 3.466338634490967  GigaBytes
Max Memory Allocated: 3.469848155975342  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([200, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 3.4693875312805176  GigaBytes
Max Memory Allocated: 3.469848155975342  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 3.4693875312805176  GigaBytes
Max Memory Allocated: 3.469848155975342  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.6834716796875 GB
    Memory Allocated: 3.46976900100708  GigaBytes
Max Memory Allocated: 3.469848155975342  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 3.51554536819458  GigaBytes
Max Memory Allocated: 3.5187878608703613  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([178, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 3.518434524536133  GigaBytes
Max Memory Allocated: 3.5187878608703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 3.518434524536133  GigaBytes
Max Memory Allocated: 3.5187878608703613  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 3.5187740325927734  GigaBytes
Max Memory Allocated: 3.5187878608703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7850341796875 GB
    Memory Allocated: 3.561891555786133  GigaBytes
Max Memory Allocated: 3.5649471282958984  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([151, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7850341796875 GB
    Memory Allocated: 3.564479351043701  GigaBytes
Max Memory Allocated: 3.5649471282958984  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7850341796875 GB
    Memory Allocated: 3.564479351043701  GigaBytes
Max Memory Allocated: 3.5649471282958984  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.7850341796875 GB
    Memory Allocated: 3.564767360687256  GigaBytes
Max Memory Allocated: 3.5649471282958984  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8280029296875 GB
    Memory Allocated: 3.603360652923584  GigaBytes
Max Memory Allocated: 3.6060967445373535  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([132, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8280029296875 GB
    Memory Allocated: 3.6057543754577637  GigaBytes
Max Memory Allocated: 3.6060967445373535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8280029296875 GB
    Memory Allocated: 3.6057543754577637  GigaBytes
Max Memory Allocated: 3.6060967445373535  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.8280029296875 GB
    Memory Allocated: 3.606006145477295  GigaBytes
Max Memory Allocated: 3.6060967445373535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.641505718231201  GigaBytes
Max Memory Allocated: 3.6440234184265137  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([117, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.6438541412353516  GigaBytes
Max Memory Allocated: 3.6440234184265137  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.6438541412353516  GigaBytes
Max Memory Allocated: 3.6440234184265137  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.6440773010253906  GigaBytes
Max Memory Allocated: 3.6440773010253906  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.677104949951172  GigaBytes
Max Memory Allocated: 3.679448127746582  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([107, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.679255962371826  GigaBytes
Max Memory Allocated: 3.679448127746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.679255962371826  GigaBytes
Max Memory Allocated: 3.679448127746582  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.679460048675537  GigaBytes
Max Memory Allocated: 3.679460048675537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9295654296875 GB
    Memory Allocated: 3.7110934257507324  GigaBytes
Max Memory Allocated: 3.7133383750915527  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9295654296875 GB
    Memory Allocated: 3.713069438934326  GigaBytes
Max Memory Allocated: 3.7133383750915527  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9295654296875 GB
    Memory Allocated: 3.713069438934326  GigaBytes
Max Memory Allocated: 3.7133383750915527  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9295654296875 GB
    Memory Allocated: 3.7132487297058105  GigaBytes
Max Memory Allocated: 3.7133383750915527  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9588623046875 GB
    Memory Allocated: 3.7422938346862793  GigaBytes
Max Memory Allocated: 3.7443556785583496  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9588623046875 GB
    Memory Allocated: 3.744119167327881  GigaBytes
Max Memory Allocated: 3.7443556785583496  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9588623046875 GB
    Memory Allocated: 3.744119167327881  GigaBytes
Max Memory Allocated: 3.7443556785583496  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9588623046875 GB
    Memory Allocated: 3.7442774772644043  GigaBytes
Max Memory Allocated: 3.7443556785583496  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9842529296875 GB
    Memory Allocated: 3.7710318565368652  GigaBytes
Max Memory Allocated: 3.7729315757751465  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([861, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0057373046875 GB
    Memory Allocated: 3.792597770690918  GigaBytes
Max Memory Allocated: 3.7926783561706543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0057373046875 GB
    Memory Allocated: 3.792597770690918  GigaBytes
Max Memory Allocated: 3.7926783561706543  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 3.7942399978637695  GigaBytes
Max Memory Allocated: 3.7942399978637695  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3729248046875 GB
    Memory Allocated: 4.084225654602051  GigaBytes
Max Memory Allocated: 4.105710029602051  GigaBytes

rst.shape  torch.Size([1, 861, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.4432373046875 GB
    Memory Allocated: 3.9652442932128906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.4432373046875 GB
    Memory Allocated: 3.9689254760742188  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.4432373046875 GB
    Memory Allocated: 3.9723777770996094  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4432373046875 GB
    Memory Allocated: 3.9685239791870117  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

torch.Size([23167, 40])
input nodes number: 39071
output nodes number: 23167
edges number: 145492
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4432373046875 GB
    Memory Allocated: 3.9726691246032715  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4432373046875 GB
    Memory Allocated: 3.972670078277588  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.04548215866088867  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

pseudo mini batch 1 input nodes size: 49168
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.0375056266784668  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.0375056266784668  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.06095075607299805  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.061118125915527344  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.03284740447998047  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.03574562072753906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.03574562072753906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.03574562072753906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

torch.Size([49168, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.03574562072753906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

m.shape torch.Size([3910, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.14038562774658203  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.14038562774658203  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 3910, 128]), torch.Size([1, 3910, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.14411449432373047  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.17500972747802734  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 3910, 128])
m.shape torch.Size([3967, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.17687416076660156  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.17687416076660156  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 3967, 128]), torch.Size([1, 3967, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.18116235733032227  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.23901796340942383  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 3967, 128])
m.shape torch.Size([3524, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.24216747283935547  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.24216747283935547  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 3524, 128]), torch.Size([1, 3524, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.24573945999145508  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.3233814239501953  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 3524, 128])
m.shape torch.Size([3033, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.32750558853149414  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.32750558853149414  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 3033, 128]), torch.Size([1, 3033, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.3306145668029785  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.4168882369995117  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 3033, 128])
m.shape torch.Size([2547, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.42151451110839844  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.42151451110839844  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 2547, 128]), torch.Size([1, 2547, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.4243483543395996  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.5127553939819336  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 2547, 128])
m.shape torch.Size([2163, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.5177292823791504  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.5177292823791504  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 2163, 128]), torch.Size([1, 2163, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.519935131072998  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.6134963035583496  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 2163, 128])
m.shape torch.Size([1811, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.6185097694396973  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.6185097694396973  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1811, 128]), torch.Size([1, 1811, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.620236873626709  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.7065920829772949  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 1811, 128])
m.shape torch.Size([1635, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.7119655609130859  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.7119655609130859  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1635, 128]), torch.Size([1, 1635, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.7135248184204102  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.8056831359863281  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 1635, 128])
m.shape torch.Size([1363, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.8107528686523438  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.8107528686523438  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1363, 128]), torch.Size([1, 1363, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.8120527267456055  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.8952436447143555  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 1363, 128])
m.shape torch.Size([11122, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.9476275444030762  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.9476275444030762  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 11122, 128]), torch.Size([1, 11122, 128])
----------------------------------------3
 Nvidia-smi: 5.7264404296875 GB
    Memory Allocated: 0.9582343101501465  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8455810546875 GB
    Memory Allocated: 1.7126688957214355  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 11122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8455810546875 GB
    Memory Allocated: 1.6221957206726074  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8455810546875 GB
    Memory Allocated: 1.6556458473205566  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8455810546875 GB
    Memory Allocated: 1.6890959739685059  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8455810546875 GB
    Memory Allocated: 1.6553840637207031  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

torch.Size([35075, 256])
first layer input nodes number: 49168
first layer output nodes number: 35075
edges number: 209505
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8455810546875 GB
    Memory Allocated: 1.6894645690917969  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8455810546875 GB
    Memory Allocated: 1.722914695739746  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8807373046875 GB
    Memory Allocated: 1.7312774658203125  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8807373046875 GB
    Memory Allocated: 1.7312774658203125  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

m.shape torch.Size([3011, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 1.9083991050720215  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 1.9083991050720215  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 3011, 256]), torch.Size([1, 3011, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 1.9156413078308105  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 1.9630846977233887  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 3011, 256])
m.shape torch.Size([2735, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 1.9661192893981934  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 1.9661192893981934  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 2735, 256]), torch.Size([1, 2735, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 1.9715933799743652  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.0507588386535645  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 2735, 256])
m.shape torch.Size([2313, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.0545997619628906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.0545997619628906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 2313, 256]), torch.Size([1, 2313, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.0590476989746094  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.158082962036133  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 2313, 256])
m.shape torch.Size([1862, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.1639232635498047  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.1639232635498047  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1862, 256]), torch.Size([1, 1862, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.1675686836242676  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.272780418395996  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 1862, 256])
m.shape torch.Size([1557, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.278487205505371  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.278487205505371  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1557, 256]), torch.Size([1, 1557, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.2817440032958984  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.3917551040649414  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 1557, 256])
m.shape torch.Size([1342, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.3971385955810547  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.3971385955810547  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1342, 256]), torch.Size([1, 1342, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.3998050689697266  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.511906147003174  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 1342, 256])
m.shape torch.Size([1076, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.5175318717956543  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.5175318717956543  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1076, 256]), torch.Size([1, 1076, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.519822120666504  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.624335289001465  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 1076, 256])
m.shape torch.Size([952, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.630629062652588  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.630629062652588  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 952, 256]), torch.Size([1, 952, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.6324448585510254  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.736372470855713  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 952, 256])
m.shape torch.Size([811, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.7424802780151367  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.7424802780151367  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 811, 256]), torch.Size([1, 811, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.7440271377563477  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.8469324111938477  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 811, 256])
m.shape torch.Size([719, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.85306978225708  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.85306978225708  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 719, 256]), torch.Size([1, 719, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.8544411659240723  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.953136920928955  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 719, 256])
m.shape torch.Size([647, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.959291934967041  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.959291934967041  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 2.9605259895324707  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.057185649871826  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([531, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.0626931190490723  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.0626931190490723  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.0637059211730957  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.150709629058838  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([463, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.1559886932373047  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.1559886932373047  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.156871795654297  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.238323211669922  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([410, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.243398666381836  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.243398666381836  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.244180679321289  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.323744773864746  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([358, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.32851505279541  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.32851505279541  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.329197883605957  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.4035987854003906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([301, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.407886505126953  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.407886505126953  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.4084606170654297  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.474384307861328  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([306, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.479097366333008  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.479097366333008  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.4796810150146484  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.552143096923828  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([253, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.5562286376953125  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.5562286376953125  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.556711196899414  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.6179962158203125  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([211, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.621608257293701  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.621608257293701  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.6220107078552246  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.6759390830993652  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([236, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.680274486541748  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.680274486541748  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.680724620819092  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.7441935539245605  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([208, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.748167037963867  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.748167037963867  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.748563766479492  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.807279586791992  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([137, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.809978485107422  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.809978485107422  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.810239791870117  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.8507423400878906  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([145, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.8538174629211426  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.8538174629211426  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.8540940284729004  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.898897647857666  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([131, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.9017815589904785  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.9017815589904785  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 6.0526123046875 GB
    Memory Allocated: 3.902031421661377  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0858154296875 GB
    Memory Allocated: 3.944258213043213  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([1732, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0858154296875 GB
    Memory Allocated: 3.985750198364258  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0858154296875 GB
    Memory Allocated: 3.985750198364258  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

 h.shape torch.Size([1, 1732, 256]), torch.Size([1, 1732, 256])
----------------------------------------3
 Nvidia-smi: 6.0858154296875 GB
    Memory Allocated: 3.9894237518310547  GigaBytes
Max Memory Allocated: 4.149773120880127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.5716142654418945  GigaBytes
Max Memory Allocated: 4.612908363342285  GigaBytes

rst.shape  torch.Size([1, 1732, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.419152736663818  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.422497749328613  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.425842761993408  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.422330379486084  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

torch.Size([22447, 40])
input nodes number: 35075
output nodes number: 22447
edges number: 179422
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.422423362731934  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.422423839569092  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.041048526763916016  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

pseudo mini batch 2 input nodes size: 92375
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.032511234283447266  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.032511234283447266  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.07655906677246094  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.07672929763793945  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.053116798400878906  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.059894561767578125  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.059894561767578125  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.059894561767578125  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

torch.Size([92375, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.4764404296875 GB
    Memory Allocated: 0.059894561767578125  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

m.shape torch.Size([3781, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.32213544845581055  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.32213544845581055  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 3781, 128]), torch.Size([1, 3781, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.3257412910461426  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.35639047622680664  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 3781, 128])
m.shape torch.Size([4056, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.35819339752197266  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.35819339752197266  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 4056, 128]), torch.Size([1, 4056, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.36283159255981445  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.42119646072387695  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 4056, 128])
m.shape torch.Size([3619, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.42432498931884766  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.42432498931884766  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 3619, 128]), torch.Size([1, 3619, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.4284219741821289  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.5054140090942383  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 3619, 128])
m.shape torch.Size([3335, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.5102300643920898  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.5102300643920898  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 3335, 128]), torch.Size([1, 3335, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.5135459899902344  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.6098518371582031  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 3335, 128])
m.shape torch.Size([3155, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.6162128448486328  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.6162128448486328  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 3155, 128]), torch.Size([1, 3155, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.619257926940918  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.7281961441040039  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 3155, 128])
m.shape torch.Size([2929, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.7350716590881348  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.7350716590881348  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 2929, 128]), torch.Size([1, 2929, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.7380280494689941  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.8586821556091309  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 2929, 128])
m.shape torch.Size([2778, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.8665580749511719  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.8665580749511719  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 2778, 128]), torch.Size([1, 2778, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 0.8692874908447266  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.002577781677246  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 2778, 128])
m.shape torch.Size([2584, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.0111103057861328  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.0111103057861328  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 2584, 128]), torch.Size([1, 2584, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.013667106628418  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.1548423767089844  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 2584, 128])
m.shape torch.Size([2432, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.1640472412109375  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.1640472412109375  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 2432, 128]), torch.Size([1, 2432, 128])
----------------------------------------3
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.1663894653320312  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7342529296875 GB
    Memory Allocated: 1.3224258422851562  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 2432, 128])
m.shape torch.Size([40056, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9256591796875 GB
    Memory Allocated: 1.5126724243164062  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9256591796875 GB
    Memory Allocated: 1.5126724243164062  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 40056, 128]), torch.Size([1, 40056, 128])
----------------------------------------3
 Nvidia-smi: 6.9256591796875 GB
    Memory Allocated: 1.5517349243164062  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.273445129394531  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 40056, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.030083656311035  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.095624923706055  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.161166191101074  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.0951128005981445  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

torch.Size([68725, 256])
first layer input nodes number: 92375
first layer output nodes number: 68725
edges number: 532005
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.161856651306152  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.227397918701172  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.243783473968506  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6795654296875 GB
    Memory Allocated: 4.243783473968506  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

m.shape torch.Size([2545, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.499815464019775  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.499815464019775  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 2545, 256]), torch.Size([1, 2545, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.505538463592529  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.544372081756592  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 2545, 256])
m.shape torch.Size([2230, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.546231746673584  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.546231746673584  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 2230, 256]), torch.Size([1, 2230, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.550928115844727  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.6160688400268555  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

rst.shape  torch.Size([1, 2230, 256])
m.shape torch.Size([1721, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.6189045906066895  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.6189045906066895  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

 h.shape torch.Size([1, 1721, 256]), torch.Size([1, 1721, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.6223530769348145  GigaBytes
Max Memory Allocated: 4.634406089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.69523286819458  GigaBytes
Max Memory Allocated: 4.7001566886901855  GigaBytes

rst.shape  torch.Size([1, 1721, 256])
m.shape torch.Size([1363, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.69874906539917  GigaBytes
Max Memory Allocated: 4.7001566886901855  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.69874906539917  GigaBytes
Max Memory Allocated: 4.7001566886901855  GigaBytes

 h.shape torch.Size([1, 1363, 256]), torch.Size([1, 1363, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.7014617919921875  GigaBytes
Max Memory Allocated: 4.7014617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.780203342437744  GigaBytes
Max Memory Allocated: 4.785402774810791  GigaBytes

rst.shape  torch.Size([1, 1363, 256])
m.shape torch.Size([1224, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.784361362457275  GigaBytes
Max Memory Allocated: 4.785402774810791  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.784361362457275  GigaBytes
Max Memory Allocated: 4.785402774810791  GigaBytes

 h.shape torch.Size([1, 1224, 256]), torch.Size([1, 1224, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.786764621734619  GigaBytes
Max Memory Allocated: 4.786764621734619  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.878864765167236  GigaBytes
Max Memory Allocated: 4.884701251983643  GigaBytes

rst.shape  torch.Size([1, 1224, 256])
m.shape torch.Size([989, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.882765293121338  GigaBytes
Max Memory Allocated: 4.884701251983643  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.882765293121338  GigaBytes
Max Memory Allocated: 4.884701251983643  GigaBytes

 h.shape torch.Size([1, 989, 256]), torch.Size([1, 989, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.8846516609191895  GigaBytes
Max Memory Allocated: 4.884701251983643  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.967474460601807  GigaBytes
Max Memory Allocated: 4.973133563995361  GigaBytes

rst.shape  torch.Size([1, 989, 256])
m.shape torch.Size([804, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.971940517425537  GigaBytes
Max Memory Allocated: 4.973133563995361  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.971940517425537  GigaBytes
Max Memory Allocated: 4.973133563995361  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 4.973474025726318  GigaBytes
Max Memory Allocated: 4.973474025726318  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.050149440765381  GigaBytes
Max Memory Allocated: 5.055516719818115  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([662, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.054472923278809  GigaBytes
Max Memory Allocated: 5.055516719818115  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.054472923278809  GigaBytes
Max Memory Allocated: 5.055516719818115  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.0557355880737305  GigaBytes
Max Memory Allocated: 5.0557355880737305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.128298759460449  GigaBytes
Max Memory Allocated: 5.133349418640137  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([655, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.133333683013916  GigaBytes
Max Memory Allocated: 5.133356094360352  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.133333683013916  GigaBytes
Max Memory Allocated: 5.133356094360352  GigaBytes

 h.shape torch.Size([1, 655, 256]), torch.Size([1, 655, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.134582996368408  GigaBytes
Max Memory Allocated: 5.134582996368408  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.214539051055908  GigaBytes
Max Memory Allocated: 5.220160961151123  GigaBytes

rst.shape  torch.Size([1, 655, 256])
m.shape torch.Size([602, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.219700813293457  GigaBytes
Max Memory Allocated: 5.220160961151123  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.219700813293457  GigaBytes
Max Memory Allocated: 5.220160961151123  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.22084903717041  GigaBytes
Max Memory Allocated: 5.22084903717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.302384376525879  GigaBytes
Max Memory Allocated: 5.3081254959106445  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([534, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.307456016540527  GigaBytes
Max Memory Allocated: 5.3081254959106445  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.307456016540527  GigaBytes
Max Memory Allocated: 5.3081254959106445  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.308474540710449  GigaBytes
Max Memory Allocated: 5.308474540710449  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.3880205154418945  GigaBytes
Max Memory Allocated: 5.393622398376465  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([497, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.393243789672852  GigaBytes
Max Memory Allocated: 5.393622398376465  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.393243789672852  GigaBytes
Max Memory Allocated: 5.393622398376465  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.394191741943359  GigaBytes
Max Memory Allocated: 5.394191741943359  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.476522445678711  GigaBytes
Max Memory Allocated: 5.482210159301758  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([426, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.4813714027404785  GigaBytes
Max Memory Allocated: 5.482210159301758  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.4813714027404785  GigaBytes
Max Memory Allocated: 5.482210159301758  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.482183933258057  GigaBytes
Max Memory Allocated: 5.482210159301758  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.558306694030762  GigaBytes
Max Memory Allocated: 5.5635881423950195  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([371, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.562892913818359  GigaBytes
Max Memory Allocated: 5.5635881423950195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.562892913818359  GigaBytes
Max Memory Allocated: 5.5635881423950195  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.563600540161133  GigaBytes
Max Memory Allocated: 5.563600540161133  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.6336565017700195  GigaBytes
Max Memory Allocated: 5.639035224914551  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([369, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.638722896575928  GigaBytes
Max Memory Allocated: 5.639035224914551  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.638722896575928  GigaBytes
Max Memory Allocated: 5.639035224914551  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.6394267082214355  GigaBytes
Max Memory Allocated: 5.6394267082214355  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.714030742645264  GigaBytes
Max Memory Allocated: 5.719309329986572  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([339, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.7188920974731445  GigaBytes
Max Memory Allocated: 5.719309329986572  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.7188920974731445  GigaBytes
Max Memory Allocated: 5.719309329986572  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.719538688659668  GigaBytes
Max Memory Allocated: 5.719538688659668  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.793610572814941  GigaBytes
Max Memory Allocated: 5.798783302307129  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([311, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.79836893081665  GigaBytes
Max Memory Allocated: 5.798783302307129  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.79836893081665  GigaBytes
Max Memory Allocated: 5.798783302307129  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.798962116241455  GigaBytes
Max Memory Allocated: 5.798962116241455  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.871896266937256  GigaBytes
Max Memory Allocated: 5.876938343048096  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([331, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.877326488494873  GigaBytes
Max Memory Allocated: 5.877348899841309  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.877326488494873  GigaBytes
Max Memory Allocated: 5.877348899841309  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.877957820892334  GigaBytes
Max Memory Allocated: 5.877957820892334  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.95935583114624  GigaBytes
Max Memory Allocated: 5.965037822723389  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([298, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.964482307434082  GigaBytes
Max Memory Allocated: 5.965037822723389  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.964482307434082  GigaBytes
Max Memory Allocated: 5.965037822723389  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 5.96505069732666  GigaBytes
Max Memory Allocated: 5.96505069732666  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.042902946472168  GigaBytes
Max Memory Allocated: 6.04830265045166  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([271, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.047828197479248  GigaBytes
Max Memory Allocated: 6.04830265045166  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.047828197479248  GigaBytes
Max Memory Allocated: 6.04830265045166  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.04834508895874  GigaBytes
Max Memory Allocated: 6.04834508895874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.123878002166748  GigaBytes
Max Memory Allocated: 6.12904691696167  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([273, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.129129886627197  GigaBytes
Max Memory Allocated: 6.129151344299316  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.129129886627197  GigaBytes
Max Memory Allocated: 6.129151344299316  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.129650592803955  GigaBytes
Max Memory Allocated: 6.129650592803955  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.20967435836792  GigaBytes
Max Memory Allocated: 6.215141773223877  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([203, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.2137064933776855  GigaBytes
Max Memory Allocated: 6.215141773223877  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.2137064933776855  GigaBytes
Max Memory Allocated: 6.215141773223877  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.2140936851501465  GigaBytes
Max Memory Allocated: 6.215141773223877  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.274108409881592  GigaBytes
Max Memory Allocated: 6.278367519378662  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([194, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.27820348739624  GigaBytes
Max Memory Allocated: 6.278367519378662  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.27820348739624  GigaBytes
Max Memory Allocated: 6.278367519378662  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.278573513031006  GigaBytes
Max Memory Allocated: 6.278573513031006  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.338517665863037  GigaBytes
Max Memory Allocated: 6.343286037445068  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([205, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.343137741088867  GigaBytes
Max Memory Allocated: 6.343286037445068  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.343137741088867  GigaBytes
Max Memory Allocated: 6.343286037445068  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.343528747558594  GigaBytes
Max Memory Allocated: 6.343528747558594  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9315185546875 GB
    Memory Allocated: 6.409608840942383  GigaBytes
Max Memory Allocated: 6.414300918579102  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([5388, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 6.539323329925537  GigaBytes
Max Memory Allocated: 6.539825439453125  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 6.539323329925537  GigaBytes
Max Memory Allocated: 6.539825439453125  GigaBytes

 h.shape torch.Size([1, 5388, 256]), torch.Size([1, 5388, 256])
----------------------------------------3
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 6.549600124359131  GigaBytes
Max Memory Allocated: 6.549600124359131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.0252685546875 GB
    Memory Allocated: 8.398969173431396  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5388, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.0252685546875 GB
    Memory Allocated: 8.163465023040771  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.0252685546875 GB
    Memory Allocated: 8.167069911956787  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.0252685546875 GB
    Memory Allocated: 8.171185970306396  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.0252685546875 GB
    Memory Allocated: 8.167410850524902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22805, 40])
input nodes number: 68725
output nodes number: 22805
edges number: 262650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0252685546875 GB
    Memory Allocated: 8.168353080749512  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.0252685546875 GB
    Memory Allocated: 8.16835355758667  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07066965103149414  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

pseudo mini batch 3 input nodes size: 92318
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05337667465209961  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05337667465209961  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0973973274230957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0975651741027832  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.053347110748291016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05736970901489258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05736970901489258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05736970901489258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([92318, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05736970901489258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([5315, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.22100400924682617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.22100400924682617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5315, 128]), torch.Size([1, 5315, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.22700119018554688  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2675514221191406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5315, 128])
m.shape torch.Size([5269, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.27004194259643555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.27004194259643555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5269, 128]), torch.Size([1, 5269, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2750668525695801  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.35044050216674805  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5269, 128])
m.shape torch.Size([4614, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.35452842712402344  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.35452842712402344  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4614, 128]), torch.Size([1, 4614, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3589286804199219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.45761871337890625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4614, 128])
m.shape torch.Size([3844, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4627504348754883  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4627504348754883  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3844, 128]), torch.Size([1, 3844, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4666619300842285  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5734891891479492  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3844, 128])
m.shape torch.Size([3398, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5797576904296875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5797576904296875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3398, 128]), torch.Size([1, 3398, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5830297470092773  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7020163536071777  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3398, 128])
m.shape torch.Size([2748, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7082581520080566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7082581520080566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2748, 128]), torch.Size([1, 2748, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7114205360412598  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8247084617614746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2748, 128])
m.shape torch.Size([2436, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8315291404724121  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8315291404724121  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2436, 128]), torch.Size([1, 2436, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8339018821716309  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.955625057220459  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2436, 128])
m.shape torch.Size([2221, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9629359245300293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9629359245300293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2221, 128]), torch.Size([1, 2221, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9651565551757812  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.088698387145996  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2221, 128])
m.shape torch.Size([1870, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0956645011901855  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0956645011901855  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1870, 128]), torch.Size([1, 1870, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0974478721618652  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.2123894691467285  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1870, 128])
m.shape torch.Size([19693, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.30540132522583  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.30540132522583  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 19693, 128]), torch.Size([1, 19693, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.32493257522583  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6658682823181152  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 19693, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.52280855178833  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.5718350410461426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.620861530303955  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.5714516639709473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([51408, 256])
first layer input nodes number: 92318
first layer output nodes number: 51408
edges number: 327129
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.621551513671875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6705780029296875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6828346252441406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6828346252441406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3908, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.8381094932556152  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.8381094932556152  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3908, 256]), torch.Size([1, 3908, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.8455634117126465  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9071927070617676  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3908, 256])
m.shape torch.Size([3251, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.909715175628662  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.909715175628662  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3251, 256]), torch.Size([1, 3251, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9165425300598145  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.012341022491455  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3251, 256])
m.shape torch.Size([2473, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.016425609588623  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.016425609588623  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2473, 256]), torch.Size([1, 2473, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.021472454071045  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1332554817199707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2473, 256])
m.shape torch.Size([1939, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1377081871032715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1377081871032715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1939, 256]), torch.Size([1, 1939, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1416754722595215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.248995304107666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1939, 256])
m.shape torch.Size([1664, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2551426887512207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2551426887512207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1664, 256]), torch.Size([1, 1664, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2584500312805176  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.377175807952881  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1664, 256])
m.shape torch.Size([1198, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.382497787475586  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.382497787475586  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1198, 256]), torch.Size([1, 1198, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3848037719726562  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.484755516052246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1198, 256])
m.shape torch.Size([1039, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.490311622619629  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.490311622619629  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1039, 256]), torch.Size([1, 1039, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.492377281188965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.598484992980957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1039, 256])
m.shape torch.Size([893, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.604360580444336  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.604360580444336  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 893, 256]), torch.Size([1, 893, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6060638427734375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7036914825439453  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 893, 256])
m.shape torch.Size([714, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7090163230895996  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7090163230895996  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7103781700134277  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7989325523376465  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([623, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8042397499084473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8042397499084473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 623, 256]), torch.Size([1, 623, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8054280281066895  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.891453266143799  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 623, 256])
m.shape torch.Size([494, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8961715698242188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8961715698242188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.897113800048828  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9727249145507812  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([459, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.977548122406006  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.977548122406006  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.978423595428467  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.053384304046631  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([386, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.058507919311523  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.058507919311523  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.059244155883789  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.127979278564453  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([333, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.132091999053955  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.132091999053955  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.132727146148682  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.1971516609191895  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([265, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.200654983520508  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.200654983520508  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.201160430908203  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.255742073059082  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([241, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.259195804595947  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.259195804595947  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.259655475616455  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.311598300933838  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([213, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.314848899841309  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.314848899841309  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.315255165100098  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.364006996154785  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([186, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.36713171005249  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.36713171005249  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.367486476898193  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.41254186630249  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([176, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.415578842163086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.415578842163086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.415914535522461  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.460897445678711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([168, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.463959217071533  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.463959217071533  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.464279651641846  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.509460926055908  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([119, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.511703014373779  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.511703014373779  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.511929988861084  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.545522212982178  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.547713756561279  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.547713756561279  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.547921657562256  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.580146312713623  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([86, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.581943511962891  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.581943511962891  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.5821075439453125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.608680725097656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([106, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.611043930053711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.611043930053711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.611246109008789  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.645414352416992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([1479, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.680850982666016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.680850982666016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1479, 256]), torch.Size([1, 1479, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.683671951293945  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.18016242980957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1479, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.048242092132568  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.052174091339111  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.055530548095703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.051430702209473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22522, 40])
input nodes number: 51408
output nodes number: 22522
edges number: 156686
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.052309036254883  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.052309513092041  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06531047821044922  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0708608627319336  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0708608627319336  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038995563983917236 |0.08710414171218872 |0.27502161264419556 |0.00013452768325805664 |0.10056036710739136 |0.005391359329223633 |
----------------------------------------------------------pseudo_mini_loss sum 5.32510232925415
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  487066
Number of first layer input nodes during this epoch:  292787
Number of first layer output nodes during this epoch:  194279
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07086038589477539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.017753124237060547
global_2_local spend time (sec) 0.04226231575012207
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004271745681762695
A = g.adjacency_matrix() spent  0.007764339447021484
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08065462112426758
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3297522068023682
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1919662952423096

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w][04:19:37] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27802158 edges into 4 parts and get 1793784 edge cuts

the counter of shared neigbor distribution
Counter({1.0: 18720996, 2.0: 3229533, 3.0: 807748, 4.0: 243722, 5.0: 89337, 6.0: 38108, 7.0: 18016, 8.0: 9112, 9.0: 4890, 10.0: 2746, 11.0: 1644, 12.0: 893, 13.0: 552, 14.0: 337, 15.0: 196, 16.0: 180, 17.0: 140, 18.0: 67, 19.0: 54, 20.0: 11, 21.0: 10})
Convert a graph into a bidirected graph: 1.144 seconds
Metis partitioning: 4.967 seconds
Split the graph: 2.603 seconds
Construct subgraphs: 0.054 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.782250881195068
23179
22385
22926
22451
total k batches seeds list generation spend  21.291558980941772
after graph partition
graph partition algorithm spend time 21.39703893661499
23179
22385
22926
22451
partition_len_list
[40172, 35193, 69004, 53352]
shared_neighbor_graph_partition_s0 selection method  spend 21.489322423934937
time for parepare:  0.017876148223876953
local_output_nid generation:  0.003283977508544922
local_in_edges_tensor generation:  0.0035610198974609375
mini_batch_src_global generation:  0.005259275436401367
r_  generation:  0.05504894256591797
local_output_nid generation:  0.0038652420043945312
local_in_edges_tensor generation:  0.004172801971435547
mini_batch_src_global generation:  0.009742021560668945
r_  generation:  0.05933713912963867
local_output_nid generation:  0.003876924514770508
local_in_edges_tensor generation:  0.0052411556243896484
mini_batch_src_global generation:  0.009494543075561523
r_  generation:  0.08693313598632812
local_output_nid generation:  0.004263639450073242
local_in_edges_tensor generation:  0.003503084182739258
mini_batch_src_global generation:  0.006861209869384766
r_  generation:  0.05730795860290527
----------------------check_connections_block total spend ----------------------------- 0.40827393531799316
generate_one_block  0.08731627464294434
generate_one_block  0.07717370986938477
generate_one_block  0.12612318992614746
generate_one_block  0.07108187675476074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04861116409301758
gen group dst list time:  0.005514383316040039
time for parepare:  0.02017688751220703
local_output_nid generation:  0.006086111068725586
local_in_edges_tensor generation:  0.09472179412841797
mini_batch_src_global generation:  0.030414342880249023
r_  generation:  0.08545732498168945
local_output_nid generation:  0.00714564323425293
local_in_edges_tensor generation:  0.008516073226928711
mini_batch_src_global generation:  0.009486675262451172
r_  generation:  0.07904052734375
local_output_nid generation:  0.011376619338989258
local_in_edges_tensor generation:  0.014744281768798828
mini_batch_src_global generation:  0.02928948402404785
r_  generation:  0.1967461109161377
local_output_nid generation:  0.013728857040405273
local_in_edges_tensor generation:  0.008945226669311523
mini_batch_src_global generation:  0.016775131225585938
r_  generation:  0.14706659317016602
----------------------check_connections_block total spend ----------------------------- 0.9119338989257812
generate_one_block  0.11512088775634766
generate_one_block  0.09892940521240234
generate_one_block  0.2566685676574707
generate_one_block  0.1715090274810791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07086038589477539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

connection checking time:  0.9119338989257812
block generation total time  0.6422278881072998
average batch blocks generation time:  0.16055697202682495
block dataloader generation time/epoch 24.026466608047485
pseudo mini batch 0 input nodes size: 62245
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05922365188598633  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05922365188598633  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.08890438079833984  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.08907747268676758  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.044888973236083984  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.047770023345947266  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.047770023345947266  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.047770023345947266  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([62245, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.047770023345947266  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([4920, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.16216468811035156  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.16216468811035156  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4920, 128]), torch.Size([1, 4920, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.16764020919799805  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.20517683029174805  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4920, 128])
m.shape torch.Size([5000, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.20759916305541992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.20759916305541992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5000, 128]), torch.Size([1, 5000, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.21236753463745117  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2838931083679199  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5000, 128])
m.shape torch.Size([4301, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2876615524291992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2876615524291992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4301, 128]), torch.Size([1, 4301, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2920255661010742  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.38365650177001953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4301, 128])
m.shape torch.Size([3633, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3882894515991211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3882894515991211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3633, 128]), torch.Size([1, 3633, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.39292049407958984  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4958682060241699  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3633, 128])
m.shape torch.Size([3110, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5015506744384766  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5015506744384766  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3110, 128]), torch.Size([1, 3110, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5047659873962402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6128029823303223  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3110, 128])
m.shape torch.Size([2521, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.618532657623291  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.618532657623291  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2521, 128]), torch.Size([1, 2521, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6214652061462402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7326192855834961  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2521, 128])
m.shape torch.Size([2084, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7383322715759277  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7383322715759277  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2084, 128]), torch.Size([1, 2084, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7403712272644043  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8425498008728027  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2084, 128])
m.shape torch.Size([1909, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8485121726989746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8485121726989746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1909, 128]), torch.Size([1, 1909, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8503327369689941  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9541049003601074  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1909, 128])
m.shape torch.Size([1569, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.959928035736084  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.959928035736084  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1569, 128]), torch.Size([1, 1569, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9614243507385254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0580158233642578  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1569, 128])
m.shape torch.Size([11125, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1103157997131348  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1103157997131348  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 11125, 128]), torch.Size([1, 11125, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1209254264831543  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.8821625709533691  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 11125, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7866110801696777  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.8256735801696777  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.8639845848083496  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.824622631072998  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([40172, 256])
first layer input nodes number: 62245
first layer output nodes number: 40172
edges number: 228262
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.864450454711914  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.903512954711914  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.912339210510254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.912339210510254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3588, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0690131187438965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0690131187438965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3588, 256]), torch.Size([1, 3588, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.076246738433838  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.1317901611328125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3588, 256])
m.shape torch.Size([3274, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.134467124938965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.134467124938965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3274, 256]), torch.Size([1, 3274, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.1417007446289062  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2361679077148438  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3274, 256])
m.shape torch.Size([2616, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.240588665008545  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.240588665008545  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2616, 256]), torch.Size([1, 2616, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.246032238006592  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.356658458709717  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2616, 256])
m.shape torch.Size([2107, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.3622641563415527  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.3622641563415527  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2107, 256]), torch.Size([1, 2107, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.3663687705993652  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.485494613647461  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2107, 256])
m.shape torch.Size([1773, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.4920058250427246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.4920058250427246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1773, 256]), torch.Size([1, 1773, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.495983600616455  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.621152400970459  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1773, 256])
m.shape torch.Size([1372, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.627373695373535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.627373695373535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1372, 256]), torch.Size([1, 1372, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6300249099731445  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.74729061126709  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1372, 256])
m.shape torch.Size([1130, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7533788681030273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7533788681030273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1130, 256]), torch.Size([1, 1130, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.755794048309326  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.867764949798584  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1130, 256])
m.shape torch.Size([1038, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.874535083770752  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.874535083770752  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1038, 256]), torch.Size([1, 1038, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.876957416534424  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.993805408477783  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1038, 256])
m.shape torch.Size([814, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.999856948852539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.999856948852539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 814, 256]), torch.Size([1, 814, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0014095306396484  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.106962203979492  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 814, 256])
m.shape torch.Size([709, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1130003929138184  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1130003929138184  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1143527030944824  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2135119438171387  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([539, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.218534469604492  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.218534469604492  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.219562530517578  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.300642967224121  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([494, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3058266639709473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3058266639709473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3067688941955566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3894333839416504  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([426, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.394285202026367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.394285202026367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3950977325439453  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.469999313354492  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([355, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.474370002746582  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.474370002746582  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4750471115112305  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.543391227722168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([347, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.548055648803711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.548055648803711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.548717498779297  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6188735961914062  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([251, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6224026679992676  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6224026679992676  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6228814125061035  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6769795417785645  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([224, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6804003715515137  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6804003715515137  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6808276176452637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7320971488952637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([189, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7351536750793457  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7351536750793457  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7355141639709473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7812962532043457  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([166, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7841477394104004  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7841477394104004  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7844643592834473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8268914222717285  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([158, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.829770565032959  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.829770565032959  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8300719261169434  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8725638389587402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([128, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8749966621398926  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8749966621398926  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8752408027648926  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9113736152648926  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([125, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9138946533203125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9138946533203125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.914133071899414  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9510879516601562  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([95, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9530692100524902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9530692100524902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9532504081726074  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.982604503631592  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([94, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.984682559967041  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.984682559967041  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9848618507385254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.015161991119385  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([1167, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.0431132316589355  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.0431132316589355  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1167, 256]), torch.Size([1, 1167, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.045835971832275  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.450968265533447  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1167, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.318697929382324  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.322329521179199  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.325783729553223  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.32197904586792  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([23179, 40])
input nodes number: 40172
output nodes number: 23179
edges number: 158303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.322151184082031  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.322152137756348  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05315351486206055  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

pseudo mini batch 1 input nodes size: 49465
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04458951950073242  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04458951950073242  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06817626953125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0683431625366211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.038489341735839844  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04136943817138672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04136943817138672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04136943817138672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([49465, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04136943817138672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3994, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.14614105224609375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.14614105224609375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3994, 128]), torch.Size([1, 3994, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1499500274658203  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.18100547790527344  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3994, 128])
m.shape torch.Size([4005, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1829204559326172  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1829204559326172  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4005, 128]), torch.Size([1, 4005, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1870265007019043  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.24509954452514648  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4005, 128])
m.shape torch.Size([3555, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.24917936325073242  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.24917936325073242  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3555, 128]), torch.Size([1, 3555, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.25298500061035156  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3300762176513672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3555, 128])
m.shape torch.Size([2997, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3334078788757324  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3334078788757324  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2997, 128]), torch.Size([1, 2997, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.337369441986084  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4250144958496094  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2997, 128])
m.shape torch.Size([2517, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.42958641052246094  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.42958641052246094  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2517, 128]), torch.Size([1, 2517, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.43221569061279297  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5201635360717773  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2517, 128])
m.shape torch.Size([2183, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5252089500427246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5252089500427246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2183, 128]), torch.Size([1, 2183, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5274500846862793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.621589183807373  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2183, 128])
m.shape torch.Size([1814, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6259994506835938  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6259994506835938  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1814, 128]), torch.Size([1, 1814, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6277294158935547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7142276763916016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1814, 128])
m.shape torch.Size([1621, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7195463180541992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7195463180541992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7210922241210938  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.809208869934082  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([1391, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8144054412841797  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8144054412841797  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1391, 128]), torch.Size([1, 1391, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8157320022583008  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.904120922088623  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1391, 128])
m.shape torch.Size([11116, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9564628601074219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9564628601074219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 11116, 128]), torch.Size([1, 11116, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9670639038085938  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7282066345214844  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 11116, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.6383070945739746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.6718697547912598  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.705432415008545  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.671607494354248  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([35193, 256])
first layer input nodes number: 49465
first layer output nodes number: 35193
edges number: 209685
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7058029174804688  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.739365577697754  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7477564811706543  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7477564811706543  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3108, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9218268394470215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9218268394470215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3108, 256]), torch.Size([1, 3108, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9290862083435059  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.979173183441162  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3108, 256])
m.shape torch.Size([2773, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9810848236083984  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9810848236083984  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2773, 256]), torch.Size([1, 2773, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9865846633911133  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.065920829772949  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2773, 256])
m.shape torch.Size([2329, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0699920654296875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0699920654296875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2329, 256]), torch.Size([1, 2329, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0744552612304688  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.1732797622680664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2329, 256])
m.shape torch.Size([1856, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.178194046020508  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.178194046020508  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1856, 256]), torch.Size([1, 1856, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.1818337440490723  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2855381965637207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1856, 256])
m.shape torch.Size([1563, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2912187576293945  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2912187576293945  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1563, 256]), torch.Size([1, 1563, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2944211959838867  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.404654026031494  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1563, 256])
m.shape torch.Size([1307, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.410080909729004  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.410080909729004  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1307, 256]), torch.Size([1, 1307, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.4136343002319336  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.5259132385253906  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1307, 256])
m.shape torch.Size([1070, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.531367301940918  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.531367301940918  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1070, 256]), torch.Size([1, 1070, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.5336084365844727  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.63675594329834  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1070, 256])
m.shape torch.Size([931, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6428942680358887  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6428942680358887  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 931, 256]), torch.Size([1, 931, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.644670009613037  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.745887279510498  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 931, 256])
m.shape torch.Size([809, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.751997470855713  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.751997470855713  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.753540515899658  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.852295398712158  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([706, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.858309745788574  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.858309745788574  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.85965633392334  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9574718475341797  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([644, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9636073112487793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9636073112487793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9648356437683105  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0611376762390137  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([513, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0664405822753906  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0664405822753906  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0674190521240234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.151721954345703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([458, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1569557189941406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1569557189941406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1578292846679688  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.239835739135742  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([401, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2449951171875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2449951171875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.245759963989258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.321582794189453  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([330, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.325958251953125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.325958251953125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.326587677001953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.395589828491211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([299, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3998732566833496  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3998732566833496  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4004435539245605  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.465524196624756  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([307, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4702553749084473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4702553749084473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4708409309387207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5433783531188965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([242, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5474252700805664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5474252700805664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.547886848449707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6065073013305664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([202, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6099653244018555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6099653244018555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6103506088256836  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6619787216186523  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([227, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.666149616241455  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.666149616241455  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6665825843811035  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.727631092071533  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([197, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.731390953063965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.731390953063965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.731766700744629  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.78737735748291  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([135, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7900443077087402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7900443077087402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.79030179977417  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8302130699157715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([140, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.833179473876953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.833179473876953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.833446502685547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8767051696777344  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([128, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8795242309570312  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8795242309570312  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8797683715820312  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9210281372070312  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([1710, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.961994171142578  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.961994171142578  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1710, 256]), torch.Size([1, 1710, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.965317726135254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.539647102355957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1710, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.389237403869629  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.392867088317871  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.39620304107666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.392406463623047  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22385, 40])
input nodes number: 35193
output nodes number: 22385
edges number: 176645
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.392833709716797  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.392834186553955  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.046970367431640625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

pseudo mini batch 2 input nodes size: 93791
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.03848743438720703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.03848743438720703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.08321046829223633  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.08338165283203125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05962800979614258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0657052993774414  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0657052993774414  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0657052993774414  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([93791, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.0657052993774414  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3977, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.32805347442626953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.32805347442626953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3977, 128]), torch.Size([1, 3977, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.33210182189941406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.363039493560791  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3977, 128])
m.shape torch.Size([4134, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3650856018066406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3650856018066406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4134, 128]), torch.Size([1, 4134, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3692936897277832  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.42843103408813477  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4134, 128])
m.shape torch.Size([3697, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4322648048400879  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4322648048400879  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3697, 128]), torch.Size([1, 3697, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.43593788146972656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5143442153930664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3697, 128])
m.shape torch.Size([3352, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5188937187194824  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5188937187194824  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3352, 128]), torch.Size([1, 3352, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5225629806518555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6174116134643555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3352, 128])
m.shape torch.Size([3203, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.623805046081543  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.623805046081543  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3203, 128]), torch.Size([1, 3203, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.627281665802002  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7372479438781738  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3203, 128])
m.shape torch.Size([2856, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.743891716003418  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.743891716003418  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2856, 128]), torch.Size([1, 2856, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7468328475952148  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8677453994750977  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2856, 128])
m.shape torch.Size([2763, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8756060600280762  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8756060600280762  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2763, 128]), torch.Size([1, 2763, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8782854080200195  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0113210678100586  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2763, 128])
m.shape torch.Size([2561, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.019773006439209  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.019773006439209  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2561, 128]), torch.Size([1, 2561, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0223002433776855  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.162400722503662  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2561, 128])
m.shape torch.Size([2458, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1717281341552734  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1717281341552734  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2458, 128]), torch.Size([1, 2458, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1741142272949219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.3306822776794434  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2458, 128])
m.shape torch.Size([40003, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.52091646194458  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.52091646194458  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 40003, 128]), torch.Size([1, 40003, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.55997896194458  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.2781453132629395  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 40003, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.034275531768799  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.100082874298096  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.165890216827393  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.0995683670043945  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([69004, 256])
first layer input nodes number: 93791
first layer output nodes number: 69004
edges number: 531876
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.166591167449951  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.232398509979248  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.248850345611572  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.248850345611572  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([2643, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.503539562225342  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.503539562225342  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2643, 256]), torch.Size([1, 2643, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.509842395782471  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.550171375274658  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2643, 256])
m.shape torch.Size([2294, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.5527262687683105  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.5527262687683105  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2294, 256]), torch.Size([1, 2294, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.557215690612793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.62424373626709  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2294, 256])
m.shape torch.Size([1780, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.627188682556152  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.627188682556152  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1780, 256]), torch.Size([1, 1780, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.630776882171631  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.706490993499756  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1780, 256])
m.shape torch.Size([1378, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.710658073425293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.710658073425293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1378, 256]), torch.Size([1, 1378, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.713446140289307  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.796337127685547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1378, 256])
m.shape torch.Size([1241, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.800475597381592  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.800475597381592  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1241, 256]), torch.Size([1, 1241, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.803522109985352  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.897760391235352  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1241, 256])
m.shape torch.Size([957, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.902095794677734  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.902095794677734  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 957, 256]), torch.Size([1, 957, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.903921127319336  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.98356819152832  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 957, 256])
m.shape torch.Size([800, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.988038063049316  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.988038063049316  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.989563941955566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.065857887268066  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([670, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.070246696472168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.070246696472168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.071524620056152  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.144366264343262  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([662, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.149454116821289  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.149454116821289  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.150716781616211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.231527328491211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([590, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.23656702041626  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.23656702041626  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.237692356109619  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.317780017852783  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([529, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.322810173034668  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.322810173034668  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.323819160461426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.403440475463867  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([504, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.408749103546143  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.408749103546143  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.40971040725708  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.492397785186768  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([428, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.497264862060547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.497264862060547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.498081207275391  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.574462890625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([376, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.5791144371032715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.5791144371032715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.579831600189209  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.653958797454834  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([350, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.658646583557129  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.658646583557129  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.659314155578613  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.732436180114746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([330, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.73717737197876  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.73717737197876  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.737806797027588  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.810305118560791  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([299, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.814876079559326  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.814876079559326  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.815446376800537  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.885095119476318  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([319, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.890328884124756  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.890328884124756  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.890937328338623  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.9690775871276855  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([295, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.974160671234131  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.974160671234131  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.9747233390808105  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.05203104019165  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([276, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.057055473327637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.057055473327637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.057581901550293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.133319854736328  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([272, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.138546943664551  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.138546943664551  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.139065742492676  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.218838691711426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([202, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.222850799560547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.222850799560547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.223236083984375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.282955169677734  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([198, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.287139892578125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.287139892578125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.287517547607422  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.348697662353516  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([201, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.353145599365234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.353145599365234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.35352897644043  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.4183197021484375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([5332, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.5462493896484375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.5462493896484375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5332, 256]), torch.Size([1, 5332, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 6.556419372558594  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 8.346336364746094  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5332, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 8.113258361816406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 8.11672592163086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 8.120563507080078  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 8.11692476272583  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22926, 40])
input nodes number: 69004
output nodes number: 22926
edges number: 260857
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 8.117448329925537  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 8.117448806762695  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07589387893676758  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

pseudo mini batch 3 input nodes size: 93789
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.059465885162353516  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.059465885162353516  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1041879653930664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1043553352355957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.059461116790771484  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06397438049316406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06397438049316406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06397438049316406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([93789, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06397438049316406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([5629, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.23205995559692383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.23205995559692383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5629, 128]), torch.Size([1, 5629, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2374281883239746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.28037405014038086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5629, 128])
m.shape torch.Size([5674, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2840404510498047  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2840404510498047  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5674, 128]), torch.Size([1, 5674, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2901015281677246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.37844038009643555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5674, 128])
m.shape torch.Size([4811, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.38172054290771484  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.38172054290771484  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4811, 128]), torch.Size([1, 4811, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.38669872283935547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4878859519958496  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4811, 128])
m.shape torch.Size([4036, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4932899475097656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4932899475097656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4036, 128]), torch.Size([1, 4036, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4975762367248535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6111555099487305  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4036, 128])
m.shape torch.Size([3507, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6173062324523926  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6173062324523926  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3507, 128]), torch.Size([1, 3507, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.621727466583252  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7446298599243164  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3507, 128])
m.shape torch.Size([2875, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.751183032989502  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.751183032989502  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2875, 128]), torch.Size([1, 2875, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7543621063232422  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8786835670471191  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2875, 128])
m.shape torch.Size([2521, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8857274055480957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8857274055480957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2521, 128]), torch.Size([1, 2521, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8883004188537598  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.01029634475708  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2521, 128])
m.shape torch.Size([2238, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0176315307617188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0176315307617188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2238, 128]), torch.Size([1, 2238, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.019848346710205  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1445226669311523  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2238, 128])
m.shape torch.Size([1976, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1519355773925781  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1519355773925781  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1976, 128]), torch.Size([1, 1976, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.1538200378417969  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.2778587341308594  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1976, 128])
m.shape torch.Size([20085, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.3726892471313477  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.3726892471313477  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 20085, 128]), torch.Size([1, 20085, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.3918437957763672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7567138671875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 20085, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6100645065307617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.660944938659668  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.711825370788574  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6605472564697266  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([53352, 256])
first layer input nodes number: 93789
first layer output nodes number: 53352
edges number: 336524
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.712526321411133  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.763406753540039  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7761268615722656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7761268615722656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([4089, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9243340492248535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9243340492248535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4089, 256]), torch.Size([1, 4089, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9328932762145996  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9953532218933105  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4089, 256])
m.shape torch.Size([3365, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.998305320739746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.998305320739746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3365, 256]), torch.Size([1, 3365, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.005462646484375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1022891998291016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3365, 256])
m.shape torch.Size([2552, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1061620712280273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1061620712280273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2552, 256]), torch.Size([1, 2552, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1115517616271973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.219362735748291  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2552, 256])
m.shape torch.Size([1979, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2244763374328613  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2244763374328613  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1979, 256]), torch.Size([1, 1979, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2282910346984863  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3411779403686523  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1979, 256])
m.shape torch.Size([1645, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.347196102142334  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.347196102142334  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1645, 256]), torch.Size([1, 1645, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3506956100463867  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.468709945678711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1645, 256])
m.shape torch.Size([1232, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.474334716796875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.474334716796875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1232, 256]), torch.Size([1, 1232, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4768319129943848  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.585697650909424  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1232, 256])
m.shape torch.Size([1045, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.591221809387207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.591221809387207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1045, 256]), torch.Size([1, 1045, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.593325614929199  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.69718074798584  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1045, 256])
m.shape torch.Size([833, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.702589511871338  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.702589511871338  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 833, 256]), torch.Size([1, 833, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7041783332824707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7961373329162598  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 833, 256])
m.shape torch.Size([691, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8013205528259277  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8013205528259277  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 691, 256]), torch.Size([1, 691, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.802638530731201  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8874096870422363  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 691, 256])
m.shape torch.Size([594, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8924598693847656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8924598693847656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8935928344726562  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.97430419921875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 594, 256])
m.shape torch.Size([491, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.978929042816162  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.978929042816162  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.979865550994873  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.054667949676514  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([426, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.059113025665283  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.059113025665283  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.059925556182861  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.129467487335205  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([344, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.134000301361084  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.134000301361084  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.1346564292907715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.19557523727417  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([302, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.199311256408691  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.199311256408691  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.199887275695801  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.257598876953125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([262, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.2610883712768555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.2610883712768555  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.261588096618652  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.316033363342285  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([231, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.3193359375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.3193359375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.31977653503418  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.369564056396484  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([200, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.372611999511719  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.372611999511719  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.372993469238281  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.418769836425781  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([198, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.422004699707031  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.422004699707031  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.422382354736328  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.470344543457031  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([173, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.473315238952637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.473315238952637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.473645210266113  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.517861366271973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([146, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.520503044128418  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.520503044128418  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.520781517028809  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.560046195983887  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([120, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.562329292297363  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.562329292297363  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.562558174133301  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.596432685852051  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([94, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.598702907562256  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.598702907562256  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.59888219833374  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.626672267913818  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([86, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.628483772277832  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.628483772277832  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes
[04:20:02] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27803442 edges into 4 parts and get 1655013 edge cuts

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.628647804260254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.655220985412598  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([102, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.657492160797119  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.657492160797119  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.657686710357666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.690565586090088  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([1251, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.720527648925781  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.720527648925781  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1251, 256]), torch.Size([1, 1251, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.72291374206543  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.152716636657715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1251, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.0296454429626465  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.033545017242432  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.036890506744385  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.03282356262207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22451, 40])
input nodes number: 53352
output nodes number: 22451
edges number: 148445
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.033266544342041  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 5.033267021179199  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07114934921264648  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07114934921264648  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07114934921264648  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045201778411865234 |0.0037551522254943848 |0.13260668516159058 |0.00010693073272705078 |0.08574700355529785 |0.004814863204956055 |
----------------------------------------------------------pseudo_mini_loss sum 4.606152534484863
Total (block generation + training)time/epoch 25.155163288116455
Training time/epoch 1.128406286239624
Training time without block to device /epoch 1.1133856773376465
Training time without total dataloading part /epoch 0.878657341003418
load block tensor time/epoch 0.18080711364746094
block to device time/epoch 0.015020608901977539
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  497011
Number of first layer input nodes during this epoch:  299290
Number of first layer output nodes during this epoch:  197721
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07114887237548828  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020162343978881836
global_2_local spend time (sec) 0.0469517707824707
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004262685775756836
A = g.adjacency_matrix() spent  0.024039506912231445
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0794062614440918
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3557243347167969
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1640887260437012

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18726793, 2.0: 3227048, 3.0: 807585, 4.0: 243406, 5.0: 88339, 6.0: 38420, 7.0: 17657, 8.0: 9197, 9.0: 4921, 10.0: 2773, 11.0: 1643, 12.0: 917, 13.0: 542, 14.0: 332, 15.0: 191, 16.0: 175, 17.0: 133, 18.0: 67, 19.0: 35, 20.0: 12, 21.0: 6})
Convert a graph into a bidirected graph: 1.129 seconds
Metis partitioning: 5.029 seconds
Split the graph: 2.793 seconds
Construct subgraphs: 0.052 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.016379356384277
23176
22485
22585
22695
total k batches seeds list generation spend  21.26750087738037
after graph partition
graph partition algorithm spend time 21.362778902053833
23176
22485
22585
22695
partition_len_list
[38957, 34717, 51143, 68188]
shared_neighbor_graph_partition_s0 selection method  spend 21.46232843399048
time for parepare:  0.01661849021911621
local_output_nid generation:  0.003327608108520508
local_in_edges_tensor generation:  0.0036766529083251953
mini_batch_src_global generation:  0.0050716400146484375
r_  generation:  0.05411577224731445
local_output_nid generation:  0.0039141178131103516
local_in_edges_tensor generation:  0.0037457942962646484
mini_batch_src_global generation:  0.007175922393798828
r_  generation:  0.06212782859802246
local_output_nid generation:  0.004033565521240234
local_in_edges_tensor generation:  0.0036666393280029297
mini_batch_src_global generation:  0.005629301071166992
r_  generation:  0.05710172653198242
local_output_nid generation:  0.004191160202026367
local_in_edges_tensor generation:  0.004228830337524414
mini_batch_src_global generation:  0.01150369644165039
r_  generation:  0.09062623977661133
----------------------check_connections_block total spend ----------------------------- 0.4059104919433594
generate_one_block  0.07514214515686035
generate_one_block  0.08016610145568848
generate_one_block  0.0739738941192627
generate_one_block  0.12398290634155273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04196810722351074
gen group dst list time:  0.005567789077758789
time for parepare:  0.0242917537689209
local_output_nid generation:  0.006185770034790039
local_in_edges_tensor generation:  0.011939048767089844
mini_batch_src_global generation:  0.0066411495208740234
r_  generation:  0.0794687271118164
local_output_nid generation:  0.007080078125
local_in_edges_tensor generation:  0.005872011184692383
mini_batch_src_global generation:  0.008212804794311523
r_  generation:  0.07641959190368652
local_output_nid generation:  0.010511636734008789
local_in_edges_tensor generation:  0.010762214660644531
mini_batch_src_global generation:  0.011155128479003906
r_  generation:  0.12181377410888672
local_output_nid generation:  0.011348247528076172
local_in_edges_tensor generation:  0.012966632843017578
mini_batch_src_global generation:  0.02689504623413086
r_  generation:  0.2042374610900879
----------------------check_connections_block total spend ----------------------------- 0.7456376552581787
generate_one_block  0.11251378059387207
generate_one_block  0.09798097610473633
generate_one_block  0.15771961212158203
generate_one_block  0.2506577968597412
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.07114887237548828  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

connection checking time:  0.7456376552581787
block generation total time  0.6188721656799316
average batch blocks generation time:  0.1547180414199829
block dataloader generation time/epoch 23.890296459197998
pseudo mini batch 0 input nodes size: 57667
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05933809280395508  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05933809280395508  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.08683586120605469  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.08700895309448242  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.042119503021240234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.044805049896240234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.044805049896240234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.044805049896240234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([57667, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.044805049896240234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([5254, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.15190935134887695  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.15190935134887695  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5254, 128]), torch.Size([1, 5254, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1569199562072754  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1970047950744629  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5254, 128])
m.shape torch.Size([5248, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1995100975036621  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1995100975036621  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5248, 128]), torch.Size([1, 5248, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2045149803161621  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2795882225036621  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5248, 128])
m.shape torch.Size([4444, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.28344297409057617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.28344297409057617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4444, 128]), torch.Size([1, 4444, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2884211540222168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.38453245162963867  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4444, 128])
m.shape torch.Size([3631, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3895106315612793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3895106315612793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3631, 128]), torch.Size([1, 3631, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3933382034301758  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.49481630325317383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3631, 128])
m.shape torch.Size([3012, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5002646446228027  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5002646446228027  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3012, 128]), torch.Size([1, 3012, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5035929679870605  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6108546257019043  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3012, 128])
m.shape torch.Size([2453, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6161398887634277  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6161398887634277  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2453, 128]), torch.Size([1, 2453, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6190423965454102  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7228298187255859  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2453, 128])
m.shape torch.Size([2008, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7283625602722168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7283625602722168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2008, 128]), torch.Size([1, 2008, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7302775382995605  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8271708488464355  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2008, 128])
m.shape torch.Size([1810, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8331179618835449  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8331179618835449  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1810, 128]), torch.Size([1, 1810, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8348441123962402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.933234691619873  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1810, 128])
m.shape torch.Size([1490, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9387660026550293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9387660026550293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1490, 128]), torch.Size([1, 1490, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9401869773864746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0311675071716309  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1490, 128])
m.shape torch.Size([9607, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0762667655944824  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0762667655944824  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 9607, 128]), torch.Size([1, 9607, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.0854287147521973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7359271049499512  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 9607, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.6477174758911133  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.6848697662353516  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7220220565795898  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.6845793724060059  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([38957, 256])
first layer input nodes number: 57667
first layer output nodes number: 38957
edges number: 211400
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7224540710449219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7596063613891602  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7693290710449219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7693290710449219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3890, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.917696475982666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.917696475982666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3890, 256]), torch.Size([1, 3890, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9251160621643066  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9844727516174316  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3890, 256])
m.shape torch.Size([3447, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.988234043121338  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.988234043121338  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3447, 256]), torch.Size([1, 3447, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9948086738586426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.093428134918213  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3447, 256])
m.shape torch.Size([2728, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0980067253112793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0980067253112793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2728, 256]), torch.Size([1, 2728, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.104177951812744  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2206215858459473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2728, 256])
m.shape torch.Size([2108, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2261242866516113  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2261242866516113  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2108, 256]), torch.Size([1, 2108, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2305006980895996  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.3511509895324707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2108, 256])
m.shape torch.Size([1769, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.357147216796875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.357147216796875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1769, 256]), torch.Size([1, 1769, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.360647678375244  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.4842238426208496  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1769, 256])
m.shape torch.Size([1365, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.490408420562744  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.490408420562744  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1365, 256]), torch.Size([1, 1365, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.4930672645568848  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6116604804992676  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1365, 256])
m.shape torch.Size([1123, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6179141998291016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6179141998291016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1123, 256]), torch.Size([1, 1123, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6200809478759766  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7280688285827637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1123, 256])
m.shape torch.Size([993, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7344970703125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7344970703125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 993, 256]), torch.Size([1, 993, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.736391067504883  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.8473052978515625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 993, 256])
m.shape torch.Size([778, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.85308837890625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.85308837890625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 778, 256]), torch.Size([1, 778, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.854572296142578  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9500417709350586  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 778, 256])
m.shape torch.Size([681, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.955845355987549  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.955845355987549  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.957144260406494  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0496602058410645  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([542, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.054741382598877  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.054741382598877  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0557751655578613  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1404786109924316  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([451, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1451635360717773  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1451635360717773  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.146023750305176  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2206106185913086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([382, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2249536514282227  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2249536514282227  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.225682258605957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2949819564819336  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([316, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.298870086669922  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.298870086669922  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2994728088378906  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.359868049621582  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([316, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3641228675842285  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3641228675842285  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3647255897521973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4297471046447754  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([237, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4330906867980957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4330906867980957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4335427284240723  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.484623432159424  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([205, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.488284111022949  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.488284111022949  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.488675117492676  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5355958938598633  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([181, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.53853178024292  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.53853178024292  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.538877010345459  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.58272123336792  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([168, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5856165885925293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5856165885925293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.585937023162842  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.628875255584717  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([144, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6314830780029297  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6314830780029297  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6317577362060547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6704845428466797  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([115, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.67266845703125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.67266845703125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6728878021240234  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.705350875854492  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([104, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7074403762817383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7074403762817383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.707638740539551  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7383852005004883  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([94, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7403640747070312  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7403640747070312  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7405433654785156  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7695884704589844  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([81, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7713675498962402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7713675498962402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.771522045135498  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7976317405700684  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([958, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8211708068847656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8211708068847656  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.822998046875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.14459228515625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 958, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.022031307220459  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.025741100311279  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.0291948318481445  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.0253119468688965  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([23176, 40])
input nodes number: 38957
output nodes number: 23176
edges number: 148922
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.026139736175537  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 4.0261406898498535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.05052757263183594  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

pseudo mini batch 1 input nodes size: 49474
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04248476028442383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04248476028442383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06607580184936523  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.06624364852905273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.03857278823852539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04150533676147461  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04150533676147461  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04150533676147461  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([49474, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.04150533676147461  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3715, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1465902328491211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1465902328491211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3715, 128]), torch.Size([1, 3715, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.1501331329345703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.17881011962890625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3715, 128])
m.shape torch.Size([3870, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.18072938919067383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.18072938919067383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3870, 128]), torch.Size([1, 3870, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.18528270721435547  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.2425832748413086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3870, 128])
m.shape torch.Size([3432, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.24564743041992188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.24564743041992188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3432, 128]), torch.Size([1, 3432, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.24926424026489258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3218502998352051  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3432, 128])
m.shape torch.Size([2885, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.325716495513916  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.325716495513916  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2885, 128]), torch.Size([1, 2885, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.3292527198791504  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4093136787414551  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2885, 128])
m.shape torch.Size([2517, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4139389991760254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4139389991760254  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2517, 128]), torch.Size([1, 2517, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.4165029525756836  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5064148902893066  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2517, 128])
m.shape torch.Size([2083, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.511174201965332  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.511174201965332  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2083, 128]), torch.Size([1, 2083, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.5132842063903809  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6006383895874023  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2083, 128])
m.shape torch.Size([1795, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6056365966796875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6056365966796875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1795, 128]), torch.Size([1, 1795, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6073484420776367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6931562423706055  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1795, 128])
m.shape torch.Size([1591, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6983695030212402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6983695030212402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.6998867988586426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7871522903442383  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1317, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7920455932617188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7920455932617188  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1317, 128]), torch.Size([1, 1317, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.7933015823364258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.8736848831176758  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1317, 128])
m.shape torch.Size([11512, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.927950382232666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.927950382232666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 11512, 128]), torch.Size([1, 11512, 128])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 0.9389290809631348  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7196907997131348  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 11512, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.6290130615234375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.6621217727661133  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.695230484008789  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.661862850189209  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([34717, 256])
first layer input nodes number: 49474
first layer output nodes number: 34717
edges number: 210640
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.695601463317871  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.7287101745605469  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.736987590789795  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.736987590789795  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([2917, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9165654182434082  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9165654182434082  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2917, 256]), torch.Size([1, 2917, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9225025177001953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.968346118927002  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2917, 256])
m.shape torch.Size([2677, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9706482887268066  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9706482887268066  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2677, 256]), torch.Size([1, 2677, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 1.9757542610168457  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.053088665008545  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2677, 256])
m.shape torch.Size([2295, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0571532249450684  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0571532249450684  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2295, 256]), torch.Size([1, 2295, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.0618295669555664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.1623830795288086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2295, 256])
m.shape torch.Size([1883, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.167433738708496  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.167433738708496  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1883, 256]), torch.Size([1, 1883, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.171231269836426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.276371955871582  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1883, 256])
m.shape torch.Size([1575, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2821455001831055  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.2821455001831055  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1575, 256]), torch.Size([1, 1575, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.285553455352783  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.395113468170166  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1575, 256])
m.shape torch.Size([1303, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.4004669189453125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.4004669189453125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1303, 256]), torch.Size([1, 1303, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.40301513671875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.5144152641296387  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1303, 256])
m.shape torch.Size([1108, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.519735813140869  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.519735813140869  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1108, 256]), torch.Size([1, 1108, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.5218992233276367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.63193941116333  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1108, 256])
m.shape torch.Size([927, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6378235816955566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.6378235816955566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 927, 256]), torch.Size([1, 927, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.639591693878174  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7403740882873535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 927, 256])
m.shape torch.Size([814, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7465314865112305  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.7465314865112305  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 814, 256]), torch.Size([1, 814, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.74808406829834  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.851260185241699  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 814, 256])
m.shape torch.Size([760, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.857788562774658  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.857788562774658  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.8592381477355957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.962433338165283  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([651, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9685912132263184  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9685912132263184  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 2.9698328971862793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0666842460632324  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([547, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0732269287109375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.0732269287109375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.074270248413086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.1656494140625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([475, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.17106294631958  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.17106294631958  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.171968936920166  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.2562804222106934  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([420, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.261478900909424  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.261478900909424  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.262279987335205  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3424267768859863  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([356, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.347158908843994  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.347158908843994  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.3478379249572754  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.421675205230713  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([298, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4259185791015625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4259185791015625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4264869689941406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4920883178710938  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([318, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.497000217437744  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.497000217437744  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.4976067543029785  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5707650184631348  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([253, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5748391151428223  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.5748391151428223  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.575321674346924  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6366066932678223  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([211, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.640218734741211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.640218734741211  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6406211853027344  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.694549560546875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([241, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.698981285095215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.698981285095215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.6994409561157227  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.764254570007324  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([211, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7682838439941406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.7682838439941406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.768686294555664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.828248977661133  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([147, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8311562538146973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8311562538146973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8314366340637207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8748955726623535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([142, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.877894878387451  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.877894878387451  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.8781657218933105  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9220423698425293  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([139, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9251136779785156  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9251136779785156  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.5291748046875 GB
    Memory Allocated: 3.9253787994384766  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 3.970184326171875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([1817, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.013710975646973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.013710975646973  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1817, 256]), torch.Size([1, 1817, 256])
----------------------------------------3
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.017176628112793  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.635124206542969  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1817, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.479185104370117  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.4825358390808105  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.485886573791504  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.482367992401123  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22485, 40])
input nodes number: 34717
output nodes number: 22485
edges number: 182848
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.482435703277588  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 4.482436180114746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.04683971405029297  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

pseudo mini batch 2 input nodes size: 90546
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.03821372985839844  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.03821372985839844  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.0813894271850586  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.0815577507019043  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.05779886245727539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([90546, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([5408, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.22155094146728516  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.22155094146728516  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5408, 128]), torch.Size([1, 5408, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.22670841217041016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.26796817779541016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5408, 128])
m.shape torch.Size([5428, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.2705659866333008  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.2705659866333008  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 5428, 128]), torch.Size([1, 5428, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.2757425308227539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.3533906936645508  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5428, 128])
m.shape torch.Size([4635, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.35743284225463867  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.35743284225463867  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4635, 128]), torch.Size([1, 4635, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.3622121810913086  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.46154356002807617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4635, 128])
m.shape torch.Size([3917, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.46680450439453125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.46680450439453125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3917, 128]), torch.Size([1, 3917, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.4708824157714844  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5826272964477539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3917, 128])
m.shape torch.Size([3435, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5880956649780273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5880956649780273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3435, 128]), torch.Size([1, 3435, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5915536880493164  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.7101855278015137  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3435, 128])
m.shape torch.Size([2781, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.7167372703552246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.7167372703552246  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2781, 128]), torch.Size([1, 2781, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.7194685935974121  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8348274230957031  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2781, 128])
m.shape torch.Size([2420, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8419241905212402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8419241905212402  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2420, 128]), torch.Size([1, 2420, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8445401191711426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.962822437286377  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2420, 128])
m.shape torch.Size([2178, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.9699769020080566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.9699769020080566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2178, 128]), torch.Size([1, 2178, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.9721131324768066  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.09324312210083  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2178, 128])
m.shape torch.Size([1891, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.099482536315918  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.099482536315918  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1891, 128]), torch.Size([1, 1891, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.1012859344482422  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.2176156044006348  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1891, 128])
m.shape torch.Size([19050, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.307551383972168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.307551383972168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 19050, 128]), torch.Size([1, 19050, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.325718879699707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.6157960891723633  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 19050, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.4763870239257812  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.525160789489746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.573934555053711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.5247793197631836  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([51143, 256])
first layer input nodes number: 90546
first layer output nodes number: 51143
edges number: 321581
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.574611186981201  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.623384952545166  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.6355786323547363  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.6355786323547363  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([4038, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.785381317138672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.785381317138672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 4038, 256]), torch.Size([1, 4038, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.7930831909179688  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.8552513122558594  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 4038, 256])
m.shape torch.Size([3368, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.8580846786499023  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.8580846786499023  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3368, 256]), torch.Size([1, 3368, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.8647804260253906  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.962055206298828  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3368, 256])
m.shape torch.Size([2542, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.9661731719970703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.9661731719970703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2542, 256]), torch.Size([1, 2542, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 2.9713401794433594  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.082070827484131  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2542, 256])
m.shape torch.Size([1999, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.086841583251953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.086841583251953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1999, 256]), torch.Size([1, 1999, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.091216564178467  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.2037320137023926  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1999, 256])
m.shape torch.Size([1676, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.2094125747680664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.2094125747680664  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1676, 256]), torch.Size([1, 1676, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.212620735168457  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.3333921432495117  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1676, 256])
m.shape torch.Size([1240, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.338944911956787  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.338944911956787  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1240, 256]), torch.Size([1, 1240, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.3416295051574707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.4515719413757324  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1240, 256])
m.shape torch.Size([1017, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.4569172859191895  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.4569172859191895  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1017, 256]), torch.Size([1, 1017, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.4588570594787598  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.5566468238830566  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1017, 256])
m.shape torch.Size([896, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.5625662803649902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.5625662803649902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.5642752647399902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.6616873741149902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([730, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.667147636413574  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.667147636413574  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.6685400009155273  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.758816719055176  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([548, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.763387680053711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.763387680053711  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.764432907104492  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.841482162475586  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([486, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.846097946166992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.846097946166992  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.847024917602539  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.9194908142089844  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([439, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.92409086227417  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.92409086227417  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.9249281883239746  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.997127056121826  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([367, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.001294136047363  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.001294136047363  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.0019941329956055  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.067285537719727  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([334, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.071430206298828  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.071430206298828  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.0720672607421875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.136138916015625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([257, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.139525890350342  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.139525890350342  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.140016078948975  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.1940388679504395  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([228, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.197299957275391  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.197299957275391  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.197734832763672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.246875762939453  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([199, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.2499098777771  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.2499098777771  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.250289440155029  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.295836925506592  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([189, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.298917293548584  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.298917293548584  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.2992777824401855  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.345059871673584  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([155, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.348601341247559  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.348601341247559  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.3488969802856445  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.38851261138916  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([147, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.391190528869629  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.391190528869629  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.391470909118652  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.431004524230957  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([128, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.43344783782959  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.43344783782959  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.43369197845459  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.46982479095459  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([104, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.471901893615723  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.471901893615723  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.472100257873535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.502846717834473  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([94, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.504825592041016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.504825592041016  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.5050048828125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.534049987792969  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([96, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.536174774169922  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.536174774169922  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.536357879638672  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.567302703857422  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([1308, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.598639965057373  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.598639965057373  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1308, 256]), torch.Size([1, 1308, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.601134777069092  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.053811550140381  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.928492069244385  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.932343006134033  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.935708522796631  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.931689262390137  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22585, 40])
input nodes number: 51143
output nodes number: 22585
edges number: 150929
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.9327392578125  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.932739734649658  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06854009628295898  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

pseudo mini batch 3 input nodes size: 92187
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.05829906463623047  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.05829906463623047  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.10225725173950195  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.10242652893066406  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.0590825080871582  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06591463088989258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06591463088989258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06591463088989258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([92187, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.06591463088989258  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([3854, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.32623767852783203  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.32623767852783203  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3854, 128]), torch.Size([1, 3854, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.3299131393432617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.36095762252807617  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3854, 128])
m.shape torch.Size([3976, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.362795352935791  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.362795352935791  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3976, 128]), torch.Size([1, 3976, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.3672213554382324  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.4251284599304199  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3976, 128])
m.shape torch.Size([3659, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.42812347412109375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.42812347412109375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3659, 128]), torch.Size([1, 3659, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.4326019287109375  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5106620788574219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3659, 128])
m.shape torch.Size([3272, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5154018402099609  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5154018402099609  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3272, 128]), torch.Size([1, 3272, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.5187506675720215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.6132388114929199  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3272, 128])
m.shape torch.Size([3103, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.6190767288208008  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.6190767288208008  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 3103, 128]), torch.Size([1, 3103, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.6221165657043457  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.7304263114929199  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 3103, 128])
m.shape torch.Size([2859, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.737126350402832  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.737126350402832  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2859, 128]), torch.Size([1, 2859, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.7399692535400391  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8598833084106445  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2859, 128])
m.shape torch.Size([2681, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8670234680175781  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8670234680175781  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2681, 128]), torch.Size([1, 2681, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.8701105117797852  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.000596523284912  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2681, 128])
m.shape torch.Size([2537, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.0089960098266602  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.0089960098266602  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2537, 128]), torch.Size([1, 2537, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.0114965438842773  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.1518259048461914  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2537, 128])
m.shape torch.Size([2430, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.161503791809082  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.161503791809082  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2430, 128]), torch.Size([1, 2430, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.1638526916503906  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.3121681213378906  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2430, 128])
m.shape torch.Size([39817, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.5008716583251953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.5008716583251953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 39817, 128]), torch.Size([1, 39817, 128])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 1.5399341583251953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.247968673706055  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 39817, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.005540370941162  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.0705695152282715  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.135598659515381  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.070061206817627  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([68188, 256])
first layer input nodes number: 92187
first layer output nodes number: 68188
edges number: 527643
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.136287689208984  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.201316833496094  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.217574119567871  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.217574119567871  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

m.shape torch.Size([2583, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.4723615646362305  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.4723615646362305  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2583, 256]), torch.Size([1, 2583, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.478277206420898  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.517941474914551  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2583, 256])
m.shape torch.Size([2214, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.520438194274902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.520438194274902  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 2214, 256]), torch.Size([1, 2214, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.524768829345703  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.588523864746094  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 2214, 256])
m.shape torch.Size([1712, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.591280460357666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.591280460357666  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1712, 256]), torch.Size([1, 1712, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.594658851623535  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.6698455810546875  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1712, 256])
m.shape torch.Size([1330, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.672779083251953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.672779083251953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1330, 256]), torch.Size([1, 1330, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.675527572631836  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.753880500793457  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1330, 256])
m.shape torch.Size([1202, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.757476806640625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.757476806640625  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.759941101074219  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.842813491821289  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([960, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.847203254699707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.847203254699707  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 960, 256]), torch.Size([1, 960, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.849034309387207  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.9290666580200195  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 960, 256])
m.shape torch.Size([797, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.933513641357422  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.933513641357422  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 4.935033798217773  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.011237144470215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([656, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.015521049499512  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.015521049499512  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 656, 256]), torch.Size([1, 656, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.016772270202637  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.088580131530762  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 656, 256])
m.shape torch.Size([654, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.093611717224121  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.093611717224121  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.0948591232299805  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.1746931076049805  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([610, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.179932594299316  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.179932594299316  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.181096076965332  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.266449928283691  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([524, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.271481037139893  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.271481037139893  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.272480487823486  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.350674152374268  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([500, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.355941295623779  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.355941295623779  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.3568949699401855  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.439696788787842  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([432, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.444617748260498  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.444617748260498  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.445441722869873  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.521247386932373  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([364, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.525733470916748  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.525733470916748  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.526427745819092  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.59717321395874  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([360, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.602016448974609  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.602016448974609  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.602703094482422  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.676929473876953  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([348, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.6819376945495605  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.6819376945495605  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.682601451873779  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.7603983879089355  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([308, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.765099048614502  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.765099048614502  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.765686511993408  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.8380818367004395  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([325, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.843410968780518  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.843410968780518  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.844030857086182  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.925478458404541  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([302, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.930683612823486  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.930683612823486  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 5.931259632110596  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.008955478668213  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([275, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.013953685760498  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.013953685760498  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.0144782066345215  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.090978622436523  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([263, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.096024990081787  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.096024990081787  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.096526622772217  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.172939777374268  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([201, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.176939487457275  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.176939487457275  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.177322864532471  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.236746311187744  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([189, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.240732669830322  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.240732669830322  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.241093158721924  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.299492359161377  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([209, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.304133415222168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.304133415222168  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.304532051086426  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.371901512145996  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([5377, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.500901699066162  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.500901699066162  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 5377, 256]), torch.Size([1, 5377, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 6.511157512664795  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 8.3587327003479  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

rst.shape  torch.Size([1, 5377, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 8.123517036437988  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 8.126925468444824  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 8.130582809448242  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 8.127005100250244  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

torch.Size([22695, 40])
input nodes number: 68188
output nodes number: 22695
edges number: 261551
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 8.127240180969238  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 8.127240657806396  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.07576894760131836  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.07576894760131836  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 0.07576894760131836  GigaBytes
Max Memory Allocated: 8.527875423431396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04127997159957886 |0.003648221492767334 |0.13395649194717407 |0.00011283159255981445 |0.08641314506530762 |0.0049762725830078125 |
----------------------------------------------------------pseudo_mini_loss sum 3.7323520183563232
Total (block generation + training)time/epoch 25.022924423217773
Training time/epoch 1.1362628936767578
Training time without block to device /epoch 1.1216700077056885
Training time without total dataloading part /epoch 0.8869061470031738
load block tensor time/epoch 0.16511988639831543
block to device time/epoch 0.014592885971069336
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  482879
Number of first layer input nodes during this epoch:  289874
Number of first layer output nodes during this epoch:  193005
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
