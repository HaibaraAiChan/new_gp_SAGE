[04:18:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 4 parts and get 0 edge cuts
main start at this time 1651551471.4604065
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023838043212890625
global_2_local spend time (sec) 0.03630185127258301
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004545688629150391
A = g.adjacency_matrix() spent  0.007712841033935547
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08116817474365234
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3054077625274658
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1719064712524414

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.001 seconds
Metis partitioning: 0.034 seconds
Split the graph: 0.035 seconds
Construct subgraphs: 0.029 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.10004425048828125
22734
22736
22735
22736
total k batches seeds list generation spend  10.024770736694336
after graph partition
graph partition algorithm spend time 10.15623140335083
22734
22736
22735
22736
partition_len_list
[95701, 95642, 95609, 96181]
shared_neighbor_graph_partition_s0 selection method  spend 10.251359462738037
time for parepare:  0.01674628257751465
local_output_nid generation:  0.0027823448181152344
local_in_edges_tensor generation:  0.0038635730743408203
mini_batch_src_global generation:  0.00711512565612793
r_  generation:  0.06657052040100098
local_output_nid generation:  0.004091024398803711
local_in_edges_tensor generation:  0.004242420196533203
mini_batch_src_global generation:  0.008933782577514648
r_  generation:  0.06855297088623047
local_output_nid generation:  0.004208087921142578
local_in_edges_tensor generation:  0.004627704620361328
mini_batch_src_global generation:  0.005512714385986328
r_  generation:  0.07286214828491211
local_output_nid generation:  0.004191398620605469
local_in_edges_tensor generation:  0.003526449203491211
mini_batch_src_global generation:  0.0063664913177490234
r_  generation:  0.07242155075073242
----------------------check_connections_block total spend ----------------------------- 0.4302952289581299
generate_one_block  0.09536957740783691
generate_one_block  0.09273624420166016
generate_one_block  0.09322071075439453
generate_one_block  0.09494972229003906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02274346351623535
gen group dst list time:  0.010994195938110352
time for parepare:  0.019106149673461914
local_output_nid generation:  0.019249916076660156
local_in_edges_tensor generation:  0.029333829879760742
mini_batch_src_global generation:  0.020182132720947266
r_  generation:  0.25038814544677734
local_output_nid generation:  0.020831584930419922
local_in_edges_tensor generation:  0.02517843246459961
mini_batch_src_global generation:  0.026035547256469727
r_  generation:  0.2596909999847412
local_output_nid generation:  0.024683475494384766
local_in_edges_tensor generation:  0.0292661190032959
mini_batch_src_global generation:  0.029498815536499023
r_  generation:  0.25700855255126953
local_output_nid generation:  0.020911216735839844
local_in_edges_tensor generation:  0.02375006675720215
mini_batch_src_global generation:  0.026757001876831055
r_  generation:  0.254453182220459
----------------------check_connections_block total spend ----------------------------- 1.5802829265594482
generate_one_block  0.3078577518463135
generate_one_block  0.3051767349243164
generate_one_block  0.30715203285217285
generate_one_block  0.3280634880065918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.5802829265594482
block generation total time  1.2482500076293945
average batch blocks generation time:  0.31206250190734863
pseudo mini batch 0 input nodes size: 143022
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.0711369514465332  GigaBytes
Max Memory Allocated: 0.0711369514465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07130670547485352  GigaBytes
Max Memory Allocated: 0.07130670547485352  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07130670547485352  GigaBytes
Max Memory Allocated: 0.07130670547485352  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07776689529418945  GigaBytes
Max Memory Allocated: 0.07776689529418945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07776689529418945  GigaBytes
Max Memory Allocated: 0.07776689529418945  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07776689529418945  GigaBytes
Max Memory Allocated: 0.07776689529418945  GigaBytes

torch.Size([143022, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.07776689529418945  GigaBytes
Max Memory Allocated: 0.07776689529418945  GigaBytes

m.shape torch.Size([5966, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.41346168518066406  GigaBytes
Max Memory Allocated: 0.42075634002685547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.41346168518066406  GigaBytes
Max Memory Allocated: 0.42075634002685547  GigaBytes

 h.shape torch.Size([1, 5966, 128]), torch.Size([1, 5966, 128])
----------------------------------------3
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.42003345489501953  GigaBytes
Max Memory Allocated: 0.42075634002685547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.4662294387817383  GigaBytes
Max Memory Allocated: 0.4690742492675781  GigaBytes

rst.shape  torch.Size([1, 5966, 128])
m.shape torch.Size([7217, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.47026729583740234  GigaBytes
Max Memory Allocated: 0.4704289436340332  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.47026729583740234  GigaBytes
Max Memory Allocated: 0.4704289436340332  GigaBytes

 h.shape torch.Size([1, 7217, 128]), torch.Size([1, 7217, 128])
----------------------------------------3
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.47782278060913086  GigaBytes
Max Memory Allocated: 0.47782278060913086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5810627937316895  GigaBytes
Max Memory Allocated: 0.5879454612731934  GigaBytes

rst.shape  torch.Size([1, 7217, 128])
m.shape torch.Size([7055, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5877137184143066  GigaBytes
Max Memory Allocated: 0.5879507064819336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5877137184143066  GigaBytes
Max Memory Allocated: 0.5879507064819336  GigaBytes

 h.shape torch.Size([1, 7055, 128]), torch.Size([1, 7055, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5944418907165527  GigaBytes
Max Memory Allocated: 0.5944418907165527  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7443404197692871  GigaBytes
Max Memory Allocated: 0.7544326782226562  GigaBytes

rst.shape  torch.Size([1, 7055, 128])
m.shape torch.Size([6613, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.753779411315918  GigaBytes
Max Memory Allocated: 0.7544326782226562  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.753779411315918  GigaBytes
Max Memory Allocated: 0.7544326782226562  GigaBytes

 h.shape torch.Size([1, 6613, 128]), torch.Size([1, 6613, 128])
----------------------------------------3
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7602968215942383  GigaBytes
Max Memory Allocated: 0.7602968215942383  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2010498046875 GB
    Memory Allocated: 0.9452133178710938  GigaBytes
Max Memory Allocated: 0.9578266143798828  GigaBytes

rst.shape  torch.Size([1, 6613, 128])
m.shape torch.Size([6042, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2010498046875 GB
    Memory Allocated: 0.9558539390563965  GigaBytes
Max Memory Allocated: 0.9578266143798828  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2010498046875 GB
    Memory Allocated: 0.9558539390563965  GigaBytes
Max Memory Allocated: 0.9578266143798828  GigaBytes

 h.shape torch.Size([1, 6042, 128]), torch.Size([1, 6042, 128])
----------------------------------------3
 Nvidia-smi: 2.2010498046875 GB
    Memory Allocated: 0.961616039276123  GigaBytes
Max Memory Allocated: 0.961616039276123  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.1713862419128418  GigaBytes
Max Memory Allocated: 1.1857914924621582  GigaBytes

rst.shape  torch.Size([1, 6042, 128])
m.shape torch.Size([5242, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.1835026741027832  GigaBytes
Max Memory Allocated: 1.1857914924621582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.1835026741027832  GigaBytes
Max Memory Allocated: 1.1857914924621582  GigaBytes

 h.shape torch.Size([1, 5242, 128]), torch.Size([1, 5242, 128])
----------------------------------------3
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.1890945434570312  GigaBytes
Max Memory Allocated: 1.1890945434570312  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6971435546875 GB
    Memory Allocated: 1.4040584564208984  GigaBytes
Max Memory Allocated: 1.4196834564208984  GigaBytes

rst.shape  torch.Size([1, 5242, 128])
m.shape torch.Size([4770, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.41748046875  GigaBytes
Max Memory Allocated: 1.4196834564208984  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.41748046875  GigaBytes
Max Memory Allocated: 1.4196834564208984  GigaBytes

 h.shape torch.Size([1, 4770, 128]), torch.Size([1, 4770, 128])
----------------------------------------3
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.42234468460083  GigaBytes
Max Memory Allocated: 1.42234468460083  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.650660514831543  GigaBytes
Max Memory Allocated: 1.6665821075439453  GigaBytes

rst.shape  torch.Size([1, 4770, 128])
m.shape torch.Size([4247, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.6645870208740234  GigaBytes
Max Memory Allocated: 1.6665821075439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.6645870208740234  GigaBytes
Max Memory Allocated: 1.6665821075439453  GigaBytes

 h.shape torch.Size([1, 4247, 128]), torch.Size([1, 4247, 128])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.6686553955078125  GigaBytes
Max Memory Allocated: 1.6686553955078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1990966796875 GB
    Memory Allocated: 1.9006609916687012  GigaBytes
Max Memory Allocated: 1.9168620109558105  GigaBytes

rst.shape  torch.Size([1, 4247, 128])
m.shape torch.Size([3801, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1990966796875 GB
    Memory Allocated: 1.9149479866027832  GigaBytes
Max Memory Allocated: 1.9168620109558105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1990966796875 GB
    Memory Allocated: 1.9149479866027832  GigaBytes
Max Memory Allocated: 1.9168620109558105  GigaBytes

 h.shape torch.Size([1, 3801, 128]), torch.Size([1, 3801, 128])
----------------------------------------3
 Nvidia-smi: 3.1990966796875 GB
    Memory Allocated: 1.9186673164367676  GigaBytes
Max Memory Allocated: 1.9186673164367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 2.151336669921875  GigaBytes
Max Memory Allocated: 2.1676487922668457  GigaBytes

rst.shape  torch.Size([1, 3801, 128])
m.shape torch.Size([44748, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7049560546875 GB
    Memory Allocated: 2.3628993034362793  GigaBytes
Max Memory Allocated: 2.3679537773132324  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7049560546875 GB
    Memory Allocated: 2.3628993034362793  GigaBytes
Max Memory Allocated: 2.3679537773132324  GigaBytes

 h.shape torch.Size([1, 44748, 128]), torch.Size([1, 44748, 128])
----------------------------------------3
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 2.4058680534362793  GigaBytes
Max Memory Allocated: 2.4058680534362793  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0135498046875 GB
    Memory Allocated: 5.456649303436279  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

rst.shape  torch.Size([1, 44748, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0135498046875 GB
    Memory Allocated: 5.154642581939697  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0135498046875 GB
    Memory Allocated: 5.245910167694092  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0135498046875 GB
    Memory Allocated: 5.337177753448486  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0135498046875 GB
    Memory Allocated: 5.24519681930542  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

torch.Size([95701, 256])
first layer input nodes number: 143022
first layer output nodes number: 95701
edges number: 678734
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0135498046875 GB
    Memory Allocated: 5.338445663452148  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0135498046875 GB
    Memory Allocated: 5.429713249206543  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.1053466796875 GB
    Memory Allocated: 5.453059673309326  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.1053466796875 GB
    Memory Allocated: 5.453059673309326  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

m.shape torch.Size([3334, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.638375282287598  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.638375282287598  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

 h.shape torch.Size([1, 3334, 256]), torch.Size([1, 3334, 256])
----------------------------------------3
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.645180702209473  GigaBytes
Max Memory Allocated: 5.670024394989014  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.696483612060547  GigaBytes
Max Memory Allocated: 5.699663162231445  GigaBytes

rst.shape  torch.Size([1, 3334, 256])
m.shape torch.Size([2916, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.698909759521484  GigaBytes
Max Memory Allocated: 5.699663162231445  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.698909759521484  GigaBytes
Max Memory Allocated: 5.699663162231445  GigaBytes

 h.shape torch.Size([1, 2916, 256]), torch.Size([1, 2916, 256])
----------------------------------------3
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.7046356201171875  GigaBytes
Max Memory Allocated: 5.7046356201171875  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.789851665496826  GigaBytes
Max Memory Allocated: 5.795413494110107  GigaBytes

rst.shape  torch.Size([1, 2916, 256])
m.shape torch.Size([2241, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.79310941696167  GigaBytes
Max Memory Allocated: 5.795413494110107  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.79310941696167  GigaBytes
Max Memory Allocated: 5.795413494110107  GigaBytes

 h.shape torch.Size([1, 2241, 256]), torch.Size([1, 2241, 256])
----------------------------------------3
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.797610759735107  GigaBytes
Max Memory Allocated: 5.797610759735107  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.89385461807251  GigaBytes
Max Memory Allocated: 5.900266170501709  GigaBytes

rst.shape  torch.Size([1, 2241, 256])
m.shape torch.Size([1828, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.897988319396973  GigaBytes
Max Memory Allocated: 5.900266170501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.897988319396973  GigaBytes
Max Memory Allocated: 5.900266170501709  GigaBytes

 h.shape torch.Size([1, 1828, 256]), torch.Size([1, 1828, 256])
----------------------------------------3
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 5.901583671569824  GigaBytes
Max Memory Allocated: 5.901583671569824  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.0035319328308105  GigaBytes
Max Memory Allocated: 6.011120319366455  GigaBytes

rst.shape  torch.Size([1, 1828, 256])
m.shape torch.Size([1538, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.009434700012207  GigaBytes
Max Memory Allocated: 6.011120319366455  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.009434700012207  GigaBytes
Max Memory Allocated: 6.011120319366455  GigaBytes

 h.shape torch.Size([1, 1538, 256]), torch.Size([1, 1538, 256])
----------------------------------------3
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.012421131134033  GigaBytes
Max Memory Allocated: 6.012421131134033  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 6.1204328536987305  GigaBytes
Max Memory Allocated: 6.1277666091918945  GigaBytes

rst.shape  torch.Size([1, 1538, 256])
m.shape torch.Size([1222, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 6.125759601593018  GigaBytes
Max Memory Allocated: 6.1277666091918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 6.125759601593018  GigaBytes
Max Memory Allocated: 6.1277666091918945  GigaBytes

 h.shape torch.Size([1, 1222, 256]), torch.Size([1, 1222, 256])
----------------------------------------3
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 6.128335952758789  GigaBytes
Max Memory Allocated: 6.128335952758789  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5018310546875 GB
    Memory Allocated: 6.234205722808838  GigaBytes
Max Memory Allocated: 6.2411980628967285  GigaBytes

rst.shape  torch.Size([1, 1222, 256])
m.shape torch.Size([1057, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5018310546875 GB
    Memory Allocated: 6.2399821281433105  GigaBytes
Max Memory Allocated: 6.2411980628967285  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5018310546875 GB
    Memory Allocated: 6.2399821281433105  GigaBytes
Max Memory Allocated: 6.2411980628967285  GigaBytes

 h.shape torch.Size([1, 1057, 256]), torch.Size([1, 1057, 256])
----------------------------------------3
 Nvidia-smi: 7.5018310546875 GB
    Memory Allocated: 6.242099285125732  GigaBytes
Max Memory Allocated: 6.242099285125732  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5994873046875 GB
    Memory Allocated: 6.345656871795654  GigaBytes
Max Memory Allocated: 6.353091716766357  GigaBytes

rst.shape  torch.Size([1, 1057, 256])
m.shape torch.Size([870, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5994873046875 GB
    Memory Allocated: 6.351808547973633  GigaBytes
Max Memory Allocated: 6.353091716766357  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5994873046875 GB
    Memory Allocated: 6.351808547973633  GigaBytes
Max Memory Allocated: 6.353091716766357  GigaBytes

 h.shape torch.Size([1, 870, 256]), torch.Size([1, 870, 256])
----------------------------------------3
 Nvidia-smi: 7.5994873046875 GB
    Memory Allocated: 6.35346794128418  GigaBytes
Max Memory Allocated: 6.35346794128418  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7147216796875 GB
    Memory Allocated: 6.448851585388184  GigaBytes
Max Memory Allocated: 6.455489158630371  GigaBytes

rst.shape  torch.Size([1, 870, 256])
m.shape torch.Size([737, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7147216796875 GB
    Memory Allocated: 6.454397201538086  GigaBytes
Max Memory Allocated: 6.455489158630371  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7147216796875 GB
    Memory Allocated: 6.454397201538086  GigaBytes
Max Memory Allocated: 6.455489158630371  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 7.7166748046875 GB
    Memory Allocated: 6.455802917480469  GigaBytes
Max Memory Allocated: 6.455802917480469  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.546779632568359  GigaBytes
Max Memory Allocated: 6.553105354309082  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([662, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.5524396896362305  GigaBytes
Max Memory Allocated: 6.553105354309082  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.5524396896362305  GigaBytes
Max Memory Allocated: 6.553105354309082  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.553702354431152  GigaBytes
Max Memory Allocated: 6.553702354431152  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 6.644354820251465  GigaBytes
Max Memory Allocated: 6.650668144226074  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([507, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 6.649084091186523  GigaBytes
Max Memory Allocated: 6.650668144226074  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 6.649084091186523  GigaBytes
Max Memory Allocated: 6.650668144226074  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 6.650051116943359  GigaBytes
Max Memory Allocated: 6.650668144226074  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.726045608520508  GigaBytes
Max Memory Allocated: 6.7313642501831055  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([467, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.730948448181152  GigaBytes
Max Memory Allocated: 6.7313642501831055  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.730948448181152  GigaBytes
Max Memory Allocated: 6.7313642501831055  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.731839179992676  GigaBytes
Max Memory Allocated: 6.731839179992676  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 6.809317588806152  GigaBytes
Max Memory Allocated: 6.814661979675293  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([413, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 6.814032554626465  GigaBytes
Max Memory Allocated: 6.814661979675293  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 6.814032554626465  GigaBytes
Max Memory Allocated: 6.814661979675293  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 6.814820289611816  GigaBytes
Max Memory Allocated: 6.814820289611816  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 6.890663146972656  GigaBytes
Max Memory Allocated: 6.895783424377441  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([358, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 6.895086765289307  GigaBytes
Max Memory Allocated: 6.895783424377441  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 6.895086765289307  GigaBytes
Max Memory Allocated: 6.895783424377441  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 6.8957695960998535  GigaBytes
Max Memory Allocated: 6.895783424377441  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1854248046875 GB
    Memory Allocated: 6.965085506439209  GigaBytes
Max Memory Allocated: 6.969865322113037  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([327, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.1854248046875 GB
    Memory Allocated: 6.96945858001709  GigaBytes
Max Memory Allocated: 6.969865322113037  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1854248046875 GB
    Memory Allocated: 6.96945858001709  GigaBytes
Max Memory Allocated: 6.969865322113037  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 8.1854248046875 GB
    Memory Allocated: 6.9700822830200195  GigaBytes
Max Memory Allocated: 6.9700822830200195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2537841796875 GB
    Memory Allocated: 7.038010597229004  GigaBytes
Max Memory Allocated: 7.042688369750977  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([279, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.2537841796875 GB
    Memory Allocated: 7.041989326477051  GigaBytes
Max Memory Allocated: 7.042688369750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2537841796875 GB
    Memory Allocated: 7.041989326477051  GigaBytes
Max Memory Allocated: 7.042688369750977  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 8.2537841796875 GB
    Memory Allocated: 7.0425214767456055  GigaBytes
Max Memory Allocated: 7.042688369750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3201904296875 GB
    Memory Allocated: 7.1031036376953125  GigaBytes
Max Memory Allocated: 7.10736083984375  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([276, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3201904296875 GB
    Memory Allocated: 7.10734748840332  GigaBytes
Max Memory Allocated: 7.107365131378174  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3201904296875 GB
    Memory Allocated: 7.10734748840332  GigaBytes
Max Memory Allocated: 7.107365131378174  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 8.3201904296875 GB
    Memory Allocated: 7.107873916625977  GigaBytes
Max Memory Allocated: 7.107873916625977  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 7.172906875610352  GigaBytes
Max Memory Allocated: 7.17738151550293  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([257, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 7.177090167999268  GigaBytes
Max Memory Allocated: 7.17738151550293  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 7.177090167999268  GigaBytes
Max Memory Allocated: 7.17738151550293  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 7.1775803565979  GigaBytes
Max Memory Allocated: 7.1775803565979  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4569091796875 GB
    Memory Allocated: 7.242056369781494  GigaBytes
Max Memory Allocated: 7.2464680671691895  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([220, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4569091796875 GB
    Memory Allocated: 7.245829105377197  GigaBytes
Max Memory Allocated: 7.2464680671691895  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4569091796875 GB
    Memory Allocated: 7.245829105377197  GigaBytes
Max Memory Allocated: 7.2464680671691895  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 8.4569091796875 GB
    Memory Allocated: 7.246248722076416  GigaBytes
Max Memory Allocated: 7.2464680671691895  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5135498046875 GB
    Memory Allocated: 7.3024773597717285  GigaBytes
Max Memory Allocated: 7.306463718414307  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([235, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5135498046875 GB
    Memory Allocated: 7.3067851066589355  GigaBytes
Max Memory Allocated: 7.306802749633789  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5135498046875 GB
    Memory Allocated: 7.3067851066589355  GigaBytes
Max Memory Allocated: 7.306802749633789  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 8.5155029296875 GB
    Memory Allocated: 7.3072333335876465  GigaBytes
Max Memory Allocated: 7.3072333335876465  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 7.370433330535889  GigaBytes
Max Memory Allocated: 7.374915599822998  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([162, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 7.37347936630249  GigaBytes
Max Memory Allocated: 7.374915599822998  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 7.37347936630249  GigaBytes
Max Memory Allocated: 7.374915599822998  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 7.373788356781006  GigaBytes
Max Memory Allocated: 7.374915599822998  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6248779296875 GB
    Memory Allocated: 7.419518947601318  GigaBytes
Max Memory Allocated: 7.422763347625732  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([144, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.6248779296875 GB
    Memory Allocated: 7.422409534454346  GigaBytes
Max Memory Allocated: 7.422763347625732  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6248779296875 GB
    Memory Allocated: 7.422409534454346  GigaBytes
Max Memory Allocated: 7.422763347625732  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 8.6248779296875 GB
    Memory Allocated: 7.422684192657471  GigaBytes
Max Memory Allocated: 7.422763347625732  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6678466796875 GB
    Memory Allocated: 7.465256214141846  GigaBytes
Max Memory Allocated: 7.4690728187561035  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([131, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.6678466796875 GB
    Memory Allocated: 7.468958377838135  GigaBytes
Max Memory Allocated: 7.4690728187561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6678466796875 GB
    Memory Allocated: 7.468958377838135  GigaBytes
Max Memory Allocated: 7.4690728187561035  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.6678466796875 GB
    Memory Allocated: 7.469208240509033  GigaBytes
Max Memory Allocated: 7.469208240509033  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 7.50968599319458  GigaBytes
Max Memory Allocated: 7.512559413909912  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([142, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 7.512836933135986  GigaBytes
Max Memory Allocated: 7.512849807739258  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 7.512836933135986  GigaBytes
Max Memory Allocated: 7.512849807739258  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 7.513107776641846  GigaBytes
Max Memory Allocated: 7.513107776641846  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7791748046875 GB
    Memory Allocated: 7.55888032913208  GigaBytes
Max Memory Allocated: 7.562130451202393  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([2411, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8377685546875 GB
    Memory Allocated: 7.6166768074035645  GigaBytes
Max Memory Allocated: 7.616901397705078  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8377685546875 GB
    Memory Allocated: 7.6166768074035645  GigaBytes
Max Memory Allocated: 7.616901397705078  GigaBytes

 h.shape torch.Size([1, 2411, 256]), torch.Size([1, 2411, 256])
----------------------------------------3
 Nvidia-smi: 8.8377685546875 GB
    Memory Allocated: 7.621275424957275  GigaBytes
Max Memory Allocated: 7.621275424957275  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7557373046875 GB
    Memory Allocated: 8.4308180809021  GigaBytes
Max Memory Allocated: 8.488300800323486  GigaBytes

rst.shape  torch.Size([1, 2411, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.7791748046875 GB
    Memory Allocated: 8.26931619644165  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.7791748046875 GB
    Memory Allocated: 8.272704124450684  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.7791748046875 GB
    Memory Allocated: 8.276092052459717  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.7791748046875 GB
    Memory Allocated: 8.272534370422363  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([22734, 40])
input nodes number: 95701
output nodes number: 22734
edges number: 188230
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7791748046875 GB
    Memory Allocated: 8.276805400848389  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.7791748046875 GB
    Memory Allocated: 8.276806354522705  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.09545469284057617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

pseudo mini batch 1 input nodes size: 143263
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.1457839012145996  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.14595365524291992  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.07742452621459961  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.08384847640991211  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.08384847640991211  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.08384847640991211  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([143263, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.08384847640991211  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([6053, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.41844749450683594  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.41844749450683594  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6053, 128]), torch.Size([1, 6053, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.42422008514404297  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.4712686538696289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6053, 128])
m.shape torch.Size([7258, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.47530412673950195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.47530412673950195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7258, 128]), torch.Size([1, 7258, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.4822258949279785  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.5860528945922852  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7258, 128])
m.shape torch.Size([7056, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.5926856994628906  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.5926856994628906  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7056, 128]), torch.Size([1, 7056, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.5995111465454102  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.7494745254516602  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7056, 128])
m.shape torch.Size([6517, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.758540153503418  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.758540153503418  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6517, 128]), torch.Size([1, 6517, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.765012264251709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.9454245567321777  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6517, 128])
m.shape torch.Size([6024, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.9566793441772461  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.9566793441772461  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6024, 128]), torch.Size([1, 6024, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 0.9627676010131836  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.174119472503662  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6024, 128])
m.shape torch.Size([5281, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.1863560676574707  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.1863560676574707  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5281, 128]), torch.Size([1, 5281, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.191392421722412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.408088207244873  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5281, 128])
m.shape torch.Size([4709, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.421288013458252  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.421288013458252  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4709, 128]), torch.Size([1, 4709, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.4258627891540527  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.6574487686157227  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4709, 128])
m.shape torch.Size([4289, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.6715645790100098  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.6715645790100098  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4289, 128]), torch.Size([1, 4289, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.6757864952087402  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.9089341163635254  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4289, 128])
m.shape torch.Size([3864, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.923471450805664  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.923471450805664  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3864, 128]), torch.Size([1, 3864, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 1.9272794723510742  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 2.1636996269226074  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3864, 128])
m.shape torch.Size([44591, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 2.374483585357666  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 2.374483585357666  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 44591, 128]), torch.Size([1, 44591, 128])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 2.417452335357666  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.467346668243408  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 44591, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.166191101074219  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.257402420043945  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.348613739013672  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.256689548492432  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([95642, 256])
first layer input nodes number: 143263
first layer output nodes number: 95642
edges number: 677572
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.349721908569336  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.4409332275390625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.4643707275390625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.4643707275390625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([3329, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.64609956741333  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.64609956741333  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3329, 256]), torch.Size([1, 3329, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.652961254119873  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.704046726226807  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3329, 256])
m.shape torch.Size([2957, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.70655632019043  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.70655632019043  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2957, 256]), torch.Size([1, 2957, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.712488651275635  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.798257827758789  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2957, 256])
m.shape torch.Size([2349, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.802322864532471  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.802322864532471  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2349, 256]), torch.Size([1, 2349, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.807114124298096  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.9068732261657715  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2349, 256])
m.shape torch.Size([1854, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.9117608070373535  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.9117608070373535  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1854, 256]), torch.Size([1, 1854, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 5.915310382843018  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.019846439361572  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1854, 256])
m.shape torch.Size([1539, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.025025367736816  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.025025367736816  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1539, 256]), torch.Size([1, 1539, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.028084754943848  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.13532829284668  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1539, 256])
m.shape torch.Size([1209, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.140684127807617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.140684127807617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1209, 256]), torch.Size([1, 1209, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.143041610717773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.247300148010254  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1209, 256])
m.shape torch.Size([978, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.252543926239014  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.252543926239014  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 978, 256]), torch.Size([1, 978, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.254409313201904  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.350310802459717  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 978, 256])
m.shape torch.Size([887, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.356198310852051  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.356198310852051  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 887, 256]), torch.Size([1, 887, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.3578901290893555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.454329490661621  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 887, 256])
m.shape torch.Size([760, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.460057735443115  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.460057735443115  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.461507320404053  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.554723262786865  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([652, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.560265064239502  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.560265064239502  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 652, 256]), torch.Size([1, 652, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.561508655548096  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.650772571563721  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 652, 256])
m.shape torch.Size([562, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.656092643737793  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.656092643737793  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.657164573669434  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.741987228393555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([515, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.747391223907471  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.747391223907471  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.748373508453369  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.833023548126221  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([437, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.8379926681518555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.8379926681518555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.8388261795043945  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.917712211608887  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([380, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.9224090576171875  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.9224090576171875  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.923133850097656  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 6.997321128845215  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([331, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.001730918884277  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.001730918884277  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.002362251281738  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.071213722229004  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([280, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.075310707092285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.075310707092285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.075844764709473  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.137914657592773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([262, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.141928672790527  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.141928672790527  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.142428398132324  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.204358100891113  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([209, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.207724094390869  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.207724094390869  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.208122730255127  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.258749485015869  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([193, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.262074947357178  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.262074947357178  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.2624430656433105  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.311770915985107  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([185, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.31514310836792  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.31514310836792  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.31549596786499  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.365249156951904  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([172, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.369020462036133  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.369020462036133  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.369348526000977  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.417901992797852  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([143, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.420762062072754  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.420762062072754  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.421034812927246  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.463311195373535  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([130, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.466048717498779  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.466048717498779  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.466296672821045  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.506465435028076  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([121, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.5091328620910645  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.5091328620910645  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 10.1463623046875 GB
    Memory Allocated: 7.509363651275635  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 7.548367023468018  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([2302, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 7.603564739227295  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 7.603564739227295  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2302, 256]), torch.Size([1, 2302, 256])
----------------------------------------3
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 7.607955455780029  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 8.38218355178833  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 8.223660945892334  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 8.227048873901367  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 8.2304368019104  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 8.226879119873047  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([22736, 40])
input nodes number: 95642
output nodes number: 22736
edges number: 184550
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 8.22776174545288  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.1815185546875 GB
    Memory Allocated: 8.227762222290039  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.09514760971069336  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

pseudo mini batch 2 input nodes size: 143075
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.07742452621459961  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.07742452621459961  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.1457839012145996  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.14595365524291992  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.08389854431152344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.08389854431152344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.08389854431152344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([143075, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.08389854431152344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([6068, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.41827964782714844  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.41827964782714844  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6068, 128]), torch.Size([1, 6068, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.42406654357910156  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.4710865020751953  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6068, 128])
m.shape torch.Size([7271, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.4751272201538086  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.4751272201538086  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7271, 128]), torch.Size([1, 7271, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.48206138610839844  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.5860738754272461  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7271, 128])
m.shape torch.Size([7119, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.5927906036376953  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.5927906036376953  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7119, 128]), torch.Size([1, 7119, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.5996522903442383  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.7498559951782227  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7119, 128])
m.shape torch.Size([6513, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.7588839530944824  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.7588839530944824  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6513, 128]), torch.Size([1, 6513, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.7653841972351074  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.9456081390380859  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6513, 128])
m.shape torch.Size([6005, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.9568195343017578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.9568195343017578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6005, 128]), torch.Size([1, 6005, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 0.9625463485717773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.1733922958374023  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6005, 128])
m.shape torch.Size([5232, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.185497760772705  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.185497760772705  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5232, 128]), torch.Size([1, 5232, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.1904873847961426  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.4052658081054688  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5232, 128])
m.shape torch.Size([4660, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.418325424194336  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.418325424194336  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4660, 128]), torch.Size([1, 4660, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.4229373931884766  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.6551713943481445  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4660, 128])
m.shape torch.Size([4281, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.6692800521850586  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.6692800521850586  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4281, 128]), torch.Size([1, 4281, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.673379898071289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.9062323570251465  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4281, 128])
m.shape torch.Size([3786, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.9204387664794922  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.9204387664794922  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3786, 128]), torch.Size([1, 3786, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 1.9240493774414062  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 2.1551284790039062  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3786, 128])
m.shape torch.Size([44674, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 2.3663454055786133  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 2.3663454055786133  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 44674, 128]), torch.Size([1, 44674, 128])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 2.4093141555786133  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.460095405578613  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 44674, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.1594648361206055  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.2512617111206055  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.342441558837891  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.249932289123535  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([95609, 256])
first layer input nodes number: 143075
first layer output nodes number: 95609
edges number: 677118
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.343602657318115  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.4347825050354  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.4582200050354  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.4582200050354  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([3379, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.6406941413879395  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.6406941413879395  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3379, 256]), torch.Size([1, 3379, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.648292541503906  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.699965953826904  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3379, 256])
m.shape torch.Size([2932, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.7023797035217285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.7023797035217285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2932, 256]), torch.Size([1, 2932, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.708281517028809  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.792880535125732  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2932, 256])
m.shape torch.Size([2326, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.7967915534973145  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.7967915534973145  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2326, 256]), torch.Size([1, 2326, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.801376819610596  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.900645732879639  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2326, 256])
m.shape torch.Size([1856, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.905562877655029  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.905562877655029  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1856, 256]), torch.Size([1, 1856, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 5.909133434295654  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.012990474700928  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1856, 256])
m.shape torch.Size([1521, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.018491744995117  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.018491744995117  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1521, 256]), torch.Size([1, 1521, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.021432399749756  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.126680850982666  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1521, 256])
m.shape torch.Size([1250, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.132260799407959  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.132260799407959  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1250, 256]), torch.Size([1, 1250, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.134759426116943  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.242240905761719  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1250, 256])
m.shape torch.Size([1012, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.247659683227539  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.247659683227539  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1012, 256]), torch.Size([1, 1012, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.249589920043945  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.34678840637207  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1012, 256])
m.shape torch.Size([848, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.352343559265137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.352343559265137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 848, 256]), torch.Size([1, 848, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.353960990905762  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.446887016296387  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 848, 256])
m.shape torch.Size([762, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.452670097351074  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.452670097351074  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 762, 256]), torch.Size([1, 762, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.454123497009277  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.547591209411621  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 762, 256])
m.shape torch.Size([644, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.553054332733154  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.553054332733154  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.5542826652526855  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.641879558563232  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([569, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.647281169891357  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.647281169891357  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.648366451263428  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.733927249908447  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([471, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.73881721496582  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.73881721496582  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.739715576171875  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.819719314575195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([388, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.824118137359619  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.824118137359619  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.82485818862915  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.8976922035217285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([354, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.902085781097412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.902085781097412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.902760982513428  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.971218109130859  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([294, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.975119113922119  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.975119113922119  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 6.975679874420166  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.036930084228516  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([261, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.040663719177246  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.040663719177246  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.04116153717041  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.099413871765137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([256, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.1033477783203125  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.1033477783203125  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.1038360595703125  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.1624298095703125  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([257, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.166649341583252  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.166649341583252  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.167139530181885  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.231201648712158  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([210, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.234831809997559  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.234831809997559  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.235232353210449  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.288905143737793  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([189, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.2923383712768555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.2923383712768555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.292698860168457  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.343527793884277  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([176, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.34689998626709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.34689998626709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.347235679626465  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.396918296813965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([148, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.3998799324035645  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.3998799324035645  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.400162220001221  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.4439167976379395  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([136, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.446782112121582  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.446782112121582  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.4470415115356445  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.4890642166137695  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([130, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.491933345794678  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.491933345794678  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 10.3631591796875 GB
    Memory Allocated: 7.492181301116943  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 7.534085750579834  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([2366, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 7.590812683105469  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 7.590812683105469  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2366, 256]), torch.Size([1, 2366, 256])
----------------------------------------3
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 7.595325469970703  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 8.390387535095215  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2366, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 8.23201036453247  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 8.235398292541504  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 8.238786220550537  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 8.235228538513184  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([22735, 40])
input nodes number: 95609
output nodes number: 22735
edges number: 185511
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 8.23611068725586  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 8.236111164093018  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.0952601432800293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

pseudo mini batch 3 input nodes size: 143395
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.07747077941894531  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.14584684371948242  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.14601659774780273  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.07748746871948242  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.08393335342407227  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.08393335342407227  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.08393335342407227  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([143395, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.08393335342407227  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([6121, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.41971921920776367  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.41971921920776367  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6121, 128]), torch.Size([1, 6121, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.42555665969848633  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.472475528717041  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6121, 128])
m.shape torch.Size([7390, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.4766044616699219  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.4766044616699219  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7390, 128]), torch.Size([1, 7390, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.48365211486816406  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.5893669128417969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7390, 128])
m.shape torch.Size([7283, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.5962615013122559  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.5962615013122559  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7283, 128]), torch.Size([1, 7283, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.6032581329345703  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.757115364074707  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7283, 128])
m.shape torch.Size([6561, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.7661566734313965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.7661566734313965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6561, 128]), torch.Size([1, 6561, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.7724137306213379  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.9538683891296387  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6561, 128])
m.shape torch.Size([6135, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.9653668403625488  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.9653668403625488  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6135, 128]), torch.Size([1, 6135, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 0.9714207649230957  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.1823067665100098  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6135, 128])
m.shape torch.Size([5246, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.1943902969360352  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.1943902969360352  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5246, 128]), torch.Size([1, 5246, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.1994032859802246  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.4145312309265137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5246, 128])
m.shape torch.Size([4719, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.427781105041504  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.427781105041504  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4719, 128]), torch.Size([1, 4719, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.4324278831481934  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.6643247604370117  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4719, 128])
m.shape torch.Size([4277, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.6783900260925293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.6783900260925293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4277, 128]), torch.Size([1, 4277, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.6827244758605957  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.915553092956543  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4277, 128])
m.shape torch.Size([3827, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.9299373626708984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.9299373626708984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3827, 128]), torch.Size([1, 3827, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 1.9338455200195312  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 2.1685104370117188  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3827, 128])
m.shape torch.Size([44622, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 2.379459857940674  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 2.379459857940674  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 44622, 128]), torch.Size([1, 44622, 128])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 2.422428607940674  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.472382068634033  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 44622, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.170494556427002  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.2622199058532715  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.353945255279541  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.261503219604492  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([96181, 256])
first layer input nodes number: 143395
first layer output nodes number: 96181
edges number: 679057
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.3550944328308105  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.44681978225708  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.47025728225708  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.47025728225708  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([3386, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.653740406036377  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.653740406036377  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3386, 256]), torch.Size([1, 3386, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.66049337387085  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.712159633636475  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3386, 256])
m.shape torch.Size([2901, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.714507102966309  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.714507102966309  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2901, 256]), torch.Size([1, 2901, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.720395088195801  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.804096221923828  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2901, 256])
m.shape torch.Size([2361, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.8086771965026855  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.8086771965026855  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2361, 256]), torch.Size([1, 2361, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.813430309295654  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.912930965423584  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2361, 256])
m.shape torch.Size([1782, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.917530536651611  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.917530536651611  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1782, 256]), torch.Size([1, 1782, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 5.9209370613098145  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.022339344024658  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1782, 256])
m.shape torch.Size([1624, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.027959823608398  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.027959823608398  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1624, 256]), torch.Size([1, 1624, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.031154632568359  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.150338649749756  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1624, 256])
m.shape torch.Size([1187, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.155635356903076  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.155635356903076  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1187, 256]), torch.Size([1, 1187, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.15794038772583  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.255667209625244  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1187, 256])
m.shape torch.Size([998, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.2612175941467285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.2612175941467285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.263121128082275  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.359785556793213  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([867, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.365500450134277  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.365500450134277  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 867, 256]), torch.Size([1, 867, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.367154121398926  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.461789131164551  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 867, 256])
m.shape torch.Size([717, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.467164516448975  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.467164516448975  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.468532085418701  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.558969974517822  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([641, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.564447402954102  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.564447402954102  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.565670013427734  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.653377532958984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([565, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.658740043640137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.658740043640137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.659817695617676  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.745053291320801  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([484, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.750096797943115  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.750096797943115  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.7510199546813965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.829629421234131  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([418, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.834390640258789  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.834390640258789  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.835187911987305  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.909330368041992  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([342, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.914147853851318  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.914147853851318  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.91480016708374  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.984116077423096  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([337, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.988648414611816  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.988648414611816  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 6.989291191101074  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.058467388153076  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([291, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.062621116638184  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.062621116638184  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.063176155090332  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.12963342666626  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([236, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.133212089538574  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.133212089538574  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.133662223815918  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.187678337097168  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([225, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.191346168518066  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.191346168518066  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.191775321960449  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.246277809143066  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([213, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.249953269958496  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.249953269958496  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.250359535217285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.3047990798950195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([198, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.308402061462402  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.308402061462402  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.308779716491699  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.362029075622559  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([207, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.366018295288086  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.366018295288086  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes
[04:18:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 4 parts and get 0 edge cuts

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.366413116455078  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.424846649169922  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([121, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.427207946777344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.427207946777344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.427438735961914  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.4632110595703125  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([122, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.465792655944824  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.465792655944824  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.466025352478027  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.503722190856934  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([132, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.506650924682617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.506650924682617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.3826904296875 GB
    Memory Allocated: 7.506902694702148  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 7.54945182800293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([2381, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 7.606537342071533  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 7.606537342071533  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2381, 256]), torch.Size([1, 2381, 256])
----------------------------------------3
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 7.61107873916626  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 8.41080379486084  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2381, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 8.251011371612549  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 8.254399299621582  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 8.257787227630615  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 8.254229545593262  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([22736, 40])
input nodes number: 96181
output nodes number: 22736
edges number: 185959
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 8.255115985870361  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 8.25511646270752  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.09531736373901367  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10086774826049805  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10086774826049805  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07080978155136108 |0.08817225694656372 |0.30035459995269775 |0.00012093782424926758 |0.08489090204238892 |0.0058116912841796875 |
----------------------------------------------------------pseudo_mini_loss sum 5.330952167510986
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  955888
Number of first layer input nodes during this epoch:  572755
Number of first layer output nodes during this epoch:  383133
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10086727142333984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020689010620117188
global_2_local spend time (sec) 0.04017138481140137
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004402637481689453
A = g.adjacency_matrix() spent  0.007796764373779297
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0801229476928711
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3272731304168701
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.3045306205749512

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.037 seconds
Split the graph: 0.038 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.07955193519592285
22734
22736
22735
22736
total k batches seeds list generation spend  10.656672954559326
after graph partition
graph partition algorithm spend time 10.842865943908691
22734
22736
22735
22736
partition_len_list
[95788, 95709, 95552, 95583]
shared_neighbor_graph_partition_s0 selection method  spend 10.93160629272461
time for parepare:  0.0218658447265625
local_output_nid generation:  0.0031960010528564453
local_in_edges_tensor generation:  0.004884004592895508
mini_batch_src_global generation:  0.0076465606689453125
r_  generation:  0.06715250015258789
local_output_nid generation:  0.004237174987792969
local_in_edges_tensor generation:  0.004067659378051758
mini_batch_src_global generation:  0.009334087371826172
r_  generation:  0.07049989700317383
local_output_nid generation:  0.0041964054107666016
local_in_edges_tensor generation:  0.003981828689575195
mini_batch_src_global generation:  0.0071833133697509766
r_  generation:  0.07380199432373047
local_output_nid generation:  0.0047147274017333984
local_in_edges_tensor generation:  0.005433320999145508
mini_batch_src_global generation:  0.007339954376220703
r_  generation:  0.07849264144897461
----------------------check_connections_block total spend ----------------------------- 0.46381497383117676
generate_one_block  0.10599589347839355
generate_one_block  0.09549427032470703
generate_one_block  0.09895801544189453
generate_one_block  0.11772584915161133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02529144287109375
gen group dst list time:  0.011101245880126953
time for parepare:  0.020593643188476562
local_output_nid generation:  0.016771554946899414
local_in_edges_tensor generation:  0.030635595321655273
mini_batch_src_global generation:  0.020867586135864258
r_  generation:  0.25128984451293945
local_output_nid generation:  0.020995140075683594
local_in_edges_tensor generation:  0.02442622184753418
mini_batch_src_global generation:  0.02899932861328125
r_  generation:  0.2508714199066162
local_output_nid generation:  0.021811246871948242
local_in_edges_tensor generation:  0.022185802459716797
mini_batch_src_global generation:  0.026402950286865234
r_  generation:  0.2610790729522705
local_output_nid generation:  0.020972013473510742
local_in_edges_tensor generation:  0.022588253021240234
mini_batch_src_global generation:  0.029702425003051758
r_  generation:  0.2692856788635254
----------------------check_connections_block total spend ----------------------------- 1.5800034999847412
generate_one_block  0.3172461986541748
generate_one_block  0.31630444526672363
generate_one_block  0.31764721870422363
generate_one_block  0.3191068172454834
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10086727142333984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

connection checking time:  1.5800034999847412
block generation total time  1.2703046798706055
average batch blocks generation time:  0.31757616996765137
block dataloader generation time/epoch 14.870262145996094
pseudo mini batch 0 input nodes size: 143161
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08303689956665039  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08303689956665039  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.1513962745666504  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.1515660285949707  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08302021026611328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945369720458984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945369720458984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945369720458984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([143161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945369720458984  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([6232, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4242110252380371  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4242110252380371  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6232, 128]), torch.Size([1, 6232, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.43015432357788086  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.47770071029663086  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6232, 128])
m.shape torch.Size([7246, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.48163938522338867  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.48163938522338867  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7246, 128]), torch.Size([1, 7246, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.48854970932006836  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5922045707702637  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7246, 128])
m.shape torch.Size([7077, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5988731384277344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5988731384277344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7077, 128]), torch.Size([1, 7077, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.6056222915649414  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7556657791137695  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7077, 128])
m.shape torch.Size([6517, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7647213935852051  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7647213935852051  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6517, 128]), torch.Size([1, 6517, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7712035179138184  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9524145126342773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6517, 128])
m.shape torch.Size([6047, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9637241363525391  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9637241363525391  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6047, 128]), torch.Size([1, 6047, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9698033332824707  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.180555820465088  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6047, 128])
m.shape torch.Size([5215, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1924076080322266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1924076080322266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5215, 128]), torch.Size([1, 5215, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.198279857635498  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4121365547180176  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5215, 128])
m.shape torch.Size([4678, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4252643585205078  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4252643585205078  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4678, 128]), torch.Size([1, 4678, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4297256469726562  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.661888599395752  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4678, 128])
m.shape torch.Size([4274, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.675961971282959  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.675961971282959  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4274, 128]), torch.Size([1, 4274, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6800427436828613  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9127249717712402  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4274, 128])
m.shape torch.Size([3792, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9269604682922363  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9269604682922363  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3792, 128]), torch.Size([1, 3792, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9308061599731445  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.1622514724731445  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3792, 128])
m.shape torch.Size([44710, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.3736371994018555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.3736371994018555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 44710, 128]), torch.Size([1, 44710, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.4166059494018555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.4673871994018555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 44710, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.165575981140137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.257372856140137  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.348723411560059  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.2562127113342285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([95788, 256])
first layer input nodes number: 143161
first layer output nodes number: 95788
edges number: 677714
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.34991455078125  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.441265106201172  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.464702606201172  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.464702606201172  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([3417, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.647429466247559  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.647429466247559  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3417, 256]), torch.Size([1, 3417, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.65487813949585  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.707940101623535  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3417, 256])
m.shape torch.Size([2924, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.711221694946289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.711221694946289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2924, 256]), torch.Size([1, 2924, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.717076778411865  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.801171779632568  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2924, 256])
m.shape torch.Size([2331, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.805104732513428  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.805104732513428  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2331, 256]), torch.Size([1, 2331, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.80961275100708  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.909330368041992  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2331, 256])
m.shape torch.Size([1862, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.914266109466553  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.914266109466553  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1862, 256]), torch.Size([1, 1862, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.917836666107178  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.021348476409912  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1862, 256])
m.shape torch.Size([1541, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.026947021484375  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.026947021484375  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1541, 256]), torch.Size([1, 1541, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.030056476593018  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.13869047164917  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1541, 256])
m.shape torch.Size([1178, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.143775939941406  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.143775939941406  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1178, 256]), torch.Size([1, 1178, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.146109580993652  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.2481184005737305  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1178, 256])
m.shape torch.Size([971, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.2534098625183105  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.2534098625183105  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 971, 256]), torch.Size([1, 971, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.2552618980407715  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.347863674163818  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 971, 256])
m.shape torch.Size([888, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.353765487670898  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.353765487670898  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 888, 256]), torch.Size([1, 888, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.355459213256836  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.452150344848633  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 888, 256])
m.shape torch.Size([707, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.457419395446777  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.457419395446777  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 707, 256]), torch.Size([1, 707, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.458767890930176  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.547632217407227  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 707, 256])
m.shape torch.Size([648, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.553186416625977  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.553186416625977  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 648, 256]), torch.Size([1, 648, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.554422378540039  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.642663955688477  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 648, 256])
m.shape torch.Size([530, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.647649765014648  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.647649765014648  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 530, 256]), torch.Size([1, 530, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.648660659790039  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.728520393371582  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 530, 256])
m.shape torch.Size([491, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.733678340911865  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.733678340911865  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.734614849090576  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.816479206085205  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([414, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.821184158325195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.821184158325195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.82197380065918  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.89692497253418  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([382, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.901670455932617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.901670455932617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.902399063110352  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.976709365844727  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([321, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.980973243713379  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.980973243713379  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.981585502624512  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.0501203536987305  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([275, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.054043292999268  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.054043292999268  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.054567813873291  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.1153035163879395  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([258, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.119256973266602  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.119256973266602  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.119749069213867  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.180638313293457  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([227, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.184319496154785  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.184319496154785  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.184752464294434  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.239739418029785  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([219, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.243522644042969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.243522644042969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.243940353393555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.29991340637207  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([221, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.303953170776367  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.303953170776367  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.304374694824219  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.363809585571289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([165, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.366929531097412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.366929531097412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.367244243621826  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.413821697235107  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([146, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.416751861572266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.416751861572266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.417030334472656  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.460193634033203  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([136, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4630608558654785  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4630608558654785  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.463320255279541  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.505342960357666  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([122, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.50802755355835  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.50802755355835  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.508260250091553  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.547585964202881  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([2360, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.604176044464111  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.604176044464111  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2360, 256]), torch.Size([1, 2360, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.608753681182861  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.402100086212158  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2360, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.243341445922852  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.247614860534668  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.251002788543701  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.246559619903564  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([22734, 40])
input nodes number: 95788
output nodes number: 22734
edges number: 185676
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.247443199157715  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.247444152832031  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10085773468017578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

pseudo mini batch 1 input nodes size: 143230
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.15131855010986328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.1514883041381836  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08295917510986328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08938312530517578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08938312530517578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08938312530517578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([143230, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08938312530517578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([6101, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.42362070083618164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.42362070083618164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6101, 128]), torch.Size([1, 6101, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.42943906784057617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4763960838317871  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6101, 128])
m.shape torch.Size([7365, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4805107116699219  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4805107116699219  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7365, 128]), torch.Size([1, 7365, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4875345230102539  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5928916931152344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7365, 128])
m.shape torch.Size([7062, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5994820594787598  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5994820594787598  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7062, 128]), torch.Size([1, 7062, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.6063613891601562  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.75634765625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7062, 128])
m.shape torch.Size([6548, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7654695510864258  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7654695510864258  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6548, 128]), torch.Size([1, 6548, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7719593048095703  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9530677795410156  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6548, 128])
m.shape torch.Size([6066, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9644079208374023  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9644079208374023  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6066, 128]), torch.Size([1, 6066, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9704780578613281  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1817398071289062  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6066, 128])
m.shape torch.Size([5224, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1937932968139648  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1937932968139648  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5224, 128]), torch.Size([1, 5224, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.198775291442871  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4130878448486328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5224, 128])
m.shape torch.Size([4740, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4264183044433594  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4264183044433594  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4740, 128]), torch.Size([1, 4740, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4310765266418457  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.664623737335205  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4740, 128])
m.shape torch.Size([4225, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.678480625152588  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.678480625152588  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4225, 128]), torch.Size([1, 4225, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6826691627502441  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9129199981689453  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4225, 128])
m.shape torch.Size([3871, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9275178909301758  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9275178909301758  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3871, 128]), torch.Size([1, 3871, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9314508438110352  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.1678385734558105  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3871, 128])
m.shape torch.Size([44507, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.378218650817871  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.378218650817871  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 44507, 128]), torch.Size([1, 44507, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.421187400817871  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.440554618835449  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 44507, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.139862060546875  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.231137275695801  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.322412490844727  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.230423927307129  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([95709, 256])
first layer input nodes number: 143230
first layer output nodes number: 95709
edges number: 676772
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.323487281799316  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.414762496948242  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.438199996948242  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.438199996948242  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([3364, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.620667457580566  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.620667457580566  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3364, 256]), torch.Size([1, 3364, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.627751350402832  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.679205417633057  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3364, 256])
m.shape torch.Size([2932, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.681633472442627  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.681633472442627  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2932, 256]), torch.Size([1, 2932, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.687444686889648  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.7728142738342285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2932, 256])
m.shape torch.Size([2305, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.776768684387207  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.776768684387207  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2305, 256]), torch.Size([1, 2305, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.781646728515625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.878966331481934  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2305, 256])
m.shape torch.Size([1812, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.883734703063965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.883734703063965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1812, 256]), torch.Size([1, 1812, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.887262344360352  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.989704132080078  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1812, 256])
m.shape torch.Size([1543, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.995391368865967  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.995391368865967  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1543, 256]), torch.Size([1, 1543, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.998419761657715  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.106385707855225  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1543, 256])
m.shape torch.Size([1238, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.111908912658691  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.111908912658691  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1238, 256]), torch.Size([1, 1238, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.114274024963379  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.21804666519165  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1238, 256])
m.shape torch.Size([1011, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.223449230194092  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.223449230194092  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1011, 256]), torch.Size([1, 1011, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.225377559661865  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.322537899017334  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1011, 256])
m.shape torch.Size([874, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.328294277191162  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.328294277191162  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.32996129989624  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.424981594085693  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 874, 256])
m.shape torch.Size([795, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.43102502822876  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.43102502822876  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.432541370391846  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.529587268829346  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 795, 256])
m.shape torch.Size([668, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.535249710083008  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.535249710083008  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 668, 256]), torch.Size([1, 668, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.536523818969727  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.628848075866699  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 668, 256])
m.shape torch.Size([555, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.6340789794921875  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.6340789794921875  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.635137557983398  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.719281196594238  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([491, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.724415302276611  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.724415302276611  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.725351810455322  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.806869983673096  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([409, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.811512470245361  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.811512470245361  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.812292575836182  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.886559963226318  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([343, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.891695499420166  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.891695499420166  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.892349720001221  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.959446907043457  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([313, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.963632583618164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.963632583618164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.964229583740234  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.028556823730469  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([275, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.032487392425537  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.032487392425537  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.0330119132995605  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.093333721160889  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([263, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.0973687171936035  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.0973687171936035  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.097870349884033  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.160102367401123  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([239, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.163986682891846  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.163986682891846  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.164442539215088  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.222336292266846  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([204, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.225833892822266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.225833892822266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.226222991943359  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.278362274169922  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([195, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.28191614151001  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.28191614151001  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.282288074493408  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.334730625152588  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([193, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.338440418243408  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.338440418243408  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.338808536529541  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.393290042877197  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([142, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.396108627319336  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.396108627319336  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.396379470825195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.438360214233398  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([132, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.441143035888672  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.441143035888672  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.441394805908203  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.482181549072266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([148, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.485469818115234  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.485469818115234  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.485752105712891  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.533458709716797  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([2292, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.588390350341797  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.588390350341797  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2292, 256]), torch.Size([1, 2292, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.592761993408203  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.363649845123291  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2292, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.205147743225098  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.20853567123413  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.211923599243164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.20836591720581  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([22736, 40])
input nodes number: 95709
output nodes number: 22736
edges number: 185263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.209249019622803  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.209249496459961  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10065555572509766  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

pseudo mini batch 2 input nodes size: 143109
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08295917510986328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08295917510986328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.15131855010986328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.1514883041381836  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945178985595703  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945178985595703  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945178985595703  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([143109, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08945178985595703  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([6004, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4238734245300293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4238734245300293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6004, 128]), torch.Size([1, 6004, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4295992851257324  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.47674131393432617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6004, 128])
m.shape torch.Size([7256, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.48079824447631836  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.48079824447631836  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7256, 128]), torch.Size([1, 7256, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4877181053161621  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5915160179138184  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7256, 128])
m.shape torch.Size([7090, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.598198413848877  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.598198413848877  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7090, 128]), torch.Size([1, 7090, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.605039119720459  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7551321983337402  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7090, 128])
m.shape torch.Size([6528, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7651457786560059  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7651457786560059  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6528, 128]), torch.Size([1, 6528, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.771639347076416  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.952242374420166  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6528, 128])
m.shape torch.Size([5960, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9633393287658691  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9633393287658691  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5960, 128]), torch.Size([1, 5960, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9695496559143066  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1788125038146973  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5960, 128])
m.shape torch.Size([5221, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1909079551696777  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1909079551696777  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5221, 128]), torch.Size([1, 5221, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1958870887756348  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.411026954650879  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5221, 128])
m.shape torch.Size([4757, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4244155883789062  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4244155883789062  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4757, 128]), torch.Size([1, 4757, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4290809631347656  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6643247604370117  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4757, 128])
m.shape torch.Size([4310, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6784977912902832  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6784977912902832  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4310, 128]), torch.Size([1, 4310, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.682706356048584  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.917304515838623  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4310, 128])
m.shape torch.Size([3798, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9315485954284668  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9315485954284668  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3798, 128]), torch.Size([1, 3798, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9355769157409668  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.167832851409912  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3798, 128])
m.shape torch.Size([44628, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.3788247108459473  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.3788247108459473  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 44628, 128]), torch.Size([1, 44628, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.4217934608459473  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.472574710845947  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 44628, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.171450138092041  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.262575626373291  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.353701114654541  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.261863708496094  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([95552, 256])
first layer input nodes number: 143109
first layer output nodes number: 95552
edges number: 677265
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.354923725128174  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.446049213409424  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.469486713409424  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.469486713409424  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([3295, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.652721881866455  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.652721881866455  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3295, 256]), torch.Size([1, 3295, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.659998893737793  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.710738182067871  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3295, 256])
m.shape torch.Size([3023, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.713407039642334  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.713407039642334  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3023, 256]), torch.Size([1, 3023, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.719649791717529  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.806138515472412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3023, 256])
m.shape torch.Size([2296, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.809875965118408  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.809875965118408  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2296, 256]), torch.Size([1, 2296, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.814907550811768  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.912351131439209  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2296, 256])
m.shape torch.Size([1834, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.91721248626709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.91721248626709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1834, 256]), torch.Size([1, 1834, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.920783042907715  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.023411750793457  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1834, 256])
m.shape torch.Size([1590, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.029038906097412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.029038906097412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1590, 256]), torch.Size([1, 1590, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.032191753387451  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.146768569946289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1590, 256])
m.shape torch.Size([1231, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.152351379394531  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.152351379394531  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1231, 256]), torch.Size([1, 1231, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.154767990112305  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.263160705566406  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1231, 256])
m.shape torch.Size([1022, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.268697738647461  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.268697738647461  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1022, 256]), torch.Size([1, 1022, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.270647048950195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.368265151977539  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1022, 256])
m.shape torch.Size([863, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.373926162719727  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.373926162719727  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 863, 256]), torch.Size([1, 863, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.375572204589844  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.46942138671875  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 863, 256])
m.shape torch.Size([726, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.474878787994385  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.474878787994385  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.476263523101807  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.566708087921143  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 726, 256])
m.shape torch.Size([624, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.5720133781433105  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.5720133781433105  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.5732035636901855  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.6596903800964355  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([575, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.66517448425293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.66517448425293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.666271209716797  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.753016471862793  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([463, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.757808208465576  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.757808208465576  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.758691310882568  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.83461332321167  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([391, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.839057445526123  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.839057445526123  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.839803218841553  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.909121990203857  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([348, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.9134321212768555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.9134321212768555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.914095878601074  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.982771873474121  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([342, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.98737096786499  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.98737096786499  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.988023281097412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.057296276092529  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([288, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.061398983001709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.061398983001709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.061948299407959  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.126439571380615  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([242, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.130346298217773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.130346298217773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.130807876586914  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.186197280883789  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([245, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.190205097198486  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.190205097198486  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.190672397613525  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.250019550323486  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([186, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.253182888031006  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.253182888031006  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.253537654876709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.301076412200928  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([191, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.30457067489624  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.30457067489624  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.304934978485107  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.356301784515381  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([192, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.359994888305664  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.359994888305664  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.360361099243164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.414560317993164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([122, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.416956901550293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.416956901550293  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.417189598083496  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4532575607299805  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([122, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.455838203430176  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.455838203430176  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.456070899963379  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.493767738342285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([125, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.496534824371338  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.496534824371338  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4967732429504395  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.5370659828186035  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([2399, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.594590663909912  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.594590663909912  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2399, 256]), torch.Size([1, 2399, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.599166393280029  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.407025814056396  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2399, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.24723196029663  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.250619888305664  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.254007816314697  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.250450134277344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([22735, 40])
input nodes number: 95552
output nodes number: 22735
edges number: 185682
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.251331806182861  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.25133228302002  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10087776184082031  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

pseudo mini batch 3 input nodes size: 143024
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.15122032165527344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.15139007568359375  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08286094665527344  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08931255340576172  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08931255340576172  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08931255340576172  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([143024, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08931255340576172  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([5979, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4250054359436035  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4250054359436035  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5979, 128]), torch.Size([1, 5979, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4307074546813965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.47789716720581055  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5979, 128])
m.shape torch.Size([7185, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.48189830780029297  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.48189830780029297  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7185, 128]), torch.Size([1, 7185, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4887504577636719  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5915327072143555  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7185, 128])
m.shape torch.Size([7067, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5982160568237305  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5982160568237305  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 7067, 128]), torch.Size([1, 7067, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.6050119400024414  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7550172805786133  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 7067, 128])
m.shape torch.Size([6517, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7640776634216309  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7640776634216309  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6517, 128]), torch.Size([1, 6517, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7705550193786621  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9508800506591797  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6517, 128])
m.shape torch.Size([6082, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.962273120880127  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.962273120880127  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 6082, 128]), torch.Size([1, 6082, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9684109687805176  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1797051429748535  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 6082, 128])
m.shape torch.Size([5211, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.191713809967041  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.191713809967041  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 5211, 128]), torch.Size([1, 5211, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.196683406829834  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4104371070861816  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 5211, 128])
m.shape torch.Size([4719, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.423703670501709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.423703670501709  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4719, 128]), torch.Size([1, 4719, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4283757209777832  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6619410514831543  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4719, 128])
m.shape torch.Size([4289, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6769719123840332  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6769719123840332  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 4289, 128]), torch.Size([1, 4289, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6812400817871094  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9149603843688965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 4289, 128])
m.shape torch.Size([3781, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.929276466369629  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.929276466369629  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3781, 128]), torch.Size([1, 3781, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9331178665161133  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.1650753021240234  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3781, 128])
m.shape torch.Size([44753, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.376671314239502  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.376671314239502  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 44753, 128]), torch.Size([1, 44753, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.419640064239502  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.46984338760376  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 44753, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.1674699783325195  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.258625030517578  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.349780082702637  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.257912635803223  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

torch.Size([95583, 256])
first layer input nodes number: 143024
first layer output nodes number: 95583
edges number: 678198
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.350906848907471  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.442061901092529  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.465499401092529  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.465499401092529  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

m.shape torch.Size([3352, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.650155067443848  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.650155067443848  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 3352, 256]), torch.Size([1, 3352, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.6572442054748535  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.708621025085449  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 3352, 256])
m.shape torch.Size([2827, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.7108588218688965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.7108588218688965  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2827, 256]), torch.Size([1, 2827, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.716866493225098  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.798691272735596  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2827, 256])
m.shape torch.Size([2345, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.802792072296143  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.802792072296143  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2345, 256]), torch.Size([1, 2345, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.8074541091918945  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.908130645751953  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2345, 256])
m.shape torch.Size([1812, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.912860870361328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.912860870361328  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1812, 256]), torch.Size([1, 1812, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.916478157043457  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.018407821655273  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1812, 256])
m.shape torch.Size([1548, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.024118900299072  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.024118900299072  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1548, 256]), torch.Size([1, 1548, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.027117729187012  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.134049415588379  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1548, 256])
m.shape torch.Size([1221, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.139537811279297  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.139537811279297  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1221, 256]), torch.Size([1, 1221, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.142021179199219  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.248300075531006  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1221, 256])
m.shape torch.Size([1041, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.253694534301758  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.253694534301758  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 1041, 256]), torch.Size([1, 1041, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.255788803100586  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.359727382659912  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 1041, 256])
m.shape torch.Size([847, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.364599704742432  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.364599704742432  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.366215229034424  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.460398197174072  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([748, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.466061115264893  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.466061115264893  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.467487812042236  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.5591721534729  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([659, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.564792633056641  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.564792633056641  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 659, 256]), torch.Size([1, 659, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.566049575805664  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.656206130981445  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 659, 256])
m.shape torch.Size([543, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.661318778991699  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.661318778991699  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.662354469299316  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.746456146240234  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([492, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.751613140106201  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.751613140106201  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.752551555633545  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.83479642868042  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([442, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.839849948883057  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.839849948883057  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.84069299697876  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.918943881988525  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([361, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.923379898071289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.923379898071289  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.924068450927734  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.993373870849609  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([313, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.997542381286621  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.997542381286621  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.998139381408691  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.063529968261719  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([273, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.067430019378662  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.067430019378662  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.06795072555542  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.128404140472412  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([267, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.132506370544434  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.132506370544434  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.1330156326293945  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.195196151733398  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([237, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.199041843414307  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.199041843414307  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.199493885040283  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.256903171539307  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([227, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.260822772979736  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.260822772979736  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.261255741119385  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.319273471832275  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([200, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.322901725769043  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.322901725769043  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.3232831954956055  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.377070426940918  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([167, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.380250453948975  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.380250453948975  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.380568981170654  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.427711009979248  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([146, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.430639266967773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.430639266967773  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.430917739868164  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.474081039428711  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([129, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4767937660217285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4767937660217285  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.477039813995361  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.516899585723877  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes
[04:18:38] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 4 parts and get 0 edge cuts

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([130, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.519775390625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.519775390625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.520023345947266  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.561927795410156  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([2409, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.619688034057617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.619688034057617  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

 h.shape torch.Size([1, 2409, 256]), torch.Size([1, 2409, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.6242828369140625  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.435559272766113  GigaBytes
Max Memory Allocated: 8.493657112121582  GigaBytes

rst.shape  torch.Size([1, 2409, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.273462295532227  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.27685022354126  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.280238151550293  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.27668046951294  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([22736, 40])
input nodes number: 95583
output nodes number: 22736
edges number: 187629
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.277562618255615  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.277563095092773  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10067892074584961  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10067892074584961  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.10067892074584961  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06939584016799927 |0.004810631275177002 |0.1535281538963318 |0.00010448694229125977 |0.08454644680023193 |0.004642009735107422 |
----------------------------------------------------------pseudo_mini_loss sum 4.132620811462402
Total (block generation + training)time/epoch 16.200374841690063
Training time/epoch 1.3298437595367432
Training time without block to device /epoch 1.3106012344360352
Training time without total dataloading part /epoch 0.9573583602905273
load block tensor time/epoch 0.27758336067199707
block to device time/epoch 0.019242525100708008
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  955156
Number of first layer input nodes during this epoch:  572524
Number of first layer output nodes during this epoch:  382632
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.1006784439086914  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02107524871826172
global_2_local spend time (sec) 0.045708417892456055
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004441976547241211
A = g.adjacency_matrix() spent  0.012002944946289062
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08329463005065918
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3149151802062988
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1599133014678955

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.034 seconds
Split the graph: 0.032 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.06975436210632324
22734
22736
22735
22736
total k batches seeds list generation spend  9.905761957168579
after graph partition
graph partition algorithm spend time 10.043396234512329
22734
22736
22735
22736
partition_len_list
[95296, 95810, 95948, 95340]
shared_neighbor_graph_partition_s0 selection method  spend 10.142543077468872
time for parepare:  0.018042564392089844
local_output_nid generation:  0.0034372806549072266
local_in_edges_tensor generation:  0.004009246826171875
mini_batch_src_global generation:  0.01009988784790039
r_  generation:  0.06740951538085938
local_output_nid generation:  0.005811929702758789
local_in_edges_tensor generation:  0.004385709762573242
mini_batch_src_global generation:  0.009171009063720703
r_  generation:  0.071502685546875
local_output_nid generation:  0.005072116851806641
local_in_edges_tensor generation:  0.003980875015258789
mini_batch_src_global generation:  0.005700588226318359
r_  generation:  0.07653188705444336
local_output_nid generation:  0.00510716438293457
local_in_edges_tensor generation:  0.004233837127685547
mini_batch_src_global generation:  0.00632929801940918
r_  generation:  0.07700395584106445
----------------------check_connections_block total spend ----------------------------- 0.4572944641113281
generate_one_block  0.10551261901855469
generate_one_block  0.1033773422241211
generate_one_block  0.10305619239807129
generate_one_block  0.09710836410522461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028506994247436523
gen group dst list time:  0.011444330215454102
time for parepare:  0.02106475830078125
local_output_nid generation:  0.017879009246826172
local_in_edges_tensor generation:  0.028545856475830078
mini_batch_src_global generation:  0.02126026153564453
r_  generation:  0.24149584770202637
local_output_nid generation:  0.02175736427307129
local_in_edges_tensor generation:  0.023386001586914062
mini_batch_src_global generation:  0.026790380477905273
r_  generation:  0.2589724063873291
local_output_nid generation:  0.02144145965576172
local_in_edges_tensor generation:  0.020186424255371094
mini_batch_src_global generation:  0.026600122451782227
r_  generation:  0.25654029846191406
local_output_nid generation:  0.020704030990600586
local_in_edges_tensor generation:  0.017401695251464844
mini_batch_src_global generation:  0.027041912078857422
r_  generation:  0.2559683322906494
----------------------check_connections_block total spend ----------------------------- 1.5378060340881348
generate_one_block  0.31340932846069336
generate_one_block  0.31581735610961914
generate_one_block  0.3357417583465576
generate_one_block  0.318756103515625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.1006784439086914  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

connection checking time:  1.5378060340881348
block generation total time  1.2837245464324951
average batch blocks generation time:  0.3209311366081238
block dataloader generation time/epoch 14.43612790107727
pseudo mini batch 0 input nodes size: 142897
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08285999298095703  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08285999298095703  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.15121936798095703  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.15138912200927734  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.08302021026611328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.0894317626953125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.0894317626953125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.0894317626953125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([142897, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.0894317626953125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([5958, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.42302799224853516  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.42302799224853516  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 5958, 128]), torch.Size([1, 5958, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4287099838256836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4759397506713867  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 5958, 128])
m.shape torch.Size([7281, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4800424575805664  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4800424575805664  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7281, 128]), torch.Size([1, 7281, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.4869861602783203  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5911417007446289  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7281, 128])
m.shape torch.Size([7056, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5977635383605957  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.5977635383605957  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7056, 128]), torch.Size([1, 7056, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.6045999526977539  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7545633316040039  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7056, 128])
m.shape torch.Size([6520, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7636346817016602  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7636346817016602  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6520, 128]), torch.Size([1, 6520, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.7701082229614258  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9505090713500977  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6520, 128])
m.shape torch.Size([5998, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.961700439453125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.961700439453125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 5998, 128]), torch.Size([1, 5998, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 0.9674205780029297  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1772441864013672  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 5998, 128])
m.shape torch.Size([5161, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1891498565673828  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1891498565673828  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 5161, 128]), torch.Size([1, 5161, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.1940717697143555  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4060230255126953  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 5161, 128])
m.shape torch.Size([4633, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4190263748168945  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4190263748168945  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4633, 128]), torch.Size([1, 4633, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.4235186576843262  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6578593254089355  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4633, 128])
m.shape torch.Size([4313, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6729722023010254  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6729722023010254  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4313, 128]), torch.Size([1, 4313, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.6770853996276855  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9115376472473145  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4313, 128])
m.shape torch.Size([3794, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9257631301879883  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.9257631301879883  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3794, 128]), torch.Size([1, 3794, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 1.929478645324707  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.162062168121338  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3794, 128])
m.shape torch.Size([44582, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.3728365898132324  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.3728365898132324  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 44582, 128]), torch.Size([1, 44582, 128])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 2.4158053398132324  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.466586589813232  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 44582, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.166016578674316  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.256897926330566  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.347779273986816  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.256187915802002  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([95296, 256])
first layer input nodes number: 142897
first layer output nodes number: 95296
edges number: 675625
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.349017143249512  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.439898490905762  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.463335990905762  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.463335990905762  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([3351, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.6450676918029785  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.6450676918029785  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3351, 256]), torch.Size([1, 3351, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.651788711547852  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.704975605010986  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3351, 256])
m.shape torch.Size([2959, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.707468032836914  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.707468032836914  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2959, 256]), torch.Size([1, 2959, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.7131500244140625  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.797807693481445  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2959, 256])
m.shape torch.Size([2372, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.8022308349609375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.8022308349609375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2372, 256]), torch.Size([1, 2372, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.807289123535156  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.906822204589844  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2372, 256])
m.shape torch.Size([1819, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.911553382873535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.911553382873535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1819, 256]), torch.Size([1, 1819, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 5.9150285720825195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.018182277679443  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1819, 256])
m.shape torch.Size([1589, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.023582458496094  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.023582458496094  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1589, 256]), torch.Size([1, 1589, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.0267252922058105  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.140965938568115  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1589, 256])
m.shape torch.Size([1175, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.14622688293457  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.14622688293457  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1175, 256]), torch.Size([1, 1175, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.148698806762695  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.246695518493652  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1175, 256])
m.shape torch.Size([1021, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.252260208129883  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.252260208129883  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1021, 256]), torch.Size([1, 1021, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.254207611083984  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.351749420166016  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1021, 256])
m.shape torch.Size([884, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.35757303237915  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.35757303237915  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 884, 256]), torch.Size([1, 884, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.359259128570557  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.455837726593018  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 884, 256])
m.shape torch.Size([758, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.461551666259766  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.461551666259766  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.4629974365234375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.555543899536133  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([621, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.560790061950684  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.560790061950684  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.56197452545166  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.649155616760254  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([533, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.65419864654541  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.65419864654541  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.655215263366699  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.736021995544434  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([447, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.740669250488281  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.740669250488281  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.741521835327148  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.815855026245117  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([410, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.820551872253418  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.820551872253418  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.821333885192871  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.895291328430176  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([355, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.899677276611328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.899677276611328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.900354385375977  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.969330787658691  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([359, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.974168300628662  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.974168300628662  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 6.974853038787842  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.048914432525635  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([292, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.053073883056641  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.053073883056641  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.053630828857422  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.119590759277344  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([250, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.123397350311279  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.123397350311279  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.123874187469482  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.181094646453857  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([242, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.1850433349609375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.1850433349609375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.185504913330078  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.2441253662109375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([201, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.247565269470215  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.247565269470215  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.24794864654541  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.299321174621582  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([200, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.302974224090576  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.302974224090576  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.303355693817139  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.357142925262451  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([166, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.360302925109863  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.360302925109863  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.36061954498291  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.407479286193848  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([145, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.410571098327637  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.410571098327637  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4108476638793945  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.4537153244018555  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([132, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.45649528503418  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.45649528503418  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.456747055053711  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.497533798217773  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([122, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.500222206115723  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.500222206115723  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.500454902648926  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.539780616760254  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([2331, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.59567403793335  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.59567403793335  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2331, 256]), torch.Size([1, 2331, 256])
----------------------------------------3
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 7.600915431976318  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.38345193862915  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.225514888763428  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.228902816772461  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.232290744781494  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.22873306274414  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([22734, 40])
input nodes number: 95296
output nodes number: 22734
edges number: 184831
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.229612827301025  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4256591796875 GB
    Memory Allocated: 8.229613780975342  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.10084247589111328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

pseudo mini batch 1 input nodes size: 143279
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.15134191513061523  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.15151166915893555  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.08298254013061523  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.08944082260131836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.08944082260131836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.08944082260131836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([143279, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.08944082260131836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([6033, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.4251723289489746  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.4251723289489746  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6033, 128]), torch.Size([1, 6033, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.4309258460998535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.4778008460998535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6033, 128])
m.shape torch.Size([7352, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.4819355010986328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.4819355010986328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7352, 128]), torch.Size([1, 7352, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.48894691467285156  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.5941181182861328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7352, 128])
m.shape torch.Size([7090, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.6007547378540039  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.6007547378540039  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7090, 128]), torch.Size([1, 7090, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.6076412200927734  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.7577342987060547  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7090, 128])
m.shape torch.Size([6536, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.766819953918457  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.766819953918457  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6536, 128]), torch.Size([1, 6536, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.7733173370361328  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.9541225433349609  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6536, 128])
m.shape torch.Size([5959, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.9652132987976074  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.9652132987976074  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 5959, 128]), torch.Size([1, 5959, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.9717111587524414  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.1812372207641602  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 5959, 128])
m.shape torch.Size([5225, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.1933445930480957  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.1933445930480957  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 5225, 128]), torch.Size([1, 5225, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.1983275413513184  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.4136261940002441  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 5225, 128])
m.shape torch.Size([4724, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.4269027709960938  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.4269027709960938  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4724, 128]), torch.Size([1, 4724, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.431541919708252  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.6649937629699707  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4724, 128])
m.shape torch.Size([4288, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.6790986061096191  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.6790986061096191  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4288, 128]), torch.Size([1, 4288, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.6832804679870605  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.9166231155395508  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4288, 128])
m.shape torch.Size([3801, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.9308905601501465  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.9308905601501465  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3801, 128]), torch.Size([1, 3801, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 1.934812068939209  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 2.1671719551086426  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3801, 128])
m.shape torch.Size([44802, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 2.3789920806884766  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 2.3789920806884766  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 44802, 128]), torch.Size([1, 44802, 128])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 2.4219608306884766  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.472257614135742  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 44802, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.170327186584473  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.2616987228393555  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.353070259094238  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.260984420776367  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([95810, 256])
first layer input nodes number: 143279
first layer output nodes number: 95810
edges number: 678897
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.354201316833496  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.445572853088379  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.469010353088379  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.469010353088379  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([3362, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.653597354888916  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.653597354888916  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3362, 256]), torch.Size([1, 3362, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.660309314727783  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.7116923332214355  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3362, 256])
m.shape torch.Size([2940, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.714873790740967  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.714873790740967  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2940, 256]), torch.Size([1, 2940, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.720554351806641  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.804668426513672  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2940, 256])
m.shape torch.Size([2318, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.80862283706665  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.80862283706665  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2318, 256]), torch.Size([1, 2318, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.8130784034729  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.910702705383301  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2318, 256])
m.shape torch.Size([1767, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.915285587310791  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.915285587310791  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1767, 256]), torch.Size([1, 1767, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 5.918728351593018  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.018188953399658  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1767, 256])
m.shape torch.Size([1520, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.02323055267334  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.02323055267334  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1520, 256]), torch.Size([1, 1520, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.026192665100098  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.13295841217041  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1520, 256])
m.shape torch.Size([1211, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.138339996337891  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.138339996337891  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1211, 256]), torch.Size([1, 1211, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.14072847366333  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.242032527923584  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1211, 256])
m.shape torch.Size([984, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.247326374053955  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.247326374053955  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 984, 256]), torch.Size([1, 984, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.249203205108643  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.346780300140381  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 984, 256])
m.shape torch.Size([894, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.352715969085693  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.352715969085693  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 894, 256]), torch.Size([1, 894, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.354421138763428  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.451615810394287  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 894, 256])
m.shape torch.Size([753, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.457276821136475  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.457276821136475  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.458713054656982  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.550776958465576  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([630, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.556114196777344  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.556114196777344  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.557315826416016  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.643951416015625  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([553, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.649197578430176  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.649197578430176  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.650252342224121  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.734409332275391  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([475, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.739360809326172  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.739360809326172  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.740266799926758  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.818092346191406  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([430, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.823012351989746  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.823012351989746  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.8238325119018555  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.900193214416504  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([354, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.904546737670898  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.904546737670898  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.905221939086914  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.975002288818359  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([322, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.979307174682617  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.979307174682617  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 6.979921340942383  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.04538631439209  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([292, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.049905300140381  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.049905300140381  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.050462245941162  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.114770412445068  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([251, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.118593215942383  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.118593215942383  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.119071960449219  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.176521301269531  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([249, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.1805901527404785  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.1805901527404785  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.181065082550049  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.2413811683654785  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([202, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.244832515716553  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.244832515716553  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.245217800140381  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.29684591293335  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([203, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.30055570602417  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.30055570602417  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.300942897796631  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.355536937713623  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([192, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.359218597412109  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.359218597412109  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.359584808349609  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.413784027099609  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([141, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.4165825843811035  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.4165825843811035  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.41685152053833  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.458536624908447  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([124, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.461143493652344  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.461143493652344  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.4613800048828125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.49969482421875  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([156, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.503175258636475  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.503175258636475  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 7.503472805023193  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 7.553758144378662  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([2413, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 7.611589431762695  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 7.611589431762695  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2413, 256]), torch.Size([1, 2413, 256])
----------------------------------------3
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 7.616191864013672  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 8.427766799926758  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2413, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 8.267247200012207  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 8.27063512802124  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 8.274023056030273  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 8.27046537399292  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([22736, 40])
input nodes number: 95810
output nodes number: 22736
edges number: 187780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 8.271349430084229  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 8.271349906921387  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.10082578659057617  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

pseudo mini batch 2 input nodes size: 143204
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08298254013061523  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08298254013061523  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.15134191513061523  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.15151166915893555  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08947277069091797  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08947277069091797  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08947277069091797  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([143204, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08947277069091797  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([6221, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4253044128417969  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4253044128417969  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6221, 128]), torch.Size([1, 6221, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.43123722076416016  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4786996841430664  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6221, 128])
m.shape torch.Size([7172, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4825730323791504  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4825730323791504  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7172, 128]), torch.Size([1, 7172, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.489412784576416  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5920090675354004  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7172, 128])
m.shape torch.Size([7059, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5986871719360352  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5986871719360352  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7059, 128]), torch.Size([1, 7059, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.6054191589355469  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.7553939819335938  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7059, 128])
m.shape torch.Size([6605, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.7646260261535645  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.7646260261535645  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6605, 128]), torch.Size([1, 6605, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.771141529083252  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9544472694396973  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6605, 128])
m.shape torch.Size([6084, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9658031463623047  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9658031463623047  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6084, 128]), torch.Size([1, 6084, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9717965126037598  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.182753562927246  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6084, 128])
m.shape torch.Size([5272, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.1949357986450195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.1949357986450195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 5272, 128]), torch.Size([1, 5272, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.2005224227905273  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.4167165756225586  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 5272, 128])
m.shape torch.Size([4639, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.4296870231628418  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.4296870231628418  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4639, 128]), torch.Size([1, 4639, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.4343233108520508  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.6641654968261719  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4639, 128])
m.shape torch.Size([4222, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.6780591011047363  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.6780591011047363  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4222, 128]), torch.Size([1, 4222, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.6823959350585938  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.9119014739990234  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4222, 128])
m.shape torch.Size([3776, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.9260931015014648  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.9260931015014648  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3776, 128]), torch.Size([1, 3776, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.9297056198120117  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.1616568565368652  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3776, 128])
m.shape torch.Size([44898, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.3745551109313965  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.3745551109313965  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 44898, 128]), torch.Size([1, 44898, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.4175238609313965  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.4683051109313965  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 44898, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.165703773498535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.257500648498535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.349003791809082  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.256491661071777  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([95948, 256])
first layer input nodes number: 143204
first layer output nodes number: 95948
edges number: 679427
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.350079536437988  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.441582679748535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.465020179748535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.465020179748535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([3406, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.648361682891846  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.648361682891846  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3406, 256]), torch.Size([1, 3406, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.655147552490234  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.7076544761657715  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3406, 256])
m.shape torch.Size([2868, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.709919452667236  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.709919452667236  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2868, 256]), torch.Size([1, 2868, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.715786933898926  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.7978410720825195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2868, 256])
m.shape torch.Size([2254, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.801694869995117  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.801694869995117  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2254, 256]), torch.Size([1, 2254, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.806298732757568  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.902589321136475  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2254, 256])
m.shape torch.Size([1861, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.907705307006836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.907705307006836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1861, 256]), torch.Size([1, 1861, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.911462783813477  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.017029762268066  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1861, 256])
m.shape torch.Size([1574, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.0228190422058105  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.0228190422058105  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1574, 256]), torch.Size([1, 1574, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.025932788848877  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.135978698730469  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1574, 256])
m.shape torch.Size([1205, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.1414265632629395  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.1414265632629395  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1205, 256]), torch.Size([1, 1205, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.143829822540283  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.2512736320495605  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1205, 256])
m.shape torch.Size([1048, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.256865501403809  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.256865501403809  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1048, 256]), torch.Size([1, 1048, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.25894832611084  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.363158226013184  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1048, 256])
m.shape torch.Size([833, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.368564128875732  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.368564128875732  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 833, 256]), torch.Size([1, 833, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.370152950286865  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.463561534881592  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 833, 256])
m.shape torch.Size([741, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.46917724609375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.46917724609375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 741, 256]), torch.Size([1, 741, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.470590591430664  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.561044692993164  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 741, 256])
m.shape torch.Size([680, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.566874027252197  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.566874027252197  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 680, 256]), torch.Size([1, 680, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.56817102432251  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.66033411026001  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 680, 256])
m.shape torch.Size([557, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.665574550628662  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.665574550628662  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.666636943817139  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.752513408660889  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([515, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.757922172546387  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.757922172546387  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.758904457092285  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.842436790466309  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([428, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.847293376922607  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.847293376922607  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.848109722137451  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.92409086227417  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([330, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.928123474121094  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.928123474121094  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.928752899169922  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.994576454162598  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([311, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.998745441436768  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.998745441436768  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.999338626861572  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.06387186050415  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([254, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.067481517791748  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.067481517791748  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.067965984344482  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.122710704803467  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([263, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.126765727996826  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.126765727996826  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.127267360687256  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.189028263092041  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([226, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.192687511444092  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.192687511444092  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.193118572235107  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.247863292694092  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([218, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.251628875732422  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.251628875732422  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.252044677734375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.307762145996094  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([199, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.312263011932373  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.312263011932373  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.312642574310303  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.366160869598389  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([177, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.36954402923584  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.36954402923584  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.369881629943848  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.419846534729004  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([142, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.422680377960205  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.422680377960205  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.4229512214660645  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.464931964874268  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([142, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.467936038970947  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.467936038970947  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.468206882476807  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.512083530426025  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([113, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.514554977416992  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.514554977416992  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.5147705078125  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.55119514465332  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([2390, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.608514785766602  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.608514785766602  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2390, 256]), torch.Size([1, 2390, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.613073348999023  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.417790412902832  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2390, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.257556438446045  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.260944366455078  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.264332294464111  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.260774612426758  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([22735, 40])
input nodes number: 95948
output nodes number: 22735
edges number: 186367
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.261659622192383  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.261660099029541  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.10078716278076172  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

pseudo mini batch 3 input nodes size: 142869
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08302116394042969  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.15114641189575195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.15131616592407227  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08278703689575195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08919572830200195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08919572830200195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08919572830200195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([142869, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.08919572830200195  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([6055, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4224433898925781  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4224433898925781  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6055, 128]), torch.Size([1, 6055, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.42821788787841797  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.4752626419067383  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6055, 128])
m.shape torch.Size([7234, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.47927427291870117  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.47927427291870117  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7234, 128]), torch.Size([1, 7234, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.486173152923584  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5896563529968262  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7234, 128])
m.shape torch.Size([7061, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5963077545166016  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5963077545166016  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 7061, 128]), torch.Size([1, 7061, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.6031241416931152  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.7531065940856934  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 7061, 128])
m.shape torch.Size([6515, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.7621660232543945  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.7621660232543945  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6515, 128]), torch.Size([1, 6515, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.7686395645141602  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9489140510559082  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6515, 128])
m.shape torch.Size([6042, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9602127075195312  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9602127075195312  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 6042, 128]), torch.Size([1, 6042, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.9665007591247559  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.1775622367858887  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 6042, 128])
m.shape torch.Size([5282, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.1897931098937988  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.1897931098937988  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 5282, 128]), torch.Size([1, 5282, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.1948304176330566  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.4115233421325684  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 5282, 128])
m.shape torch.Size([4678, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.424619197845459  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.424619197845459  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4678, 128]), torch.Size([1, 4678, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.4291348457336426  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.6603221893310547  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4678, 128])
m.shape torch.Size([4253, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.6743154525756836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.6743154525756836  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 4253, 128]), torch.Size([1, 4253, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.67840576171875  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.9097743034362793  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 4253, 128])
m.shape torch.Size([3831, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.924187183380127  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.924187183380127  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3831, 128]), torch.Size([1, 3831, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 1.9278416633605957  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.1621007919311523  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3831, 128])
m.shape torch.Size([44389, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.3719372749328613  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.3719372749328613  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 44389, 128]), torch.Size([1, 44389, 128])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 2.4149060249328613  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.427521228790283  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 44389, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.1274542808532715  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.218377590179443  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.309300899505615  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.217667102813721  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([95340, 256])
first layer input nodes number: 142869
first layer output nodes number: 95340
edges number: 674807
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.310548305511475  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.4014716148376465  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.4249091148376465  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.4249091148376465  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

m.shape torch.Size([3309, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.60705041885376  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.60705041885376  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 3309, 256]), torch.Size([1, 3309, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.614477157592773  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.665477752685547  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 3309, 256])
m.shape torch.Size([2939, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.667971611022949  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.667971611022949  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2939, 256]), torch.Size([1, 2939, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.673909664154053  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.758298873901367  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2939, 256])
m.shape torch.Size([2333, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.762456893920898  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.762456893920898  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2333, 256]), torch.Size([1, 2333, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.766912460327148  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.866745948791504  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2333, 256])
m.shape torch.Size([1873, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.871187210083008  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.871187210083008  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1873, 256]), torch.Size([1, 1873, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.875329494476318  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.980888843536377  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1873, 256])
m.shape torch.Size([1539, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.986498832702637  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.986498832702637  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1539, 256]), torch.Size([1, 1539, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 5.989652156829834  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.098711967468262  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1539, 256])
m.shape torch.Size([1277, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.104826927185059  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.104826927185059  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 1277, 256]), torch.Size([1, 1277, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.107317924499512  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.213160514831543  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 1277, 256])
m.shape torch.Size([992, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.218562602996826  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.218562602996826  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 992, 256]), torch.Size([1, 992, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.220454692840576  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.317359447479248  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 992, 256])
m.shape torch.Size([861, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.323033809661865  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.323033809661865  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.324676036834717  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.418624401092529  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([724, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.424066066741943  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.424066066741943  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 724, 256]), torch.Size([1, 724, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.4254469871521  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.5165114402771  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 724, 256])
m.shape torch.Size([668, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.522241592407227  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.522241592407227  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 668, 256]), torch.Size([1, 668, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.523515701293945  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.61418342590332  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 668, 256])
m.shape torch.Size([560, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.620382785797119  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.620382785797119  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.621450901031494  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.705679416656494  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([500, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.710912227630615  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.710912227630615  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.7118659019470215  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.794335842132568  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([388, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.798707008361816  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.798707008361816  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.799447059631348  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.869685173034668  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([395, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.874630451202393  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.874630451202393  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.8753838539123535  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.950693607330322  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([297, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.954813480377197  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.954813480377197  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 6.955379962921143  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.021427154541016  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([273, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.0253424644470215  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.0253424644470215  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.025863170623779  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.088303565979004  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([266, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.0923895835876465  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.0923895835876465  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.092896938323975  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.15510892868042  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([231, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.158851623535156  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.158851623535156  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.159292221069336  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.215248107910156  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([215, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.218954086303711  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.218954086303711  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.219364166259766  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.274314880371094  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([205, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.278050899505615  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.278050899505615  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.278441905975342  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.333573818206787  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([182, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.337051868438721  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.337051868438721  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.337399005889893  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.38877534866333  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([128, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.391308307647705  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.391308307647705  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.391552448272705  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.429394245147705  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([121, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.431947231292725  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.431947231292725  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.432178020477295  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.4695658683776855  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([134, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.472541809082031  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.472541809082031  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.472797393798828  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.5159912109375  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([2326, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.571753025054932  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.571753025054932  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

 h.shape torch.Size([1, 2326, 256]), torch.Size([1, 2326, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 7.577108860015869  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.359201908111572  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

rst.shape  torch.Size([1, 2326, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.20121717453003  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.204605102539062  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.207993030548096  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.204435348510742  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

torch.Size([22736, 40])
input nodes number: 95340
output nodes number: 22736
edges number: 185272
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.205315589904785  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 8.205316066741943  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.1006169319152832  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.1006169319152832  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.1006169319152832  GigaBytes
Max Memory Allocated: 8.498406410217285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06619477272033691 |0.005282759666442871 |0.15608131885528564 |0.00010401010513305664 |0.08486509323120117 |0.004603385925292969 |
----------------------------------------------------------pseudo_mini_loss sum 3.0800716876983643
Total (block generation + training)time/epoch 15.765926361083984
Training time/epoch 1.3291935920715332
Training time without block to device /epoch 1.3080625534057617
Training time without total dataloading part /epoch 0.9688050746917725
load block tensor time/epoch 0.26477909088134766
block to device time/epoch 0.021131038665771484
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  954643
Number of first layer input nodes during this epoch:  572249
Number of first layer output nodes during this epoch:  382394
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
