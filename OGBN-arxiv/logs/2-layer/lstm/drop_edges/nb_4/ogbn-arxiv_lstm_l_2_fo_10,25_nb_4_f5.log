[04:24:35] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23358328 edges into 4 parts and get 1864628 edge cuts
main start at this time 1651551855.3788824
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018822908401489258
global_2_local spend time (sec) 0.035073280334472656
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004639148712158203
A = g.adjacency_matrix() spent  0.0075991153717041016
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08954453468322754
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.297147274017334
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1978635787963867

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328})
Convert a graph into a bidirected graph: 0.993 seconds
Metis partitioning: 4.403 seconds
Split the graph: 2.347 seconds
Construct subgraphs: 0.073 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.826877117156982
22358
22469
23087
23027
total k batches seeds list generation spend  18.495277404785156
after graph partition
graph partition algorithm spend time 18.587485790252686
22358
22469
23087
23027
partition_len_list
[68754, 54428, 41590, 35715]
shared_neighbor_graph_partition_s0 selection method  spend 18.668684244155884
time for parepare:  0.016718387603759766
local_output_nid generation:  0.0027289390563964844
local_in_edges_tensor generation:  0.0045626163482666016
mini_batch_src_global generation:  0.00972890853881836
r_  generation:  0.0844271183013916
local_output_nid generation:  0.0039556026458740234
local_in_edges_tensor generation:  0.003706693649291992
mini_batch_src_global generation:  0.00780177116394043
r_  generation:  0.05741691589355469
local_output_nid generation:  0.003996133804321289
local_in_edges_tensor generation:  0.003537416458129883
mini_batch_src_global generation:  0.005394935607910156
r_  generation:  0.062071800231933594
local_output_nid generation:  0.0038793087005615234
local_in_edges_tensor generation:  0.0036890506744384766
mini_batch_src_global generation:  0.006621360778808594
r_  generation:  0.0633385181427002
----------------------check_connections_block total spend ----------------------------- 0.4119396209716797
generate_one_block  0.12602686882019043
generate_one_block  0.06938314437866211
generate_one_block  0.07185935974121094
generate_one_block  0.07909679412841797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023261547088623047
gen group dst list time:  0.005664348602294922
time for parepare:  0.021298885345458984
local_output_nid generation:  0.009289026260375977
local_in_edges_tensor generation:  0.018575429916381836
mini_batch_src_global generation:  0.01774311065673828
r_  generation:  0.185624361038208
local_output_nid generation:  0.011619091033935547
local_in_edges_tensor generation:  0.011298179626464844
mini_batch_src_global generation:  0.014930248260498047
r_  generation:  0.13349103927612305
local_output_nid generation:  0.008591413497924805
local_in_edges_tensor generation:  0.007469654083251953
mini_batch_src_global generation:  0.00971841812133789
r_  generation:  0.09655451774597168
local_output_nid generation:  0.00715327262878418
local_in_edges_tensor generation:  0.00644993782043457
mini_batch_src_global generation:  0.008654117584228516
r_  generation:  0.08146047592163086
----------------------check_connections_block total spend ----------------------------- 0.7577261924743652
generate_one_block  0.23412513732910156
generate_one_block  0.15909314155578613
generate_one_block  0.10943317413330078
generate_one_block  0.1026756763458252
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.7577261924743652
block generation total time  0.6053271293640137
average batch blocks generation time:  0.15133178234100342
pseudo mini batch 0 input nodes size: 93475
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.0476994514465332  GigaBytes
Max Memory Allocated: 0.0476994514465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.0478663444519043  GigaBytes
Max Memory Allocated: 0.0478663444519043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.0478663444519043  GigaBytes
Max Memory Allocated: 0.0478663444519043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05374765396118164  GigaBytes
Max Memory Allocated: 0.05374765396118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05374765396118164  GigaBytes
Max Memory Allocated: 0.05374765396118164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05374765396118164  GigaBytes
Max Memory Allocated: 0.05374765396118164  GigaBytes

torch.Size([93475, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05374765396118164  GigaBytes
Max Memory Allocated: 0.05374765396118164  GigaBytes

m.shape torch.Size([3810, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.3161444664001465  GigaBytes
Max Memory Allocated: 0.3223443031311035  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.3161444664001465  GigaBytes
Max Memory Allocated: 0.3223443031311035  GigaBytes

 h.shape torch.Size([1, 3810, 128]), torch.Size([1, 3810, 128])
----------------------------------------3
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.3197779655456543  GigaBytes
Max Memory Allocated: 0.3223443031311035  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.34954023361206055  GigaBytes
Max Memory Allocated: 0.35135698318481445  GigaBytes

rst.shape  torch.Size([1, 3810, 128])
m.shape torch.Size([4021, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.35155820846557617  GigaBytes
Max Memory Allocated: 0.35164833068847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.35155820846557617  GigaBytes
Max Memory Allocated: 0.35164833068847656  GigaBytes

 h.shape torch.Size([1, 4021, 128]), torch.Size([1, 4021, 128])
----------------------------------------3
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.3553929328918457  GigaBytes
Max Memory Allocated: 0.3553929328918457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.4142885208129883  GigaBytes
Max Memory Allocated: 0.4181232452392578  GigaBytes

rst.shape  torch.Size([1, 4021, 128])
m.shape torch.Size([3637, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.4181232452392578  GigaBytes
Max Memory Allocated: 0.418245792388916  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.4181232452392578  GigaBytes
Max Memory Allocated: 0.418245792388916  GigaBytes

 h.shape torch.Size([1, 3637, 128]), torch.Size([1, 3637, 128])
----------------------------------------3
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.4223155975341797  GigaBytes
Max Memory Allocated: 0.4223155975341797  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.49953174591064453  GigaBytes
Max Memory Allocated: 0.5051889419555664  GigaBytes

rst.shape  torch.Size([1, 3637, 128])
m.shape torch.Size([3287, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5040669441223145  GigaBytes
Max Memory Allocated: 0.5051889419555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5040669441223145  GigaBytes
Max Memory Allocated: 0.5051889419555664  GigaBytes

 h.shape torch.Size([1, 3287, 128]), torch.Size([1, 3287, 128])
----------------------------------------3
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5075173377990723  GigaBytes
Max Memory Allocated: 0.5075173377990723  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6029477119445801  GigaBytes
Max Memory Allocated: 0.6092171669006348  GigaBytes

rst.shape  torch.Size([1, 3287, 128])
m.shape torch.Size([3177, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6092171669006348  GigaBytes
Max Memory Allocated: 0.6093955039978027  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6092171669006348  GigaBytes
Max Memory Allocated: 0.6093955039978027  GigaBytes

 h.shape torch.Size([1, 3177, 128]), torch.Size([1, 3177, 128])
----------------------------------------3
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6122469902038574  GigaBytes
Max Memory Allocated: 0.6122469902038574  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.721320629119873  GigaBytes
Max Memory Allocated: 0.7288951873779297  GigaBytes

rst.shape  torch.Size([1, 3177, 128])
m.shape torch.Size([2901, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.7281055450439453  GigaBytes
Max Memory Allocated: 0.7288951873779297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.7281055450439453  GigaBytes
Max Memory Allocated: 0.7288951873779297  GigaBytes

 h.shape torch.Size([1, 2901, 128]), torch.Size([1, 2901, 128])
----------------------------------------3
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.731630802154541  GigaBytes
Max Memory Allocated: 0.731630802154541  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8514533042907715  GigaBytes
Max Memory Allocated: 0.8597531318664551  GigaBytes

rst.shape  torch.Size([1, 2901, 128])
m.shape torch.Size([2754, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8597531318664551  GigaBytes
Max Memory Allocated: 0.8599691390991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8597531318664551  GigaBytes
Max Memory Allocated: 0.8599691390991211  GigaBytes

 h.shape torch.Size([1, 2754, 128]), torch.Size([1, 2754, 128])
----------------------------------------3
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8624577522277832  GigaBytes
Max Memory Allocated: 0.8624577522277832  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.994391918182373  GigaBytes
Max Memory Allocated: 1.003584384918213  GigaBytes

rst.shape  torch.Size([1, 2754, 128])
m.shape torch.Size([2586, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 1.002943515777588  GigaBytes
Max Memory Allocated: 1.003584384918213  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 1.002943515777588  GigaBytes
Max Memory Allocated: 1.003584384918213  GigaBytes

 h.shape torch.Size([1, 2586, 128]), torch.Size([1, 2586, 128])
----------------------------------------3
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 1.0054898262023926  GigaBytes
Max Memory Allocated: 1.0054898262023926  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3787841796875 GB
    Memory Allocated: 1.1464571952819824  GigaBytes
Max Memory Allocated: 1.1563220024108887  GigaBytes

rst.shape  torch.Size([1, 2586, 128])
m.shape torch.Size([2430, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 1.1556525230407715  GigaBytes
Max Memory Allocated: 1.1563220024108887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 1.1556525230407715  GigaBytes
Max Memory Allocated: 1.1563220024108887  GigaBytes

 h.shape torch.Size([1, 2430, 128]), torch.Size([1, 2430, 128])
----------------------------------------3
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 1.1581015586853027  GigaBytes
Max Memory Allocated: 1.1581015586853027  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5389404296875 GB
    Memory Allocated: 1.3074660301208496  GigaBytes
Max Memory Allocated: 1.317894458770752  GigaBytes

rst.shape  torch.Size([1, 2430, 128])
m.shape torch.Size([40151, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 1.4976305961608887  GigaBytes
Max Memory Allocated: 1.5021181106567383  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 1.4976305961608887  GigaBytes
Max Memory Allocated: 1.5021181106567383  GigaBytes

 h.shape torch.Size([1, 40151, 128]), torch.Size([1, 40151, 128])
----------------------------------------3
 Nvidia-smi: 2.7713623046875 GB
    Memory Allocated: 1.5366930961608887  GigaBytes
Max Memory Allocated: 1.5366930961608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.263839244842529  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

rst.shape  torch.Size([1, 40151, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.021480560302734  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.08704948425293  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.152618408203125  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.086536884307861  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

torch.Size([68754, 256])
first layer input nodes number: 93475
first layer output nodes number: 68754
edges number: 532548
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.153316974639893  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.218885898590088  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.235278129577637  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7381591796875 GB
    Memory Allocated: 4.235278129577637  GigaBytes
Max Memory Allocated: 4.455294132232666  GigaBytes

m.shape torch.Size([2568, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.485291004180908  GigaBytes
Max Memory Allocated: 4.4872331619262695  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.485291004180908  GigaBytes
Max Memory Allocated: 4.4872331619262695  GigaBytes

 h.shape torch.Size([1, 2568, 256]), torch.Size([1, 2568, 256])
----------------------------------------3
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.490879058837891  GigaBytes
Max Memory Allocated: 4.490879058837891  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.530063629150391  GigaBytes
Max Memory Allocated: 4.532978057861328  GigaBytes

rst.shape  torch.Size([1, 2568, 256])
m.shape torch.Size([2180, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.532484531402588  GigaBytes
Max Memory Allocated: 4.532978057861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.532484531402588  GigaBytes
Max Memory Allocated: 4.532978057861328  GigaBytes

 h.shape torch.Size([1, 2180, 256]), torch.Size([1, 2180, 256])
----------------------------------------3
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.537084102630615  GigaBytes
Max Memory Allocated: 4.537084102630615  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.600409030914307  GigaBytes
Max Memory Allocated: 4.604567050933838  GigaBytes

rst.shape  torch.Size([1, 2180, 256])
m.shape torch.Size([1691, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.603206157684326  GigaBytes
Max Memory Allocated: 4.604567050933838  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.603206157684326  GigaBytes
Max Memory Allocated: 4.604567050933838  GigaBytes

 h.shape torch.Size([1, 1691, 256]), torch.Size([1, 1691, 256])
----------------------------------------3
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.606757164001465  GigaBytes
Max Memory Allocated: 4.606757164001465  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.6786208152771  GigaBytes
Max Memory Allocated: 4.6834588050842285  GigaBytes

rst.shape  torch.Size([1, 1691, 256])
m.shape torch.Size([1326, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.682106018066406  GigaBytes
Max Memory Allocated: 4.6834588050842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.682106018066406  GigaBytes
Max Memory Allocated: 4.6834588050842285  GigaBytes

 h.shape torch.Size([1, 1326, 256]), torch.Size([1, 1326, 256])
----------------------------------------3
 Nvidia-smi: 5.9862060546875 GB
    Memory Allocated: 4.684815883636475  GigaBytes
Max Memory Allocated: 4.684815883636475  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 4.760622978210449  GigaBytes
Max Memory Allocated: 4.765681266784668  GigaBytes

rst.shape  torch.Size([1, 1326, 256])
m.shape torch.Size([1183, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 4.76476526260376  GigaBytes
Max Memory Allocated: 4.765681266784668  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 4.76476526260376  GigaBytes
Max Memory Allocated: 4.765681266784668  GigaBytes

 h.shape torch.Size([1, 1183, 256]), torch.Size([1, 1183, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 4.767049312591553  GigaBytes
Max Memory Allocated: 4.767049312591553  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1033935546875 GB
    Memory Allocated: 4.851171970367432  GigaBytes
Max Memory Allocated: 4.8571648597717285  GigaBytes

rst.shape  torch.Size([1, 1183, 256])
m.shape torch.Size([982, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1033935546875 GB
    Memory Allocated: 4.855666160583496  GigaBytes
Max Memory Allocated: 4.8571648597717285  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1033935546875 GB
    Memory Allocated: 4.855666160583496  GigaBytes
Max Memory Allocated: 4.8571648597717285  GigaBytes

 h.shape torch.Size([1, 982, 256]), torch.Size([1, 982, 256])
----------------------------------------3
 Nvidia-smi: 6.1053466796875 GB
    Memory Allocated: 4.857539176940918  GigaBytes
Max Memory Allocated: 4.857539176940918  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1971435546875 GB
    Memory Allocated: 4.941120147705078  GigaBytes
Max Memory Allocated: 4.946739196777344  GigaBytes

rst.shape  torch.Size([1, 982, 256])
m.shape torch.Size([764, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1971435546875 GB
    Memory Allocated: 4.945323944091797  GigaBytes
Max Memory Allocated: 4.946739196777344  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1971435546875 GB
    Memory Allocated: 4.945323944091797  GigaBytes
Max Memory Allocated: 4.946739196777344  GigaBytes

 h.shape torch.Size([1, 764, 256]), torch.Size([1, 764, 256])
----------------------------------------3
 Nvidia-smi: 6.1971435546875 GB
    Memory Allocated: 4.946781158447266  GigaBytes
Max Memory Allocated: 4.946781158447266  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 5.0198822021484375  GigaBytes
Max Memory Allocated: 5.024982452392578  GigaBytes

rst.shape  torch.Size([1, 764, 256])
m.shape torch.Size([652, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 5.024167060852051  GigaBytes
Max Memory Allocated: 5.024982452392578  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 5.024167060852051  GigaBytes
Max Memory Allocated: 5.024982452392578  GigaBytes

 h.shape torch.Size([1, 652, 256]), torch.Size([1, 652, 256])
----------------------------------------3
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 5.0254106521606445  GigaBytes
Max Memory Allocated: 5.0254106521606445  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3612060546875 GB
    Memory Allocated: 5.096295356750488  GigaBytes
Max Memory Allocated: 5.101269721984863  GigaBytes

rst.shape  torch.Size([1, 652, 256])
m.shape torch.Size([636, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.3612060546875 GB
    Memory Allocated: 5.101175308227539  GigaBytes
Max Memory Allocated: 5.101269721984863  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3612060546875 GB
    Memory Allocated: 5.101175308227539  GigaBytes
Max Memory Allocated: 5.101269721984863  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 6.3631591796875 GB
    Memory Allocated: 5.102388381958008  GigaBytes
Max Memory Allocated: 5.102388381958008  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4530029296875 GB
    Memory Allocated: 5.180437088012695  GigaBytes
Max Memory Allocated: 5.185895919799805  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([586, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.4530029296875 GB
    Memory Allocated: 5.185462951660156  GigaBytes
Max Memory Allocated: 5.185895919799805  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4530029296875 GB
    Memory Allocated: 5.185462951660156  GigaBytes
Max Memory Allocated: 5.185895919799805  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 6.4530029296875 GB
    Memory Allocated: 5.186580657958984  GigaBytes
Max Memory Allocated: 5.186580657958984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5447998046875 GB
    Memory Allocated: 5.266277313232422  GigaBytes
Max Memory Allocated: 5.2718658447265625  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([520, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.5447998046875 GB
    Memory Allocated: 5.27121639251709  GigaBytes
Max Memory Allocated: 5.2718658447265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5447998046875 GB
    Memory Allocated: 5.27121639251709  GigaBytes
Max Memory Allocated: 5.2718658447265625  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 6.5447998046875 GB
    Memory Allocated: 5.272208213806152  GigaBytes
Max Memory Allocated: 5.272208213806152  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6170654296875 GB
    Memory Allocated: 5.350104331970215  GigaBytes
Max Memory Allocated: 5.355559349060059  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([493, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6170654296875 GB
    Memory Allocated: 5.355294704437256  GigaBytes
Max Memory Allocated: 5.355559349060059  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6170654296875 GB
    Memory Allocated: 5.355294704437256  GigaBytes
Max Memory Allocated: 5.355559349060059  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 6.6170654296875 GB
    Memory Allocated: 5.356235027313232  GigaBytes
Max Memory Allocated: 5.356235027313232  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7069091796875 GB
    Memory Allocated: 5.438649654388428  GigaBytes
Max Memory Allocated: 5.444291591644287  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([427, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.7069091796875 GB
    Memory Allocated: 5.443514823913574  GigaBytes
Max Memory Allocated: 5.444291591644287  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7069091796875 GB
    Memory Allocated: 5.443514823913574  GigaBytes
Max Memory Allocated: 5.444291591644287  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 6.7069091796875 GB
    Memory Allocated: 5.444329261779785  GigaBytes
Max Memory Allocated: 5.444329261779785  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7772216796875 GB
    Memory Allocated: 5.520185470581055  GigaBytes
Max Memory Allocated: 5.525479316711426  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([362, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.7772216796875 GB
    Memory Allocated: 5.524649620056152  GigaBytes
Max Memory Allocated: 5.525479316711426  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7772216796875 GB
    Memory Allocated: 5.524649620056152  GigaBytes
Max Memory Allocated: 5.525479316711426  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 6.7772216796875 GB
    Memory Allocated: 5.5253400802612305  GigaBytes
Max Memory Allocated: 5.525479316711426  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8280029296875 GB
    Memory Allocated: 5.597950458526611  GigaBytes
Max Memory Allocated: 5.602783679962158  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([370, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.8280029296875 GB
    Memory Allocated: 5.602939605712891  GigaBytes
Max Memory Allocated: 5.602960586547852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8280029296875 GB
    Memory Allocated: 5.602939605712891  GigaBytes
Max Memory Allocated: 5.602960586547852  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 6.8299560546875 GB
    Memory Allocated: 5.603645324707031  GigaBytes
Max Memory Allocated: 5.603645324707031  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9002685546875 GB
    Memory Allocated: 5.67857551574707  GigaBytes
Max Memory Allocated: 5.683868408203125  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([319, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9002685546875 GB
    Memory Allocated: 5.683128356933594  GigaBytes
Max Memory Allocated: 5.683868408203125  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9002685546875 GB
    Memory Allocated: 5.683128356933594  GigaBytes
Max Memory Allocated: 5.683868408203125  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 6.9002685546875 GB
    Memory Allocated: 5.683736801147461  GigaBytes
Max Memory Allocated: 5.683868408203125  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9881591796875 GB
    Memory Allocated: 5.75335693359375  GigaBytes
Max Memory Allocated: 5.7582244873046875  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([304, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9881591796875 GB
    Memory Allocated: 5.758019924163818  GigaBytes
Max Memory Allocated: 5.7582244873046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9881591796875 GB
    Memory Allocated: 5.758019924163818  GigaBytes
Max Memory Allocated: 5.7582244873046875  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 6.9881591796875 GB
    Memory Allocated: 5.758599758148193  GigaBytes
Max Memory Allocated: 5.758599758148193  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0584716796875 GB
    Memory Allocated: 5.830983638763428  GigaBytes
Max Memory Allocated: 5.835912227630615  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([319, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0584716796875 GB
    Memory Allocated: 5.836212635040283  GigaBytes
Max Memory Allocated: 5.836234092712402  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0584716796875 GB
    Memory Allocated: 5.836212635040283  GigaBytes
Max Memory Allocated: 5.836234092712402  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 7.0584716796875 GB
    Memory Allocated: 5.83682107925415  GigaBytes
Max Memory Allocated: 5.83682107925415  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1502685546875 GB
    Memory Allocated: 5.915113925933838  GigaBytes
Max Memory Allocated: 5.920589923858643  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([293, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.1502685546875 GB
    Memory Allocated: 5.920160293579102  GigaBytes
Max Memory Allocated: 5.920589923858643  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1502685546875 GB
    Memory Allocated: 5.920160293579102  GigaBytes
Max Memory Allocated: 5.920589923858643  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 7.1502685546875 GB
    Memory Allocated: 5.920719146728516  GigaBytes
Max Memory Allocated: 5.920719146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2205810546875 GB
    Memory Allocated: 5.997635841369629  GigaBytes
Max Memory Allocated: 6.0029449462890625  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([271, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2205810546875 GB
    Memory Allocated: 6.002565860748291  GigaBytes
Max Memory Allocated: 6.0029449462890625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2205810546875 GB
    Memory Allocated: 6.002565860748291  GigaBytes
Max Memory Allocated: 6.0029449462890625  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 7.2205810546875 GB
    Memory Allocated: 6.003082752227783  GigaBytes
Max Memory Allocated: 6.003082752227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.077977657318115  GigaBytes
Max Memory Allocated: 6.083146572113037  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([259, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.08294677734375  GigaBytes
Max Memory Allocated: 6.083146572113037  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.08294677734375  GigaBytes
Max Memory Allocated: 6.083146572113037  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 7.3065185546875 GB
    Memory Allocated: 6.083440780639648  GigaBytes
Max Memory Allocated: 6.083440780639648  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3787841796875 GB
    Memory Allocated: 6.158717155456543  GigaBytes
Max Memory Allocated: 6.163904190063477  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([195, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3787841796875 GB
    Memory Allocated: 6.162593841552734  GigaBytes
Max Memory Allocated: 6.163904190063477  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3787841796875 GB
    Memory Allocated: 6.162593841552734  GigaBytes
Max Memory Allocated: 6.163904190063477  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 7.3787841796875 GB
    Memory Allocated: 6.162965774536133  GigaBytes
Max Memory Allocated: 6.163904190063477  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4432373046875 GB
    Memory Allocated: 6.220615386962891  GigaBytes
Max Memory Allocated: 6.224706649780273  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([195, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.4432373046875 GB
    Memory Allocated: 6.224740505218506  GigaBytes
Max Memory Allocated: 6.224757671356201  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4432373046875 GB
    Memory Allocated: 6.224740505218506  GigaBytes
Max Memory Allocated: 6.224757671356201  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 7.4432373046875 GB
    Memory Allocated: 6.225112438201904  GigaBytes
Max Memory Allocated: 6.225112438201904  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 6.285365581512451  GigaBytes
Max Memory Allocated: 6.289642810821533  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([198, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 6.28974723815918  GigaBytes
Max Memory Allocated: 6.289765357971191  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 6.28974723815918  GigaBytes
Max Memory Allocated: 6.289765357971191  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 6.290124893188477  GigaBytes
Max Memory Allocated: 6.290124893188477  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5799560546875 GB
    Memory Allocated: 6.353948593139648  GigaBytes
Max Memory Allocated: 6.358480453491211  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([5265, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 6.4802680015563965  GigaBytes
Max Memory Allocated: 6.4807586669921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 6.4802680015563965  GigaBytes
Max Memory Allocated: 6.4807586669921875  GigaBytes

 h.shape torch.Size([1, 5265, 256]), torch.Size([1, 5265, 256])
----------------------------------------3
 Nvidia-smi: 7.7283935546875 GB
    Memory Allocated: 6.490310192108154  GigaBytes
Max Memory Allocated: 6.490310192108154  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7987060546875 GB
    Memory Allocated: 8.25773572921753  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 5265, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.7987060546875 GB
    Memory Allocated: 8.0281400680542  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.7987060546875 GB
    Memory Allocated: 8.031471729278564  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.7987060546875 GB
    Memory Allocated: 8.03480339050293  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.7987060546875 GB
    Memory Allocated: 8.031304836273193  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([22358, 40])
input nodes number: 68754
output nodes number: 22358
edges number: 256657
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7987060546875 GB
    Memory Allocated: 8.035315990447998  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.7987060546875 GB
    Memory Allocated: 8.035316944122314  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.07013511657714844  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

pseudo mini batch 1 input nodes size: 95066
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.053974151611328125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.053974151611328125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.0993051528930664  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.0994729995727539  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.05438423156738281  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.058032989501953125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.058032989501953125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.058032989501953125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([95066, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.058032989501953125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([5717, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.22948360443115234  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.22948360443115234  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 5717, 128]), torch.Size([1, 5717, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.23493576049804688  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.27900171279907227  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 5717, 128])
m.shape torch.Size([5760, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.28172779083251953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.28172779083251953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 5760, 128]), torch.Size([1, 5760, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.2876286506652832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.3703312873840332  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 5760, 128])
m.shape torch.Size([4868, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.37454843521118164  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.37454843521118164  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4868, 128]), torch.Size([1, 4868, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.38034677505493164  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.4863266944885254  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4868, 128])
m.shape torch.Size([4140, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.49190187454223633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.49190187454223633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4140, 128]), torch.Size([1, 4140, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.4961972236633301  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.6110711097717285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4140, 128])
m.shape torch.Size([3580, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.6176323890686035  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.6176323890686035  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3580, 128]), torch.Size([1, 3580, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.6211609840393066  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7460732460021973  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3580, 128])
m.shape torch.Size([2917, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7527117729187012  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7527117729187012  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2917, 128]), torch.Size([1, 2917, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7557258605957031  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8778300285339355  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2917, 128])
m.shape torch.Size([2539, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8849139213562012  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8849139213562012  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2539, 128]), torch.Size([1, 2539, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8875155448913574  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.010124683380127  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2539, 128])
m.shape torch.Size([2248, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.017329216003418  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.017329216003418  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2248, 128]), torch.Size([1, 2248, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.0195612907409668  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.143388271331787  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2248, 128])
m.shape torch.Size([1957, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.1507148742675781  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.1507148742675781  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1957, 128]), torch.Size([1, 1957, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.1525812149047852  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.2763662338256836  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1957, 128])
m.shape torch.Size([20702, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.374147891998291  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.374147891998291  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 20702, 128]), torch.Size([1, 20702, 128])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 1.3938908576965332  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.7956414222717285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 20702, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.646578788757324  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.6984853744506836  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.750391960144043  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.6980795860290527  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([54428, 256])
first layer input nodes number: 95066
first layer output nodes number: 54428
edges number: 344193
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.7511024475097656  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.803009033203125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.815985679626465  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.815985679626465  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([4162, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.9605493545532227  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.9605493545532227  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4162, 256]), torch.Size([1, 4162, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 2.9684877395629883  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.0319948196411133  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4162, 256])
m.shape torch.Size([3491, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.0347366333007812  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.0347366333007812  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3491, 256]), torch.Size([1, 3491, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.0420455932617188  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.1428890228271484  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3491, 256])
m.shape torch.Size([2572, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.1469759941101074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.1469759941101074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2572, 256]), torch.Size([1, 2572, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.152287483215332  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.262820243835449  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2572, 256])
m.shape torch.Size([1985, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.2679991722106934  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.2679991722106934  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1985, 256]), torch.Size([1, 1985, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.2719311714172363  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.3836731910705566  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1985, 256])
m.shape torch.Size([1700, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.3897552490234375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.3897552490234375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1700, 256]), torch.Size([1, 1700, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.393183708190918  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.516170024871826  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1700, 256])
m.shape torch.Size([1193, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.5214285850524902  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.5214285850524902  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1193, 256]), torch.Size([1, 1193, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.5239477157592773  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.6271510124206543  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1193, 256])
m.shape torch.Size([1009, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.6328020095825195  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.6328020095825195  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1009, 256]), torch.Size([1, 1009, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.6347265243530273  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.7323570251464844  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1009, 256])
m.shape torch.Size([849, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.7379231452941895  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.7379231452941895  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.7395424842834473  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.8335022926330566  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([706, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.8387999534606934  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.8387999534606934  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.840146541595459  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.9318881034851074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([569, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.9366836547851562  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.9366836547851562  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 3.9377689361572266  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.014823913574219  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([455, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.019092082977295  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.019092082977295  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.019959926605225  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.090691089630127  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([400, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.094870567321777  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.094870567321777  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.095633506774902  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.161131858825684  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([358, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.165223598480225  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.165223598480225  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.1659064292907715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.229550838470459  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([298, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.233219623565674  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.233219623565674  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.233788013458252  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.290669918060303  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([224, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.293615341186523  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.293615341186523  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.294042587280273  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.339330673217773  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([230, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.342654228210449  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.342654228210449  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.343092918395996  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.392664909362793  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([177, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.39533805847168  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.39533805847168  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.3956756591796875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.436187744140625  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([190, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.439306259155273  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.439306259155273  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.439668655395508  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.485692977905273  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([165, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.488524913787842  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.488524913787842  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.488839626312256  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.53101110458374  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([132, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.53339147567749  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.53339147567749  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.5336432456970215  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.569142818450928  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([117, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.571378707885742  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.571378707885742  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 4.571601867675781  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3104248046875 GB
    Memory Allocated: 4.6046295166015625  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([86, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.3104248046875 GB
    Memory Allocated: 4.60633659362793  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3104248046875 GB
    Memory Allocated: 4.60633659362793  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 10.3104248046875 GB
    Memory Allocated: 4.606500625610352  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3377685546875 GB
    Memory Allocated: 4.631925582885742  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.3377685546875 GB
    Memory Allocated: 4.633568286895752  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3377685546875 GB
    Memory Allocated: 4.633568286895752  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 10.3377685546875 GB
    Memory Allocated: 4.633717060089111  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3592529296875 GB
    Memory Allocated: 4.65781831741333  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([94, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.3592529296875 GB
    Memory Allocated: 4.659912586212158  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3592529296875 GB
    Memory Allocated: 4.659912586212158  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 10.3592529296875 GB
    Memory Allocated: 4.660091876983643  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 4.690392017364502  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([1229, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 4.7198333740234375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 4.7198333740234375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1229, 256]), torch.Size([1, 1229, 256])
----------------------------------------3
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 4.7233171463012695  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 5.152419090270996  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1229, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 5.0326337814331055  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 5.036602973937988  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 5.039951324462891  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 5.03581428527832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([22469, 40])
input nodes number: 54428
output nodes number: 22469
edges number: 145356
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 5.036404609680176  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3905029296875 GB
    Memory Allocated: 5.036405086517334  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.06496000289916992  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

pseudo mini batch 2 input nodes size: 65038
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.05440092086791992  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.05440092086791992  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.08541345596313477  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.0855855941772461  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.04008674621582031  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.043076515197753906  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.043076515197753906  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.043076515197753906  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([65038, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.043076515197753906  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([4908, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.16338205337524414  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.16338205337524414  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4908, 128]), torch.Size([1, 4908, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.16901636123657227  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.2064957618713379  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4908, 128])
m.shape torch.Size([4995, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.20891904830932617  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.20891904830932617  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4995, 128]), torch.Size([1, 4995, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.2142772674560547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.28716182708740234  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4995, 128])
m.shape torch.Size([4410, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.2910885810852051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.2910885810852051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4410, 128]), torch.Size([1, 4410, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.2958106994628906  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.3908061981201172  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4410, 128])
m.shape torch.Size([3725, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.39580821990966797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.39580821990966797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3725, 128]), torch.Size([1, 3725, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.3993659019470215  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5025224685668945  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3725, 128])
m.shape torch.Size([3140, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.508232593536377  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.508232593536377  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3140, 128]), torch.Size([1, 3140, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5117707252502441  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.6214504241943359  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3140, 128])
m.shape torch.Size([2587, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.627354621887207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.627354621887207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2587, 128]), torch.Size([1, 2587, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.6301584243774414  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7362461090087891  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2587, 128])
m.shape torch.Size([2208, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7423825263977051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7423825263977051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2208, 128]), torch.Size([1, 2208, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7445812225341797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8541674613952637  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2208, 128])
m.shape torch.Size([1949, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8605494499206543  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8605494499206543  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1949, 128]), torch.Size([1, 1949, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8624081611633301  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9730753898620605  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1949, 128])
m.shape torch.Size([1612, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9790639877319336  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9790639877319336  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1612, 128]), torch.Size([1, 1612, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9806013107299805  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.0789899826049805  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1612, 128])
m.shape torch.Size([12056, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.1357088088989258  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.1357088088989258  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 12056, 128]), torch.Size([1, 12056, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.1472063064575195  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9635286331176758  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 12056, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.861989974975586  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9016532897949219  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9413166046142578  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9013433456420898  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([41590, 256])
first layer input nodes number: 65038
first layer output nodes number: 41590
edges number: 240366
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9418034553527832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9814667701721191  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9913825988769531  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9913825988769531  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([3550, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.150270938873291  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.150270938873291  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3550, 256]), torch.Size([1, 3550, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.1570534706115723  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.211245059967041  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3550, 256])
m.shape torch.Size([3202, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.2140092849731445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.2140092849731445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3202, 256]), torch.Size([1, 3202, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.220791816711426  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.312739372253418  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3202, 256])
m.shape torch.Size([2558, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.317061424255371  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.317061424255371  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2558, 256]), torch.Size([1, 2558, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.322244167327881  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.430957317352295  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2558, 256])
m.shape torch.Size([2091, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.436556816101074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.436556816101074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2091, 256]), torch.Size([1, 2091, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.4409446716308594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.5588088035583496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2091, 256])
m.shape torch.Size([1734, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.565147876739502  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.565147876739502  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1734, 256]), torch.Size([1, 1734, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.5688295364379883  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.6927804946899414  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1734, 256])
m.shape torch.Size([1355, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.698941230773926  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.698941230773926  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1355, 256]), torch.Size([1, 1355, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.7018661499023438  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.81508731842041  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1355, 256])
m.shape torch.Size([1161, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.821606159210205  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.821606159210205  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1161, 256]), torch.Size([1, 1161, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.8238492012023926  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.93953800201416  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1161, 256])
m.shape torch.Size([1010, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.9454941749572754  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.9454941749572754  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1010, 256]), torch.Size([1, 1010, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.947420597076416  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.0585618019104004  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1010, 256])
m.shape torch.Size([800, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.064518928527832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.064518928527832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.066044807434082  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.164158821105957  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([708, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.170200824737549  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.170200824737549  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.17155122756958  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.2693066596984863  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([572, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.274679183959961  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.274679183959961  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.2757701873779297  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3614139556884766  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([492, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3665432929992676  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3665432929992676  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3674817085266113  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.4504284858703613  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([411, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.455094814300537  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.455094814300537  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.455878734588623  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.530336856842041  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([361, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.535403251647949  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.535403251647949  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.5360918045043945  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.605013847351074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([344, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6096291542053223  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6096291542053223  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6102852821350098  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6800103187561035  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([259, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6836652755737305  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6836652755737305  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.684159278869629  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.743454933166504  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([235, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.7470479011535645  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.7470479011535645  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.7474961280822754  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.801283359527588  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([190, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8043465614318848  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8043465614318848  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.804708957672119  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8507332801818848  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([169, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8536386489868164  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8536386489868164  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8539609909057617  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8971548080444336  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([168, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9002232551574707  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9002232551574707  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.900543689727783  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9457249641418457  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([134, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9482693672180176  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9482693672180176  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9485249519348145  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.986351490020752  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([131, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9889941215515137  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9889941215515137  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.989243984222412  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.02797269821167  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([107, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.03034782409668  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.03034782409668  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.030551910400391  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.0636138916015625  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([101, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.0658416748046875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.0658416748046875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.066034317016602  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.098590850830078  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([1244, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.128385543823242  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.128385543823242  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1244, 256]), torch.Size([1, 1244, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.130758285522461  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.560672760009766  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1244, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.427975654602051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.431416034698486  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.434856414794922  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.431243896484375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([23087, 40])
input nodes number: 41590
output nodes number: 23087
edges number: 160843
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.431818008422852  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 4.43181848526001  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.049030303955078125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

pseudo mini batch 3 input nodes size: 49905
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.040178775787353516  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.040178775787353516  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.06397533416748047  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.0641469955444336  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.03296232223510742  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.035898685455322266  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.035898685455322266  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.035898685455322266  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([49905, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.035898685455322266  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([4031, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.14208507537841797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.14208507537841797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4031, 128]), torch.Size([1, 4031, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.14592933654785156  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.17705535888671875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4031, 128])
m.shape torch.Size([4060, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.17900514602661133  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.17900514602661133  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4060, 128]), torch.Size([1, 4060, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.1828770637512207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.2414846420288086  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4060, 128])
m.shape torch.Size([3651, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.24535655975341797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.24535655975341797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3651, 128]), torch.Size([1, 3651, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.2488384246826172  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.3262014389038086  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3651, 128])
m.shape torch.Size([3049, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.33083009719848633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.33083009719848633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3049, 128]), torch.Size([1, 3049, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.3340458869934082  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.42186784744262695  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3049, 128])
m.shape torch.Size([2596, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4266033172607422  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.4266033172607422  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2596, 128]), torch.Size([1, 2596, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.42908334732055664  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5210995674133301  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2596, 128])
m.shape torch.Size([2208, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5261788368225098  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5261788368225098  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2208, 128]), torch.Size([1, 2208, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.5283217430114746  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.6225929260253906  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2208, 128])
m.shape torch.Size([1844, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.6276950836181641  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.6276950836181641  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1844, 128]), torch.Size([1, 1844, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.6294536590576172  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7173824310302734  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1844, 128])
m.shape torch.Size([1647, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7227859497070312  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7227859497070312  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1647, 128]), torch.Size([1, 1647, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.7243566513061523  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8162422180175781  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1647, 128])
m.shape torch.Size([1372, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8213448524475098  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8213448524475098  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1372, 128]), torch.Size([1, 1372, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.8226532936096191  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9063935279846191  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1372, 128])
m.shape torch.Size([11257, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9594168663024902  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9594168663024902  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 11257, 128]), torch.Size([1, 11257, 128])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 0.9701523780822754  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.732774257659912  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 11257, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.641843318939209  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.6759037971496582  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.7099642753601074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.6756372451782227  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([35715, 256])
first layer input nodes number: 49905
first layer output nodes number: 35715
edges number: 212530
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.7103381156921387  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.744398593902588  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.7529139518737793  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.7529139518737793  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([3148, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.931586742401123  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.931586742401123  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3148, 256]), torch.Size([1, 3148, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9384427070617676  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9877548217773438  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3148, 256])
m.shape torch.Size([2833, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9897727966308594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9897727966308594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2833, 256]), torch.Size([1, 2833, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 1.9960484504699707  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.078446388244629  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2833, 256])
m.shape torch.Size([2456, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.082207679748535  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.082207679748535  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2456, 256]), torch.Size([1, 2456, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.087209701538086  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.1940765380859375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2456, 256])
m.shape torch.Size([1918, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.199108123779297  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.199108123779297  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1918, 256]), torch.Size([1, 1918, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.2029662132263184  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.310615062713623  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1918, 256])
m.shape torch.Size([1605, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.3164992332458496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.3164992332458496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1605, 256]), torch.Size([1, 1605, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.3197989463806152  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.4308528900146484  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1605, 256])
m.shape torch.Size([1338, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.4370384216308594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.4370384216308594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1338, 256]), torch.Size([1, 1338, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.439784049987793  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.5522561073303223  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1338, 256])
m.shape torch.Size([1111, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.5580639839172363  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.5580639839172363  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1111, 256]), torch.Size([1, 1111, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.5603065490722656  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.670620918273926  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1111, 256])
m.shape torch.Size([961, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.6764912605285645  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.6764912605285645  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 961, 256]), torch.Size([1, 961, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.6783242225646973  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.783966541290283  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 961, 256])
m.shape torch.Size([834, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.79026460647583  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.79026460647583  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.7918553352355957  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.8954319953918457  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([736, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.9017105102539062  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.9017105102539062  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 736, 256]), torch.Size([1, 736, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 2.9031143188476562  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.0038280487060547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 736, 256])
m.shape torch.Size([656, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.010061740875244  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.010061740875244  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 656, 256]), torch.Size([1, 656, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.011312961578369  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.109910488128662  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 656, 256])
m.shape torch.Size([552, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.1163535118103027  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.1163535118103027  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.1174063682556152  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.2088770866394043  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([460, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.2140984535217285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.2140984535217285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.2149758338928223  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.2981362342834473  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([413, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.303255081176758  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.303255081176758  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3040428161621094  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3844223022460938  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([351, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3890891075134277  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.3890891075134277  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.389758586883545  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.4632725715637207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([303, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.467597484588623  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.467597484588623  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.4681754112243652  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.534575939178467  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([314, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.5394177436828613  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.5394177436828613  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.5400166511535645  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.613020420074463  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([249, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6170291900634766  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6170291900634766  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.617504119873047  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6778202056884766  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([209, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6813998222351074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6813998222351074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.6817984580993652  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.735215663909912  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([236, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.7395529747009277  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.7395529747009277  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.7400031089782715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8034720420837402  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([207, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.807425022125244  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.807425022125244  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.8078198432922363  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.86625337600708  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([144, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.869101047515869  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.869101047515869  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.869375705718994  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.911947727203369  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([139, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9148831367492676  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9148831367492676  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.3944091796875 GB
    Memory Allocated: 3.9151482582092285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4197998046875 GB
    Memory Allocated: 3.9580979347229004  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([132, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4197998046875 GB
    Memory Allocated: 3.961010456085205  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4197998046875 GB
    Memory Allocated: 3.961010456085205  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.4197998046875 GB
    Memory Allocated: 3.9612622261047363  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.003811359405518  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([1722, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.045062065124512  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.045062065124512  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1722, 256]), torch.Size([1, 1722, 256])
----------------------------------------3
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.048346519470215  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.6279296875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1722, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.474808216094971  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.4782395362854  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.48167085647583  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.478067874908447  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([23027, 40])
input nodes number: 35715
output nodes number: 23027
edges number: 181394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.47849702835083  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4666748046875 GB
    Memory Allocated: 4.478497505187988  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.04160785675048828  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.047158241271972656  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.047158241271972656  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04652184247970581 |0.08667004108428955 |0.271819531917572 |0.00013107061386108398 |0.08821815252304077 |0.0058786869049072266 |
----------------------------------------------------------pseudo_mini_loss sum 5.331000804901123
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  503971
Number of first layer input nodes during this epoch:  303484
Number of first layer output nodes during this epoch:  200487
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.04715776443481445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01695704460144043
global_2_local spend time (sec) 0.041961669921875
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004286289215087891
A = g.adjacency_matrix() spent  0.008965730667114258
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0785374641418457
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.298449993133545
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1685550212860107

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w][04:24:59] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23400434 edges into 4 parts and get 1749901 edge cuts

the counter of shared neigbor distribution
Counter({1.0: 23400434})
Convert a graph into a bidirected graph: 0.970 seconds
Metis partitioning: 4.454 seconds
Split the graph: 2.626 seconds
Construct subgraphs: 0.074 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.136417865753174
22835
23124
22525
22457
total k batches seeds list generation spend  18.911859273910522
after graph partition
graph partition algorithm spend time 19.057779788970947
22835
23124
22525
22457
partition_len_list
[35643, 41068, 69173, 54936]
shared_neighbor_graph_partition_s0 selection method  spend 19.149800300598145
time for parepare:  0.017668724060058594
local_output_nid generation:  0.003104686737060547
local_in_edges_tensor generation:  0.0036106109619140625
mini_batch_src_global generation:  0.006087541580200195
r_  generation:  0.059651851654052734
local_output_nid generation:  0.0038039684295654297
local_in_edges_tensor generation:  0.00428318977355957
mini_batch_src_global generation:  0.00622868537902832
r_  generation:  0.058281660079956055
local_output_nid generation:  0.003847837448120117
local_in_edges_tensor generation:  0.004171609878540039
mini_batch_src_global generation:  0.018739938735961914
r_  generation:  0.09166336059570312
local_output_nid generation:  0.006392002105712891
local_in_edges_tensor generation:  0.004170656204223633
mini_batch_src_global generation:  0.013428688049316406
r_  generation:  0.05849957466125488
----------------------check_connections_block total spend ----------------------------- 0.43729162216186523
generate_one_block  0.08761906623840332
generate_one_block  0.07482695579528809
generate_one_block  0.12923550605773926
generate_one_block  0.06827282905578613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04585981369018555
gen group dst list time:  0.005680561065673828
time for parepare:  0.01960015296936035
local_output_nid generation:  0.005143642425537109
local_in_edges_tensor generation:  0.017073869705200195
mini_batch_src_global generation:  0.0065822601318359375
r_  generation:  0.07609844207763672
local_output_nid generation:  0.008466243743896484
local_in_edges_tensor generation:  0.008819818496704102
mini_batch_src_global generation:  0.008790731430053711
r_  generation:  0.08904910087585449
local_output_nid generation:  0.01153564453125
local_in_edges_tensor generation:  0.015381813049316406
mini_batch_src_global generation:  0.019074440002441406
r_  generation:  0.2032787799835205
local_output_nid generation:  0.0151519775390625
local_in_edges_tensor generation:  0.01484537124633789
mini_batch_src_global generation:  0.014942407608032227
r_  generation:  0.13477659225463867
----------------------check_connections_block total spend ----------------------------- 0.7821569442749023
generate_one_block  0.09877443313598633
generate_one_block  0.1112363338470459
generate_one_block  0.25983476638793945
generate_one_block  0.16703176498413086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.04715776443481445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

connection checking time:  0.7821569442749023
block generation total time  0.6368772983551025
average batch blocks generation time:  0.15921932458877563
block dataloader generation time/epoch 21.53101420402527
pseudo mini batch 0 input nodes size: 50180
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.03850269317626953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.03850269317626953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.062430381774902344  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.06260061264038086  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.03863239288330078  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.041563987731933594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.041563987731933594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.041563987731933594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([50180, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.041563987731933594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([4007, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.14785337448120117  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.14785337448120117  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4007, 128]), torch.Size([1, 4007, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.15167474746704102  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.1827549934387207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4007, 128])
m.shape torch.Size([4026, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.18468379974365234  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.18468379974365234  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4026, 128]), torch.Size([1, 4026, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.1885232925415039  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.24712610244750977  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4026, 128])
m.shape torch.Size([3575, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.24997758865356445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.24997758865356445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3575, 128]), torch.Size([1, 3575, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.2533869743347168  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.3299527168273926  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3575, 128])
m.shape torch.Size([3037, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.33414173126220703  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.33414173126220703  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3037, 128]), torch.Size([1, 3037, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.33750200271606445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.42434120178222656  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3037, 128])
m.shape torch.Size([2616, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.42913007736206055  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.42913007736206055  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2616, 128]), torch.Size([1, 2616, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.4316248893737793  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.523958683013916  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2616, 128])
m.shape torch.Size([2205, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.5281996726989746  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.5281996726989746  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2205, 128]), torch.Size([1, 2205, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.5303783416748047  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.6243462562561035  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2205, 128])
m.shape torch.Size([1866, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.6295232772827148  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.6295232772827148  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.6313028335571289  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.720280647277832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1626, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.7255935668945312  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.7255935668945312  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.7271442413330078  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.8187675476074219  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([1389, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.8239531517028809  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.8239531517028809  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1389, 128]), torch.Size([1, 1389, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.8252778053283691  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.9100556373596191  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1389, 128])
m.shape torch.Size([11296, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.9635906219482422  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.9635906219482422  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 11296, 128]), torch.Size([1, 11296, 128])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 0.9752616882324219  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.7401237487792969  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 11296, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.6489992141723633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.6829910278320312  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.7169828414916992  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.682725429534912  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([35643, 256])
first layer input nodes number: 50180
first layer output nodes number: 35643
edges number: 212773
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.7173590660095215  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.7513508796691895  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.7598490715026855  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.7598490715026855  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([3129, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.937645435333252  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.937645435333252  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3129, 256]), torch.Size([1, 3129, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.9445791244506836  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.992323875427246  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3129, 256])
m.shape torch.Size([2795, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.9947128295898438  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.9947128295898438  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2795, 256]), torch.Size([1, 2795, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.0001449584960938  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.080413818359375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2795, 256])
m.shape torch.Size([2396, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.0853466987609863  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.0853466987609863  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2396, 256]), torch.Size([1, 2396, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.090333938598633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.192531108856201  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2396, 256])
m.shape torch.Size([1903, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.1975622177124023  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.1975622177124023  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1903, 256]), torch.Size([1, 1903, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.2013039588928223  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.308258533477783  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1903, 256])
m.shape torch.Size([1589, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.314080238342285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.314080238342285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1589, 256]), torch.Size([1, 1589, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.3172998428344727  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.428290367126465  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1589, 256])
m.shape torch.Size([1324, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.4341111183166504  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.4341111183166504  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1324, 256]), torch.Size([1, 1324, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.436774730682373  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.5483288764953613  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1324, 256])
m.shape torch.Size([1102, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.553889274597168  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.553889274597168  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1102, 256]), torch.Size([1, 1102, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.556325912475586  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.667634963989258  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1102, 256])
m.shape torch.Size([947, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.6732516288757324  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.6732516288757324  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 947, 256]), torch.Size([1, 947, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.675057888031006  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.778014659881592  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 947, 256])
m.shape torch.Size([826, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.784256935119629  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.784256935119629  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.785832405090332  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.889164924621582  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([733, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.8954224586486816  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.8954224586486816  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 733, 256]), torch.Size([1, 733, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.896820545196533  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.996084690093994  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 733, 256])
m.shape torch.Size([661, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.0023741722106934  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.0023741722106934  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.0036349296569824  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.1029105186462402  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([554, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.1086697578430176  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.1086697578430176  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.1097264289855957  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.20176362991333  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([460, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.2069830894470215  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.2069830894470215  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.2078604698181152  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.2897257804870605  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([417, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.294898509979248  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.294898509979248  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.295693874359131  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.3760228157043457  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([354, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.3807287216186523  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.3807287216186523  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.381403923034668  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.4550600051879883  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([305, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.4594130516052246  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.4594130516052246  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.4599947929382324  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.527585506439209  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([315, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.5324416160583496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.5324416160583496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.5330424308776855  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.6064038276672363  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([248, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.61039400100708  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.61039400100708  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.6108670234680176  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.67094087600708  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([207, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.6744847297668457  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.6744847297668457  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.674879550933838  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.727785587310791  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([236, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.7321248054504395  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.7321248054504395  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.732574939727783  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.796043872833252  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([206, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.7999768257141113  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.7999768257141113  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.8003697395324707  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.858520984649658  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([140, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.8612852096557617  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.8612852096557617  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.8615522384643555  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.9029417037963867  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([143, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.9059696197509766  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.9059696197509766  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.9062423706054688  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.950428009033203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([130, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.9532904624938965  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.9532904624938965  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 3.953538417816162  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 3.9954428672790527  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([1715, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.036527156829834  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.036527156829834  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1715, 256]), torch.Size([1, 1715, 256])
----------------------------------------3
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.039798259735107  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.616180896759033  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1715, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.463642597198486  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.467045307159424  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.470448017120361  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.466875076293945  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([22835, 40])
input nodes number: 35643
output nodes number: 22835
edges number: 180551
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.467282295227051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 4.467283248901367  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.0472407341003418  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

pseudo mini batch 1 input nodes size: 63771
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.038604736328125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.038604736328125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.06901311874389648  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.06918573379516602  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.04508781433105469  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.04807567596435547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.04807567596435547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.04807567596435547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([63771, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.04807567596435547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([4794, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.16713190078735352  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.16713190078735352  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4794, 128]), torch.Size([1, 4794, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.17170381546020508  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.20885705947875977  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4794, 128])
m.shape torch.Size([4964, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.21114301681518555  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.21114301681518555  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4964, 128]), torch.Size([1, 4964, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.21659374237060547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.28990745544433594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4964, 128])
m.shape torch.Size([4379, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.2932095527648926  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.2932095527648926  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 4379, 128]), torch.Size([1, 4379, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.2982597351074219  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.3936471939086914  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 4379, 128])
m.shape torch.Size([3610, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.39844465255737305  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.39844465255737305  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3610, 128]), torch.Size([1, 3610, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.40223121643066406  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.5038986206054688  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3610, 128])
m.shape torch.Size([3092, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.5095491409301758  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.5095491409301758  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3092, 128]), torch.Size([1, 3092, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.5135879516601562  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.6224179267883301  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3092, 128])
m.shape torch.Size([2522, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.6286797523498535  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.6286797523498535  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2522, 128]), torch.Size([1, 2522, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.6314253807067871  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.7376351356506348  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2522, 128])
m.shape torch.Size([2177, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.7436990737915039  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.7436990737915039  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2177, 128]), torch.Size([1, 2177, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.746006965637207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.8544983863830566  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2177, 128])
m.shape torch.Size([1930, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.8608226776123047  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.8608226776123047  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1930, 128]), torch.Size([1, 1930, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.8626632690429688  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.9675769805908203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1930, 128])
m.shape torch.Size([1631, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.973656177520752  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.973656177520752  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1631, 128]), torch.Size([1, 1631, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.9752116203308105  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.078223705291748  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1631, 128])
m.shape torch.Size([11969, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.1345186233520508  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.1345186233520508  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 11969, 128]), torch.Size([1, 11969, 128])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.1459331512451172  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.956364631652832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 11969, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.8560080528259277  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.8951735496520996  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.9343390464782715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.8948674201965332  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([41068, 256])
first layer input nodes number: 63771
first layer output nodes number: 41068
edges number: 237939
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.9348163604736328  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.9739818572998047  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.9837732315063477  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 1.9837732315063477  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([3499, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.1453070640563965  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.1453070640563965  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3499, 256]), torch.Size([1, 3499, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.153168201446533  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.2089333534240723  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3499, 256])
m.shape torch.Size([3212, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.2112345695495605  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.2112345695495605  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3212, 256]), torch.Size([1, 3212, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.2190957069396973  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.3136959075927734  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3212, 256])
m.shape torch.Size([2556, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.318002700805664  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.318002700805664  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2556, 256]), torch.Size([1, 2556, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.323751926422119  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.4312891960144043  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2556, 256])
m.shape torch.Size([2049, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.4367294311523438  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.4367294311523438  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2049, 256]), torch.Size([1, 2049, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.441103458404541  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.5562191009521484  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2049, 256])
m.shape torch.Size([1739, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.5626220703125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.5626220703125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1739, 256]), torch.Size([1, 1739, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.5662450790405273  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.6906261444091797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1739, 256])
m.shape torch.Size([1354, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.6967759132385254  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.6967759132385254  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1354, 256]), torch.Size([1, 1354, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.699553966522217  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.8131518363952637  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1354, 256])
m.shape torch.Size([1170, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.819732189178467  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.819732189178467  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1170, 256]), torch.Size([1, 1170, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.8219828605651855  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.938319683074951  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1170, 256])
m.shape torch.Size([987, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.944793224334717  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.944793224334717  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 2.9466757774353027  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.057654857635498  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 987, 256])
m.shape torch.Size([815, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.0637636184692383  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.0637636184692383  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.0653181076049805  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.1675376892089844  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([699, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.1734790802001953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.1734790802001953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.1748123168945312  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.2720699310302734  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([560, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.2773241996765137  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.2773241996765137  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.2783923149108887  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.3635382652282715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([492, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.3686790466308594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.3686790466308594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.369617462158203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.451671600341797  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([441, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.4567127227783203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.4567127227783203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.4575538635253906  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.5349388122558594  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([371, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.539510726928711  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.539510726928711  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.5402183532714844  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.6105546951293945  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([350, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.6152472496032715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.6152472496032715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.615914821624756  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.689727306365967  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([273, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.693592071533203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.693592071533203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.694112777709961  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.7550525665283203  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([231, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.7585668563842773  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.7585668563842773  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.759007453918457  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.8118791580200195  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([212, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.815326690673828  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.815326690673828  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.8157310485839844  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.867084503173828  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([180, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.8707237243652344  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.8707237243652344  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.8710670471191406  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.917072296142578  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([168, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.9201302528381348  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.9201302528381348  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.9204506874084473  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.9656319618225098  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([135, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.9681968688964844  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.9681968688964844  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 3.968454360961914  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.006563186645508  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.009373664855957  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.009373664855957  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.009638786315918  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.050732612609863  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([101, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.052833080291748  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.052833080291748  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.053025722503662  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.08423376083374  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([106, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.086582660675049  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.086582660675049  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.086784839630127  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.12095308303833  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([1285, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.15172815322876  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.15172815322876  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1285, 256]), torch.Size([1, 1285, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.154179096221924  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.585545063018799  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.449686050415039  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.453616619110107  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.457062721252441  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.4529595375061035  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([23124, 40])
input nodes number: 41068
output nodes number: 23124
edges number: 163034
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.45396614074707  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 4.4539666175842285  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.0544590950012207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

pseudo mini batch 2 input nodes size: 93537
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.04561567306518555  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.04561567306518555  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.09021759033203125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.09038543701171875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.059804439544677734  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.06575441360473633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.06575441360473633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.06575441360473633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([93537, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 0.06575441360473633  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([3730, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.3301510810852051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.3301510810852051  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3730, 128]), torch.Size([1, 3730, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.33387231826782227  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.36232995986938477  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3730, 128])
m.shape torch.Size([3994, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.36436033248901367  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.36436033248901367  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3994, 128]), torch.Size([1, 3994, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.36816930770874023  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.42688894271850586  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3994, 128])
m.shape torch.Size([3652, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.4295964241027832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.4295964241027832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3652, 128]), torch.Size([1, 3652, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.43307924270629883  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.5104527473449707  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3652, 128])
m.shape torch.Size([3345, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.5152373313903809  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.5152373313903809  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3345, 128]), torch.Size([1, 3345, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.5190958976745605  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.6139860153198242  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3345, 128])
m.shape torch.Size([3218, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.620063304901123  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.620063304901123  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 3218, 128]), torch.Size([1, 3218, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.6231927871704102  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.7336740493774414  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 3218, 128])
m.shape torch.Size([2928, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.7413463592529297  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.7413463592529297  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2928, 128]), torch.Size([1, 2928, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.7442402839660645  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.864311695098877  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2928, 128])
m.shape torch.Size([2815, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.8726887702941895  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.8726887702941895  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2815, 128]), torch.Size([1, 2815, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.875450611114502  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.0135688781738281  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2815, 128])
m.shape torch.Size([2619, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.0214781761169434  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.0214781761169434  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2619, 128]), torch.Size([1, 2619, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.024815559387207  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.1729350090026855  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2619, 128])
m.shape torch.Size([2502, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.1824235916137695  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.1824235916137695  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2502, 128]), torch.Size([1, 2502, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.1848654747009277  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.3435711860656738  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2502, 128])
m.shape torch.Size([40370, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.5357375144958496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.5357375144958496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 40370, 128]), torch.Size([1, 40370, 128])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 1.5748000144958496  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.314477443695068  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 40370, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.069298267364502  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.1352667808532715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.201235294342041  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.134751319885254  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

torch.Size([69173, 256])
first layer input nodes number: 93537
first layer output nodes number: 69173
edges number: 536587
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.201934337615967  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.267902851104736  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.284395217895508  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.284395217895508  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

m.shape torch.Size([2440, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.539932727813721  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.539932727813721  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2440, 256]), torch.Size([1, 2440, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.544586658477783  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.583715438842773  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2440, 256])
m.shape torch.Size([2145, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.5860748291015625  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.5860748291015625  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 2145, 256]), torch.Size([1, 2145, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.590167999267578  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.65153694152832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 2145, 256])
m.shape torch.Size([1699, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.654741287231445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.654741287231445  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1699, 256]), torch.Size([1, 1699, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.658261299133301  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.731668949127197  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1699, 256])
m.shape torch.Size([1342, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.7351202964782715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.7351202964782715  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1342, 256]), torch.Size([1, 1342, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.737858772277832  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.81361198425293  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1342, 256])
m.shape torch.Size([1193, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.818065643310547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.818065643310547  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 1193, 256]), torch.Size([1, 1193, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.820534706115723  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.904757499694824  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 1193, 256])
m.shape torch.Size([972, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.9092254638671875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.9092254638671875  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 972, 256]), torch.Size([1, 972, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.911079406738281  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.9907989501953125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 972, 256])
m.shape torch.Size([800, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.9952545166015625  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.9952545166015625  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 4.9967803955078125  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.073089599609375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([663, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.0774245262146  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.0774245262146  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 663, 256]), torch.Size([1, 663, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.078689098358154  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.151551723480225  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 663, 256])
m.shape torch.Size([664, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.156663417816162  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.156663417816162  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.15792989730835  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.23898458480835  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([597, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.244089603424072  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.244089603424072  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.245228290557861  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.326262950897217  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([543, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.331434726715088  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.331434726715088  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.332470417022705  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.41604471206665  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([502, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.421317100524902  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.421317100524902  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.422274589538574  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.504805564880371  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([429, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.509687423706055  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.509687423706055  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.510505676269531  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.5875091552734375  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([375, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.592146396636963  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.592146396636963  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.592861652374268  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.6657395362854  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([358, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.670543193817139  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.670543193817139  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.6712260246276855  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.745141506195068  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([331, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.749890327453613  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.749890327453613  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.750521659851074  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.823786735534668  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([315, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.828618049621582  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.828618049621582  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.829218864440918  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.902020454406738  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([328, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.907394886016846  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.907394886016846  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.908020496368408  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.990246295928955  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([303, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.995466709136963  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.995466709136963  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 5.996044635772705  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.074392795562744  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([274, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.079370975494385  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.079370975494385  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.079893589019775  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.157230854034424  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([274, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.162499904632568  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.162499904632568  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.163022518157959  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.242976665496826  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([208, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.2471137046813965  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.2471137046813965  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.2475104331970215  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.3090033531188965  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([197, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.313159942626953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.313159942626953  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.313535690307617  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.374406814575195  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([215, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.379178524017334  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.379178524017334  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.379588603973389  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.448892116546631  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([5358, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.577455043792725  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.577455043792725  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

 h.shape torch.Size([1, 5358, 256]), torch.Size([1, 5358, 256])
----------------------------------------3
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 6.587674617767334  GigaBytes
Max Memory Allocated: 8.383263111114502  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 8.386424541473389  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 5358, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 8.151666641235352  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 8.155632019042969  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 8.159833908081055  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 8.15570068359375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([22525, 40])
input nodes number: 69173
output nodes number: 22525
edges number: 261799
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 8.156418800354004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 8.156419277191162  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.0761861801147461  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

pseudo mini batch 3 input nodes size: 96678
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.05983924865722656  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.05983924865722656  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.10593891143798828  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.10610628128051758  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.061336517333984375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06491851806640625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06491851806640625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06491851806640625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([96678, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06491851806640625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([6015, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.23540925979614258  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.23540925979614258  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 6015, 128]), torch.Size([1, 6015, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2420334815979004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.28792428970336914  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 6015, 128])
m.shape torch.Size([5949, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2907295227050781  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2907295227050781  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 5949, 128]), torch.Size([1, 5949, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2964029312133789  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.38184452056884766  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 5949, 128])
m.shape torch.Size([5018, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3861861228942871  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3861861228942871  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 5018, 128]), torch.Size([1, 5018, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3912081718444824  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.4984903335571289  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 5018, 128])
m.shape torch.Size([4290, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5042819976806641  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5042819976806641  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4290, 128]), torch.Size([1, 4290, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5089578628540039  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6279439926147461  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4290, 128])
m.shape torch.Size([3670, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.634648323059082  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.634648323059082  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3670, 128]), torch.Size([1, 3670, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6384439468383789  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.765568733215332  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3670, 128])
m.shape torch.Size([3025, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7721920013427734  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7721920013427734  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3025, 128]), torch.Size([1, 3025, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7759494781494141  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9055728912353516  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3025, 128])
m.shape torch.Size([2607, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9128322601318359  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9128322601318359  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2607, 128]), torch.Size([1, 2607, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.915428638458252  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0448899269104004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2607, 128])
m.shape torch.Size([2304, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0523486137390137  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0523486137390137  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2304, 128]), torch.Size([1, 2304, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0545897483825684  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.185342788696289  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2304, 128])
m.shape torch.Size([2008, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.192861557006836  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.192861557006836  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2008, 128]), torch.Size([1, 2008, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.1947765350341797  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.3192424774169922  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2008, 128])
m.shape torch.Size([20050, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.4138908386230469  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.4138908386230469  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 20050, 128]), torch.Size([1, 20050, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.4334220886230469  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7955360412597656  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 20050, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.646855354309082  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.699246406555176  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7516374588012695  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.6988368034362793  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([54936, 256])
first layer input nodes number: 96678
first layer output nodes number: 54936
edges number: 341880
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7523598670959473  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.804750919342041  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.8178486824035645  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.8178486824035645  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([4360, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.956366539001465  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.956366539001465  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4360, 256]), torch.Size([1, 4360, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.9646825790405273  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0312108993530273  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4360, 256])
m.shape torch.Size([3554, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0338850021362305  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0338850021362305  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3554, 256]), torch.Size([1, 3554, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.040663719177246  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1423444747924805  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3554, 256])
m.shape torch.Size([2626, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1465272903442383  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1465272903442383  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2626, 256]), torch.Size([1, 2626, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1516332626342773  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2636308670043945  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2626, 256])
m.shape torch.Size([2026, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2685208320617676  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2685208320617676  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2026, 256]), torch.Size([1, 2026, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2728419303894043  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3881173133850098  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2026, 256])
m.shape torch.Size([1701, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3941497802734375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3941497802734375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1701, 256]), torch.Size([1, 1701, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.397430419921875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5147056579589844  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1701, 256])
m.shape torch.Size([1218, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.520089626312256  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.520089626312256  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1218, 256]), torch.Size([1, 1218, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.522519111633301  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.632711887359619  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1218, 256])
m.shape torch.Size([973, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6374731063842773  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6374731063842773  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 973, 256]), torch.Size([1, 973, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.639328956604004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7360057830810547  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 973, 256])
m.shape torch.Size([875, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7418060302734375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7418060302734375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 875, 256]), torch.Size([1, 875, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7434749603271484  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.838603973388672  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 875, 256])
m.shape torch.Size([671, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.843574047088623  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.843574047088623  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 671, 256]), torch.Size([1, 671, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8448538780212402  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9298577308654785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 671, 256])
m.shape torch.Size([570, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.934696674346924  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.934696674346924  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.935783863067627  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.0132527351379395  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([439, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.017350673675537  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.017350673675537  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.018187999725342  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.086802005767822  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([389, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.090869903564453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.090869903564453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.091611862182617  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.155616760253906  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([326, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.1593194007873535  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.1593194007873535  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.15994119644165  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.219131946563721  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([271, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.22246789932251  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.22246789932251  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.222984790802002  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.2758564949035645  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([227, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.278871059417725  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.278871059417725  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.279304027557373  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.325198650360107  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([202, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.328088760375977  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.328088760375977  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.328474044799805  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.372011184692383  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([169, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.374579906463623  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.374579906463623  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.374902248382568  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.413583278656006  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([160, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.416190147399902  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.416190147399902  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.416495323181152  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.455252647399902  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([146, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.457766532897949  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.457766532897949  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.45804500579834  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.495360374450684  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([129, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.497701168060303  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.497701168060303  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.4979472160339355  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.532639980316162  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([102, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.534575939178467  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.534575939178467  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.534770488739014  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.563563823699951  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.565308094024658  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.565308094024658  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.565439701080322  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.585838794708252  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.587497711181641  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.587497711181641  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.587646484375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.611747741699219  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes
[04:25:21] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23407770 edges into 4 parts and get 1744318 edge cuts

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([74, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.613380432128906  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.613380432128906  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.613521575927734  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.6373748779296875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([1102, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.663783550262451  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.663783550262451  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1102, 256]), torch.Size([1, 1102, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.6658854484558105  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.047213077545166  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1102, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.933804035186768  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.937193393707275  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.940539836883545  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.936983108520508  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([22457, 40])
input nodes number: 54936
output nodes number: 22457
edges number: 138866
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.936984062194824  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.936984539031982  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.07116031646728516  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.07116031646728516  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.07116031646728516  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03814166784286499 |0.0038700103759765625 |0.13306480646133423 |0.00010770559310913086 |0.09552657604217529 |0.004678964614868164 |
----------------------------------------------------------pseudo_mini_loss sum 4.537644386291504
Total (block generation + training)time/epoch 22.670329570770264
Training time/epoch 1.138965129852295
Training time without block to device /epoch 1.1234850883483887
Training time without total dataloading part /epoch 0.9194753170013428
load block tensor time/epoch 0.15256667137145996
block to device time/epoch 0.01548004150390625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  504986
Number of first layer input nodes during this epoch:  304166
Number of first layer output nodes during this epoch:  200820
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.07115983963012695  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02250981330871582
global_2_local spend time (sec) 0.04620504379272461
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0042476654052734375
A = g.adjacency_matrix() spent  0.01170492172241211
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08277654647827148
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.39259672164917
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1733505725860596

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770})
Convert a graph into a bidirected graph: 1.036 seconds
Metis partitioning: 4.446 seconds
Split the graph: 2.604 seconds
Construct subgraphs: 0.057 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.154516220092773
22420
23154
22420
22947
total k batches seeds list generation spend  19.09040856361389
after graph partition
graph partition algorithm spend time 19.18100333213806
22420
23154
22420
22947
partition_len_list
[35526, 42049, 54894, 70021]
shared_neighbor_graph_partition_s0 selection method  spend 19.279863595962524
time for parepare:  0.017119884490966797
local_output_nid generation:  0.0032091140747070312
local_in_edges_tensor generation:  0.0037953853607177734
mini_batch_src_global generation:  0.006128072738647461
r_  generation:  0.060402870178222656
local_output_nid generation:  0.004010677337646484
local_in_edges_tensor generation:  0.004361391067504883
mini_batch_src_global generation:  0.006415605545043945
r_  generation:  0.058676719665527344
local_output_nid generation:  0.004039764404296875
local_in_edges_tensor generation:  0.003501415252685547
mini_batch_src_global generation:  0.005297660827636719
r_  generation:  0.05384182929992676
local_output_nid generation:  0.004139900207519531
local_in_edges_tensor generation:  0.0055463314056396484
mini_batch_src_global generation:  0.00958395004272461
r_  generation:  0.0942237377166748
----------------------check_connections_block total spend ----------------------------- 0.4164772033691406
generate_one_block  0.08652520179748535
generate_one_block  0.07770776748657227
generate_one_block  0.07140445709228516
generate_one_block  0.12997984886169434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042075395584106445
gen group dst list time:  0.00590825080871582
time for parepare:  0.02393341064453125
local_output_nid generation:  0.0054972171783447266
local_in_edges_tensor generation:  0.02223038673400879
mini_batch_src_global generation:  0.006983518600463867
r_  generation:  0.07776069641113281
local_output_nid generation:  0.01162266731262207
local_in_edges_tensor generation:  0.0070531368255615234
mini_batch_src_global generation:  0.009046792984008789
r_  generation:  0.09111714363098145
local_output_nid generation:  0.012470483779907227
local_in_edges_tensor generation:  0.011373281478881836
mini_batch_src_global generation:  0.012204408645629883
r_  generation:  0.1355729103088379
local_output_nid generation:  0.013575315475463867
local_in_edges_tensor generation:  0.01676797866821289
mini_batch_src_global generation:  0.018790483474731445
r_  generation:  0.2004837989807129
----------------------check_connections_block total spend ----------------------------- 0.8033385276794434
generate_one_block  0.10590553283691406
generate_one_block  0.11763262748718262
generate_one_block  0.16380929946899414
generate_one_block  0.24735212326049805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.07115983963012695  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

connection checking time:  0.8033385276794434
block generation total time  0.6346995830535889
average batch blocks generation time:  0.15867489576339722
block dataloader generation time/epoch 21.599275588989258
pseudo mini batch 0 input nodes size: 49630
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.060759544372558594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.060759544372558594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.08442497253417969  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.08459234237670898  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.03832530975341797  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.0412445068359375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.0412445068359375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.0412445068359375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([49630, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.0412445068359375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([3937, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.14811992645263672  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.14811992645263672  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3937, 128]), torch.Size([1, 3937, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.15187454223632812  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.18282127380371094  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3937, 128])
m.shape torch.Size([4007, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.18469858169555664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.18469858169555664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4007, 128]), torch.Size([1, 4007, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.18933725357055664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.24782276153564453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4007, 128])
m.shape torch.Size([3558, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.25100183486938477  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.25100183486938477  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3558, 128]), torch.Size([1, 3558, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2546091079711914  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3327178955078125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3558, 128])
m.shape torch.Size([3039, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.33611106872558594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.33611106872558594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3039, 128]), torch.Size([1, 3039, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.33900928497314453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.42673349380493164  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3039, 128])
m.shape torch.Size([2566, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.43140220642089844  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.43140220642089844  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2566, 128]), torch.Size([1, 2566, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.43407487869262695  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5221714973449707  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2566, 128])
m.shape torch.Size([2233, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.527336597442627  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.527336597442627  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2233, 128]), torch.Size([1, 2233, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5296306610107422  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6234321594238281  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2233, 128])
m.shape torch.Size([1859, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6285724639892578  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6285724639892578  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1859, 128]), torch.Size([1, 1859, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.630345344543457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7194328308105469  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1859, 128])
m.shape torch.Size([1649, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7248368263244629  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7248368263244629  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7264094352722168  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.818687915802002  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1394, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8238840103149414  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8238840103149414  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1394, 128]), torch.Size([1, 1394, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8252134323120117  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9133090972900391  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1394, 128])
m.shape torch.Size([11284, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9664506912231445  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9664506912231445  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 11284, 128]), torch.Size([1, 11284, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9772119522094727  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.7419919967651367  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 11284, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.6500248908996582  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.6839051246643066  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.717785358428955  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.6836400032043457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([35526, 256])
first layer input nodes number: 49630
first layer output nodes number: 35526
edges number: 212600
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.7181572914123535  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.752037525177002  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.760507583618164  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.760507583618164  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([3038, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9366087913513184  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9366087913513184  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3038, 256]), torch.Size([1, 3038, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9428954124450684  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9892516136169434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3038, 256])
m.shape torch.Size([2718, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9915790557861328  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9915790557861328  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2718, 256]), torch.Size([1, 2718, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9969406127929688  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.075927734375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2718, 256])
m.shape torch.Size([2315, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.0798068046569824  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.0798068046569824  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2315, 256]), torch.Size([1, 2315, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.084636688232422  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.1868896484375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2315, 256])
m.shape torch.Size([1862, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.1912522315979004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.1912522315979004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1862, 256]), torch.Size([1, 1862, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.194857120513916  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.299323081970215  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1862, 256])
m.shape torch.Size([1565, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.304696559906006  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.304696559906006  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1565, 256]), torch.Size([1, 1565, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.307926654815674  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.4182658195495605  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1565, 256])
m.shape torch.Size([1297, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.4238553047180176  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.4238553047180176  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1297, 256]), torch.Size([1, 1297, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.427152156829834  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.5355372428894043  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1297, 256])
m.shape torch.Size([1075, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.5415329933166504  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.5415329933166504  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1075, 256]), torch.Size([1, 1075, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.543914318084717  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.6470866203308105  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1075, 256])
m.shape torch.Size([941, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.653296947479248  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.653296947479248  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 941, 256]), torch.Size([1, 941, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.6550917625427246  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7573962211608887  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 941, 256])
m.shape torch.Size([804, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.763453960418701  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.763453960418701  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7649874687194824  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.8631930351257324  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([735, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.869490623474121  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.869490623474121  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.8708925247192383  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.9705305099487305  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([652, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.9767231941223145  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.9767231941223145  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 652, 256]), torch.Size([1, 652, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.977966785430908  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0758519172668457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 652, 256])
m.shape torch.Size([543, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.082374095916748  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.082374095916748  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0834097862243652  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1746134757995605  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([462, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.179868221282959  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.179868221282959  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1807494163513184  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.262254238128662  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([410, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2673306465148926  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2673306465148926  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2681126594543457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3478264808654785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([347, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3529295921325684  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3529295921325684  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3535914421081543  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4237475395202637  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([299, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4280147552490234  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4280147552490234  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4285850524902344  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4942092895507812  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([315, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4990711212158203  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4990711212158203  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4996719360351562  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.572628974914551  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([250, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5766539573669434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5766539573669434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5771307945251465  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6376891136169434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([210, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6412858963012695  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6412858963012695  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.64168643951416  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.695359230041504  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([231, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6995997428894043  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6995997428894043  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.700040340423584  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.76216459274292  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([202, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.766021728515625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.766021728515625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.766407012939453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8234291076660156  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([140, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8261971473693848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8261971473693848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8264641761779785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8678536415100098  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([143, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8708815574645996  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8708815574645996  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.871154308319092  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.915339946746826  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([133, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.918271541595459  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.918271541595459  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.918525218963623  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9613966941833496  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([1733, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.002910614013672  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.002910614013672  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1733, 256]), torch.Size([1, 1733, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.006585121154785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.58834171295166  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1733, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.4367499351501465  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.440091133117676  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.443432331085205  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.4399237632751465  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([22420, 40])
input nodes number: 35526
output nodes number: 22420
edges number: 179129
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.440308094024658  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.440309047698975  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.046868324279785156  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

pseudo mini batch 1 input nodes size: 65639
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.03827810287475586  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.03827810287475586  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06957721710205078  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06974983215332031  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.04591703414916992  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.048947811126708984  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.048947811126708984  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.048947811126708984  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([65639, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.048947811126708984  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([4928, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.17151689529418945  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.17151689529418945  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4928, 128]), torch.Size([1, 4928, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.17621660232543945  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.21381425857543945  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4928, 128])
m.shape torch.Size([5074, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.21630334854125977  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.21630334854125977  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 5074, 128]), torch.Size([1, 5074, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.22114229202270508  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.29442834854125977  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 5074, 128])
m.shape torch.Size([4418, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2992672920227051  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2992672920227051  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4418, 128]), torch.Size([1, 4418, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3039059638977051  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.39969873428344727  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4418, 128])
m.shape torch.Size([3735, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.4041447639465332  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.4041447639465332  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3735, 128]), torch.Size([1, 3735, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.40779972076416016  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5110969543457031  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3735, 128])
m.shape torch.Size([3166, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5168642997741699  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5168642997741699  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3166, 128]), torch.Size([1, 3166, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5202503204345703  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6300644874572754  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3166, 128])
m.shape torch.Size([2583, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6359448432922363  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6359448432922363  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2583, 128]), torch.Size([1, 2583, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6386141777038574  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7461581230163574  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2583, 128])
m.shape torch.Size([2239, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7523999214172363  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7523999214172363  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2239, 128]), torch.Size([1, 2239, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7546992301940918  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8650379180908203  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2239, 128])
m.shape torch.Size([1991, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8712515830993652  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8712515830993652  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1991, 128]), torch.Size([1, 1991, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8731503486633301  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.984097957611084  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1991, 128])
m.shape torch.Size([1638, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.990178108215332  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.990178108215332  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1638, 128]), torch.Size([1, 1638, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9917402267456055  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0946297645568848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1638, 128])
m.shape torch.Size([12277, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.1523900032043457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.1523900032043457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 12277, 128]), torch.Size([1, 12277, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.1640982627868652  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.995384693145752  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 12277, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.8924050331115723  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9325060844421387  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.972607135772705  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.932192325592041  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([42049, 256])
first layer input nodes number: 65639
first layer output nodes number: 42049
edges number: 243711
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.9730982780456543  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.0131993293762207  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.0232248306274414  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.0232248306274414  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([3587, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.1842823028564453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.1842823028564453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3587, 256]), torch.Size([1, 3587, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.1911239624023438  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.2458572387695312  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3587, 256])
m.shape torch.Size([3205, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.2485976219177246  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.2485976219177246  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3205, 256]), torch.Size([1, 3205, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.255074977874756  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.346770763397217  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3205, 256])
m.shape torch.Size([2557, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.3510870933532715  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.3510870933532715  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2557, 256]), torch.Size([1, 2557, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.3563461303710938  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.4647274017333984  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2557, 256])
m.shape torch.Size([2060, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.4702086448669434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.4702086448669434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2060, 256]), torch.Size([1, 2060, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.4741463661193848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.588606357574463  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2060, 256])
m.shape torch.Size([1720, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.594851016998291  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.594851016998291  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1720, 256]), torch.Size([1, 1720, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.598550796508789  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.722775459289551  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1720, 256])
m.shape torch.Size([1329, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7282652854919434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7282652854919434  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1329, 256]), torch.Size([1, 1329, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7310805320739746  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.8435592651367188  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1329, 256])
m.shape torch.Size([1154, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.850043773651123  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.850043773651123  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1154, 256]), torch.Size([1, 1154, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.8524160385131836  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.9685091972351074  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1154, 256])
m.shape torch.Size([983, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.9749670028686523  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.9749670028686523  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.976841926574707  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0886220932006836  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([817, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0947518348693848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0947518348693848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.0963101387023926  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1993680000305176  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 817, 256])
m.shape torch.Size([698, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2052979469299316  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2052979469299316  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 698, 256]), torch.Size([1, 698, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2066292762756348  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3047242164611816  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 698, 256])
m.shape torch.Size([563, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3100109100341797  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3100109100341797  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.311084747314453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.3961896896362305  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([496, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4013733863830566  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4013733863830566  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.4023194313049316  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.484574794769287  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([432, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.489499568939209  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.489499568939209  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.490323543548584  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.566129207611084  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([369, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5706825256347656  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5706825256347656  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5713863372802734  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.641317367553711  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([339, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.645853042602539  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.645853042602539  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6464996337890625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7158918380737305  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([262, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.719597816467285  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.719597816467285  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.720097541809082  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7790756225585938  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([234, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.782649517059326  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.782649517059326  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7830958366394043  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8366541862487793  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([204, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8399605751037598  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8399605751037598  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8403496742248535  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8897652626037598  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([182, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.892894744873047  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.892894744873047  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8932418823242188  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.93975830078125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([172, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9428911209106445  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9428911209106445  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9432191848754883  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.989476203918457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([144, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9925756454467773  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9925756454467773  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.9928503036499023  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.033499717712402  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.036301612854004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.036301612854004  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.036566734313965  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.07766056060791  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([110, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.079959869384766  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.079959869384766  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.080169677734375  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.114158630371094  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([104, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.116452693939209  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.116452693939209  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.1166510581970215  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.150174617767334  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([1294, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.181168079376221  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.181168079376221  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1294, 256]), torch.Size([1, 1294, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.18363618850708  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.619250774383545  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1294, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.4831414222717285  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.486591815948486  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.490042209625244  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.486419200897217  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([23154, 40])
input nodes number: 42049
output nodes number: 23154
edges number: 162967
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.4870147705078125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.487015247344971  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.0549921989440918  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

pseudo mini batch 2 input nodes size: 96580
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.04602622985839844  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.04602622985839844  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.09207916259765625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.09224653244018555  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.060774803161621094  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06438255310058594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06438255310058594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06438255310058594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([96580, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06438255310058594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([5777, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.23603487014770508  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.23603487014770508  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 5777, 128]), torch.Size([1, 5777, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.24154424667358398  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.28586769104003906  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 5777, 128])
m.shape torch.Size([5866, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2886223793029785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.2886223793029785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 5866, 128]), torch.Size([1, 5866, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.29438018798828125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3782939910888672  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 5866, 128])
m.shape torch.Size([5010, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3826637268066406  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3826637268066406  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 5010, 128]), torch.Size([1, 5010, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.38816070556640625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.49572086334228516  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 5010, 128])
m.shape torch.Size([4182, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5013084411621094  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5013084411621094  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4182, 128]), torch.Size([1, 4182, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5056915283203125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6213560104370117  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4182, 128])
m.shape torch.Size([3721, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6282334327697754  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6282334327697754  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3721, 128]), torch.Size([1, 3721, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6320018768310547  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7598075866699219  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3721, 128])
m.shape torch.Size([3045, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7667450904846191  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7667450904846191  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3045, 128]), torch.Size([1, 3045, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7699131965637207  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8999032974243164  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3045, 128])
m.shape torch.Size([2628, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9072232246398926  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.9072232246398926  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2628, 128]), torch.Size([1, 2628, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.909947395324707  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0403013229370117  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2628, 128])
m.shape torch.Size([2330, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0479364395141602  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0479364395141602  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2330, 128]), torch.Size([1, 2330, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.050288200378418  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.182535171508789  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2330, 128])
m.shape torch.Size([2015, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.1900715827941895  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.1900715827941895  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2015, 128]), torch.Size([1, 2015, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.191993236541748  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.3165526390075684  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2015, 128])
m.shape torch.Size([20320, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.412485122680664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.412485122680664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 20320, 128]), torch.Size([1, 20320, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.432016372680664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.818124771118164  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 20320, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.667851448059082  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7202024459838867  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7725534439086914  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.7197933197021484  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([54894, 256])
first layer input nodes number: 96580
first layer output nodes number: 54894
edges number: 344513
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.773275375366211  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.8256263732910156  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.838714122772217  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.838714122772217  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([4204, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.977774143218994  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.977774143218994  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4204, 256]), torch.Size([1, 4204, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 2.985792636871338  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.049940586090088  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4204, 256])
m.shape torch.Size([3550, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.052755355834961  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.052755355834961  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3550, 256]), torch.Size([1, 3550, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.059743881225586  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.161418914794922  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3550, 256])
m.shape torch.Size([2650, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1656746864318848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.1656746864318848  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2650, 256]), torch.Size([1, 2650, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.170881748199463  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2849769592285156  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2650, 256])
m.shape torch.Size([2023, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2902274131774902  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.2902274131774902  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2023, 256]), torch.Size([1, 2023, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.294201374053955  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.408543586730957  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2023, 256])
m.shape torch.Size([1705, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.414569854736328  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.414569854736328  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1705, 256]), torch.Size([1, 1705, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.417980194091797  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5373120307922363  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1705, 256])
m.shape torch.Size([1246, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.542329788208008  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.542329788208008  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1246, 256]), torch.Size([1, 1246, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.5447959899902344  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6501731872558594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1246, 256])
m.shape torch.Size([988, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6556477546691895  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.6556477546691895  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 988, 256]), torch.Size([1, 988, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.657532215118408  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7545018196105957  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 988, 256])
m.shape torch.Size([860, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7601723670959473  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.7601723670959473  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 860, 256]), torch.Size([1, 860, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.761812686920166  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8553109169006348  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 860, 256])
m.shape torch.Size([701, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8605546951293945  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.8605546951293945  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.861891746520996  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.951716423034668  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([562, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.956449508666992  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.956449508666992  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 3.957521438598633  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.034597396850586  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([445, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.038766384124756  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.038766384124756  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.039615154266357  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.108303546905518  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([397, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.112458229064941  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.112458229064941  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.113215446472168  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.177745819091797  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([329, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.181478023529053  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.181478023529053  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.182105541229248  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.242075443267822  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([284, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.245583534240723  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.245583534240723  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.246125221252441  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.300641059875488  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([243, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.303873538970947  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.303873538970947  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.304337024688721  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.353466510772705  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([209, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.356540679931641  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.356540679931641  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.356939315795898  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.401985168457031  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([178, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.404694557189941  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.404694557189941  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.405034065246582  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.445775032043457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([171, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.448564052581787  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.448564052581787  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.448890209197998  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.490312099456787  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([141, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.4927239418029785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.4927239418029785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.492992877960205  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.5290303230285645  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([136, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.531510353088379  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.531510353088379  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.531769752502441  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.568345069885254  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([96, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.57015323638916  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.57015323638916  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.57033634185791  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.59743595123291  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([75, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.598930358886719  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.598930358886719  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.59907341003418  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.621246337890625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.622776031494141  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.622776031494141  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.622913360595703  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.645160675048828  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([82, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.646983623504639  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.646983623504639  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.647140026092529  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.673572063446045  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([1073, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.69946813583374  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.69946813583374  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1073, 256]), torch.Size([1, 1073, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.701578140258789  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.063365936279297  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1073, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.949435234069824  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.952820777893066  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.956830024719238  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.953277111053467  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([22420, 40])
input nodes number: 54894
output nodes number: 22420
edges number: 139591
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.953788757324219  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.953789234161377  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.07116460800170898  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

pseudo mini batch 3 input nodes size: 94667
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06070995330810547  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.06070995330810547  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.1058506965637207  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.10602188110351562  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.059801578521728516  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.066375732421875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.066375732421875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.066375732421875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([94667, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.066375732421875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([3921, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.33270263671875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.33270263671875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3921, 128]), torch.Size([1, 3921, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3364419937133789  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.36685752868652344  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3921, 128])
m.shape torch.Size([4083, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3688817024230957  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3688817024230957  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 4083, 128]), torch.Size([1, 4083, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.3731527328491211  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.43220996856689453  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 4083, 128])
m.shape torch.Size([3771, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.4355955123901367  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.4355955123901367  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3771, 128]), torch.Size([1, 3771, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.4393162727355957  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.519005298614502  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3771, 128])
m.shape torch.Size([3468, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5238218307495117  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5238218307495117  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3468, 128]), torch.Size([1, 3468, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.5271697044372559  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6234931945800781  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3468, 128])
m.shape torch.Size([3273, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6296429634094238  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6296429634094238  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 3273, 128]), torch.Size([1, 3273, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.6328573226928711  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7491655349731445  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 3273, 128])
m.shape torch.Size([2990, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7553563117980957  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7553563117980957  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2990, 128]), torch.Size([1, 2990, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.7584028244018555  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.88262939453125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2990, 128])
m.shape torch.Size([2831, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8911838531494141  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8911838531494141  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2831, 128]), torch.Size([1, 2831, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 0.8939347267150879  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0327467918395996  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2831, 128])
m.shape torch.Size([2620, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.041391372680664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.041391372680664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2620, 128]), torch.Size([1, 2620, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.0439906120300293  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.1913042068481445  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2620, 128])
m.shape torch.Size([2511, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.2000393867492676  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.2000393867492676  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2511, 128]), torch.Size([1, 2511, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.203277587890625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.3619441986083984  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2511, 128])
m.shape torch.Size([40553, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.5541186332702637  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.5541186332702637  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 40553, 128]), torch.Size([1, 40553, 128])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 1.5931811332702637  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.365842342376709  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 40553, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.1203813552856445  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.187158584594727  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.253935813903809  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.186636447906494  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

torch.Size([70021, 256])
first layer input nodes number: 94667
first layer output nodes number: 70021
edges number: 540483
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.254643440246582  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.321420669555664  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.338115215301514  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.338115215301514  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

m.shape torch.Size([2599, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.5940399169921875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.5940399169921875  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2599, 256]), torch.Size([1, 2599, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.599499702453613  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.639157295227051  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2599, 256])
m.shape torch.Size([2233, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.641371726989746  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.641371726989746  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 2233, 256]), torch.Size([1, 2233, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.645979881286621  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.710962295532227  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 2233, 256])
m.shape torch.Size([1755, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.713528156280518  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.713528156280518  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1755, 256]), torch.Size([1, 1755, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.717059135437012  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.791835784912109  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1755, 256])
m.shape torch.Size([1375, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.796344757080078  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.796344757080078  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1375, 256]), torch.Size([1, 1375, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.7991204261779785  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.876604080200195  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1375, 256])
m.shape torch.Size([1232, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.881213665008545  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.881213665008545  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 1232, 256]), torch.Size([1, 1232, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.88363790512085  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.972099781036377  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 1232, 256])
m.shape torch.Size([996, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.976668834686279  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.976668834686279  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 996, 256]), torch.Size([1, 996, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 4.9785685539245605  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.0624918937683105  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 996, 256])
m.shape torch.Size([828, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.067112922668457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.067112922668457  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.068692207336426  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.149483680725098  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([688, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.153984069824219  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.153984069824219  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.155296325683594  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.230720520019531  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([654, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.235721588134766  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.235721588134766  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.236968994140625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.316802978515625  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([604, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.321984767913818  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.321984767913818  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.323136806488037  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.404931545257568  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([543, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.410096645355225  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.410096645355225  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.411132335662842  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.494761943817139  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([501, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.5000224113464355  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.5000224113464355  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.500977993011475  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.583930492401123  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([433, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.588862895965576  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.588862895965576  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.589688777923584  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.665669918060303  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([371, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.6702494621276855  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.6702494621276855  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.670957088470459  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.741698741912842  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([360, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.746535301208496  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.746535301208496  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.747221946716309  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.82126522064209  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([341, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.826166152954102  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.826166152954102  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.826816558837891  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.901491165161133  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([303, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.906116962432861  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.906116962432861  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.9066948890686035  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.97674036026001  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([323, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.982155799865723  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.982155799865723  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 5.982771873474121  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.061013221740723  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([303, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.0662384033203125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.0662384033203125  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.066816329956055  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.144898414611816  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([268, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.149761199951172  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.149761199951172  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.150272369384766  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.223498821258545  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([275, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.228794097900391  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.228794097900391  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.229318618774414  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.308711051940918  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([202, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.31272029876709  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.31272029876709  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.313105583190918  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.372824668884277  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([194, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.376920700073242  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.376920700073242  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.377290725708008  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.437234878540039  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([206, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.441802024841309  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.441802024841309  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.442194938659668  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.508597373962402  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([5360, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.637848854064941  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.637848854064941  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

 h.shape torch.Size([1, 5360, 256]), torch.Size([1, 5360, 256])
----------------------------------------3
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 6.648409843444824  GigaBytes
Max Memory Allocated: 8.514169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 8.447726249694824  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 5360, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 8.2127103805542  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 8.216309547424316  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 8.220505714416504  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 8.216735363006592  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

torch.Size([22947, 40])
input nodes number: 70021
output nodes number: 22947
edges number: 262563
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 8.217642307281494  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9842529296875 GB
    Memory Allocated: 8.217642784118652  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.2362060546875 GB
    Memory Allocated: 0.0771327018737793  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.2362060546875 GB
    Memory Allocated: 0.0771327018737793  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.2362060546875 GB
    Memory Allocated: 0.0771327018737793  GigaBytes
Max Memory Allocated: 8.575518608093262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04117339849472046 |0.004704713821411133 |0.1337248682975769 |0.00010281801223754883 |0.09428054094314575 |0.004862308502197266 |
----------------------------------------------------------pseudo_mini_loss sum 3.567674160003662
Total (block generation + training)time/epoch 22.739506721496582
Training time/epoch 1.1408839225769043
Training time without block to device /epoch 1.1220650672912598
Training time without total dataloading part /epoch 0.9172952175140381
load block tensor time/epoch 0.16469359397888184
block to device time/epoch 0.01881885528564453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  509006
Number of first layer input nodes during this epoch:  306516
Number of first layer output nodes during this epoch:  202490
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
