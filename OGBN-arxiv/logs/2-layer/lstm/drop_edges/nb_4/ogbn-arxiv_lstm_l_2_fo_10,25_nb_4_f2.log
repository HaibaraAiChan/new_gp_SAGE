[04:20:35] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21674458 edges into 4 parts and get 1397918 edge cuts
main start at this time 1651551613.2995417
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03356599807739258
global_2_local spend time (sec) 0.03547310829162598
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0045986175537109375
A = g.adjacency_matrix() spent  0.0077517032623291016
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0908203125
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3088407516479492
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1916017532348633

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11680458, 2.0: 2009204, 3.0: 503973, 4.0: 152362, 5.0: 55000, 6.0: 23754, 7.0: 11121, 8.0: 5689, 9.0: 3141, 10.0: 1718, 11.0: 1012, 12.0: 561, 13.0: 341, 14.0: 224, 15.0: 154, 16.0: 98, 17.0: 78, 18.0: 41, 19.0: 29, 20.0: 8, 21.0: 4})
Convert a graph into a bidirected graph: 0.804 seconds
Metis partitioning: 4.154 seconds
Split the graph: 1.570 seconds
Construct subgraphs: 0.085 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.623664617538452
22786
23144
22504
22507
total k batches seeds list generation spend  19.62120795249939
after graph partition
graph partition algorithm spend time 19.729933977127075
22786
23144
22504
22507
partition_len_list
[34914, 40563, 53028, 69029]
shared_neighbor_graph_partition_s0 selection method  spend 19.816399574279785
time for parepare:  0.018526792526245117
local_output_nid generation:  0.003003835678100586
local_in_edges_tensor generation:  0.0038712024688720703
mini_batch_src_global generation:  0.006649494171142578
r_  generation:  0.06062173843383789
local_output_nid generation:  0.0037457942962646484
local_in_edges_tensor generation:  0.004305124282836914
mini_batch_src_global generation:  0.006262302398681641
r_  generation:  0.05664849281311035
local_output_nid generation:  0.003805398941040039
local_in_edges_tensor generation:  0.0035119056701660156
mini_batch_src_global generation:  0.005756855010986328
r_  generation:  0.054436683654785156
local_output_nid generation:  0.003659963607788086
local_in_edges_tensor generation:  0.006206035614013672
mini_batch_src_global generation:  0.014102458953857422
r_  generation:  0.09082484245300293
----------------------check_connections_block total spend ----------------------------- 0.42182302474975586
generate_one_block  0.07573485374450684
generate_one_block  0.07179117202758789
generate_one_block  0.07106971740722656
generate_one_block  0.12295794486999512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07733917236328125
gen group dst list time:  0.0053424835205078125
time for parepare:  0.02191615104675293
local_output_nid generation:  0.005228757858276367
local_in_edges_tensor generation:  0.01826620101928711
mini_batch_src_global generation:  0.00635838508605957
r_  generation:  0.07399654388427734
local_output_nid generation:  0.008413076400756836
local_in_edges_tensor generation:  0.00820159912109375
mini_batch_src_global generation:  0.011772394180297852
r_  generation:  0.08557677268981934
local_output_nid generation:  0.0108795166015625
local_in_edges_tensor generation:  0.013823747634887695
mini_batch_src_global generation:  0.013826608657836914
r_  generation:  0.1289818286895752
local_output_nid generation:  0.011183500289916992
local_in_edges_tensor generation:  0.01717996597290039
mini_batch_src_global generation:  0.024989843368530273
r_  generation:  0.18966102600097656
----------------------check_connections_block total spend ----------------------------- 0.7658970355987549
generate_one_block  0.0900115966796875
generate_one_block  0.10552072525024414
generate_one_block  0.15308570861816406
generate_one_block  0.2569546699523926
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.7658970355987549
block generation total time  0.6055727005004883
average batch blocks generation time:  0.15139317512512207
pseudo mini batch 0 input nodes size: 49081
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.026215076446533203  GigaBytes
Max Memory Allocated: 0.026215076446533203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.02638530731201172  GigaBytes
Max Memory Allocated: 0.02638530731201172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.02638530731201172  GigaBytes
Max Memory Allocated: 0.02638530731201172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.02927684783935547  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.02927684783935547  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.02927684783935547  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

torch.Size([49081, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.02927684783935547  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

m.shape torch.Size([4009, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.1336526870727539  GigaBytes
Max Memory Allocated: 0.1346874237060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.1336526870727539  GigaBytes
Max Memory Allocated: 0.1346874237060547  GigaBytes

 h.shape torch.Size([1, 4009, 128]), torch.Size([1, 4009, 128])
----------------------------------------3
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.13747596740722656  GigaBytes
Max Memory Allocated: 0.13747596740722656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.16889190673828125  GigaBytes
Max Memory Allocated: 0.17080354690551758  GigaBytes

rst.shape  torch.Size([1, 4009, 128])
m.shape torch.Size([4002, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.17080354690551758  GigaBytes
Max Memory Allocated: 0.17089366912841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.17080354690551758  GigaBytes
Max Memory Allocated: 0.17089366912841797  GigaBytes

 h.shape torch.Size([1, 4002, 128]), torch.Size([1, 4002, 128])
----------------------------------------3
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.1746201515197754  GigaBytes
Max Memory Allocated: 0.1746201515197754  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.2332139015197754  GigaBytes
Max Memory Allocated: 0.2370305061340332  GigaBytes

rst.shape  torch.Size([1, 4002, 128])
m.shape torch.Size([3525, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.2370305061340332  GigaBytes
Max Memory Allocated: 0.23714923858642578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.2370305061340332  GigaBytes
Max Memory Allocated: 0.23714923858642578  GigaBytes

 h.shape torch.Size([1, 3525, 128]), torch.Size([1, 3525, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.24039220809936523  GigaBytes
Max Memory Allocated: 0.24039220809936523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.3144817352294922  GigaBytes
Max Memory Allocated: 0.31952428817749023  GigaBytes

rst.shape  torch.Size([1, 3525, 128])
m.shape torch.Size([2956, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.31888532638549805  GigaBytes
Max Memory Allocated: 0.31952428817749023  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.31888532638549805  GigaBytes
Max Memory Allocated: 0.31952428817749023  GigaBytes

 h.shape torch.Size([1, 2956, 128]), torch.Size([1, 2956, 128])
----------------------------------------3
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.3217043876647949  GigaBytes
Max Memory Allocated: 0.3217043876647949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.40363216400146484  GigaBytes
Max Memory Allocated: 0.4092702865600586  GigaBytes

rst.shape  torch.Size([1, 2956, 128])
m.shape torch.Size([2507, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.4081997871398926  GigaBytes
Max Memory Allocated: 0.4092702865600586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.4081997871398926  GigaBytes
Max Memory Allocated: 0.4092702865600586  GigaBytes

 h.shape torch.Size([1, 2507, 128]), torch.Size([1, 2507, 128])
----------------------------------------3
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.4106144905090332  GigaBytes
Max Memory Allocated: 0.4106144905090332  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.49804019927978516  GigaBytes
Max Memory Allocated: 0.5040173530578613  GigaBytes

rst.shape  torch.Size([1, 2507, 128])
m.shape torch.Size([2166, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5030417442321777  GigaBytes
Max Memory Allocated: 0.5040173530578613  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5030417442321777  GigaBytes
Max Memory Allocated: 0.5040173530578613  GigaBytes

 h.shape torch.Size([1, 2166, 128]), torch.Size([1, 2166, 128])
----------------------------------------3
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5051541328430176  GigaBytes
Max Memory Allocated: 0.5051541328430176  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.598517894744873  GigaBytes
Max Memory Allocated: 0.6047148704528809  GigaBytes

rst.shape  torch.Size([1, 2166, 128])
m.shape torch.Size([1819, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6035566329956055  GigaBytes
Max Memory Allocated: 0.6047148704528809  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6035566329956055  GigaBytes
Max Memory Allocated: 0.6047148704528809  GigaBytes

 h.shape torch.Size([1, 1819, 128]), torch.Size([1, 1819, 128])
----------------------------------------3
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6052913665771484  GigaBytes
Max Memory Allocated: 0.6052913665771484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9022216796875 GB
    Memory Allocated: 0.6920280456542969  GigaBytes
Max Memory Allocated: 0.6980996131896973  GigaBytes

rst.shape  torch.Size([1, 1819, 128])
m.shape torch.Size([1585, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9022216796875 GB
    Memory Allocated: 0.697206974029541  GigaBytes
Max Memory Allocated: 0.6980996131896973  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9022216796875 GB
    Memory Allocated: 0.697206974029541  GigaBytes
Max Memory Allocated: 0.6980996131896973  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 1.9022216796875 GB
    Memory Allocated: 0.6987185478210449  GigaBytes
Max Memory Allocated: 0.6987185478210449  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.7849597930908203  GigaBytes
Max Memory Allocated: 0.7910060882568359  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([1351, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.7900018692016602  GigaBytes
Max Memory Allocated: 0.7910060882568359  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.7900018692016602  GigaBytes
Max Memory Allocated: 0.7910060882568359  GigaBytes

 h.shape torch.Size([1, 1351, 128]), torch.Size([1, 1351, 128])
----------------------------------------3
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.791290283203125  GigaBytes
Max Memory Allocated: 0.791290283203125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.873748779296875  GigaBytes
Max Memory Allocated: 0.8795466423034668  GigaBytes

rst.shape  torch.Size([1, 1351, 128])
m.shape torch.Size([10994, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.9258389472961426  GigaBytes
Max Memory Allocated: 0.927067756652832  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.9258389472961426  GigaBytes
Max Memory Allocated: 0.927067756652832  GigaBytes

 h.shape torch.Size([1, 10994, 128]), torch.Size([1, 10994, 128])
----------------------------------------3
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.9363236427307129  GigaBytes
Max Memory Allocated: 0.9363236427307129  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.6961865425109863  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

rst.shape  torch.Size([1, 10994, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.606910228729248  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.6402068138122559  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6735033988952637  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.639946460723877  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

torch.Size([34914, 256])
first layer input nodes number: 49081
first layer output nodes number: 34914
edges number: 207455
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6738710403442383  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.707167625427246  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0682373046875 GB
    Memory Allocated: 1.715491771697998  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0682373046875 GB
    Memory Allocated: 1.715491771697998  GigaBytes
Max Memory Allocated: 1.7489209175109863  GigaBytes

m.shape torch.Size([3078, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.8936991691589355  GigaBytes
Max Memory Allocated: 1.8937110900878906  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.8936991691589355  GigaBytes
Max Memory Allocated: 1.8937110900878906  GigaBytes

 h.shape torch.Size([1, 3078, 256]), torch.Size([1, 3078, 256])
----------------------------------------3
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.9013075828552246  GigaBytes
Max Memory Allocated: 1.9013075828552246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.950880527496338  GigaBytes
Max Memory Allocated: 1.9546847343444824  GigaBytes

rst.shape  torch.Size([1, 3078, 256])
m.shape torch.Size([2811, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.9530830383300781  GigaBytes
Max Memory Allocated: 1.9546847343444824  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.9530830383300781  GigaBytes
Max Memory Allocated: 1.9546847343444824  GigaBytes

 h.shape torch.Size([1, 2811, 256]), torch.Size([1, 2811, 256])
----------------------------------------3
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.9585533142089844  GigaBytes
Max Memory Allocated: 1.9585533142089844  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 2.0389766693115234  GigaBytes
Max Memory Allocated: 2.0443382263183594  GigaBytes

rst.shape  torch.Size([1, 2811, 256])
m.shape torch.Size([2383, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 2.0431671142578125  GigaBytes
Max Memory Allocated: 2.0443382263183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 2.0431671142578125  GigaBytes
Max Memory Allocated: 2.0443382263183594  GigaBytes

 h.shape torch.Size([1, 2383, 256]), torch.Size([1, 2383, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 2.0481743812561035  GigaBytes
Max Memory Allocated: 2.0481743812561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 2.148703098297119  GigaBytes
Max Memory Allocated: 2.1555209159851074  GigaBytes

rst.shape  torch.Size([1, 2383, 256])
m.shape torch.Size([1893, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 2.1537084579467773  GigaBytes
Max Memory Allocated: 2.1555209159851074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 2.1537084579467773  GigaBytes
Max Memory Allocated: 2.1555209159851074  GigaBytes

 h.shape torch.Size([1, 1893, 256]), torch.Size([1, 1893, 256])
----------------------------------------3
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 2.1574277877807617  GigaBytes
Max Memory Allocated: 2.1574277877807617  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 2.2637948989868164  GigaBytes
Max Memory Allocated: 2.2710161209106445  GigaBytes

rst.shape  torch.Size([1, 1893, 256])
m.shape torch.Size([1575, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 2.269558906555176  GigaBytes
Max Memory Allocated: 2.2710161209106445  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 2.269558906555176  GigaBytes
Max Memory Allocated: 2.2710161209106445  GigaBytes

 h.shape torch.Size([1, 1575, 256]), torch.Size([1, 1575, 256])
----------------------------------------3
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 2.2728638648986816  GigaBytes
Max Memory Allocated: 2.2728638648986816  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6287841796875 GB
    Memory Allocated: 2.382354736328125  GigaBytes
Max Memory Allocated: 2.389864921569824  GigaBytes

rst.shape  torch.Size([1, 1575, 256])
m.shape torch.Size([1346, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6287841796875 GB
    Memory Allocated: 2.388615131378174  GigaBytes
Max Memory Allocated: 2.389864921569824  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6287841796875 GB
    Memory Allocated: 2.388615131378174  GigaBytes
Max Memory Allocated: 2.389864921569824  GigaBytes

 h.shape torch.Size([1, 1346, 256]), torch.Size([1, 1346, 256])
----------------------------------------3
 Nvidia-smi: 3.6287841796875 GB
    Memory Allocated: 2.3913159370422363  GigaBytes
Max Memory Allocated: 2.3913159370422363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.504342555999756  GigaBytes
Max Memory Allocated: 2.5120444297790527  GigaBytes

rst.shape  torch.Size([1, 1346, 256])
m.shape torch.Size([1102, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.5101966857910156  GigaBytes
Max Memory Allocated: 2.5120444297790527  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.5101966857910156  GigaBytes
Max Memory Allocated: 2.5120444297790527  GigaBytes

 h.shape torch.Size([1, 1102, 256]), torch.Size([1, 1102, 256])
----------------------------------------3
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.512423515319824  GigaBytes
Max Memory Allocated: 2.512423515319824  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.623669147491455  GigaBytes
Max Memory Allocated: 2.631025791168213  GigaBytes

rst.shape  torch.Size([1, 1102, 256])
m.shape torch.Size([949, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.629915237426758  GigaBytes
Max Memory Allocated: 2.631025791168213  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.629915237426758  GigaBytes
Max Memory Allocated: 2.631025791168213  GigaBytes

 h.shape torch.Size([1, 949, 256]), torch.Size([1, 949, 256])
----------------------------------------3
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.631725311279297  GigaBytes
Max Memory Allocated: 2.631725311279297  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9588623046875 GB
    Memory Allocated: 2.736421585083008  GigaBytes
Max Memory Allocated: 2.743661880493164  GigaBytes

rst.shape  torch.Size([1, 949, 256])
m.shape torch.Size([845, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9588623046875 GB
    Memory Allocated: 2.742825984954834  GigaBytes
Max Memory Allocated: 2.743661880493164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9588623046875 GB
    Memory Allocated: 2.742825984954834  GigaBytes
Max Memory Allocated: 2.743661880493164  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 3.9588623046875 GB
    Memory Allocated: 2.7444376945495605  GigaBytes
Max Memory Allocated: 2.7444376945495605  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.848426342010498  GigaBytes
Max Memory Allocated: 2.8556790351867676  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([737, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8547043800354004  GigaBytes
Max Memory Allocated: 2.8556790351867676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8547043800354004  GigaBytes
Max Memory Allocated: 2.8556790351867676  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.856110095977783  GigaBytes
Max Memory Allocated: 2.856110095977783  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1971435546875 GB
    Memory Allocated: 2.956760883331299  GigaBytes
Max Memory Allocated: 2.963789463043213  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([653, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.1971435546875 GB
    Memory Allocated: 2.9629621505737305  GigaBytes
Max Memory Allocated: 2.963789463043213  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1971435546875 GB
    Memory Allocated: 2.9629621505737305  GigaBytes
Max Memory Allocated: 2.963789463043213  GigaBytes

 h.shape torch.Size([1, 653, 256]), torch.Size([1, 653, 256])
----------------------------------------3
 Nvidia-smi: 4.1971435546875 GB
    Memory Allocated: 2.964207649230957  GigaBytes
Max Memory Allocated: 2.964207649230957  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3084716796875 GB
    Memory Allocated: 3.0620431900024414  GigaBytes
Max Memory Allocated: 3.0688934326171875  GigaBytes

rst.shape  torch.Size([1, 653, 256])
m.shape torch.Size([545, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3084716796875 GB
    Memory Allocated: 3.06770658493042  GigaBytes
Max Memory Allocated: 3.0688934326171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3084716796875 GB
    Memory Allocated: 3.06770658493042  GigaBytes
Max Memory Allocated: 3.0688934326171875  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 4.3084716796875 GB
    Memory Allocated: 3.0687460899353027  GigaBytes
Max Memory Allocated: 3.0688934326171875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.15962553024292  GigaBytes
Max Memory Allocated: 3.165862560272217  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([459, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.1648411750793457  GigaBytes
Max Memory Allocated: 3.165862560272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.1648411750793457  GigaBytes
Max Memory Allocated: 3.165862560272217  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 4.3983154296875 GB
    Memory Allocated: 3.1657166481018066  GigaBytes
Max Memory Allocated: 3.165862560272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.247145175933838  GigaBytes
Max Memory Allocated: 3.252835750579834  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([412, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.252251625061035  GigaBytes
Max Memory Allocated: 3.252835750579834  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.252251625061035  GigaBytes
Max Memory Allocated: 3.252835750579834  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.253037452697754  GigaBytes
Max Memory Allocated: 3.253037452697754  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5565185546875 GB
    Memory Allocated: 3.333242416381836  GigaBytes
Max Memory Allocated: 3.338743209838867  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([350, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5565185546875 GB
    Memory Allocated: 3.3378958702087402  GigaBytes
Max Memory Allocated: 3.338743209838867  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5565185546875 GB
    Memory Allocated: 3.3378958702087402  GigaBytes
Max Memory Allocated: 3.338743209838867  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 4.5565185546875 GB
    Memory Allocated: 3.3385634422302246  GigaBytes
Max Memory Allocated: 3.338743209838867  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 3.4118494987487793  GigaBytes
Max Memory Allocated: 3.416856288909912  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([305, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 3.4162063598632812  GigaBytes
Max Memory Allocated: 3.416856288909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 3.4162063598632812  GigaBytes
Max Memory Allocated: 3.416856288909912  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 3.416788101196289  GigaBytes
Max Memory Allocated: 3.416856288909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6912841796875 GB
    Memory Allocated: 3.484355926513672  GigaBytes
Max Memory Allocated: 3.4890098571777344  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([312, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6912841796875 GB
    Memory Allocated: 3.4891629219055176  GigaBytes
Max Memory Allocated: 3.489182949066162  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6912841796875 GB
    Memory Allocated: 3.4891629219055176  GigaBytes
Max Memory Allocated: 3.489182949066162  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.6932373046875 GB
    Memory Allocated: 3.489758014678955  GigaBytes
Max Memory Allocated: 3.489758014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.5631184577941895  GigaBytes
Max Memory Allocated: 3.568176746368408  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([245, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.5670595169067383  GigaBytes
Max Memory Allocated: 3.568176746368408  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.5670595169067383  GigaBytes
Max Memory Allocated: 3.568176746368408  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.5675268173217773  GigaBytes
Max Memory Allocated: 3.568176746368408  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8436279296875 GB
    Memory Allocated: 3.6268739700317383  GigaBytes
Max Memory Allocated: 3.63107967376709  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([206, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8436279296875 GB
    Memory Allocated: 3.6304025650024414  GigaBytes
Max Memory Allocated: 3.63107967376709  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8436279296875 GB
    Memory Allocated: 3.6304025650024414  GigaBytes
Max Memory Allocated: 3.63107967376709  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.8436279296875 GB
    Memory Allocated: 3.630795478820801  GigaBytes
Max Memory Allocated: 3.63107967376709  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.683445930480957  GigaBytes
Max Memory Allocated: 3.687178611755371  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([234, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.6877479553222656  GigaBytes
Max Memory Allocated: 3.687765598297119  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.6877479553222656  GigaBytes
Max Memory Allocated: 3.687765598297119  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.8983154296875 GB
    Memory Allocated: 3.6881942749023438  GigaBytes
Max Memory Allocated: 3.6881942749023438  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9666748046875 GB
    Memory Allocated: 3.7511253356933594  GigaBytes
Max Memory Allocated: 3.7558746337890625  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([208, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9666748046875 GB
    Memory Allocated: 3.7556843757629395  GigaBytes
Max Memory Allocated: 3.7558746337890625  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9666748046875 GB
    Memory Allocated: 3.7556843757629395  GigaBytes
Max Memory Allocated: 3.7558746337890625  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.9686279296875 GB
    Memory Allocated: 3.7560811042785645  GigaBytes
Max Memory Allocated: 3.7560811042785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0506591796875 GB
    Memory Allocated: 3.8147969245910645  GigaBytes
Max Memory Allocated: 3.818962574005127  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([141, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0506591796875 GB
    Memory Allocated: 3.817580223083496  GigaBytes
Max Memory Allocated: 3.818962574005127  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0506591796875 GB
    Memory Allocated: 3.817580223083496  GigaBytes
Max Memory Allocated: 3.818962574005127  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.0506591796875 GB
    Memory Allocated: 3.8178491592407227  GigaBytes
Max Memory Allocated: 3.818962574005127  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.85953426361084  GigaBytes
Max Memory Allocated: 3.862492561340332  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([144, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.8625831604003906  GigaBytes
Max Memory Allocated: 3.862595558166504  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.8625831604003906  GigaBytes
Max Memory Allocated: 3.862595558166504  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.8628578186035156  GigaBytes
Max Memory Allocated: 3.8628578186035156  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 3.9073524475097656  GigaBytes
Max Memory Allocated: 3.910511016845703  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([129, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 3.910191059112549  GigaBytes
Max Memory Allocated: 3.910511016845703  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 3.910191059112549  GigaBytes
Max Memory Allocated: 3.910511016845703  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 3.9104371070861816  GigaBytes
Max Memory Allocated: 3.910511016845703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1854248046875 GB
    Memory Allocated: 3.952019214630127  GigaBytes
Max Memory Allocated: 3.9549717903137207  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([1724, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2283935546875 GB
    Memory Allocated: 3.993320941925049  GigaBytes
Max Memory Allocated: 3.9934816360473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2283935546875 GB
    Memory Allocated: 3.993320941925049  GigaBytes
Max Memory Allocated: 3.9934816360473633  GigaBytes

 h.shape torch.Size([1, 1724, 256]), torch.Size([1, 1724, 256])
----------------------------------------3
 Nvidia-smi: 5.2283935546875 GB
    Memory Allocated: 3.996830463409424  GigaBytes
Max Memory Allocated: 3.996830463409424  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9940185546875 GB
    Memory Allocated: 4.5763840675354  GigaBytes
Max Memory Allocated: 4.61748743057251  GigaBytes

rst.shape  torch.Size([1, 1724, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0408935546875 GB
    Memory Allocated: 4.423058032989502  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0408935546875 GB
    Memory Allocated: 4.426453590393066  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0408935546875 GB
    Memory Allocated: 4.429849147796631  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0408935546875 GB
    Memory Allocated: 4.426283359527588  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

torch.Size([22786, 40])
input nodes number: 34914
output nodes number: 22786
edges number: 180527
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0408935546875 GB
    Memory Allocated: 4.43010950088501  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0408935546875 GB
    Memory Allocated: 4.430110454559326  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.041088104248046875  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

pseudo mini batch 1 input nodes size: 62453
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.032557010650634766  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.032557010650634766  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.06233692169189453  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.06250953674316406  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.03890180587768555  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.04177427291870117  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.04177427291870117  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.04177427291870117  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

torch.Size([62453, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.04177427291870117  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

m.shape torch.Size([5053, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.15647602081298828  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.15647602081298828  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 5053, 128]), torch.Size([1, 5053, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.16185235977172852  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.2007441520690918  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 5053, 128])
m.shape torch.Size([5155, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.20325088500976562  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.20325088500976562  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 5155, 128]), torch.Size([1, 5155, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.20816707611083984  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.2819099426269531  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 5155, 128])
m.shape torch.Size([4487, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.28669261932373047  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.28669261932373047  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 4487, 128]), torch.Size([1, 4487, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.29134178161621094  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.38735151290893555  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 4487, 128])
m.shape torch.Size([3649, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.39166831970214844  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.39166831970214844  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 3649, 128]), torch.Size([1, 3649, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.3958301544189453  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.49945068359375  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 3649, 128])
m.shape torch.Size([3069, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.504636287689209  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.504636287689209  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 3069, 128]), torch.Size([1, 3069, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.5082311630249023  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.6179981231689453  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 3069, 128])
m.shape torch.Size([2458, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.6243586540222168  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.6243586540222168  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2458, 128]), torch.Size([1, 2458, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.6268692016601562  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.7326750755310059  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2458, 128])
m.shape torch.Size([2134, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.7386260032653809  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.7386260032653809  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.7409071922302246  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.8438754081726074  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([1865, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.8499722480773926  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.8499722480773926  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1865, 128]), torch.Size([1, 1865, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.8517508506774902  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.953850269317627  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1865, 128])
m.shape torch.Size([1566, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.959681510925293  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.959681510925293  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1566, 128]), torch.Size([1, 1566, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 0.9611749649047852  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.0567560195922852  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1566, 128])
m.shape torch.Size([11127, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.1090669631958008  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.1090669631958008  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 11127, 128]), torch.Size([1, 11127, 128])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.1196784973144531  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.880936622619629  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 11127, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.7853217124938965  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.8240056037902832  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.86268949508667  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.8237032890319824  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

torch.Size([40563, 256])
first layer input nodes number: 62453
first layer output nodes number: 40563
edges number: 228735
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.863156795501709  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.9018406867980957  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.9115118980407715  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 1.9115118980407715  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

m.shape torch.Size([3646, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.0666685104370117  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.0666685104370117  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 3646, 256]), torch.Size([1, 3646, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.0738964080810547  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.1319727897644043  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 3646, 256])
m.shape torch.Size([3280, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.133993148803711  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.133993148803711  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 3280, 256]), torch.Size([1, 3280, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.140735149383545  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.236865520477295  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 3280, 256])
m.shape torch.Size([2628, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.2413153648376465  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.2413153648376465  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2628, 256]), torch.Size([1, 2628, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.2469496726989746  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.357224941253662  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2628, 256])
m.shape torch.Size([2130, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.362907886505127  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.362907886505127  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2130, 256]), torch.Size([1, 2130, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.3671836853027344  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.487053394317627  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2130, 256])
m.shape torch.Size([1748, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.493422508239746  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.493422508239746  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1748, 256]), torch.Size([1, 1748, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.4969077110290527  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.6188273429870605  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1748, 256])
m.shape torch.Size([1358, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.6249918937683105  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.6249918937683105  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1358, 256]), torch.Size([1, 1358, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.627753734588623  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.741945266723633  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1358, 256])
m.shape torch.Size([1183, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.748291015625  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.748291015625  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1183, 256]), torch.Size([1, 1183, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.750619888305664  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.868016242980957  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1183, 256])
m.shape torch.Size([983, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.874446392059326  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.874446392059326  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.876321315765381  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.987342357635498  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([791, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.9932475090026855  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.9932475090026855  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 2.9947562217712402  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.0919861793518066  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([689, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.0978541374206543  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.0978541374206543  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 689, 256]), torch.Size([1, 689, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.099168300628662  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.192473888397217  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 689, 256])
m.shape torch.Size([554, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.19767427444458  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.19767427444458  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.198730945587158  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.2830185890197754  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([476, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.287980556488037  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.287980556488037  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.288888454437256  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.3662428855895996  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([408, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.37088680267334  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.37088680267334  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.3716650009155273  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.4449682235717773  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([356, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.4501399993896484  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.4501399993896484  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.4508190155029297  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.5194759368896484  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([325, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.52382230758667  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.52382230758667  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.524442195892334  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.5924363136291504  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([253, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.596017360687256  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.596017360687256  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.5964999198913574  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.651029109954834  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([225, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.6544642448425293  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.6544642448425293  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.654893398284912  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.7063918113708496  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([205, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.709723949432373  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.709723949432373  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.7101149559020996  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.759772777557373  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([185, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.762955665588379  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.762955665588379  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.763308525085449  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.810591697692871  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([160, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.813490867614746  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.813490867614746  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.813796043395996  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.856825828552246  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([132, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.85933780670166  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.85933780670166  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.8595895767211914  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.8968515396118164  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([122, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9000625610351562  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9000625610351562  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9002952575683594  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9363632202148438  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([104, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9385461807250977  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9385461807250977  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.93874454498291  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.970879554748535  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([95, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9729719161987305  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9729719161987305  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 3.9731531143188477  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.003775596618652  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([1108, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.030308246612549  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.030308246612549  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1108, 256]), torch.Size([1, 1108, 256])
----------------------------------------3
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.0324907302856445  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.415485382080078  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1108, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.283431053161621  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.287322044372559  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.290771007537842  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.286707401275635  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

torch.Size([23144, 40])
input nodes number: 40563
output nodes number: 23144
edges number: 156727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.287677764892578  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.3963623046875 GB
    Memory Allocated: 4.287678241729736  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.04794168472290039  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

pseudo mini batch 2 input nodes size: 93848
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.039397239685058594  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.039397239685058594  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.08414745330810547  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.08431529998779297  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.05436277389526367  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.05793619155883789  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.05793619155883789  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.05793619155883789  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

torch.Size([93848, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.5467529296875 GB
    Memory Allocated: 0.05793619155883789  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

m.shape torch.Size([5704, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.22357416152954102  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.22357416152954102  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 5704, 128]), torch.Size([1, 5704, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.22901391983032227  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.27421045303344727  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 5704, 128])
m.shape torch.Size([5756, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.276979923248291  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.276979923248291  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 5756, 128]), torch.Size([1, 5756, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.28328371047973633  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.36594247817993164  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 5756, 128])
m.shape torch.Size([4821, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.37009429931640625  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.37009429931640625  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 4821, 128]), torch.Size([1, 4821, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.37555885314941406  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.47747182846069336  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 4821, 128])
m.shape torch.Size([4079, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.48372554779052734  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.48372554779052734  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 4079, 128]), torch.Size([1, 4079, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.4877777099609375  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.6012668609619141  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 4079, 128])
m.shape torch.Size([3561, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.6077308654785156  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.6077308654785156  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 3561, 128]), torch.Size([1, 3561, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.6117830276489258  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.7369656562805176  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 3561, 128])
m.shape torch.Size([2879, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.743504524230957  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.743504524230957  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2879, 128]), torch.Size([1, 2879, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.7468166351318359  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.8690423965454102  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2879, 128])
m.shape torch.Size([2468, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.8759074211120605  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.8759074211120605  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2468, 128]), torch.Size([1, 2468, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 0.8782958984375  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.0010886192321777  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2468, 128])
m.shape torch.Size([2221, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.0076823234558105  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.0076823234558105  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2221, 128]), torch.Size([1, 2221, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.0099635124206543  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.1341357231140137  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2221, 128])
m.shape torch.Size([1858, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.1410503387451172  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.1410503387451172  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1858, 128]), torch.Size([1, 1858, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.142822265625  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.2562255859375  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1858, 128])
m.shape torch.Size([19681, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.3491859436035156  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.3491859436035156  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 19681, 128]), torch.Size([1, 19681, 128])
----------------------------------------3
 Nvidia-smi: 6.5487060546875 GB
    Memory Allocated: 1.367955207824707  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.70919132232666  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 19681, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.5648813247680664  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.615452766418457  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.6660242080688477  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.6150574684143066  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

torch.Size([53028, 256])
first layer input nodes number: 93848
first layer output nodes number: 53028
edges number: 331650
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.6667256355285645  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.717297077178955  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.7299399375915527  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2303466796875 GB
    Memory Allocated: 2.7299399375915527  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

m.shape torch.Size([4138, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 2.876763343811035  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 2.876763343811035  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 4138, 256]), torch.Size([1, 4138, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 2.8846559524536133  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 2.9477968215942383  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 4138, 256])
m.shape torch.Size([3417, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 2.9507899284362793  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 2.9507899284362793  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 3417, 256]), torch.Size([1, 3417, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 2.9578146934509277  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.0572381019592285  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 3417, 256])
m.shape torch.Size([2567, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.0613813400268555  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.0613813400268555  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 2567, 256]), torch.Size([1, 2567, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.066654682159424  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.176517963409424  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 2567, 256])
m.shape torch.Size([1978, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.1816744804382324  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.1816744804382324  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1978, 256]), torch.Size([1, 1978, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.1855974197387695  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.298384189605713  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1978, 256])
m.shape torch.Size([1701, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.304259777069092  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.304259777069092  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1701, 256]), torch.Size([1, 1701, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.307633399963379  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.4283013343811035  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1701, 256])
m.shape torch.Size([1235, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.4338011741638184  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.4338011741638184  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 1235, 256]), torch.Size([1, 1235, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.4367690086364746  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.5453925132751465  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 1235, 256])
m.shape torch.Size([970, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.5503950119018555  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.5503950119018555  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.5522451400756836  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.6471757888793945  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 970, 256])
m.shape torch.Size([887, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.6530709266662598  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.6530709266662598  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 887, 256]), torch.Size([1, 887, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.6547627449035645  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.7511963844299316  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 887, 256])
m.shape torch.Size([677, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.75620698928833  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.75620698928833  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.757498264312744  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.840261936187744  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 677, 256])
m.shape torch.Size([576, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.8451523780822754  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.8451523780822754  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.8462510108947754  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.9247231483459473  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([482, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.929269790649414  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.929269790649414  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 3.9301891326904297  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.002382278442383  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([409, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.0066399574279785  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.0066399574279785  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.007420063018799  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.075488567352295  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([359, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.079584121704102  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.079584121704102  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.080268859863281  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.145125389099121  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([299, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.148806571960449  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.148806571960449  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.14937686920166  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.207653999328613  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([252, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.211002349853516  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.211002349853516  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.211483001708984  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.262432098388672  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([215, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.265498161315918  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.265498161315918  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.265908241271973  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.312247276306152  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([191, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.3151631355285645  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.3151631355285645  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.315527439117432  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.359243869781494  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([177, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.362123966217041  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.362123966217041  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.362461566925049  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.405336856842041  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([151, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.407925605773926  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.407925605773926  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.4082136154174805  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.446806907653809  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([139, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.449389457702637  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.449389457702637  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.449654579162598  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.48703670501709  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([113, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.489185333251953  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.489185333251953  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.489400863647461  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.521299362182617  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([90, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.523094654083252  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.523094654083252  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.523266315460205  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.5498738288879395  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.5514020919799805  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.5514020919799805  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.551541328430176  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.574097633361816  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([103, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.576404094696045  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.576404094696045  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.576600551605225  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.609801769256592  GigaBytes
Max Memory Allocated: 4.639801979064941  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([1305, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.6410603523254395  GigaBytes
Max Memory Allocated: 4.641181945800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.6410603523254395  GigaBytes
Max Memory Allocated: 4.641181945800781  GigaBytes

 h.shape torch.Size([1, 1305, 256]), torch.Size([1, 1305, 256])
----------------------------------------3
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.64354944229126  GigaBytes
Max Memory Allocated: 4.64354944229126  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 5.097279071807861  GigaBytes
Max Memory Allocated: 5.128392696380615  GigaBytes

rst.shape  torch.Size([1, 1305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.9738688468933105  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.9778151512146  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.981168746948242  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.977054595947266  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

torch.Size([22504, 40])
input nodes number: 53028
output nodes number: 22504
edges number: 147733
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.977673053741455  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 4.977673530578613  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.0648040771484375  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

pseudo mini batch 3 input nodes size: 93920
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.054418087005615234  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.054418087005615234  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.09920263290405273  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.09937047958374023  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.05445241928100586  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.06035280227661133  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.06035280227661133  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.06035280227661133  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

torch.Size([93920, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.06035280227661133  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

m.shape torch.Size([3912, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.32277441024780273  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.32277441024780273  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 3912, 128]), torch.Size([1, 3912, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.3266177177429199  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.3575167655944824  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 3912, 128])
m.shape torch.Size([4141, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.3596005439758301  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.3596005439758301  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 4141, 128]), torch.Size([1, 4141, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.3639669418334961  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.4232044219970703  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 4141, 128])
m.shape torch.Size([3728, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.4271535873413086  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.4271535873413086  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 3728, 128]), torch.Size([1, 3728, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.43079662322998047  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.5091924667358398  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 3728, 128])
m.shape torch.Size([3362, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.5138273239135742  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.5138273239135742  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 3362, 128]), torch.Size([1, 3362, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.5173368453979492  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.6126160621643066  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 3362, 128])
m.shape torch.Size([3157, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.6185398101806641  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.6185398101806641  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 3157, 128]), torch.Size([1, 3157, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.6216483116149902  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.7300353050231934  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 3157, 128])
m.shape torch.Size([2870, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.7375621795654297  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.7375621795654297  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 2870, 128]), torch.Size([1, 2870, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.7404956817626953  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.8603043556213379  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 2870, 128])
m.shape torch.Size([2771, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.8681850433349609  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.8681850433349609  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 2771, 128]), torch.Size([1, 2771, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.8708748817443848  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.003939151763916  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 2771, 128])
m.shape torch.Size([2587, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.012486457824707  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.012486457824707  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 2587, 128]), torch.Size([1, 2587, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.01495361328125  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.155907154083252  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 2587, 128])
m.shape torch.Size([2451, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.1651921272277832  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.1651921272277832  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 2451, 128]), torch.Size([1, 2451, 128])
----------------------------------------3
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.1675992012023926  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 1.3229832649230957  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 2451, 128])
m.shape torch.Size([40050, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 1.5132207870483398  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 1.5132207870483398  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 40050, 128]), torch.Size([1, 40050, 128])
----------------------------------------3
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 1.5522832870483398  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.273432731628418  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 40050, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.030282974243164  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.096471786499023  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.162660598754883  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.095957279205322  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

torch.Size([69029, 256])
first layer input nodes number: 93920
first layer output nodes number: 69029
edges number: 532483
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.163362503051758  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.229551315307617  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.245651721954346  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.245651721954346  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

m.shape torch.Size([2566, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.4987897872924805  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.4987897872924805  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 2566, 256]), torch.Size([1, 2566, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.503684043884277  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.542838096618652  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 2566, 256])
m.shape torch.Size([2198, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.5446319580078125  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.5446319580078125  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 2198, 256]), torch.Size([1, 2198, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.549264430999756  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.613831996917725  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 2198, 256])
m.shape torch.Size([1699, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.616634845733643  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.616634845733643  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 1699, 256]), torch.Size([1, 1699, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.620106220245361  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.692585468292236  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 1699, 256])
m.shape torch.Size([1319, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.695920944213867  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.695920944213867  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 1319, 256]), torch.Size([1, 1319, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.6986002922058105  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.774909973144531  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 1319, 256])
m.shape torch.Size([1198, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.778931617736816  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.778931617736816  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 1198, 256]), torch.Size([1, 1198, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.781344890594482  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.868988513946533  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 1198, 256])
m.shape torch.Size([929, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.872568607330322  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.872568607330322  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 929, 256]), torch.Size([1, 929, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.874340534210205  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.954777240753174  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 929, 256])
m.shape torch.Size([790, 7, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.959206581115723  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.959206581115723  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 4.9607133865356445  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.036053657531738  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([653, 8, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.040321350097656  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.040321350097656  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 653, 256]), torch.Size([1, 653, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.041566848754883  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.112560272216797  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

rst.shape  torch.Size([1, 653, 256])
m.shape torch.Size([663, 9, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.117672920227051  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.117672920227051  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

 h.shape torch.Size([1, 663, 256]), torch.Size([1, 663, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.1189374923706055  GigaBytes
Max Memory Allocated: 5.160576343536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.1998701095581055  GigaBytes
Max Memory Allocated: 5.205560684204102  GigaBytes

rst.shape  torch.Size([1, 663, 256])
m.shape torch.Size([597, 10, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.2049760818481445  GigaBytes
Max Memory Allocated: 5.205560684204102  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.2049760818481445  GigaBytes
Max Memory Allocated: 5.205560684204102  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.206114768981934  GigaBytes
Max Memory Allocated: 5.206114768981934  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.287135124206543  GigaBytes
Max Memory Allocated: 5.292828559875488  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([514, 11, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.2920002937316895  GigaBytes
Max Memory Allocated: 5.292828559875488  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.2920002937316895  GigaBytes
Max Memory Allocated: 5.292828559875488  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.292980670928955  GigaBytes
Max Memory Allocated: 5.292980670928955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.370240211486816  GigaBytes
Max Memory Allocated: 5.375632286071777  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([507, 12, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.375597953796387  GigaBytes
Max Memory Allocated: 5.375632286071777  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.375597953796387  GigaBytes
Max Memory Allocated: 5.375632286071777  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.376564979553223  GigaBytes
Max Memory Allocated: 5.376564979553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.459418296813965  GigaBytes
Max Memory Allocated: 5.4652204513549805  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([430, 13, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.46430778503418  GigaBytes
Max Memory Allocated: 5.4652204513549805  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.46430778503418  GigaBytes
Max Memory Allocated: 5.4652204513549805  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.465127944946289  GigaBytes
Max Memory Allocated: 5.4652204513549805  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.542308807373047  GigaBytes
Max Memory Allocated: 5.547639846801758  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([367, 14, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.546837329864502  GigaBytes
Max Memory Allocated: 5.547639846801758  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.546837329864502  GigaBytes
Max Memory Allocated: 5.547639846801758  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.547537326812744  GigaBytes
Max Memory Allocated: 5.547639846801758  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.617464542388916  GigaBytes
Max Memory Allocated: 5.622364521026611  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([362, 15, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.622333526611328  GigaBytes
Max Memory Allocated: 5.622364521026611  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.622333526611328  GigaBytes
Max Memory Allocated: 5.622364521026611  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.623023986816406  GigaBytes
Max Memory Allocated: 5.623023986816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.697076797485352  GigaBytes
Max Memory Allocated: 5.7022552490234375  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([338, 16, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.701929569244385  GigaBytes
Max Memory Allocated: 5.7022552490234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.701929569244385  GigaBytes
Max Memory Allocated: 5.7022552490234375  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.702574253082275  GigaBytes
Max Memory Allocated: 5.702574253082275  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.776430606842041  GigaBytes
Max Memory Allocated: 5.781588077545166  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([302, 17, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.78104305267334  GigaBytes
Max Memory Allocated: 5.781588077545166  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.78104305267334  GigaBytes
Max Memory Allocated: 5.781588077545166  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.781619071960449  GigaBytes
Max Memory Allocated: 5.781619071960449  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.851922988891602  GigaBytes
Max Memory Allocated: 5.856819152832031  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([321, 18, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.857188701629639  GigaBytes
Max Memory Allocated: 5.857210636138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.857188701629639  GigaBytes
Max Memory Allocated: 5.857210636138916  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.8578009605407715  GigaBytes
Max Memory Allocated: 5.8578009605407715  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.936471462249756  GigaBytes
Max Memory Allocated: 5.941981792449951  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([294, 19, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.941534519195557  GigaBytes
Max Memory Allocated: 5.941981792449951  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.941534519195557  GigaBytes
Max Memory Allocated: 5.941981792449951  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 5.9420952796936035  GigaBytes
Max Memory Allocated: 5.9420952796936035  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.018751621246338  GigaBytes
Max Memory Allocated: 6.024078845977783  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([274, 20, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.023738384246826  GigaBytes
Max Memory Allocated: 6.024078845977783  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.023738384246826  GigaBytes
Max Memory Allocated: 6.024078845977783  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.024260997772217  GigaBytes
Max Memory Allocated: 6.024260997772217  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.099637985229492  GigaBytes
Max Memory Allocated: 6.104864120483398  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([264, 21, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.104705333709717  GigaBytes
Max Memory Allocated: 6.104864120483398  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.104705333709717  GigaBytes
Max Memory Allocated: 6.104864120483398  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.105208873748779  GigaBytes
Max Memory Allocated: 6.105208873748779  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.181637287139893  GigaBytes
Max Memory Allocated: 6.186924457550049  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([203, 22, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.185678005218506  GigaBytes
Max Memory Allocated: 6.186924457550049  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.185678005218506  GigaBytes
Max Memory Allocated: 6.186924457550049  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.186065196990967  GigaBytes
Max Memory Allocated: 6.186924457550049  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.246079921722412  GigaBytes
Max Memory Allocated: 6.250339031219482  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([198, 23, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.250263690948486  GigaBytes
Max Memory Allocated: 6.250339031219482  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.250263690948486  GigaBytes
Max Memory Allocated: 6.250339031219482  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.250641345977783  GigaBytes
Max Memory Allocated: 6.250641345977783  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.311821460723877  GigaBytes
Max Memory Allocated: 6.316164493560791  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([198, 24, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.316200256347656  GigaBytes
Max Memory Allocated: 6.316218376159668  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.316200256347656  GigaBytes
Max Memory Allocated: 6.316218376159668  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.316577911376953  GigaBytes
Max Memory Allocated: 6.316577911376953  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.380401611328125  GigaBytes
Max Memory Allocated: 6.385791778564453  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([5323, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.508122444152832  GigaBytes
Max Memory Allocated: 6.508618354797363  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.508122444152832  GigaBytes
Max Memory Allocated: 6.508618354797363  GigaBytes

 h.shape torch.Size([1, 5323, 256]), torch.Size([1, 5323, 256])
----------------------------------------3
 Nvidia-smi: 9.7049560546875 GB
    Memory Allocated: 6.518589019775391  GigaBytes
Max Memory Allocated: 6.518589019775391  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.0897216796875 GB
    Memory Allocated: 8.30791187286377  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 5323, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.0897216796875 GB
    Memory Allocated: 8.074599266052246  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.0897216796875 GB
    Memory Allocated: 8.078126907348633  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.0897216796875 GB
    Memory Allocated: 8.08165454864502  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.0897216796875 GB
    Memory Allocated: 8.077959060668945  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([22507, 40])
input nodes number: 69029
output nodes number: 22507
edges number: 259263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0897216796875 GB
    Memory Allocated: 8.078222751617432  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.0897216796875 GB
    Memory Allocated: 8.07822322845459  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.07027578353881836  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.07582616806030273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.07582616806030273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047704100608825684 |0.08279937505722046 |0.2671877145767212 |0.00013303756713867188 |0.09537714719772339 |0.0057125091552734375 |
----------------------------------------------------------pseudo_mini_loss sum 5.334139347076416
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  496836
Number of first layer input nodes during this epoch:  299302
Number of first layer output nodes during this epoch:  197534
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.07582569122314453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.021537065505981445
global_2_local spend time (sec) 0.04210019111633301
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0045964717864990234
A = g.adjacency_matrix() spent  0.0077931880950927734
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0775153636932373
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3415017127990723
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1866438388824463

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11701738, 2.0: 2017886, 3.0: 504377, 4.0: 152112, 5.0: 55817, 6.0: 23824, 7.0: 11409, 8.0: 5685, 9.0: 3070, 10.0: 1700, 11.0: 1036, 12.0: 534, 13.0: 336, 14.0: 225, 15.0: 120, 16.0: 118, 17.0: 96, 18.0: 53, 19.0: 34, 20.0: 8, 21.0: 6})[04:20:59] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21719692 edges into 4 parts and get 1373371 edge cuts

Convert a graph into a bidirected graph: 0.792 seconds
Metis partitioning: 4.099 seconds
Split the graph: 1.669 seconds
Construct subgraphs: 0.076 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.646690845489502
23169
23086
22343
22343
total k batches seeds list generation spend  19.58378553390503
after graph partition
graph partition algorithm spend time 19.688079595565796
23169
23086
22343
22343
partition_len_list
[42157, 36582, 51891, 68151]
shared_neighbor_graph_partition_s0 selection method  spend 19.781503438949585
time for parepare:  0.017364025115966797
local_output_nid generation:  0.0030677318572998047
local_in_edges_tensor generation:  0.0035085678100585938
mini_batch_src_global generation:  0.0055158138275146484
r_  generation:  0.05899953842163086
local_output_nid generation:  0.003923177719116211
local_in_edges_tensor generation:  0.004402875900268555
mini_batch_src_global generation:  0.007007598876953125
r_  generation:  0.06378793716430664
local_output_nid generation:  0.0039327144622802734
local_in_edges_tensor generation:  0.003450155258178711
mini_batch_src_global generation:  0.005490541458129883
r_  generation:  0.05490303039550781
local_output_nid generation:  0.004070758819580078
local_in_edges_tensor generation:  0.015117883682250977
mini_batch_src_global generation:  0.01158285140991211
r_  generation:  0.09048318862915039
----------------------check_connections_block total spend ----------------------------- 0.42816829681396484
generate_one_block  0.08788943290710449
generate_one_block  0.08186864852905273
generate_one_block  0.07624578475952148
generate_one_block  0.1291332244873047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06557679176330566
gen group dst list time:  0.006724357604980469
time for parepare:  0.022907257080078125
local_output_nid generation:  0.00641179084777832
local_in_edges_tensor generation:  0.0203402042388916
mini_batch_src_global generation:  0.009754419326782227
r_  generation:  0.09207367897033691
local_output_nid generation:  0.007457733154296875
local_in_edges_tensor generation:  0.0067632198333740234
mini_batch_src_global generation:  0.028357505798339844
r_  generation:  0.08082103729248047
local_output_nid generation:  0.010751485824584961
local_in_edges_tensor generation:  0.010283946990966797
mini_batch_src_global generation:  0.011726617813110352
r_  generation:  0.12542366981506348
local_output_nid generation:  0.011269807815551758
local_in_edges_tensor generation:  0.012208223342895508
mini_batch_src_global generation:  0.0184783935546875
r_  generation:  0.18739032745361328
----------------------check_connections_block total spend ----------------------------- 0.7909352779388428
generate_one_block  0.13690423965454102
generate_one_block  0.10147500038146973
generate_one_block  0.1528332233428955
generate_one_block  0.243025541305542
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.07582569122314453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

connection checking time:  0.7909352779388428
block generation total time  0.6342380046844482
average batch blocks generation time:  0.15855950117111206
block dataloader generation time/epoch 22.217449188232422
pseudo mini batch 0 input nodes size: 66769
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.059583187103271484  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.059583187103271484  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.09142112731933594  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.09159421920776367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04664182662963867  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04967164993286133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04967164993286133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04967164993286133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([66769, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04967164993286133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([5070, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.17207813262939453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.17207813262939453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 5070, 128]), torch.Size([1, 5070, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.17691326141357422  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.21559429168701172  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 5070, 128])
m.shape torch.Size([5107, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.2180471420288086  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.2180471420288086  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 5107, 128]), torch.Size([1, 5107, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.2229175567626953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.29622507095336914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 5107, 128])
m.shape torch.Size([4484, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.30109548568725586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.30109548568725586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4484, 128]), torch.Size([1, 4484, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.305633544921875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.4017953872680664  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4484, 128])
m.shape torch.Size([3762, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.40654468536376953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.40654468536376953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3762, 128]), torch.Size([1, 3762, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.4106416702270508  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.5149402618408203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3762, 128])
m.shape torch.Size([3177, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.5207209587097168  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.5207209587097168  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3177, 128]), torch.Size([1, 3177, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.5238943099975586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.6342658996582031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3177, 128])
m.shape torch.Size([2589, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.6401581764221191  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.6401581764221191  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2589, 128]), torch.Size([1, 2589, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.642758846282959  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7506389617919922  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2589, 128])
m.shape torch.Size([2214, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7567944526672363  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7567944526672363  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2214, 128]), torch.Size([1, 2214, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7590847015380859  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8684225082397461  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2214, 128])
m.shape torch.Size([1982, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8758125305175781  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8758125305175781  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1982, 128]), torch.Size([1, 1982, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8777027130126953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.9879608154296875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1982, 128])
m.shape torch.Size([1632, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.9940195083618164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.9940195083618164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.9955759048461914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.0984077453613281  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([12140, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.155517578125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.155517578125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 12140, 128]), torch.Size([1, 12140, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.1670951843261719  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.992447853088379  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 12140, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.890401840209961  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.9306058883666992  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.9708099365234375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.9302916526794434  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([42157, 256])
first layer input nodes number: 66769
first layer output nodes number: 42157
edges number: 242645
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.9713096618652344  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.0115137100219727  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.021632194519043  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.021632194519043  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([3589, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.1843981742858887  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.1843981742858887  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3589, 256]), torch.Size([1, 3589, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.1930575370788574  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.2496352195739746  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3589, 256])
m.shape torch.Size([3131, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.2522311210632324  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.2522311210632324  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3131, 256]), torch.Size([1, 3131, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.2587437629699707  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.3483223915100098  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3131, 256])
m.shape torch.Size([2549, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.3529810905456543  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.3529810905456543  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2549, 256]), torch.Size([1, 2549, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.35800838470459  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.4658279418945312  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2549, 256])
m.shape torch.Size([2103, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.471482276916504  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.471482276916504  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2103, 256]), torch.Size([1, 2103, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.475785255432129  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.5931529998779297  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2103, 256])
m.shape torch.Size([1734, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.599480628967285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.599480628967285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1734, 256]), torch.Size([1, 1734, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.602975845336914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7233009338378906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1734, 256])
m.shape torch.Size([1325, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7299752235412598  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7299752235412598  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1325, 256]), torch.Size([1, 1325, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7326130867004395  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.844330310821533  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1325, 256])
m.shape torch.Size([1127, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.8500723838806152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.8500723838806152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1127, 256]), torch.Size([1, 1127, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.8525543212890625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.963275909423828  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1127, 256])
m.shape torch.Size([1015, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.970860004425049  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.970860004425049  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1015, 256]), torch.Size([1, 1015, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.9727959632873535  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.083832263946533  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1015, 256])
m.shape torch.Size([791, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.0897068977355957  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.0897068977355957  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.0912156105041504  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.188445568084717  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([708, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.1952056884765625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.1952056884765625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.1965560913085938  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.2949371337890625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([564, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.300224781036377  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.300224781036377  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.301300525665283  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.385712146759033  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([508, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.39103364944458  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.39103364944458  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.392002582550049  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.4748196601867676  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([434, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.4797582626342773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.4797582626342773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.480586051940918  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.5569047927856445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([372, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.5614967346191406  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.5614967346191406  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.562206268310547  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.6328773498535156  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([354, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.6376261711120605  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.6376261711120605  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.638301372528076  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.7119498252868652  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([265, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.7156877517700195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.7156877517700195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.716193199157715  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.775322437286377  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([241, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.779468536376953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.779468536376953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.779928207397461  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8350887298583984  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([204, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.838388442993164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.838388442993164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.838777542114258  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.888193130493164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([184, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8913588523864746  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8913588523864746  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.891709804534912  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.938737392425537  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([166, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9417529106140137  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9417529106140137  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9420695304870605  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.98671293258667  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([135, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9892797470092773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9892797470092773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.989537239074707  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.027646064758301  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([131, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.030287742614746  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.030287742614746  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.0305376052856445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.069266319274902  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([105, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.071462631225586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.071462631225586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.071662902832031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.104106903076172  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([106, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.106451988220215  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.106451988220215  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.106654167175293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.140822410583496  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([1328, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.172783374786377  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.172783374786377  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1328, 256]), torch.Size([1, 1328, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.17582368850708  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.631344318389893  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1328, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.494884967803955  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.499218463897705  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.503551959991455  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.499045372009277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([23169, 40])
input nodes number: 42157
output nodes number: 23169
edges number: 163899
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.500338554382324  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 4.500339508056641  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.056430816650390625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

pseudo mini batch 1 input nodes size: 52779
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04744863510131836  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04744863510131836  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.0726156234741211  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.07278776168823242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.040776729583740234  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04373311996459961  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04373311996459961  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04373311996459961  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([52779, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.04373311996459961  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([4183, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.1515064239501953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.1515064239501953  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4183, 128]), torch.Size([1, 4183, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.15549564361572266  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.1874256134033203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4183, 128])
m.shape torch.Size([4268, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.18950128555297852  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.18950128555297852  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4268, 128]), torch.Size([1, 4268, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.1935715675354004  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.25557756423950195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4268, 128])
m.shape torch.Size([3802, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.25898122787475586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.25898122787475586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3802, 128]), torch.Size([1, 3802, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.26285743713378906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.34262657165527344  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3802, 128])
m.shape torch.Size([3131, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.3467855453491211  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.3467855453491211  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3131, 128]), torch.Size([1, 3131, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.3502364158630371  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.43834972381591797  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3131, 128])
m.shape torch.Size([2694, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.4432797431945801  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.4432797431945801  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2694, 128]), torch.Size([1, 2694, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.44608354568481445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.540583610534668  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2694, 128])
m.shape torch.Size([2267, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.5455226898193359  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.5455226898193359  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2267, 128]), torch.Size([1, 2267, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.547917366027832  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.6424455642700195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2267, 128])
m.shape torch.Size([1906, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.6477265357971191  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.6477265357971191  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1906, 128]), torch.Size([1, 1906, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.6495442390441895  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7404294013977051  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1906, 128])
m.shape torch.Size([1684, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7459444999694824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7459444999694824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.7475504875183105  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8401293754577637  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
m.shape torch.Size([1416, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8454031944274902  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8454031944274902  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1416, 128]), torch.Size([1, 1416, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.8467535972595215  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.935056209564209  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1416, 128])
m.shape torch.Size([11231, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.9879345893859863  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.9879345893859863  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 11231, 128]), torch.Size([1, 11231, 128])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 0.9993634223937988  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.7617125511169434  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 11231, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.669745922088623  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.704902172088623  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.7397894859313965  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.7043604850769043  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([36582, 256])
first layer input nodes number: 52779
first layer output nodes number: 36582
edges number: 215589
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.7401847839355469  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.7750720977783203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.7838926315307617  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.7838926315307617  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([3178, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.9622259140014648  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.9622259140014648  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3178, 256]), torch.Size([1, 3178, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 1.969156265258789  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.0190696716308594  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3178, 256])
m.shape torch.Size([2857, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.0209789276123047  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.0209789276123047  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2857, 256]), torch.Size([1, 2857, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.028027057647705  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.110225200653076  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2857, 256])
m.shape torch.Size([2433, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.1140575408935547  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.1140575408935547  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2433, 256]), torch.Size([1, 2433, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.1186981201171875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.2246665954589844  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2433, 256])
m.shape torch.Size([1913, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.229701042175293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.229701042175293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1913, 256]), torch.Size([1, 1913, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.23361873626709  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.341367244720459  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1913, 256])
m.shape torch.Size([1633, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.347390651702881  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.347390651702881  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1633, 256]), torch.Size([1, 1633, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.3506369590759277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.4674572944641113  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1633, 256])
m.shape torch.Size([1351, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.473690986633301  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.473690986633301  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1351, 256]), torch.Size([1, 1351, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.476358413696289  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.589569091796875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1351, 256])
m.shape torch.Size([1130, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.595883369445801  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.595883369445801  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1130, 256]), torch.Size([1, 1130, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.598155975341797  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7090187072753906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1130, 256])
m.shape torch.Size([952, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7152609825134277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7152609825134277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 952, 256]), torch.Size([1, 952, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.7170767784118652  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.8214545249938965  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 952, 256])
m.shape torch.Size([842, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.8278303146362305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.8278303146362305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.8294363021850586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.932997703552246  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([738, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.9392881393432617  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.9392881393432617  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 738, 256]), torch.Size([1, 738, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 2.9406957626342773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.041293144226074  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 738, 256])
m.shape torch.Size([673, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.0477046966552734  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.0477046966552734  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.0489883422851562  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.149503707885742  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 673, 256])
m.shape torch.Size([545, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.1551480293273926  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.1551480293273926  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.1561875343322754  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.2479519844055176  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([474, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.253355026245117  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.253355026245117  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.2542591094970703  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.3376874923706055  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([411, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.3427658081054688  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.3427658081054688  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.3435497283935547  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.4229393005371094  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([346, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.4275360107421875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.4275360107421875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.4281959533691406  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.5004920959472656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([303, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.50482177734375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.50482177734375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.505399703979492  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.5709991455078125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([308, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.575742721557617  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.575742721557617  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.5763301849365234  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.6488819122314453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([238, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.652705669403076  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.652705669403076  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.6531596183776855  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.710811138153076  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([198, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.714200019836426  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.714200019836426  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.7145776748657227  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.765183448791504  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([236, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.76953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.76953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.7699813842773438  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8334503173828125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([206, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.837383270263672  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.837383270263672  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8377761840820312  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8959274291992188  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([144, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8989858627319336  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8989858627319336  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.8992605209350586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9418325424194336  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([142, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9448347091674805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9448347091674805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.94510555267334  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9889822006225586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([132, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.991891860961914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.991891860961914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.9921436309814453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.034692764282227  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([1703, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.07548713684082  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.07548713684082  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1703, 256]), torch.Size([1, 1703, 256])
----------------------------------------3
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.079760551452637  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.653765678405762  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1703, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.49980354309082  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.503243923187256  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.506684303283691  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.5030717849731445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([23086, 40])
input nodes number: 36582
output nodes number: 23086
edges number: 181000
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.502623558044434  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 4.502624034881592  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04861593246459961  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

pseudo mini batch 2 input nodes size: 91823
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.03988361358642578  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.03988361358642578  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.08366823196411133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.08383512496948242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.05849599838256836  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06195783615112305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06195783615112305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06195783615112305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([91823, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06195783615112305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([5743, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.22335147857666016  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.22335147857666016  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 5743, 128]), torch.Size([1, 5743, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.22882843017578125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.27567291259765625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 5743, 128])
m.shape torch.Size([5816, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.27848100662231445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.27848100662231445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 5816, 128]), torch.Size([1, 5816, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.2840275764465332  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.36749744415283203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 5816, 128])
m.shape torch.Size([4777, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.37155771255493164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.37155771255493164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4777, 128]), torch.Size([1, 4777, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.37722253799438477  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.4774479866027832  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4777, 128])
m.shape torch.Size([3956, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.48331212997436523  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.48331212997436523  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3956, 128]), torch.Size([1, 3956, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.4874763488769531  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6002235412597656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3956, 128])
m.shape torch.Size([3396, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6064338684082031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6064338684082031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3396, 128]), torch.Size([1, 3396, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6099395751953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7284631729125977  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3396, 128])
m.shape torch.Size([2791, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7347297668457031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7347297668457031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2791, 128]), torch.Size([1, 2791, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7377939224243164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8581275939941406  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2791, 128])
m.shape torch.Size([2410, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8639416694641113  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8639416694641113  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2410, 128]), torch.Size([1, 2410, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8665585517883301  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9817948341369629  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2410, 128])
m.shape torch.Size([2132, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9887785911560059  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9887785911560059  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2132, 128]), torch.Size([1, 2132, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9908814430236816  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1082663536071777  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2132, 128])
m.shape torch.Size([1858, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1150078773498535  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1150078773498535  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1858, 128]), torch.Size([1, 1858, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1167798042297363  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.2311091423034668  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1858, 128])
m.shape torch.Size([19012, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.3208794593811035  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.3208794593811035  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 19012, 128]), torch.Size([1, 19012, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.3390107154846191  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6263298988342285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 19012, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.486813545227051  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5363006591796875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.585787773132324  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5359139442443848  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([51891, 256])
first layer input nodes number: 91823
first layer output nodes number: 51891
edges number: 322024
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5864739418029785  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6359610557556152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6483330726623535  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6483330726623535  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([4151, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.790144443511963  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.790144443511963  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4151, 256]), torch.Size([1, 4151, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.7980618476867676  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.861401081085205  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4151, 256])
m.shape torch.Size([3525, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.864654541015625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.864654541015625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3525, 256]), torch.Size([1, 3525, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.8720474243164062  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.9737658500671387  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3525, 256])
m.shape torch.Size([2599, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.977898120880127  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.977898120880127  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2599, 256]), torch.Size([1, 2599, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.9831748008728027  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.0952672958374023  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2599, 256])
m.shape torch.Size([1950, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.099964141845703  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.099964141845703  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1950, 256]), torch.Size([1, 1950, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1043806076049805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.216207981109619  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1950, 256])
m.shape torch.Size([1674, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2219748497009277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2219748497009277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1674, 256]), torch.Size([1, 1674, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2252354621887207  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.3439064025878906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1674, 256])
m.shape torch.Size([1248, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.3495068550109863  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.3495068550109863  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1248, 256]), torch.Size([1, 1248, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.3519139289855957  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.4573659896850586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1248, 256])
m.shape torch.Size([994, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.462653636932373  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.462653636932373  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 994, 256]), torch.Size([1, 994, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.4645495414733887  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5631041526794434  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 994, 256])
m.shape torch.Size([858, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.568753719329834  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.568753719329834  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 858, 256]), torch.Size([1, 858, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.570390224456787  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6637721061706543  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 858, 256])
m.shape torch.Size([692, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6689400672912598  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6689400672912598  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 692, 256]), torch.Size([1, 692, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.670259952545166  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.760242462158203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 692, 256])
m.shape torch.Size([565, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.7650132179260254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.7650132179260254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.7660908699035645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8430047035217285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([449, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8472132682800293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8472132682800293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.848069667816162  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.916769504547119  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([392, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9208626747131348  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9208626747131348  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9216103553771973  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.986177921295166  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([325, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.989865303039551  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.989865303039551  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.990485191345215  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.050441741943359  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([283, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.0539398193359375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.0539398193359375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.054479598999023  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.108364105224609  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([239, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.1115403175354  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.1115403175354  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.111996173858643  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.1603169441223145  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([216, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.163410663604736  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.163410663604736  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.163822650909424  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.210377216339111  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([180, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.2131123542785645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.2131123542785645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.213455677032471  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.254654407501221  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([188, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.257735252380371  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.257735252380371  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.25809383392334  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.303633689880371  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([158, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.306339740753174  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.306339740753174  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.306641101837158  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.3470234870910645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([132, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.349410533905029  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.349410533905029  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.3496623039245605  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.385161876678467  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.387276649475098  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.387276649475098  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.38748836517334  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.418822288513184  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([81, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.420429229736328  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.420429229736328  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.420583724975586  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.444530487060547  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.446177959442139  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.446177959442139  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.446326732635498  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.470427989959717  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([87, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.472360610961914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.472360610961914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.472526550292969  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.500570297241211  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([1168, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.529343128204346  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.529343128204346  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1168, 256]), torch.Size([1, 1168, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.531747341156006  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.936506748199463  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1168, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.819240093231201  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.822601795196533  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.825931549072266  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.8224029541015625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([22343, 40])
input nodes number: 51891
output nodes number: 22343
edges number: 142508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.822877883911133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.822878360748291  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06849861145019531  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

pseudo mini batch 3 input nodes size: 92654
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.058417320251464844  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.058417320251464844  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.10259819030761719  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.10276508331298828  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.05881357192993164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06541013717651367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06541013717651367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06541013717651367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([92654, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06541013717651367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([3861, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.3245115280151367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.3245115280151367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3861, 128]), torch.Size([1, 3861, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.32819366455078125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.3589954376220703  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3861, 128])
m.shape torch.Size([4089, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.3608365058898926  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.3608365058898926  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4089, 128]), torch.Size([1, 4089, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.36529970169067383  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.4238600730895996  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4089, 128])
m.shape torch.Size([3645, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.42775964736938477  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.42775964736938477  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3645, 128]), torch.Size([1, 3645, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.4314908981323242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5092144012451172  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3645, 128])
m.shape torch.Size([3310, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5137896537780762  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5137896537780762  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3310, 128]), torch.Size([1, 3310, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5171060562133789  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.612797737121582  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3310, 128])
m.shape torch.Size([3135, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6191110610961914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6191110610961914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3135, 128]), torch.Size([1, 3135, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6221365928649902  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7302570343017578  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3135, 128])
m.shape torch.Size([2850, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7377314567565918  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7377314567565918  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2850, 128]), torch.Size([1, 2850, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7404494285583496  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8607625961303711  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2850, 128])
m.shape torch.Size([2727, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8685059547424316  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8685059547424316  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2727, 128]), torch.Size([1, 2727, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8711652755737305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.001978874206543  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2727, 128])
m.shape torch.Size([2528, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.010322093963623  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.010322093963623  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2528, 128]), torch.Size([1, 2528, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.0128278732299805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.152024269104004  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2528, 128])
m.shape torch.Size([2405, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.160895824432373  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.160895824432373  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2405, 128]), torch.Size([1, 2405, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.163492202758789  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.3109521865844727  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2405, 128])
m.shape torch.Size([39601, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.4986376762390137  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.4986376762390137  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 39601, 128]), torch.Size([1, 39601, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.5377001762390137  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.233375072479248  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 39601, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.993183135986328  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.0581769943237305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.123170852661133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.057669162750244  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([68151, 256])
first layer input nodes number: 92654
first layer output nodes number: 68151
edges number: 525957
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.123863220214844  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.188857078552246  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.205105781555176  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.205105781555176  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([2510, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.455413341522217  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.455413341522217  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2510, 256]), torch.Size([1, 2510, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.460597515106201  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.50036096572876  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2510, 256])
m.shape torch.Size([2193, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.501984596252441  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.501984596252441  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2193, 256]), torch.Size([1, 2193, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.5065178871154785  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.572264194488525  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2193, 256])
m.shape torch.Size([1696, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.5745625495910645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.5745625495910645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1696, 256]), torch.Size([1, 1696, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.578353404998779  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.655627727508545  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1696, 256])
m.shape torch.Size([1354, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.658241271972656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.658241271972656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1354, 256]), torch.Size([1, 1354, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.660926818847656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.736349582672119  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1354, 256])
m.shape torch.Size([1181, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.740734100341797  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.740734100341797  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1181, 256]), torch.Size([1, 1181, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.743083477020264  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.827474594116211  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1181, 256])
m.shape torch.Size([944, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.832406520843506  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.832406520843506  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 944, 256]), torch.Size([1, 944, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.834207057952881  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.91293478012085  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 944, 256])
m.shape torch.Size([794, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.917376518249512  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.917376518249512  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 794, 256]), torch.Size([1, 794, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.918890953063965  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.995927810668945  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 794, 256])
m.shape torch.Size([647, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.000145435333252  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.000145435333252  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.001379489898682  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.072052478790283  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([651, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.077066898345947  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.077066898345947  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.078308582305908  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.157776355743408  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([588, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.162806987762451  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.162806987762451  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.163928508758545  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.244189739227295  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([517, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.2490949630737305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.2490949630737305  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.2500810623168945  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.327666282653809  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([492, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.332848072052002  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.332848072052002  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.333786487579346  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.4158406257629395  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([423, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.420656681060791  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.420656681060791  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.421463489532471  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.496609210968018  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([368, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.501157760620117  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.501157760620117  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.501859664916992  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.572440147399902  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([350, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.5771355628967285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.5771355628967285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.577803134918213  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.650332927703857  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([327, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.655027866363525  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.655027866363525  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.655651569366455  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.728132724761963  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([301, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.733668804168701  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.733668804168701  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.734242916107178  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.803202152252197  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([318, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.808416843414307  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.808416843414307  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.809023380279541  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.887026309967041  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([296, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.8929524421691895  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.8929524421691895  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.893517017364502  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.970207691192627  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([273, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.975173473358154  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.975173473358154  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 5.975694179534912  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.051225662231445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([265, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.056313991546631  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.056313991546631  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.056819438934326  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.133354663848877  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([200, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.137331008911133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.137331008911133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.137712478637695  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.196840286254883  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([194, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.2009382247924805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.2009382247924805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.201308250427246  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.261252403259277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([200, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.26568078994751  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.26568078994751  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])[04:21:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21724554 edges into 4 parts and get 1268801 edge cuts

----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.266062259674072  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.330530643463135  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([5261, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.456752300262451  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.456752300262451  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 5261, 256]), torch.Size([1, 5261, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 6.466786861419678  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 8.233755588531494  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 5261, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 8.002432346343994  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 8.005800724029541  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 8.009169101715088  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 8.00563383102417  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([22343, 40])
input nodes number: 68151
output nodes number: 22343
edges number: 256843
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 8.006315231323242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 8.0063157081604  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.07562923431396484  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.07562923431396484  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.07562923431396484  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04144394397735596 |0.0041544437408447266 |0.13300830125808716 |0.00010579824447631836 |0.08736562728881836 |0.004744052886962891 |
----------------------------------------------------------pseudo_mini_loss sum 4.535634994506836
Total (block generation + training)time/epoch 23.353960752487183
Training time/epoch 1.1361780166625977
Training time without block to device /epoch 1.1195602416992188
Training time without total dataloading part /epoch 0.8866629600524902
load block tensor time/epoch 0.16577577590942383
block to device time/epoch 0.016617774963378906
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  502806
Number of first layer input nodes during this epoch:  304025
Number of first layer output nodes during this epoch:  198781
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.07562875747680664  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0239102840423584
global_2_local spend time (sec) 0.04448747634887695
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004355907440185547
A = g.adjacency_matrix() spent  0.015200376510620117
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.080474853515625
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3046047687530518
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1730904579162598

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11704867, 2.0: 2016386, 3.0: 505014, 4.0: 151832, 5.0: 55157, 6.0: 24090, 7.0: 11047, 8.0: 5737, 9.0: 3033, 10.0: 1743, 11.0: 999, 12.0: 546, 13.0: 336, 14.0: 193, 15.0: 115, 16.0: 108, 17.0: 90, 18.0: 42, 19.0: 26, 20.0: 6, 21.0: 3})
Convert a graph into a bidirected graph: 0.791 seconds
Metis partitioning: 4.141 seconds
Split the graph: 1.712 seconds
Construct subgraphs: 0.065 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.71821403503418
23098
22383
23389
22071
total k batches seeds list generation spend  19.952520847320557
after graph partition
graph partition algorithm spend time 20.04752469062805
23098
22383
23389
22071
partition_len_list
[42700, 36560, 70185, 48956]
shared_neighbor_graph_partition_s0 selection method  spend 20.14649486541748
time for parepare:  0.01669025421142578
local_output_nid generation:  0.0032181739807128906
local_in_edges_tensor generation:  0.003628253936767578
mini_batch_src_global generation:  0.005944728851318359
r_  generation:  0.06024646759033203
local_output_nid generation:  0.003922462463378906
local_in_edges_tensor generation:  0.00481867790222168
mini_batch_src_global generation:  0.006760120391845703
r_  generation:  0.06036520004272461
local_output_nid generation:  0.0041103363037109375
local_in_edges_tensor generation:  0.00401616096496582
mini_batch_src_global generation:  0.010118484497070312
r_  generation:  0.09053707122802734
local_output_nid generation:  0.004315614700317383
local_in_edges_tensor generation:  0.0033714771270751953
mini_batch_src_global generation:  0.006261110305786133
r_  generation:  0.05453205108642578
----------------------check_connections_block total spend ----------------------------- 0.4051642417907715
generate_one_block  0.08465790748596191
generate_one_block  0.07731771469116211
generate_one_block  0.13121652603149414
generate_one_block  0.06428027153015137
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05988001823425293
gen group dst list time:  0.0055348873138427734
time for parepare:  0.01985025405883789
local_output_nid generation:  0.006428956985473633
local_in_edges_tensor generation:  0.014488458633422852
mini_batch_src_global generation:  0.008109331130981445
r_  generation:  0.09456324577331543
local_output_nid generation:  0.007956743240356445
local_in_edges_tensor generation:  0.0074615478515625
mini_batch_src_global generation:  0.008947134017944336
r_  generation:  0.08781933784484863
local_output_nid generation:  0.012009143829345703
local_in_edges_tensor generation:  0.017027854919433594
mini_batch_src_global generation:  0.019701004028320312
r_  generation:  0.2041938304901123
local_output_nid generation:  0.013135194778442383
local_in_edges_tensor generation:  0.010093212127685547
mini_batch_src_global generation:  0.014555931091308594
r_  generation:  0.1185765266418457
----------------------check_connections_block total spend ----------------------------- 0.794461727142334
generate_one_block  0.12352132797241211
generate_one_block  0.1050424575805664
generate_one_block  0.2504293918609619
generate_one_block  0.14165735244750977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.07562875747680664  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

connection checking time:  0.794461727142334
block generation total time  0.6206505298614502
average batch blocks generation time:  0.15516263246536255
block dataloader generation time/epoch 22.358699202537537
pseudo mini batch 0 input nodes size: 69564
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.05881929397583008  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.05881929397583008  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.09198999404907227  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.0921621322631836  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.047814369201660156  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.051016807556152344  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.051016807556152344  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.051016807556152344  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([69564, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.051016807556152344  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([4615, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.17881441116333008  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.17881441116333008  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4615, 128]), torch.Size([1, 4615, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.18367767333984375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.22103452682495117  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4615, 128])
m.shape torch.Size([4772, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.22338485717773438  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.22338485717773438  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4772, 128]), torch.Size([1, 4772, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.227935791015625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.2961997985839844  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4772, 128])
m.shape torch.Size([4311, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.300750732421875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.300750732421875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4311, 128]), torch.Size([1, 4311, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.3049321174621582  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.39538049697875977  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4311, 128])
m.shape torch.Size([3643, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.40027332305908203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.40027332305908203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3643, 128]), torch.Size([1, 3643, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.4040260314941406  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5062966346740723  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3643, 128])
m.shape torch.Size([3213, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5117969512939453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5117969512939453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3213, 128]), torch.Size([1, 3213, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5155091285705566  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6266517639160156  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3213, 128])
m.shape torch.Size([2658, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6327242851257324  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6327242851257324  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2658, 128]), torch.Size([1, 2658, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6353793144226074  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7473340034484863  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2658, 128])
m.shape torch.Size([2230, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7529902458190918  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7529902458190918  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2230, 128]), torch.Size([1, 2230, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7552828788757324  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8654589653015137  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2230, 128])
m.shape torch.Size([2040, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8721776008605957  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8721776008605957  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2040, 128]), torch.Size([1, 2040, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8741230964660645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9853215217590332  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2040, 128])
m.shape torch.Size([1746, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9918417930603027  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9918417930603027  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1746, 128]), torch.Size([1, 1746, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.993506908416748  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1007113456726074  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1746, 128])
m.shape torch.Size([13472, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1641182899475098  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1641182899475098  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 13472, 128]), torch.Size([1, 13472, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.1769661903381348  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.0943551063537598  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 13472, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.984489917755127  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.025211811065674  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.0659337043762207  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.024893283843994  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([42700, 256])
first layer input nodes number: 69564
first layer output nodes number: 42700
edges number: 256041
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.0664539337158203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.107175827026367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.117356300354004  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.117356300354004  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([3253, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.2882490158081055  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.2882490158081055  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3253, 256]), torch.Size([1, 3253, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.294677734375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.347187042236328  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3253, 256])
m.shape torch.Size([2928, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.3503332138061523  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.3503332138061523  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2928, 256]), torch.Size([1, 2928, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.356093406677246  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.440802574157715  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2928, 256])
m.shape torch.Size([2440, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.4450459480285645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.4450459480285645  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2440, 256]), torch.Size([1, 2440, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.4503560066223145  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5573201179504395  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2440, 256])
m.shape torch.Size([2012, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5618128776550293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5618128776550293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2012, 256]), torch.Size([1, 2012, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5659050941467285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.679564952850342  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2012, 256])
m.shape torch.Size([1740, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6860079765319824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6860079765319824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1740, 256]), torch.Size([1, 1740, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6895341873168945  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.812718391418457  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1740, 256])
m.shape torch.Size([1365, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.8189306259155273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.8189306259155273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1365, 256]), torch.Size([1, 1365, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.8216161727905273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.934452533721924  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1365, 256])
m.shape torch.Size([1134, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.9407758712768555  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.9407758712768555  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1134, 256]), torch.Size([1, 1134, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.9430227279663086  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.053007125854492  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1134, 256])
m.shape torch.Size([1033, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.0594234466552734  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.0594234466552734  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1033, 256]), torch.Size([1, 1033, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.0614843368530273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1764297485351562  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1033, 256])
m.shape torch.Size([853, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1828231811523438  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1828231811523438  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.184450149536133  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2911739349365234  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([716, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2972421646118164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2972421646118164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.29860782623291  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.3979501724243164  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([620, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.403822422027588  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.403822422027588  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 620, 256]), torch.Size([1, 620, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.4050049781799316  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.499075412750244  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 620, 256])
m.shape torch.Size([542, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5047354698181152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5047354698181152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5057692527770996  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5964102745056152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([479, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6018786430358887  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6018786430358887  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.602792263031006  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6876473426818848  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([398, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6925463676452637  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6925463676452637  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.693305492401123  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.769228458404541  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([378, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.774298667907715  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.774298667907715  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.775019645690918  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.854336738586426  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([297, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.858543872833252  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.858543872833252  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8591103553771973  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.924499988555908  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([238, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9281058311462402  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9281058311462402  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9285597801208496  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9830336570739746  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([224, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9866819381713867  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9866819381713867  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.9871091842651367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.041369438171387  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([199, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.044790267944336  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.044790267944336  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.045169830322266  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.096031188964844  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([196, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.099609375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.099609375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.099983215332031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.1526947021484375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([153, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.155882358551025  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.155882358551025  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.156174182891846  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.199364185333252  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([156, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.202517032623291  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.202517032623291  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.20281457901001  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.248934268951416  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([121, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.251460552215576  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.251460552215576  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.2516913414001465  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.289079189300537  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([111, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.291524410247803  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.291524410247803  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.291736125946045  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.327516078948975  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([1512, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.363740921020508  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.363740921020508  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1512, 256]), torch.Size([1, 1512, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.36662483215332  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.895594596862793  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1512, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.747692108154297  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.751134395599365  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.754576683044434  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.750962257385254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([23098, 40])
input nodes number: 42700
output nodes number: 23098
edges number: 173622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.751526832580566  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.751527786254883  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.057320594787597656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

pseudo mini batch 1 input nodes size: 54684
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04788923263549805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04788923263549805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.07396459579467773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.07413148880004883  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04078865051269531  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04370880126953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04370880126953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04370880126953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([54684, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04370880126953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([4216, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.15228033065795898  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.15228033065795898  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4216, 128]), torch.Size([1, 4216, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.15683364868164062  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.18899917602539062  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4216, 128])
m.shape torch.Size([4257, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.19104862213134766  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.19104862213134766  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4257, 128]), torch.Size([1, 4257, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.19510841369628906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.25600528717041016  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4257, 128])
m.shape torch.Size([3673, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.25960445404052734  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.25960445404052734  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3673, 128]), torch.Size([1, 3673, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.2636446952819824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.34123849868774414  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3673, 128])
m.shape torch.Size([3095, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.34539031982421875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.34539031982421875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3095, 128]), torch.Size([1, 3095, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.34852170944213867  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.43613624572753906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3095, 128])
m.shape torch.Size([2613, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.4408903121948242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.4408903121948242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2613, 128]), torch.Size([1, 2613, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.44341468811035156  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5353446006774902  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2613, 128])
m.shape torch.Size([2206, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.540410041809082  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.540410041809082  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2206, 128]), torch.Size([1, 2206, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.5427079200744629  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6365790367126465  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2206, 128])
m.shape torch.Size([1856, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6417222023010254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6417222023010254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1856, 128]), torch.Size([1, 1856, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.6434922218322754  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7319931983947754  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1856, 128])
m.shape torch.Size([1637, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7373528480529785  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7373528480529785  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.7389140129089355  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8310894966125488  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1377, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8362183570861816  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.8362183570861816  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1377, 128]), torch.Size([1, 1377, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.837531566619873  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9221963882446289  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1377, 128])
m.shape torch.Size([11630, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9769959449768066  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9769959449768066  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 11630, 128]), torch.Size([1, 11630, 128])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.9880871772766113  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.777510166168213  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 11630, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.6846504211425781  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.7195167541503906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.7543830871582031  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.7192440032958984  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([36560, 256])
first layer input nodes number: 54684
first layer output nodes number: 36560
edges number: 217211
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.7547926902770996  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.789659023284912  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.7983756065368652  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.7983756065368652  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([3193, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.97088623046875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.97088623046875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3193, 256]), torch.Size([1, 3193, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 1.9777040481567383  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.026425361633301  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3193, 256])
m.shape torch.Size([2838, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.0288357734680176  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.0288357734680176  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2838, 256]), torch.Size([1, 2838, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.0344834327697754  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.1164822578430176  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2838, 256])
m.shape torch.Size([2355, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.1205663681030273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.1205663681030273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2355, 256]), torch.Size([1, 2355, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.1252660751342773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.2249412536621094  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2355, 256])
m.shape torch.Size([1868, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.230647563934326  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.230647563934326  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1868, 256]), torch.Size([1, 1868, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.234309673309326  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.339571952819824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1868, 256])
m.shape torch.Size([1560, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.345287322998047  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.345287322998047  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1560, 256]), torch.Size([1, 1560, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.3484115600585938  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.457780361175537  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1560, 256])
m.shape torch.Size([1282, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.463685989379883  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.463685989379883  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1282, 256]), torch.Size([1, 1282, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.466187000274658  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.57354736328125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1282, 256])
m.shape torch.Size([1081, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5797171592712402  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.5797171592712402  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1081, 256]), torch.Size([1, 1081, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.58180570602417  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.690047264099121  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1081, 256])
m.shape torch.Size([887, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6958365440368652  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.6958365440368652  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 887, 256]), torch.Size([1, 887, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.69752836227417  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.793962001800537  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 887, 256])
m.shape torch.Size([782, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.7998805046081543  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.7998805046081543  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.8013720512390137  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.8974242210388184  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 782, 256])
m.shape torch.Size([704, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.904329776763916  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.904329776763916  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 2.905672550201416  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.003939151763916  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([603, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.009643077850342  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.009643077850342  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.0107932090759277  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.103001117706299  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([517, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.108388900756836  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.108388900756836  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.109375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1931934356689453  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([431, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1980857849121094  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1980857849121094  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.1989078521728516  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2749500274658203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([405, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2799887657165527  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.2799887657165527  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.280761241912842  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.3577189445495605  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([326, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.362032890319824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.362032890319824  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.362654685974121  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.431882858276367  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([300, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.436185359954834  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.436185359954834  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.4367575645446777  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.502194881439209  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([305, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.506892681121826  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.506892681121826  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.507474422454834  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5798916816711426  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([242, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5837879180908203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.5837879180908203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.584249496459961  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6428699493408203  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([205, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6463828086853027  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6463828086853027  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6467738151550293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.6991686820983887  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([221, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.7032217979431152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.7032217979431152  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.703643321990967  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.763078212738037  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([192, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.766742706298828  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.766742706298828  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.767108917236328  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.821308135986328  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([130, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8247485160827637  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8247485160827637  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8249964714050293  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.863429546356201  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([141, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.866422653198242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.866422653198242  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.8666915893554688  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.910259246826172  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([135, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.913239002227783  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.913239002227783  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.913496494293213  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.95701265335083  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([1680, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.997251510620117  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 3.997251510620117  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1680, 256]), torch.Size([1, 1680, 256])
----------------------------------------3
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.000932693481445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.573973655700684  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1680, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.425252914428711  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.428588390350342  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.431923866271973  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.428421497344971  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([22383, 40])
input nodes number: 36560
output nodes number: 22383
edges number: 174670
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.4287543296813965  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 4.428754806518555  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.049300193786621094  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

pseudo mini batch 2 input nodes size: 94494
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04068183898925781  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.04068183898925781  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.0857400894165039  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.08591461181640625  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.05967235565185547  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06606340408325195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06606340408325195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06606340408325195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([94494, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5916748046875 GB
    Memory Allocated: 0.06606340408325195  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([3969, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.33321046829223633  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.33321046829223633  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3969, 128]), torch.Size([1, 3969, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.33699560165405273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.36800336837768555  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3969, 128])
m.shape torch.Size([4169, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.36989593505859375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.36989593505859375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 4169, 128]), torch.Size([1, 4169, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.3738718032836914  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.43358707427978516  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 4169, 128])
m.shape torch.Size([3825, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.4370708465576172  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.4370708465576172  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3825, 128]), torch.Size([1, 3825, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.4407186508178711  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.5220985412597656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3825, 128])
m.shape torch.Size([3427, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.5268111228942871  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.5268111228942871  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3427, 128]), torch.Size([1, 3427, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.5300908088684082  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.6252021789550781  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3427, 128])
m.shape torch.Size([3257, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.6313333511352539  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.6313333511352539  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 3257, 128]), torch.Size([1, 3257, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.6344451904296875  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.7514791488647461  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 3257, 128])
m.shape torch.Size([2996, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.759244441986084  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.759244441986084  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2996, 128]), torch.Size([1, 2996, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.7622084617614746  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.8908247947692871  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2996, 128])
m.shape torch.Size([2809, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.8978128433227539  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.8978128433227539  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2809, 128]), torch.Size([1, 2809, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 0.9005188941955566  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.0396723747253418  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2809, 128])
m.shape torch.Size([2622, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.048335075378418  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.048335075378418  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2622, 128]), torch.Size([1, 2622, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.0508952140808105  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.1970863342285156  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2622, 128])
m.shape torch.Size([2500, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.2057876586914062  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.2057876586914062  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2500, 128]), torch.Size([1, 2500, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.2090072631835938  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.368577480316162  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2500, 128])
m.shape torch.Size([40611, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.5610337257385254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.5610337257385254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 40611, 128]), torch.Size([1, 40611, 128])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 1.6000962257385254  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.365545749664307  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 40611, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.120031833648682  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.186965465545654  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.253899097442627  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.1864423751831055  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

torch.Size([70185, 256])
first layer input nodes number: 94494
first layer output nodes number: 70185
edges number: 541000
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.254605293273926  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.321538925170898  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.338272571563721  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.338272571563721  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

m.shape torch.Size([2631, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.599847793579102  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.599847793579102  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2631, 256]), torch.Size([1, 2631, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.605443477630615  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.645589351654053  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2631, 256])
m.shape torch.Size([2285, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.647472858428955  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.647472858428955  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 2285, 256]), torch.Size([1, 2285, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.652129173278809  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.718438148498535  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 2285, 256])
m.shape torch.Size([1776, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.721380233764648  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.721380233764648  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1776, 256]), torch.Size([1, 1776, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.725096702575684  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.803552150726318  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1776, 256])
m.shape torch.Size([1391, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.8078813552856445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.8078813552856445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1391, 256]), torch.Size([1, 1391, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.81082010269165  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.893111228942871  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1391, 256])
m.shape torch.Size([1241, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.896789073944092  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.896789073944092  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1241, 256]), torch.Size([1, 1241, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.899156093597412  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.988129138946533  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1241, 256])
m.shape torch.Size([1009, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.993503570556641  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.993503570556641  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 1009, 256]), torch.Size([1, 1009, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 4.995428085327148  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.07904052734375  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 1009, 256])
m.shape torch.Size([858, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.083850860595703  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.083850860595703  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 858, 256]), torch.Size([1, 858, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.085487365722656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.1673126220703125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 858, 256])
m.shape torch.Size([698, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.17186164855957  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.17186164855957  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 698, 256]), torch.Size([1, 698, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.173192977905273  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.253637313842773  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 698, 256])
m.shape torch.Size([671, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.2587761878967285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.2587761878967285  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 671, 256]), torch.Size([1, 671, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.260056018829346  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.3429388999938965  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 671, 256])
m.shape torch.Size([634, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.348392963409424  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.348392963409424  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.349602222442627  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.436008930206299  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([569, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.441420078277588  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.441420078277588  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.442505359649658  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.5274481773376465  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([519, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.532891750335693  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.532891750335693  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.533881664276123  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.619534969329834  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([450, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.62466287612915  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.62466287612915  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.625521183013916  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.7073140144348145  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([379, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.711984634399414  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.711984634399414  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.71270751953125  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.787696838378906  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([370, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.792669773101807  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.792669773101807  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.793375492095947  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.8681817054748535  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([349, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.873196125030518  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.873196125030518  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.873861789703369  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.951807498931885  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([311, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.95655632019043  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.95655632019043  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 5.957149505615234  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.03011417388916  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([339, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.035682678222656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.035682678222656  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.03632926940918  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.119733810424805  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([306, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.124998569488525  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.124998569488525  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.125582218170166  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.205545902252197  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([284, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.2107133865356445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.2107133865356445  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.211255073547363  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.288016319274902  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([278, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.293356895446777  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.293356895446777  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.293887138366699  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.373379707336426  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([209, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.377533912658691  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.377533912658691  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.377932548522949  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.43972110748291  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([195, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.443832874298096  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.443832874298096  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.444204807281494  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.504457950592041  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([203, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.508955001831055  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.508955001831055  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.509342193603516  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.574777603149414  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([5434, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.705152988433838  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.705152988433838  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

 h.shape torch.Size([1, 5434, 256]), torch.Size([1, 5434, 256])
----------------------------------------3
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 6.715517520904541  GigaBytes
Max Memory Allocated: 8.43486499786377  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 8.5728440284729  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 5434, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 8.33276653289795  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 8.336750984191895  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 8.34023666381836  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 8.336077690124512  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

torch.Size([23389, 40])
input nodes number: 70185
output nodes number: 23389
edges number: 267624
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 8.337424278259277  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8514404296875 GB
    Memory Allocated: 8.337424755096436  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.07914924621582031  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

pseudo mini batch 3 input nodes size: 87717
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.06032133102416992  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.06032133102416992  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.10214805603027344  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.10231256484985352  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.05707979202270508  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.060257911682128906  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.060257911682128906  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.060257911682128906  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

torch.Size([87717, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.060257911682128906  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

m.shape torch.Size([5983, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.20523595809936523  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.20523595809936523  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 5983, 128]), torch.Size([1, 5983, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.21094179153442383  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.2572026252746582  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 5983, 128])
m.shape torch.Size([5966, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.2600555419921875  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.2600555419921875  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 5966, 128]), torch.Size([1, 5966, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.2657451629638672  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.3510894775390625  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 5966, 128])
m.shape torch.Size([4888, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.3552370071411133  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.3552370071411133  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 4888, 128]), torch.Size([1, 4888, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.36012935638427734  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.46700096130371094  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 4888, 128])
m.shape torch.Size([4019, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.4728221893310547  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.4728221893310547  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 4019, 128]), torch.Size([1, 4019, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.4771871566772461  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.5902218818664551  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 4019, 128])
m.shape torch.Size([3341, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.5959038734436035  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.5959038734436035  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 3341, 128]), torch.Size([1, 3341, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.600471019744873  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.7184257507324219  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 3341, 128])
m.shape torch.Size([2674, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.7244830131530762  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.7244830131530762  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 2674, 128]), torch.Size([1, 2674, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.727358341217041  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.8390402793884277  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 2674, 128])
m.shape torch.Size([2295, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.8450202941894531  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.8450202941894531  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 2295, 128]), torch.Size([1, 2295, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.8473396301269531  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.9629683494567871  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 2295, 128])
m.shape torch.Size([1996, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.9694881439208984  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.9694881439208984  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 1996, 128]), torch.Size([1, 1996, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.9713916778564453  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.0818767547607422  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 1996, 128])
m.shape torch.Size([1688, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.0890350341796875  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.0890350341796875  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 1688, 128]), torch.Size([1, 1688, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.0906448364257812  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.1945266723632812  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 1688, 128])
m.shape torch.Size([16106, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.2705211639404297  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.2705211639404297  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 16106, 128]), torch.Size([1, 16106, 128])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 1.2858810424804688  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.3863744735717773  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 16106, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.2627577781677246  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.309445858001709  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.3561339378356934  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.3090810775756836  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

torch.Size([48956, 256])
first layer input nodes number: 87717
first layer output nodes number: 48956
edges number: 289689
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.3567895889282227  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.403477668762207  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.415149688720703  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.415149688720703  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

m.shape torch.Size([4351, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.543539524078369  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.543539524078369  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 4351, 256]), torch.Size([1, 4351, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.552412509918213  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.6205201148986816  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 4351, 256])
m.shape torch.Size([3655, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.623396873474121  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.623396873474121  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 3655, 256]), torch.Size([1, 3655, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.6310319900512695  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.735602378845215  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 3655, 256])
m.shape torch.Size([2706, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.7399191856384277  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.7399191856384277  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 2706, 256]), torch.Size([1, 2706, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.745616912841797  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.859945297241211  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 2706, 256])
m.shape torch.Size([2049, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.8652424812316895  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.8652424812316895  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 2049, 256]), torch.Size([1, 2049, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.869352340698242  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.9844632148742676  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 2049, 256])
m.shape torch.Size([1681, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.9905877113342285  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.9905877113342285  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 1681, 256]), torch.Size([1, 1681, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 2.994448661804199  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.114077568054199  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 1681, 256])
m.shape torch.Size([1212, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.1194639205932617  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.1194639205932617  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 1212, 256]), torch.Size([1, 1212, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.1220645904541016  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.224379062652588  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 1212, 256])
m.shape torch.Size([972, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.2297630310058594  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.2297630310058594  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 972, 256]), torch.Size([1, 972, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.231616973876953  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.3243141174316406  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 972, 256])
m.shape torch.Size([854, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.329953670501709  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.329953670501709  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 854, 256]), torch.Size([1, 854, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.331582546234131  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.4244284629821777  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 854, 256])
m.shape torch.Size([670, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.429409980773926  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.429409980773926  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.43068790435791  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.515458106994629  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([545, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.5200576782226562  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.5200576782226562  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.521097183227539  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.5966548919677734  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([411, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.600480556488037  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.600480556488037  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.601264476776123  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.664315700531006  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([359, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.668064594268799  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.668064594268799  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.6687493324279785  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.7276692390441895  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([296, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.731822967529297  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.731822967529297  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.7323875427246094  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.7850141525268555  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([252, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.78812313079834  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.78812313079834  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.7886037826538086  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.836188316345215  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([215, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.839047908782959  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.839047908782959  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.8394579887390137  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.8829264640808105  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([165, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.8852591514587402  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.8852591514587402  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.8855738639831543  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.9211363792419434  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([176, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.9238548278808594  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.9238548278808594  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.9241905212402344  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.9644737243652344  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([143, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.967528820037842  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.967528820037842  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 3.967801570892334  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.002440929412842  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([126, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.004605770111084  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.004605770111084  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.004846096038818  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.037049770355225  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.038967609405518  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.038967609405518  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.039169788360596  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.067677021026611  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([94, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.0694732666015625  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.0694732666015625  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.069652557373047  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.096187591552734  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([61, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.097387790679932  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.097387790679932  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.097504138946533  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.115538120269775  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.116850852966309  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.116850852966309  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.116969108581543  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.136126518249512  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([76, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.137820720672607  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.137820720672607  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.137965679168701  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.162463665008545  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([834, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.182430744171143  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.182430744171143  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.184021472930908  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.469299793243408  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

rst.shape  torch.Size([1, 834, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.36660623550415  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.370091915130615  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.3733811378479  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.3697309494018555  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

torch.Size([22071, 40])
input nodes number: 48956
output nodes number: 22071
edges number: 128334
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.3697614669799805  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 4.369761943817139  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes
Using backend: pytorch

-----------------------------------------after loss backward
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.0658268928527832  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.0658268928527832  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.1072998046875 GB
    Memory Allocated: 0.0658268928527832  GigaBytes
Max Memory Allocated: 8.70240068435669  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038735270500183105 |0.002930581569671631 |0.13492846488952637 |9.98377799987793e-05 |0.09248465299606323 |0.004719257354736328 |
----------------------------------------------------------pseudo_mini_loss sum 3.524350881576538
Total (block generation + training)time/epoch 23.492173194885254
Training time/epoch 1.130136489868164
Training time without block to device /epoch 1.1184141635894775
Training time without total dataloading part /epoch 0.9147710800170898
load block tensor time/epoch 0.15494108200073242
block to device time/epoch 0.011722326278686523
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  504860
Number of first layer input nodes during this epoch:  306459
Number of first layer output nodes during this epoch:  198401
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
